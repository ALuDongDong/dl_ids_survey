2020-05-10 00:59:41,100 [INFO] Initialized logging. log_filename = results_selected_models/selected_ids18_full_lstm_shallow_rep2/run_log.log
2020-05-10 00:59:41,100 [INFO] ================= Running experiment no. 2  ================= 

2020-05-10 00:59:41,100 [INFO] Experiment parameters given below
2020-05-10 00:59:41,100 [INFO] 
{'experiment_num': 2, 'results_dir': 'results_selected_models/selected_ids18_full_lstm_shallow_rep2', 'model': 'lstm', 'model_type': 'classifier', 'normal_label': 'BENIGN', 'lstm_time_steps': 32, 'lstm_layer_units': [32], 'lstm_layer_activations': ['relu'], 'lstm_layer_dropout_rates': [0.2], 'batch_size': 8192, 'epochs': 80, 'early_stop_patience': 20, 'dataset_dir': '../Datasets/full_datasets/ids2018', 'description': 'selected_ids18_full_lstm_shallow_rep2'}
2020-05-10 00:59:41,101 [INFO] Created tensorboard log directory: results_selected_models/selected_ids18_full_lstm_shallow_rep2/tf_logs_run_2020_05_10-00_59_41
2020-05-10 00:59:41,101 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2018
2020-05-10 00:59:41,101 [INFO] Reading X, y files
2020-05-10 00:59:41,101 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_1.h5
2020-05-10 00:59:42,548 [INFO] Reading complete. time_to_read=1.45 seconds
2020-05-10 00:59:42,548 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_10.h5
2020-05-10 00:59:43,994 [INFO] Reading complete. time_to_read=1.45 seconds
2020-05-10 00:59:43,994 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_11.h5
2020-05-10 00:59:45,439 [INFO] Reading complete. time_to_read=1.44 seconds
2020-05-10 00:59:45,439 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_12.h5
2020-05-10 00:59:46,723 [INFO] Reading complete. time_to_read=1.28 seconds
2020-05-10 00:59:46,723 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_13.h5
2020-05-10 00:59:47,572 [INFO] Reading complete. time_to_read=0.85 seconds
2020-05-10 00:59:47,572 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_2.h5
2020-05-10 00:59:48,882 [INFO] Reading complete. time_to_read=1.31 seconds
2020-05-10 00:59:48,882 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_3.h5
2020-05-10 00:59:50,322 [INFO] Reading complete. time_to_read=1.44 seconds
2020-05-10 00:59:50,322 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_4.h5
2020-05-10 00:59:53,080 [INFO] Reading complete. time_to_read=2.76 seconds
2020-05-10 00:59:53,080 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_5.h5
2020-05-10 00:59:55,795 [INFO] Reading complete. time_to_read=2.71 seconds
2020-05-10 00:59:55,795 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_6.h5
2020-05-10 00:59:58,505 [INFO] Reading complete. time_to_read=2.71 seconds
2020-05-10 00:59:58,505 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_7.h5
2020-05-10 01:00:01,227 [INFO] Reading complete. time_to_read=2.72 seconds
2020-05-10 01:00:01,227 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_8.h5
2020-05-10 01:00:01,690 [INFO] Reading complete. time_to_read=0.46 seconds
2020-05-10 01:00:01,690 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_9.h5
2020-05-10 01:00:03,124 [INFO] Reading complete. time_to_read=1.43 seconds
2020-05-10 01:00:03,124 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_1.h5
2020-05-10 01:00:03,608 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 01:00:03,608 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_10.h5
2020-05-10 01:00:04,093 [INFO] Reading complete. time_to_read=0.49 seconds
2020-05-10 01:00:04,093 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_11.h5
2020-05-10 01:00:04,578 [INFO] Reading complete. time_to_read=0.49 seconds
2020-05-10 01:00:04,579 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_12.h5
2020-05-10 01:00:05,010 [INFO] Reading complete. time_to_read=0.43 seconds
2020-05-10 01:00:05,011 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_13.h5
2020-05-10 01:00:05,293 [INFO] Reading complete. time_to_read=0.28 seconds
2020-05-10 01:00:05,293 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_2.h5
2020-05-10 01:00:05,733 [INFO] Reading complete. time_to_read=0.44 seconds
2020-05-10 01:00:05,733 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_3.h5
2020-05-10 01:00:06,217 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 01:00:06,217 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_4.h5
2020-05-10 01:00:07,138 [INFO] Reading complete. time_to_read=0.92 seconds
2020-05-10 01:00:07,138 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_5.h5
2020-05-10 01:00:08,042 [INFO] Reading complete. time_to_read=0.90 seconds
2020-05-10 01:00:08,042 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_6.h5
2020-05-10 01:00:08,951 [INFO] Reading complete. time_to_read=0.91 seconds
2020-05-10 01:00:08,951 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_7.h5
2020-05-10 01:00:09,862 [INFO] Reading complete. time_to_read=0.91 seconds
2020-05-10 01:00:09,863 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_8.h5
2020-05-10 01:00:10,018 [INFO] Reading complete. time_to_read=0.16 seconds
2020-05-10 01:00:10,018 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_9.h5
2020-05-10 01:00:10,500 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 01:00:10,500 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_1.h5
2020-05-10 01:00:10,982 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 01:00:10,983 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_10.h5
2020-05-10 01:00:11,468 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 01:00:11,468 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_11.h5
2020-05-10 01:00:11,952 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 01:00:11,952 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_12.h5
2020-05-10 01:00:12,384 [INFO] Reading complete. time_to_read=0.43 seconds
2020-05-10 01:00:12,384 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_13.h5
2020-05-10 01:00:12,666 [INFO] Reading complete. time_to_read=0.28 seconds
2020-05-10 01:00:12,666 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_2.h5
2020-05-10 01:00:13,105 [INFO] Reading complete. time_to_read=0.44 seconds
2020-05-10 01:00:13,105 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_3.h5
2020-05-10 01:00:13,591 [INFO] Reading complete. time_to_read=0.49 seconds
2020-05-10 01:00:13,591 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_4.h5
2020-05-10 01:00:14,513 [INFO] Reading complete. time_to_read=0.92 seconds
2020-05-10 01:00:14,514 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_5.h5
2020-05-10 01:00:15,422 [INFO] Reading complete. time_to_read=0.91 seconds
2020-05-10 01:00:15,422 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_6.h5
2020-05-10 01:00:16,329 [INFO] Reading complete. time_to_read=0.91 seconds
2020-05-10 01:00:16,329 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_7.h5
2020-05-10 01:00:17,238 [INFO] Reading complete. time_to_read=0.91 seconds
2020-05-10 01:00:17,239 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_8.h5
2020-05-10 01:00:17,394 [INFO] Reading complete. time_to_read=0.16 seconds
2020-05-10 01:00:17,394 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_9.h5
2020-05-10 01:00:17,877 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 01:00:17,878 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_1.h5
2020-05-10 01:00:18,183 [INFO] Reading complete. time_to_read=0.31 seconds
2020-05-10 01:00:18,184 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_10.h5
2020-05-10 01:00:18,501 [INFO] Reading complete. time_to_read=0.32 seconds
2020-05-10 01:00:18,501 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_11.h5
2020-05-10 01:00:18,819 [INFO] Reading complete. time_to_read=0.32 seconds
2020-05-10 01:00:18,819 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_12.h5
2020-05-10 01:00:19,158 [INFO] Reading complete. time_to_read=0.34 seconds
2020-05-10 01:00:19,158 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_13.h5
2020-05-10 01:00:19,342 [INFO] Reading complete. time_to_read=0.18 seconds
2020-05-10 01:00:19,342 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_2.h5
2020-05-10 01:00:19,694 [INFO] Reading complete. time_to_read=0.35 seconds
2020-05-10 01:00:19,694 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_3.h5
2020-05-10 01:00:20,011 [INFO] Reading complete. time_to_read=0.32 seconds
2020-05-10 01:00:20,011 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_4.h5
2020-05-10 01:00:20,644 [INFO] Reading complete. time_to_read=0.63 seconds
2020-05-10 01:00:20,644 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_5.h5
2020-05-10 01:00:21,199 [INFO] Reading complete. time_to_read=0.55 seconds
2020-05-10 01:00:21,199 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_6.h5
2020-05-10 01:00:21,753 [INFO] Reading complete. time_to_read=0.55 seconds
2020-05-10 01:00:21,753 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_7.h5
2020-05-10 01:00:22,360 [INFO] Reading complete. time_to_read=0.61 seconds
2020-05-10 01:00:22,360 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_8.h5
2020-05-10 01:00:22,463 [INFO] Reading complete. time_to_read=0.10 seconds
2020-05-10 01:00:22,463 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_9.h5
2020-05-10 01:00:22,782 [INFO] Reading complete. time_to_read=0.32 seconds
2020-05-10 01:00:22,782 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_1.h5
2020-05-10 01:00:22,887 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:00:22,888 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_10.h5
2020-05-10 01:00:22,997 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:00:22,997 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_11.h5
2020-05-10 01:00:23,108 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:00:23,108 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_12.h5
2020-05-10 01:00:23,225 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 01:00:23,225 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_13.h5
2020-05-10 01:00:23,290 [INFO] Reading complete. time_to_read=0.06 seconds
2020-05-10 01:00:23,290 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_2.h5
2020-05-10 01:00:23,411 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 01:00:23,411 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_3.h5
2020-05-10 01:00:23,521 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:00:23,521 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_4.h5
2020-05-10 01:00:23,756 [INFO] Reading complete. time_to_read=0.23 seconds
2020-05-10 01:00:23,756 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_5.h5
2020-05-10 01:00:23,947 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:00:23,947 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_6.h5
2020-05-10 01:00:24,140 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:00:24,140 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_7.h5
2020-05-10 01:00:24,331 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:00:24,331 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_8.h5
2020-05-10 01:00:24,369 [INFO] Reading complete. time_to_read=0.04 seconds
2020-05-10 01:00:24,370 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_9.h5
2020-05-10 01:00:24,480 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:00:24,480 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_1.h5
2020-05-10 01:00:24,584 [INFO] Reading complete. time_to_read=0.10 seconds
2020-05-10 01:00:24,585 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_10.h5
2020-05-10 01:00:24,695 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:00:24,695 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_11.h5
2020-05-10 01:00:24,805 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:00:24,805 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_12.h5
2020-05-10 01:00:24,922 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 01:00:24,922 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_13.h5
2020-05-10 01:00:25,001 [INFO] Reading complete. time_to_read=0.08 seconds
2020-05-10 01:00:25,001 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_2.h5
2020-05-10 01:00:25,122 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 01:00:25,122 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_3.h5
2020-05-10 01:00:25,233 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:00:25,233 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_4.h5
2020-05-10 01:00:25,450 [INFO] Reading complete. time_to_read=0.22 seconds
2020-05-10 01:00:25,450 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_5.h5
2020-05-10 01:00:25,640 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:00:25,640 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_6.h5
2020-05-10 01:00:25,831 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:00:25,831 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_7.h5
2020-05-10 01:00:26,023 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:00:26,023 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_8.h5
2020-05-10 01:00:26,061 [INFO] Reading complete. time_to_read=0.04 seconds
2020-05-10 01:00:26,061 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_9.h5
2020-05-10 01:00:26,171 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:00:29,129 [INFO] Preparing flow sequences
2020-05-10 01:01:43,577 [INFO] Extracting flows complete. time_taken = 74.45 sec
2020-05-10 01:01:47,916 [INFO] Initializing model
2020-05-10 01:01:48,026 [INFO] Model: "sequential_2"
2020-05-10 01:01:48,026 [INFO] _________________________________________________________________
2020-05-10 01:01:48,026 [INFO] Layer (type)                 Output Shape              Param #   
2020-05-10 01:01:48,026 [INFO] =================================================================
2020-05-10 01:01:48,027 [INFO] lstm_2 (LSTM)                (None, 32, 32)            14080     
2020-05-10 01:01:48,027 [INFO] _________________________________________________________________
2020-05-10 01:01:48,027 [INFO] batch_normalization_2 (Batch (None, 32, 32)            128       
2020-05-10 01:01:48,027 [INFO] _________________________________________________________________
2020-05-10 01:01:48,027 [INFO] dropout_2 (Dropout)          (None, 32, 32)            0         
2020-05-10 01:01:48,027 [INFO] _________________________________________________________________
2020-05-10 01:01:48,027 [INFO] time_distributed_2 (TimeDist (None, 32, 15)            495       
2020-05-10 01:01:48,027 [INFO] =================================================================
2020-05-10 01:01:48,027 [INFO] Total params: 14,703
2020-05-10 01:01:48,027 [INFO] Trainable params: 14,639
2020-05-10 01:01:48,027 [INFO] Non-trainable params: 64
2020-05-10 01:01:48,027 [INFO] _________________________________________________________________
2020-05-10 01:01:48,027 [INFO] Training model
2020-05-10 01:06:40,107 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-05-10 01:06:40,109 [INFO] Training complete. time_to_train = 292.08 sec, 4.87 min
2020-05-10 01:06:40,115 [INFO] Model saved to results_selected_models/selected_ids18_full_lstm_shallow_rep2/best_model.pickle
2020-05-10 01:06:40,117 [INFO] Training history saved to: results_selected_models/selected_ids18_full_lstm_shallow_rep2/training_error_history.csv
2020-05-10 01:06:40,214 [INFO] Plot saved to: results_selected_models/selected_ids18_full_lstm_shallow_rep2/training_error_history.png
2020-05-10 01:06:40,215 [INFO] Making predictions on training, validation, testing data
2020-05-10 01:06:57,834 [INFO] Making predictions complete. time_to_predict = 17.62 sec, 0.29 min
2020-05-10 01:06:57,880 [INFO] Evaluating predictions (results)
2020-05-10 01:08:43,230 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate    avg f1
0     Micro avg      0.988884       0.988884                     0.988884              0.000794                 0.011116  0.988884
1     Macro avg      0.998518       0.762661                     0.709205              0.004156                 0.290795  0.717231
2  Weighted avg      0.990903       0.984436                     0.988884              0.051228                 0.011116  0.983965
2020-05-10 01:08:43,263 [INFO] Results saved to: results_selected_models/selected_ids18_full_lstm_shallow_rep2/selected_ids18_full_lstm_shallow_rep2_results.xlsx
2020-05-10 01:08:43,268 [INFO] ================= Finished running experiment no. 2 ================= 

2020-05-10 01:08:43,537 [INFO] Created directory: results_selected_models/selected_ids18_full_lstm_shallow_rep3
