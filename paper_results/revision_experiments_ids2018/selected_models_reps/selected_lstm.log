Using TensorFlow backend.
2020-05-10 00:48:50,637 [INFO] Read 8 experiments from file: experiment_specs/selected_model_tests/selected_lstm.csv
2020-05-10 00:48:50,637 [INFO] ================= Started running experiments ================= 

2020-05-10 00:48:50,637 [INFO] Created directory: results_selected_models/selected_ids18_full_lstm_shallow_rep1
2020-05-10 00:48:50,637 [INFO] Initialized logging. log_filename = results_selected_models/selected_ids18_full_lstm_shallow_rep1/run_log.log
2020-05-10 00:48:50,637 [INFO] ================= Running experiment no. 1  ================= 

2020-05-10 00:48:50,637 [INFO] Experiment parameters given below
2020-05-10 00:48:50,638 [INFO] 
{'experiment_num': 1, 'results_dir': 'results_selected_models/selected_ids18_full_lstm_shallow_rep1', 'model': 'lstm', 'model_type': 'classifier', 'normal_label': 'BENIGN', 'lstm_time_steps': 32, 'lstm_layer_units': [32], 'lstm_layer_activations': ['relu'], 'lstm_layer_dropout_rates': [0.2], 'batch_size': 8192, 'epochs': 80, 'early_stop_patience': 20, 'dataset_dir': '../Datasets/full_datasets/ids2018', 'description': 'selected_ids18_full_lstm_shallow_rep1'}
2020-05-10 00:48:50,638 [INFO] Created tensorboard log directory: results_selected_models/selected_ids18_full_lstm_shallow_rep1/tf_logs_run_2020_05_10-00_48_50
2020-05-10 00:48:50,638 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2018
2020-05-10 00:48:50,638 [INFO] Reading X, y files
2020-05-10 00:48:50,639 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_1.h5
2020-05-10 00:48:50,643 [INFO] Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2020-05-10 00:48:50,644 [INFO] NumExpr defaulting to 8 threads.
2020-05-10 00:48:52,035 [INFO] Reading complete. time_to_read=1.40 seconds
2020-05-10 00:48:52,035 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_10.h5
2020-05-10 00:48:53,423 [INFO] Reading complete. time_to_read=1.39 seconds
2020-05-10 00:48:53,423 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_11.h5
2020-05-10 00:48:54,809 [INFO] Reading complete. time_to_read=1.39 seconds
2020-05-10 00:48:54,809 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_12.h5
2020-05-10 00:48:56,050 [INFO] Reading complete. time_to_read=1.24 seconds
2020-05-10 00:48:56,050 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_13.h5
2020-05-10 00:48:56,865 [INFO] Reading complete. time_to_read=0.82 seconds
2020-05-10 00:48:56,866 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_2.h5
2020-05-10 00:48:58,126 [INFO] Reading complete. time_to_read=1.26 seconds
2020-05-10 00:48:58,126 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_3.h5
2020-05-10 00:48:59,510 [INFO] Reading complete. time_to_read=1.38 seconds
2020-05-10 00:48:59,510 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_4.h5
2020-05-10 00:49:02,160 [INFO] Reading complete. time_to_read=2.65 seconds
2020-05-10 00:49:02,160 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_5.h5
2020-05-10 00:49:04,769 [INFO] Reading complete. time_to_read=2.61 seconds
2020-05-10 00:49:04,769 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_6.h5
2020-05-10 00:49:07,374 [INFO] Reading complete. time_to_read=2.60 seconds
2020-05-10 00:49:07,374 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_7.h5
2020-05-10 00:49:09,994 [INFO] Reading complete. time_to_read=2.62 seconds
2020-05-10 00:49:09,994 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_8.h5
2020-05-10 00:49:10,439 [INFO] Reading complete. time_to_read=0.44 seconds
2020-05-10 00:49:10,439 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_9.h5
2020-05-10 00:49:11,818 [INFO] Reading complete. time_to_read=1.38 seconds
2020-05-10 00:49:11,818 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_1.h5
2020-05-10 00:49:12,283 [INFO] Reading complete. time_to_read=0.46 seconds
2020-05-10 00:49:12,283 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_10.h5
2020-05-10 00:49:12,750 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-10 00:49:12,750 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_11.h5
2020-05-10 00:49:13,218 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-10 00:49:13,218 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_12.h5
2020-05-10 00:49:13,632 [INFO] Reading complete. time_to_read=0.41 seconds
2020-05-10 00:49:13,632 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_13.h5
2020-05-10 00:49:13,902 [INFO] Reading complete. time_to_read=0.27 seconds
2020-05-10 00:49:13,903 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_2.h5
2020-05-10 00:49:14,325 [INFO] Reading complete. time_to_read=0.42 seconds
2020-05-10 00:49:14,325 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_3.h5
2020-05-10 00:49:14,791 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-10 00:49:14,791 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_4.h5
2020-05-10 00:49:15,675 [INFO] Reading complete. time_to_read=0.88 seconds
2020-05-10 00:49:15,675 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_5.h5
2020-05-10 00:49:16,544 [INFO] Reading complete. time_to_read=0.87 seconds
2020-05-10 00:49:16,544 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_6.h5
2020-05-10 00:49:17,417 [INFO] Reading complete. time_to_read=0.87 seconds
2020-05-10 00:49:17,417 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_7.h5
2020-05-10 00:49:18,293 [INFO] Reading complete. time_to_read=0.88 seconds
2020-05-10 00:49:18,293 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_8.h5
2020-05-10 00:49:18,442 [INFO] Reading complete. time_to_read=0.15 seconds
2020-05-10 00:49:18,442 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_9.h5
2020-05-10 00:49:18,905 [INFO] Reading complete. time_to_read=0.46 seconds
2020-05-10 00:49:18,905 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_1.h5
2020-05-10 00:49:19,369 [INFO] Reading complete. time_to_read=0.46 seconds
2020-05-10 00:49:19,370 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_10.h5
2020-05-10 00:49:19,836 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-10 00:49:19,836 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_11.h5
2020-05-10 00:49:20,303 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-10 00:49:20,303 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_12.h5
2020-05-10 00:49:20,717 [INFO] Reading complete. time_to_read=0.41 seconds
2020-05-10 00:49:20,717 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_13.h5
2020-05-10 00:49:20,988 [INFO] Reading complete. time_to_read=0.27 seconds
2020-05-10 00:49:20,988 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_2.h5
2020-05-10 00:49:21,411 [INFO] Reading complete. time_to_read=0.42 seconds
2020-05-10 00:49:21,412 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_3.h5
2020-05-10 00:49:21,879 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-10 00:49:21,879 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_4.h5
2020-05-10 00:49:22,768 [INFO] Reading complete. time_to_read=0.89 seconds
2020-05-10 00:49:22,768 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_5.h5
2020-05-10 00:49:23,640 [INFO] Reading complete. time_to_read=0.87 seconds
2020-05-10 00:49:23,640 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_6.h5
2020-05-10 00:49:24,513 [INFO] Reading complete. time_to_read=0.87 seconds
2020-05-10 00:49:24,513 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_7.h5
2020-05-10 00:49:25,388 [INFO] Reading complete. time_to_read=0.88 seconds
2020-05-10 00:49:25,389 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_8.h5
2020-05-10 00:49:25,538 [INFO] Reading complete. time_to_read=0.15 seconds
2020-05-10 00:49:25,538 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_9.h5
2020-05-10 00:49:26,002 [INFO] Reading complete. time_to_read=0.46 seconds
2020-05-10 00:49:26,002 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_1.h5
2020-05-10 00:49:26,296 [INFO] Reading complete. time_to_read=0.29 seconds
2020-05-10 00:49:26,296 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_10.h5
2020-05-10 00:49:26,604 [INFO] Reading complete. time_to_read=0.31 seconds
2020-05-10 00:49:26,604 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_11.h5
2020-05-10 00:49:26,915 [INFO] Reading complete. time_to_read=0.31 seconds
2020-05-10 00:49:26,915 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_12.h5
2020-05-10 00:49:27,244 [INFO] Reading complete. time_to_read=0.33 seconds
2020-05-10 00:49:27,245 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_13.h5
2020-05-10 00:49:27,423 [INFO] Reading complete. time_to_read=0.18 seconds
2020-05-10 00:49:27,423 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_2.h5
2020-05-10 00:49:27,763 [INFO] Reading complete. time_to_read=0.34 seconds
2020-05-10 00:49:27,763 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_3.h5
2020-05-10 00:49:28,093 [INFO] Reading complete. time_to_read=0.33 seconds
2020-05-10 00:49:28,093 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_4.h5
2020-05-10 00:49:28,702 [INFO] Reading complete. time_to_read=0.61 seconds
2020-05-10 00:49:28,702 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_5.h5
2020-05-10 00:49:29,231 [INFO] Reading complete. time_to_read=0.53 seconds
2020-05-10 00:49:29,231 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_6.h5
2020-05-10 00:49:29,762 [INFO] Reading complete. time_to_read=0.53 seconds
2020-05-10 00:49:29,762 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_7.h5
2020-05-10 00:49:30,296 [INFO] Reading complete. time_to_read=0.53 seconds
2020-05-10 00:49:30,296 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_8.h5
2020-05-10 00:49:30,394 [INFO] Reading complete. time_to_read=0.10 seconds
2020-05-10 00:49:30,395 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_9.h5
2020-05-10 00:49:30,701 [INFO] Reading complete. time_to_read=0.31 seconds
2020-05-10 00:49:30,701 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_1.h5
2020-05-10 00:49:30,803 [INFO] Reading complete. time_to_read=0.10 seconds
2020-05-10 00:49:30,803 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_10.h5
2020-05-10 00:49:30,909 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 00:49:30,909 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_11.h5
2020-05-10 00:49:31,014 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 00:49:31,014 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_12.h5
2020-05-10 00:49:31,165 [INFO] Reading complete. time_to_read=0.15 seconds
2020-05-10 00:49:31,165 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_13.h5
2020-05-10 00:49:31,228 [INFO] Reading complete. time_to_read=0.06 seconds
2020-05-10 00:49:31,228 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_2.h5
2020-05-10 00:49:31,346 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 00:49:31,346 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_3.h5
2020-05-10 00:49:31,452 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 00:49:31,452 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_4.h5
2020-05-10 00:49:31,662 [INFO] Reading complete. time_to_read=0.21 seconds
2020-05-10 00:49:31,662 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_5.h5
2020-05-10 00:49:31,847 [INFO] Reading complete. time_to_read=0.18 seconds
2020-05-10 00:49:31,847 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_6.h5
2020-05-10 00:49:32,031 [INFO] Reading complete. time_to_read=0.18 seconds
2020-05-10 00:49:32,031 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_7.h5
2020-05-10 00:49:32,218 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 00:49:32,218 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_8.h5
2020-05-10 00:49:32,255 [INFO] Reading complete. time_to_read=0.04 seconds
2020-05-10 00:49:32,255 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_9.h5
2020-05-10 00:49:32,362 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 00:49:32,362 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_1.h5
2020-05-10 00:49:32,480 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 00:49:32,480 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_10.h5
2020-05-10 00:49:32,588 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 00:49:32,588 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_11.h5
2020-05-10 00:49:32,696 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 00:49:32,696 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_12.h5
2020-05-10 00:49:32,809 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 00:49:32,809 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_13.h5
2020-05-10 00:49:32,871 [INFO] Reading complete. time_to_read=0.06 seconds
2020-05-10 00:49:32,871 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_2.h5
2020-05-10 00:49:32,990 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 00:49:32,990 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_3.h5
2020-05-10 00:49:33,099 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 00:49:33,099 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_4.h5
2020-05-10 00:49:33,312 [INFO] Reading complete. time_to_read=0.21 seconds
2020-05-10 00:49:33,312 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_5.h5
2020-05-10 00:49:33,498 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 00:49:33,498 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_6.h5
2020-05-10 00:49:33,686 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 00:49:33,687 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_7.h5
2020-05-10 00:49:33,889 [INFO] Reading complete. time_to_read=0.20 seconds
2020-05-10 00:49:33,889 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_8.h5
2020-05-10 00:49:33,927 [INFO] Reading complete. time_to_read=0.04 seconds
2020-05-10 00:49:33,927 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_9.h5
2020-05-10 00:49:34,035 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 00:49:36,946 [INFO] Preparing flow sequences
2020-05-10 00:50:51,328 [INFO] Extracting flows complete. time_taken = 74.38 sec
2020-05-10 00:50:55,670 [INFO] Initializing model
2020-05-10 00:50:55.674025: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-05-10 00:50:55.710899: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 00:50:55.711456: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1555] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2020-05-10 00:50:55.711515: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 00:50:55.712003: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1555] Found device 1 with properties: 
pciBusID: 0000:09:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2020-05-10 00:50:55.712138: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-10 00:50:55.713129: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-05-10 00:50:55.714086: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-05-10 00:50:55.714226: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-05-10 00:50:55.715043: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-05-10 00:50:55.715436: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-05-10 00:50:55.717137: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-05-10 00:50:55.717244: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 00:50:55.717823: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 00:50:55.718373: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 00:50:55.718900: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 00:50:55.719393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1697] Adding visible gpu devices: 0, 1
2020-05-10 00:50:55.719602: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2020-05-10 00:50:55.743064: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3792870000 Hz
2020-05-10 00:50:55.743790: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d50b93ad40 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-10 00:50:55.743818: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-05-10 00:50:55.917160: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 00:50:55.917662: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1555] Found device 0 with properties: 
pciBusID: 0000:08:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2020-05-10 00:50:55.917720: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 00:50:55.918171: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1555] Found device 1 with properties: 
pciBusID: 0000:09:00.0 name: GeForce RTX 2080 Ti computeCapability: 7.5
coreClock: 1.545GHz coreCount: 68 deviceMemorySize: 10.76GiB deviceMemoryBandwidth: 573.69GiB/s
2020-05-10 00:50:55.918206: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-10 00:50:55.918216: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-05-10 00:50:55.918226: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2020-05-10 00:50:55.918244: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2020-05-10 00:50:55.918256: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2020-05-10 00:50:55.918266: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2020-05-10 00:50:55.918276: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-05-10 00:50:55.918326: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 00:50:55.918814: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 00:50:55.919311: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 00:50:55.919798: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 00:50:55.920241: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1697] Adding visible gpu devices: 0, 1
2020-05-10 00:50:55.920267: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2020-05-10 00:50:55.921626: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1096] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-05-10 00:50:55.921634: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102]      0 1 
2020-05-10 00:50:55.921639: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] 0:   N N 
2020-05-10 00:50:55.921642: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] 1:   N N 
2020-05-10 00:50:55.921735: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 00:50:55.922224: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 00:50:55.922710: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 00:50:55.923204: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 00:50:55.923668: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1241] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10197 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:08:00.0, compute capability: 7.5)
2020-05-10 00:50:55.923906: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 00:50:55.924405: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:981] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-05-10 00:50:55.924857: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1241] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 10311 MB memory) -> physical GPU (device: 1, name: GeForce RTX 2080 Ti, pci bus id: 0000:09:00.0, compute capability: 7.5)
2020-05-10 00:50:55.926094: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d50d270700 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-05-10 00:50:55.926107: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-05-10 00:50:55.926111: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (1): GeForce RTX 2080 Ti, Compute Capability 7.5
2020-05-10 00:50:56,309 [INFO] Model: "sequential_1"
2020-05-10 00:50:56,309 [INFO] _________________________________________________________________
2020-05-10 00:50:56,309 [INFO] Layer (type)                 Output Shape              Param #   
2020-05-10 00:50:56,309 [INFO] =================================================================
2020-05-10 00:50:56,309 [INFO] lstm_1 (LSTM)                (None, 32, 32)            14080     
2020-05-10 00:50:56,309 [INFO] _________________________________________________________________
2020-05-10 00:50:56,309 [INFO] batch_normalization_1 (Batch (None, 32, 32)            128       
2020-05-10 00:50:56,309 [INFO] _________________________________________________________________
2020-05-10 00:50:56,309 [INFO] dropout_1 (Dropout)          (None, 32, 32)            0         
2020-05-10 00:50:56,309 [INFO] _________________________________________________________________
2020-05-10 00:50:56,309 [INFO] time_distributed_1 (TimeDist (None, 32, 15)            495       
2020-05-10 00:50:56,309 [INFO] =================================================================
2020-05-10 00:50:56,310 [INFO] Total params: 14,703
2020-05-10 00:50:56,310 [INFO] Trainable params: 14,639
2020-05-10 00:50:56,310 [INFO] Non-trainable params: 64
2020-05-10 00:50:56,310 [INFO] _________________________________________________________________
2020-05-10 00:50:56,310 [INFO] Training model
2020-05-10 00:50:56.912026: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] layout failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 00:50:56.913417: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/time_distributed_1_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/time_distributed_1_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 00:50:56.919013: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 00:50:56.921518: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 00:50:56.943956: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 00:50:56.945416: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/time_distributed_1_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/time_distributed_1_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 00:50:56.947378: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 00:50:56.949166: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 00:50:56.953331: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 00:50:57.073693: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2020-05-10 00:51:01.075221: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] layout failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 00:51:01.075553: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/time_distributed_1_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/time_distributed_1_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 00:51:01.076688: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 00:51:01.077201: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 00:51:01.080999: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 00:51:01.081305: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss/time_distributed_1_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss/time_distributed_1_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 00:51:01.081672: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 00:51:01.081998: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 00:51:01.082790: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
Train on 302572 samples, validate on 100857 samples
Epoch 1/80
 - 5s - loss: 0.2400 - val_loss: 0.2138
Epoch 2/80
 - 5s - loss: 0.1835 - val_loss: 0.1793
Epoch 3/80
 - 5s - loss: 0.1373 - val_loss: 0.1335
Epoch 4/80
 - 5s - loss: 0.0923 - val_loss: 0.0843
Epoch 5/80
 - 5s - loss: 0.0597 - val_loss: 0.0556
Epoch 6/80
 - 5s - loss: 0.0438 - val_loss: 0.0429
Epoch 7/80
 - 5s - loss: 0.0368 - val_loss: 0.0362
Epoch 8/80
 - 5s - loss: 0.0324 - val_loss: 0.0316
Epoch 9/80
 - 5s - loss: 0.0291 - val_loss: 0.0282
Epoch 10/80
 - 5s - loss: 0.0266 - val_loss: 0.0255
Epoch 11/80
 - 5s - loss: 0.0246 - val_loss: 0.0234
Epoch 12/80
 - 5s - loss: 0.0229 - val_loss: 0.0219
Epoch 13/80
 - 5s - loss: 0.0216 - val_loss: 0.0204
Epoch 14/80
 - 5s - loss: 0.0203 - val_loss: 0.0192
Epoch 15/80
 - 5s - loss: 0.0192 - val_loss: 0.0181
Epoch 16/80
 - 5s - loss: 0.0181 - val_loss: 0.0170
Epoch 17/80
 - 5s - loss: 0.0170 - val_loss: 0.0158
Epoch 18/80
 - 5s - loss: 0.0160 - val_loss: 0.0147
Epoch 19/80
 - 5s - loss: 0.0153 - val_loss: 0.0137
Epoch 20/80
 - 5s - loss: 0.0146 - val_loss: 0.0129
Epoch 21/80
 - 5s - loss: 0.0141 - val_loss: 0.0121
Epoch 22/80
 - 5s - loss: 0.0136 - val_loss: 0.0115
Epoch 23/80
 - 5s - loss: 0.0132 - val_loss: 0.0110
Epoch 24/80
 - 5s - loss: 0.0127 - val_loss: 0.0106
Epoch 25/80
 - 5s - loss: 0.0124 - val_loss: 0.0102
Epoch 26/80
 - 5s - loss: 0.0121 - val_loss: 0.0099
Epoch 27/80
 - 5s - loss: 0.0118 - val_loss: 0.0096
Epoch 28/80
 - 5s - loss: 0.0115 - val_loss: 0.0094
Epoch 29/80
 - 5s - loss: 0.0113 - val_loss: 0.0091
Epoch 30/80
 - 5s - loss: 0.0110 - val_loss: 0.0088
Epoch 31/80
 - 5s - loss: 0.0108 - val_loss: 0.0087
Epoch 32/80
 - 5s - loss: 0.0106 - val_loss: 0.0085
Epoch 33/80
 - 5s - loss: 0.0104 - val_loss: 0.0083
Epoch 34/80
 - 5s - loss: 0.0102 - val_loss: 0.0082
Epoch 35/80
 - 5s - loss: 0.0100 - val_loss: 0.0081
Epoch 36/80
 - 5s - loss: 0.0099 - val_loss: 0.0080
Epoch 37/80
 - 5s - loss: 0.0098 - val_loss: 0.0079
Epoch 38/80
 - 5s - loss: 0.0096 - val_loss: 0.0077
Epoch 39/80
 - 5s - loss: 0.0094 - val_loss: 0.0076
Epoch 40/80
 - 5s - loss: 0.0093 - val_loss: 0.0076
Epoch 41/80
 - 5s - loss: 0.0092 - val_loss: 0.0074
Epoch 42/80
 - 5s - loss: 0.0091 - val_loss: 0.0074
Epoch 43/80
 - 5s - loss: 0.0090 - val_loss: 0.0073
Epoch 44/80
 - 5s - loss: 0.0088 - val_loss: 0.0072
Epoch 45/80
 - 5s - loss: 0.0087 - val_loss: 0.0070
Epoch 46/80
 - 5s - loss: 0.0086 - val_loss: 0.0070
Epoch 47/80
 - 5s - loss: 0.0085 - val_loss: 0.0070
Epoch 48/80
 - 5s - loss: 0.0084 - val_loss: 0.0069
Epoch 49/80
 - 5s - loss: 0.0083 - val_loss: 0.0068
Epoch 50/80
 - 5s - loss: 0.0082 - val_loss: 0.0067
Epoch 51/80
 - 5s - loss: 0.0082 - val_loss: 0.0067
Epoch 52/80
 - 5s - loss: 0.0081 - val_loss: 0.0066
Epoch 53/80
 - 5s - loss: 0.0080 - val_loss: 0.0064
Epoch 54/80
 - 5s - loss: 0.0078 - val_loss: 0.0064
Epoch 55/80
 - 5s - loss: 0.0077 - val_loss: 0.0063
Epoch 56/80
 - 5s - loss: 0.0076 - val_loss: 0.0063
Epoch 57/80
 - 5s - loss: 0.0076 - val_loss: 0.0062
Epoch 58/80
 - 5s - loss: 0.0075 - val_loss: 0.0062
Epoch 59/80
 - 5s - loss: 0.0074 - val_loss: 0.0061
Epoch 60/80
 - 5s - loss: 0.0073 - val_loss: 0.0061
Epoch 61/80
 - 5s - loss: 0.0073 - val_loss: 0.0060
Epoch 62/80
 - 5s - loss: 0.0072 - val_loss: 0.0060
Epoch 63/80
 - 5s - loss: 0.0072 - val_loss: 0.0059
Epoch 64/80
 - 5s - loss: 0.0071 - val_loss: 0.0059
Epoch 65/80
 - 5s - loss: 0.0070 - val_loss: 0.0058
Epoch 66/80
 - 5s - loss: 0.0070 - val_loss: 0.0058
Epoch 67/80
 - 5s - loss: 0.0069 - val_loss: 0.0058
Epoch 68/80
 - 5s - loss: 0.0069 - val_loss: 0.0057
Epoch 69/80
 - 5s - loss: 0.0068 - val_loss: 0.0057
Epoch 70/80
 - 5s - loss: 0.0068 - val_loss: 0.0057
Epoch 71/80
 - 5s - loss: 0.0067 - val_loss: 0.0057
Epoch 72/80
 - 5s - loss: 0.0067 - val_loss: 0.0056
Epoch 73/80
 - 5s - loss: 0.0066 - val_loss: 0.0056
Epoch 74/80
 - 5s - loss: 0.0066 - val_loss: 0.0056
Epoch 75/80
 - 5s - loss: 0.0065 - val_loss: 0.0056
Epoch 76/80
 - 5s - loss: 0.0065 - val_loss: 0.0055
Epoch 77/80
 - 5s - loss: 0.0065 - val_loss: 0.0055
Epoch 78/80
 - 5s - loss: 0.0064 - val_loss: 0.0055
Epoch 79/80
 - 5s - loss: 0.0064 - val_loss: 0.0055
Epoch 80/80
 - 5s - loss: 0.0063 - val_loss: 0.0054
2020-05-10 00:57:27,786 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-05-10 00:57:27,787 [INFO] Training complete. time_to_train = 391.48 sec, 6.52 min
2020-05-10 00:57:27,791 [INFO] Model saved to results_selected_models/selected_ids18_full_lstm_shallow_rep1/best_model.pickle
2020-05-10 00:57:27,792 [INFO] Training history saved to: results_selected_models/selected_ids18_full_lstm_shallow_rep1/training_error_history.csv
2020-05-10 00:57:27,898 [INFO] Plot saved to: results_selected_models/selected_ids18_full_lstm_shallow_rep1/training_error_history.png
2020-05-10 00:57:27,898 [INFO] Making predictions on training, validation, testing data
2020-05-10 00:57:45,517 [INFO] Making predictions complete. time_to_predict = 17.62 sec, 0.29 min
2020-05-10 00:57:45,567 [INFO] Evaluating predictions (results)
/home/sunanda/.conda/envs/ml_env_gpu/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sunanda/research/ids_experiments/utility.py:328: RuntimeWarning: invalid value encountered in true_divide
  PPV = TP / (TP + FP)    # Precision or positive predictive value
/home/sunanda/research/ids_experiments/utility.py:332: RuntimeWarning: invalid value encountered in true_divide
  FDR = FP / (TP + FP)    # False discovery rate
/home/sunanda/research/ids_experiments/utility.py:334: RuntimeWarning: invalid value encountered in true_divide
  F1 = (2 * PPV * TPR) / (PPV + TPR)  # F1 score
2020-05-10 00:59:40,707 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate    avg f1
0     Micro avg      0.988655       0.988655                     0.988655              0.000810                 0.011345  0.988655
1     Macro avg      0.998487       0.750831                     0.708633              0.004130                 0.291367  0.715640
2  Weighted avg      0.990757       0.982816                     0.988655              0.050601                 0.011345  0.983800
2020-05-10 00:59:40,806 [INFO] Results saved to: results_selected_models/selected_ids18_full_lstm_shallow_rep1/selected_ids18_full_lstm_shallow_rep1_results.xlsx
2020-05-10 00:59:40,811 [INFO] ================= Finished running experiment no. 1 ================= 

2020-05-10 00:59:41,100 [INFO] Created directory: results_selected_models/selected_ids18_full_lstm_shallow_rep2
2020-05-10 00:59:41,100 [INFO] Initialized logging. log_filename = results_selected_models/selected_ids18_full_lstm_shallow_rep2/run_log.log
2020-05-10 00:59:41,100 [INFO] ================= Running experiment no. 2  ================= 

2020-05-10 00:59:41,100 [INFO] Experiment parameters given below
2020-05-10 00:59:41,100 [INFO] 
{'experiment_num': 2, 'results_dir': 'results_selected_models/selected_ids18_full_lstm_shallow_rep2', 'model': 'lstm', 'model_type': 'classifier', 'normal_label': 'BENIGN', 'lstm_time_steps': 32, 'lstm_layer_units': [32], 'lstm_layer_activations': ['relu'], 'lstm_layer_dropout_rates': [0.2], 'batch_size': 8192, 'epochs': 80, 'early_stop_patience': 20, 'dataset_dir': '../Datasets/full_datasets/ids2018', 'description': 'selected_ids18_full_lstm_shallow_rep2'}
2020-05-10 00:59:41,101 [INFO] Created tensorboard log directory: results_selected_models/selected_ids18_full_lstm_shallow_rep2/tf_logs_run_2020_05_10-00_59_41
2020-05-10 00:59:41,101 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2018
2020-05-10 00:59:41,101 [INFO] Reading X, y files
2020-05-10 00:59:41,101 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_1.h5
2020-05-10 00:59:42,548 [INFO] Reading complete. time_to_read=1.45 seconds
2020-05-10 00:59:42,548 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_10.h5
2020-05-10 00:59:43,994 [INFO] Reading complete. time_to_read=1.45 seconds
2020-05-10 00:59:43,994 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_11.h5
2020-05-10 00:59:45,439 [INFO] Reading complete. time_to_read=1.44 seconds
2020-05-10 00:59:45,439 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_12.h5
2020-05-10 00:59:46,723 [INFO] Reading complete. time_to_read=1.28 seconds
2020-05-10 00:59:46,723 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_13.h5
2020-05-10 00:59:47,572 [INFO] Reading complete. time_to_read=0.85 seconds
2020-05-10 00:59:47,572 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_2.h5
2020-05-10 00:59:48,882 [INFO] Reading complete. time_to_read=1.31 seconds
2020-05-10 00:59:48,882 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_3.h5
2020-05-10 00:59:50,322 [INFO] Reading complete. time_to_read=1.44 seconds
2020-05-10 00:59:50,322 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_4.h5
2020-05-10 00:59:53,080 [INFO] Reading complete. time_to_read=2.76 seconds
2020-05-10 00:59:53,080 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_5.h5
2020-05-10 00:59:55,795 [INFO] Reading complete. time_to_read=2.71 seconds
2020-05-10 00:59:55,795 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_6.h5
2020-05-10 00:59:58,505 [INFO] Reading complete. time_to_read=2.71 seconds
2020-05-10 00:59:58,505 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_7.h5
2020-05-10 01:00:01,227 [INFO] Reading complete. time_to_read=2.72 seconds
2020-05-10 01:00:01,227 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_8.h5
2020-05-10 01:00:01,690 [INFO] Reading complete. time_to_read=0.46 seconds
2020-05-10 01:00:01,690 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_9.h5
2020-05-10 01:00:03,124 [INFO] Reading complete. time_to_read=1.43 seconds
2020-05-10 01:00:03,124 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_1.h5
2020-05-10 01:00:03,608 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 01:00:03,608 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_10.h5
2020-05-10 01:00:04,093 [INFO] Reading complete. time_to_read=0.49 seconds
2020-05-10 01:00:04,093 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_11.h5
2020-05-10 01:00:04,578 [INFO] Reading complete. time_to_read=0.49 seconds
2020-05-10 01:00:04,579 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_12.h5
2020-05-10 01:00:05,010 [INFO] Reading complete. time_to_read=0.43 seconds
2020-05-10 01:00:05,011 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_13.h5
2020-05-10 01:00:05,293 [INFO] Reading complete. time_to_read=0.28 seconds
2020-05-10 01:00:05,293 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_2.h5
2020-05-10 01:00:05,733 [INFO] Reading complete. time_to_read=0.44 seconds
2020-05-10 01:00:05,733 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_3.h5
2020-05-10 01:00:06,217 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 01:00:06,217 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_4.h5
2020-05-10 01:00:07,138 [INFO] Reading complete. time_to_read=0.92 seconds
2020-05-10 01:00:07,138 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_5.h5
2020-05-10 01:00:08,042 [INFO] Reading complete. time_to_read=0.90 seconds
2020-05-10 01:00:08,042 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_6.h5
2020-05-10 01:00:08,951 [INFO] Reading complete. time_to_read=0.91 seconds
2020-05-10 01:00:08,951 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_7.h5
2020-05-10 01:00:09,862 [INFO] Reading complete. time_to_read=0.91 seconds
2020-05-10 01:00:09,863 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_8.h5
2020-05-10 01:00:10,018 [INFO] Reading complete. time_to_read=0.16 seconds
2020-05-10 01:00:10,018 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_9.h5
2020-05-10 01:00:10,500 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 01:00:10,500 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_1.h5
2020-05-10 01:00:10,982 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 01:00:10,983 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_10.h5
2020-05-10 01:00:11,468 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 01:00:11,468 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_11.h5
2020-05-10 01:00:11,952 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 01:00:11,952 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_12.h5
2020-05-10 01:00:12,384 [INFO] Reading complete. time_to_read=0.43 seconds
2020-05-10 01:00:12,384 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_13.h5
2020-05-10 01:00:12,666 [INFO] Reading complete. time_to_read=0.28 seconds
2020-05-10 01:00:12,666 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_2.h5
2020-05-10 01:00:13,105 [INFO] Reading complete. time_to_read=0.44 seconds
2020-05-10 01:00:13,105 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_3.h5
2020-05-10 01:00:13,591 [INFO] Reading complete. time_to_read=0.49 seconds
2020-05-10 01:00:13,591 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_4.h5
2020-05-10 01:00:14,513 [INFO] Reading complete. time_to_read=0.92 seconds
2020-05-10 01:00:14,514 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_5.h5
2020-05-10 01:00:15,422 [INFO] Reading complete. time_to_read=0.91 seconds
2020-05-10 01:00:15,422 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_6.h5
2020-05-10 01:00:16,329 [INFO] Reading complete. time_to_read=0.91 seconds
2020-05-10 01:00:16,329 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_7.h5
2020-05-10 01:00:17,238 [INFO] Reading complete. time_to_read=0.91 seconds
2020-05-10 01:00:17,239 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_8.h5
2020-05-10 01:00:17,394 [INFO] Reading complete. time_to_read=0.16 seconds
2020-05-10 01:00:17,394 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_9.h5
2020-05-10 01:00:17,877 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 01:00:17,878 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_1.h5
2020-05-10 01:00:18,183 [INFO] Reading complete. time_to_read=0.31 seconds
2020-05-10 01:00:18,184 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_10.h5
2020-05-10 01:00:18,501 [INFO] Reading complete. time_to_read=0.32 seconds
2020-05-10 01:00:18,501 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_11.h5
2020-05-10 01:00:18,819 [INFO] Reading complete. time_to_read=0.32 seconds
2020-05-10 01:00:18,819 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_12.h5
2020-05-10 01:00:19,158 [INFO] Reading complete. time_to_read=0.34 seconds
2020-05-10 01:00:19,158 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_13.h5
2020-05-10 01:00:19,342 [INFO] Reading complete. time_to_read=0.18 seconds
2020-05-10 01:00:19,342 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_2.h5
2020-05-10 01:00:19,694 [INFO] Reading complete. time_to_read=0.35 seconds
2020-05-10 01:00:19,694 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_3.h5
2020-05-10 01:00:20,011 [INFO] Reading complete. time_to_read=0.32 seconds
2020-05-10 01:00:20,011 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_4.h5
2020-05-10 01:00:20,644 [INFO] Reading complete. time_to_read=0.63 seconds
2020-05-10 01:00:20,644 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_5.h5
2020-05-10 01:00:21,199 [INFO] Reading complete. time_to_read=0.55 seconds
2020-05-10 01:00:21,199 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_6.h5
2020-05-10 01:00:21,753 [INFO] Reading complete. time_to_read=0.55 seconds
2020-05-10 01:00:21,753 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_7.h5
2020-05-10 01:00:22,360 [INFO] Reading complete. time_to_read=0.61 seconds
2020-05-10 01:00:22,360 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_8.h5
2020-05-10 01:00:22,463 [INFO] Reading complete. time_to_read=0.10 seconds
2020-05-10 01:00:22,463 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_9.h5
2020-05-10 01:00:22,782 [INFO] Reading complete. time_to_read=0.32 seconds
2020-05-10 01:00:22,782 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_1.h5
2020-05-10 01:00:22,887 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:00:22,888 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_10.h5
2020-05-10 01:00:22,997 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:00:22,997 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_11.h5
2020-05-10 01:00:23,108 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:00:23,108 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_12.h5
2020-05-10 01:00:23,225 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 01:00:23,225 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_13.h5
2020-05-10 01:00:23,290 [INFO] Reading complete. time_to_read=0.06 seconds
2020-05-10 01:00:23,290 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_2.h5
2020-05-10 01:00:23,411 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 01:00:23,411 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_3.h5
2020-05-10 01:00:23,521 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:00:23,521 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_4.h5
2020-05-10 01:00:23,756 [INFO] Reading complete. time_to_read=0.23 seconds
2020-05-10 01:00:23,756 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_5.h5
2020-05-10 01:00:23,947 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:00:23,947 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_6.h5
2020-05-10 01:00:24,140 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:00:24,140 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_7.h5
2020-05-10 01:00:24,331 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:00:24,331 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_8.h5
2020-05-10 01:00:24,369 [INFO] Reading complete. time_to_read=0.04 seconds
2020-05-10 01:00:24,370 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_9.h5
2020-05-10 01:00:24,480 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:00:24,480 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_1.h5
2020-05-10 01:00:24,584 [INFO] Reading complete. time_to_read=0.10 seconds
2020-05-10 01:00:24,585 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_10.h5
2020-05-10 01:00:24,695 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:00:24,695 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_11.h5
2020-05-10 01:00:24,805 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:00:24,805 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_12.h5
2020-05-10 01:00:24,922 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 01:00:24,922 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_13.h5
2020-05-10 01:00:25,001 [INFO] Reading complete. time_to_read=0.08 seconds
2020-05-10 01:00:25,001 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_2.h5
2020-05-10 01:00:25,122 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 01:00:25,122 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_3.h5
2020-05-10 01:00:25,233 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:00:25,233 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_4.h5
2020-05-10 01:00:25,450 [INFO] Reading complete. time_to_read=0.22 seconds
2020-05-10 01:00:25,450 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_5.h5
2020-05-10 01:00:25,640 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:00:25,640 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_6.h5
2020-05-10 01:00:25,831 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:00:25,831 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_7.h5
2020-05-10 01:00:26,023 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:00:26,023 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_8.h5
2020-05-10 01:00:26,061 [INFO] Reading complete. time_to_read=0.04 seconds
2020-05-10 01:00:26,061 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_9.h5
2020-05-10 01:00:26,171 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:00:29,129 [INFO] Preparing flow sequences
2020-05-10 01:01:43,577 [INFO] Extracting flows complete. time_taken = 74.45 sec
2020-05-10 01:01:47,916 [INFO] Initializing model
2020-05-10 01:01:48,026 [INFO] Model: "sequential_2"
2020-05-10 01:01:48,026 [INFO] _________________________________________________________________
2020-05-10 01:01:48,026 [INFO] Layer (type)                 Output Shape              Param #   
2020-05-10 01:01:48,026 [INFO] =================================================================
2020-05-10 01:01:48,027 [INFO] lstm_2 (LSTM)                (None, 32, 32)            14080     
2020-05-10 01:01:48,027 [INFO] _________________________________________________________________
2020-05-10 01:01:48,027 [INFO] batch_normalization_2 (Batch (None, 32, 32)            128       
2020-05-10 01:01:48,027 [INFO] _________________________________________________________________
2020-05-10 01:01:48,027 [INFO] dropout_2 (Dropout)          (None, 32, 32)            0         
2020-05-10 01:01:48,027 [INFO] _________________________________________________________________
2020-05-10 01:01:48,027 [INFO] time_distributed_2 (TimeDist (None, 32, 15)            495       
2020-05-10 01:01:48,027 [INFO] =================================================================
2020-05-10 01:01:48,027 [INFO] Total params: 14,703
2020-05-10 01:01:48,027 [INFO] Trainable params: 14,639
2020-05-10 01:01:48,027 [INFO] Non-trainable params: 64
2020-05-10 01:01:48,027 [INFO] _________________________________________________________________
2020-05-10 01:01:48,027 [INFO] Training model
2020-05-10 01:01:48.591324: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] layout failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:01:48.592623: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss_1/time_distributed_2_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss_1/time_distributed_2_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 01:01:48.597964: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:01:48.600360: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:01:48.621845: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:01:48.623216: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss_1/time_distributed_2_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss_1/time_distributed_2_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 01:01:48.625111: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:01:48.626810: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:01:48.631182: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:01:51.779846: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] layout failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:01:51.780153: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss_1/time_distributed_2_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss_1/time_distributed_2_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 01:01:51.781255: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:01:51.781752: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:01:51.785438: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:01:51.785739: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss_1/time_distributed_2_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss_1/time_distributed_2_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 01:01:51.786095: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:01:51.786419: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:01:51.787354: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
Train on 302572 samples, validate on 100857 samples
Epoch 1/80
 - 4s - loss: 0.2390 - val_loss: 0.2126
Epoch 2/80
 - 4s - loss: 0.1740 - val_loss: 0.1699
Epoch 3/80
 - 4s - loss: 0.1152 - val_loss: 0.1139
Epoch 4/80
 - 4s - loss: 0.0692 - val_loss: 0.0691
Epoch 5/80
 - 4s - loss: 0.0440 - val_loss: 0.0484
Epoch 6/80
 - 4s - loss: 0.0333 - val_loss: 0.0389
Epoch 7/80
 - 4s - loss: 0.0276 - val_loss: 0.0330
Epoch 8/80
 - 4s - loss: 0.0240 - val_loss: 0.0288
Epoch 9/80
 - 4s - loss: 0.0215 - val_loss: 0.0254
Epoch 10/80
 - 4s - loss: 0.0194 - val_loss: 0.0226
Epoch 11/80
 - 4s - loss: 0.0178 - val_loss: 0.0200
Epoch 12/80
 - 4s - loss: 0.0165 - val_loss: 0.0176
Epoch 13/80
 - 4s - loss: 0.0153 - val_loss: 0.0157
Epoch 14/80
 - 4s - loss: 0.0143 - val_loss: 0.0142
Epoch 15/80
 - 4s - loss: 0.0134 - val_loss: 0.0129
Epoch 16/80
 - 4s - loss: 0.0127 - val_loss: 0.0117
Epoch 17/80
 - 4s - loss: 0.0121 - val_loss: 0.0108
Epoch 18/80
 - 4s - loss: 0.0115 - val_loss: 0.0102
Epoch 19/80
 - 4s - loss: 0.0111 - val_loss: 0.0097
Epoch 20/80
 - 4s - loss: 0.0106 - val_loss: 0.0092
Epoch 21/80
 - 4s - loss: 0.0102 - val_loss: 0.0090
Epoch 22/80
 - 4s - loss: 0.0099 - val_loss: 0.0085
Epoch 23/80
 - 4s - loss: 0.0096 - val_loss: 0.0083
Epoch 24/80
 - 4s - loss: 0.0093 - val_loss: 0.0080
Epoch 25/80
 - 4s - loss: 0.0091 - val_loss: 0.0077
Epoch 26/80
 - 4s - loss: 0.0088 - val_loss: 0.0075
Epoch 27/80
 - 4s - loss: 0.0086 - val_loss: 0.0074
Epoch 28/80
 - 4s - loss: 0.0084 - val_loss: 0.0072
Epoch 29/80
 - 4s - loss: 0.0082 - val_loss: 0.0071
Epoch 30/80
 - 4s - loss: 0.0081 - val_loss: 0.0069
Epoch 31/80
 - 4s - loss: 0.0080 - val_loss: 0.0069
Epoch 32/80
 - 4s - loss: 0.0078 - val_loss: 0.0068
Epoch 33/80
 - 4s - loss: 0.0077 - val_loss: 0.0067
Epoch 34/80
 - 4s - loss: 0.0076 - val_loss: 0.0067
Epoch 35/80
 - 4s - loss: 0.0075 - val_loss: 0.0065
Epoch 36/80
 - 4s - loss: 0.0074 - val_loss: 0.0066
Epoch 37/80
 - 4s - loss: 0.0073 - val_loss: 0.0064
Epoch 38/80
 - 4s - loss: 0.0073 - val_loss: 0.0064
Epoch 39/80
 - 4s - loss: 0.0072 - val_loss: 0.0062
Epoch 40/80
 - 4s - loss: 0.0071 - val_loss: 0.0062
Epoch 41/80
 - 4s - loss: 0.0070 - val_loss: 0.0062
Epoch 42/80
 - 4s - loss: 0.0069 - val_loss: 0.0061
Epoch 43/80
 - 4s - loss: 0.0068 - val_loss: 0.0060
Epoch 44/80
 - 4s - loss: 0.0068 - val_loss: 0.0059
Epoch 45/80
 - 4s - loss: 0.0067 - val_loss: 0.0059
Epoch 46/80
 - 4s - loss: 0.0067 - val_loss: 0.0058
Epoch 47/80
 - 4s - loss: 0.0066 - val_loss: 0.0058
Epoch 48/80
 - 4s - loss: 0.0066 - val_loss: 0.0058
Epoch 49/80
 - 4s - loss: 0.0065 - val_loss: 0.0058
Epoch 50/80
 - 4s - loss: 0.0065 - val_loss: 0.0057
Epoch 51/80
 - 4s - loss: 0.0064 - val_loss: 0.0058
Epoch 52/80
 - 4s - loss: 0.0064 - val_loss: 0.0057
Epoch 53/80
 - 4s - loss: 0.0063 - val_loss: 0.0056
Epoch 54/80
 - 4s - loss: 0.0063 - val_loss: 0.0055
Epoch 55/80
 - 4s - loss: 0.0062 - val_loss: 0.0056
Epoch 56/80
 - 4s - loss: 0.0062 - val_loss: 0.0056
Epoch 57/80
 - 4s - loss: 0.0062 - val_loss: 0.0056
Epoch 58/80
 - 4s - loss: 0.0061 - val_loss: 0.0055
Epoch 59/80
 - 4s - loss: 0.0061 - val_loss: 0.0055
Epoch 60/80
 - 4s - loss: 0.0061 - val_loss: 0.0054
Epoch 61/80
 - 4s - loss: 0.0060 - val_loss: 0.0054
Epoch 62/80
 - 4s - loss: 0.0060 - val_loss: 0.0054
Epoch 63/80
 - 4s - loss: 0.0060 - val_loss: 0.0054
Epoch 64/80
 - 4s - loss: 0.0059 - val_loss: 0.0053
Epoch 65/80
 - 4s - loss: 0.0059 - val_loss: 0.0054
Epoch 66/80
 - 4s - loss: 0.0059 - val_loss: 0.0053
Epoch 67/80
 - 4s - loss: 0.0059 - val_loss: 0.0052
Epoch 68/80
 - 4s - loss: 0.0058 - val_loss: 0.0053
Epoch 69/80
 - 4s - loss: 0.0058 - val_loss: 0.0052
Epoch 70/80
 - 4s - loss: 0.0058 - val_loss: 0.0052
Epoch 71/80
 - 4s - loss: 0.0058 - val_loss: 0.0052
Epoch 72/80
 - 4s - loss: 0.0058 - val_loss: 0.0052
Epoch 73/80
 - 4s - loss: 0.0057 - val_loss: 0.0051
Epoch 74/80
 - 4s - loss: 0.0057 - val_loss: 0.0052
Epoch 75/80
 - 4s - loss: 0.0057 - val_loss: 0.0051
Epoch 76/80
 - 4s - loss: 0.0057 - val_loss: 0.0052
Epoch 77/80
 - 4s - loss: 0.0056 - val_loss: 0.0051
Epoch 78/80
 - 4s - loss: 0.0056 - val_loss: 0.0051
Epoch 79/80
 - 4s - loss: 0.0056 - val_loss: 0.0051
Epoch 80/80
 - 4s - loss: 0.0056 - val_loss: 0.0051
2020-05-10 01:06:40,107 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-05-10 01:06:40,109 [INFO] Training complete. time_to_train = 292.08 sec, 4.87 min
2020-05-10 01:06:40,115 [INFO] Model saved to results_selected_models/selected_ids18_full_lstm_shallow_rep2/best_model.pickle
2020-05-10 01:06:40,117 [INFO] Training history saved to: results_selected_models/selected_ids18_full_lstm_shallow_rep2/training_error_history.csv
2020-05-10 01:06:40,214 [INFO] Plot saved to: results_selected_models/selected_ids18_full_lstm_shallow_rep2/training_error_history.png
2020-05-10 01:06:40,215 [INFO] Making predictions on training, validation, testing data
2020-05-10 01:06:57,834 [INFO] Making predictions complete. time_to_predict = 17.62 sec, 0.29 min
2020-05-10 01:06:57,880 [INFO] Evaluating predictions (results)
/home/sunanda/.conda/envs/ml_env_gpu/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sunanda/research/ids_experiments/utility.py:328: RuntimeWarning: invalid value encountered in true_divide
  PPV = TP / (TP + FP)    # Precision or positive predictive value
/home/sunanda/research/ids_experiments/utility.py:332: RuntimeWarning: invalid value encountered in true_divide
  FDR = FP / (TP + FP)    # False discovery rate
2020-05-10 01:08:43,230 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate    avg f1
0     Micro avg      0.988884       0.988884                     0.988884              0.000794                 0.011116  0.988884
1     Macro avg      0.998518       0.762661                     0.709205              0.004156                 0.290795  0.717231
2  Weighted avg      0.990903       0.984436                     0.988884              0.051228                 0.011116  0.983965
2020-05-10 01:08:43,263 [INFO] Results saved to: results_selected_models/selected_ids18_full_lstm_shallow_rep2/selected_ids18_full_lstm_shallow_rep2_results.xlsx
2020-05-10 01:08:43,268 [INFO] ================= Finished running experiment no. 2 ================= 

2020-05-10 01:08:43,537 [INFO] Created directory: results_selected_models/selected_ids18_full_lstm_shallow_rep3
2020-05-10 01:08:43,537 [INFO] Initialized logging. log_filename = results_selected_models/selected_ids18_full_lstm_shallow_rep3/run_log.log
2020-05-10 01:08:43,537 [INFO] ================= Running experiment no. 3  ================= 

2020-05-10 01:08:43,537 [INFO] Experiment parameters given below
2020-05-10 01:08:43,537 [INFO] 
{'experiment_num': 3, 'results_dir': 'results_selected_models/selected_ids18_full_lstm_shallow_rep3', 'model': 'lstm', 'model_type': 'classifier', 'normal_label': 'BENIGN', 'lstm_time_steps': 32, 'lstm_layer_units': [32], 'lstm_layer_activations': ['relu'], 'lstm_layer_dropout_rates': [0.2], 'batch_size': 8192, 'epochs': 80, 'early_stop_patience': 20, 'dataset_dir': '../Datasets/full_datasets/ids2018', 'description': 'selected_ids18_full_lstm_shallow_rep3'}
2020-05-10 01:08:43,537 [INFO] Created tensorboard log directory: results_selected_models/selected_ids18_full_lstm_shallow_rep3/tf_logs_run_2020_05_10-01_08_43
2020-05-10 01:08:43,537 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2018
2020-05-10 01:08:43,538 [INFO] Reading X, y files
2020-05-10 01:08:43,538 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_1.h5
2020-05-10 01:08:44,922 [INFO] Reading complete. time_to_read=1.38 seconds
2020-05-10 01:08:44,922 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_10.h5
2020-05-10 01:08:46,310 [INFO] Reading complete. time_to_read=1.39 seconds
2020-05-10 01:08:46,310 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_11.h5
2020-05-10 01:08:47,696 [INFO] Reading complete. time_to_read=1.39 seconds
2020-05-10 01:08:47,696 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_12.h5
2020-05-10 01:08:48,927 [INFO] Reading complete. time_to_read=1.23 seconds
2020-05-10 01:08:48,927 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_13.h5
2020-05-10 01:08:49,743 [INFO] Reading complete. time_to_read=0.82 seconds
2020-05-10 01:08:49,743 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_2.h5
2020-05-10 01:08:51,001 [INFO] Reading complete. time_to_read=1.26 seconds
2020-05-10 01:08:51,001 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_3.h5
2020-05-10 01:08:52,384 [INFO] Reading complete. time_to_read=1.38 seconds
2020-05-10 01:08:52,384 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_4.h5
2020-05-10 01:08:55,028 [INFO] Reading complete. time_to_read=2.64 seconds
2020-05-10 01:08:55,028 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_5.h5
2020-05-10 01:08:57,632 [INFO] Reading complete. time_to_read=2.60 seconds
2020-05-10 01:08:57,632 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_6.h5
2020-05-10 01:09:00,229 [INFO] Reading complete. time_to_read=2.60 seconds
2020-05-10 01:09:00,229 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_7.h5
2020-05-10 01:09:02,842 [INFO] Reading complete. time_to_read=2.61 seconds
2020-05-10 01:09:02,843 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_8.h5
2020-05-10 01:09:03,280 [INFO] Reading complete. time_to_read=0.44 seconds
2020-05-10 01:09:03,280 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_9.h5
2020-05-10 01:09:04,657 [INFO] Reading complete. time_to_read=1.38 seconds
2020-05-10 01:09:04,657 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_1.h5
2020-05-10 01:09:05,114 [INFO] Reading complete. time_to_read=0.46 seconds
2020-05-10 01:09:05,114 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_10.h5
2020-05-10 01:09:05,573 [INFO] Reading complete. time_to_read=0.46 seconds
2020-05-10 01:09:05,573 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_11.h5
2020-05-10 01:09:06,039 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-10 01:09:06,039 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_12.h5
2020-05-10 01:09:06,453 [INFO] Reading complete. time_to_read=0.41 seconds
2020-05-10 01:09:06,453 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_13.h5
2020-05-10 01:09:06,719 [INFO] Reading complete. time_to_read=0.27 seconds
2020-05-10 01:09:06,719 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_2.h5
2020-05-10 01:09:07,141 [INFO] Reading complete. time_to_read=0.42 seconds
2020-05-10 01:09:07,142 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_3.h5
2020-05-10 01:09:07,606 [INFO] Reading complete. time_to_read=0.46 seconds
2020-05-10 01:09:07,606 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_4.h5
2020-05-10 01:09:08,489 [INFO] Reading complete. time_to_read=0.88 seconds
2020-05-10 01:09:08,489 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_5.h5
2020-05-10 01:09:09,357 [INFO] Reading complete. time_to_read=0.87 seconds
2020-05-10 01:09:09,357 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_6.h5
2020-05-10 01:09:10,229 [INFO] Reading complete. time_to_read=0.87 seconds
2020-05-10 01:09:10,229 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_7.h5
2020-05-10 01:09:11,105 [INFO] Reading complete. time_to_read=0.88 seconds
2020-05-10 01:09:11,105 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_8.h5
2020-05-10 01:09:11,251 [INFO] Reading complete. time_to_read=0.15 seconds
2020-05-10 01:09:11,251 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_9.h5
2020-05-10 01:09:11,713 [INFO] Reading complete. time_to_read=0.46 seconds
2020-05-10 01:09:11,713 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_1.h5
2020-05-10 01:09:12,177 [INFO] Reading complete. time_to_read=0.46 seconds
2020-05-10 01:09:12,177 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_10.h5
2020-05-10 01:09:12,642 [INFO] Reading complete. time_to_read=0.46 seconds
2020-05-10 01:09:12,642 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_11.h5
2020-05-10 01:09:13,107 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-10 01:09:13,107 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_12.h5
2020-05-10 01:09:13,521 [INFO] Reading complete. time_to_read=0.41 seconds
2020-05-10 01:09:13,521 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_13.h5
2020-05-10 01:09:13,790 [INFO] Reading complete. time_to_read=0.27 seconds
2020-05-10 01:09:13,791 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_2.h5
2020-05-10 01:09:14,212 [INFO] Reading complete. time_to_read=0.42 seconds
2020-05-10 01:09:14,212 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_3.h5
2020-05-10 01:09:14,678 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-10 01:09:14,678 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_4.h5
2020-05-10 01:09:15,564 [INFO] Reading complete. time_to_read=0.89 seconds
2020-05-10 01:09:15,564 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_5.h5
2020-05-10 01:09:16,433 [INFO] Reading complete. time_to_read=0.87 seconds
2020-05-10 01:09:16,433 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_6.h5
2020-05-10 01:09:17,305 [INFO] Reading complete. time_to_read=0.87 seconds
2020-05-10 01:09:17,305 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_7.h5
2020-05-10 01:09:18,178 [INFO] Reading complete. time_to_read=0.87 seconds
2020-05-10 01:09:18,178 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_8.h5
2020-05-10 01:09:18,327 [INFO] Reading complete. time_to_read=0.15 seconds
2020-05-10 01:09:18,327 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_9.h5
2020-05-10 01:09:18,789 [INFO] Reading complete. time_to_read=0.46 seconds
2020-05-10 01:09:18,789 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_1.h5
2020-05-10 01:09:19,087 [INFO] Reading complete. time_to_read=0.30 seconds
2020-05-10 01:09:19,087 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_10.h5
2020-05-10 01:09:19,391 [INFO] Reading complete. time_to_read=0.30 seconds
2020-05-10 01:09:19,391 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_11.h5
2020-05-10 01:09:19,702 [INFO] Reading complete. time_to_read=0.31 seconds
2020-05-10 01:09:19,702 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_12.h5
2020-05-10 01:09:20,027 [INFO] Reading complete. time_to_read=0.32 seconds
2020-05-10 01:09:20,027 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_13.h5
2020-05-10 01:09:20,203 [INFO] Reading complete. time_to_read=0.18 seconds
2020-05-10 01:09:20,203 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_2.h5
2020-05-10 01:09:20,540 [INFO] Reading complete. time_to_read=0.34 seconds
2020-05-10 01:09:20,540 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_3.h5
2020-05-10 01:09:20,845 [INFO] Reading complete. time_to_read=0.30 seconds
2020-05-10 01:09:20,845 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_4.h5
2020-05-10 01:09:21,453 [INFO] Reading complete. time_to_read=0.61 seconds
2020-05-10 01:09:21,453 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_5.h5
2020-05-10 01:09:21,979 [INFO] Reading complete. time_to_read=0.53 seconds
2020-05-10 01:09:21,980 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_6.h5
2020-05-10 01:09:22,508 [INFO] Reading complete. time_to_read=0.53 seconds
2020-05-10 01:09:22,508 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_7.h5
2020-05-10 01:09:23,092 [INFO] Reading complete. time_to_read=0.58 seconds
2020-05-10 01:09:23,092 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_8.h5
2020-05-10 01:09:23,188 [INFO] Reading complete. time_to_read=0.10 seconds
2020-05-10 01:09:23,188 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_9.h5
2020-05-10 01:09:23,495 [INFO] Reading complete. time_to_read=0.31 seconds
2020-05-10 01:09:23,495 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_1.h5
2020-05-10 01:09:23,595 [INFO] Reading complete. time_to_read=0.10 seconds
2020-05-10 01:09:23,595 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_10.h5
2020-05-10 01:09:23,700 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:09:23,701 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_11.h5
2020-05-10 01:09:23,806 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:09:23,806 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_12.h5
2020-05-10 01:09:23,918 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:09:23,918 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_13.h5
2020-05-10 01:09:23,979 [INFO] Reading complete. time_to_read=0.06 seconds
2020-05-10 01:09:23,980 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_2.h5
2020-05-10 01:09:24,096 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 01:09:24,096 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_3.h5
2020-05-10 01:09:24,201 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:09:24,201 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_4.h5
2020-05-10 01:09:24,408 [INFO] Reading complete. time_to_read=0.21 seconds
2020-05-10 01:09:24,408 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_5.h5
2020-05-10 01:09:24,592 [INFO] Reading complete. time_to_read=0.18 seconds
2020-05-10 01:09:24,592 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_6.h5
2020-05-10 01:09:24,795 [INFO] Reading complete. time_to_read=0.20 seconds
2020-05-10 01:09:24,795 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_7.h5
2020-05-10 01:09:24,979 [INFO] Reading complete. time_to_read=0.18 seconds
2020-05-10 01:09:24,979 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_8.h5
2020-05-10 01:09:25,016 [INFO] Reading complete. time_to_read=0.04 seconds
2020-05-10 01:09:25,016 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_9.h5
2020-05-10 01:09:25,124 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:09:25,124 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_1.h5
2020-05-10 01:09:25,226 [INFO] Reading complete. time_to_read=0.10 seconds
2020-05-10 01:09:25,226 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_10.h5
2020-05-10 01:09:25,333 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:09:25,333 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_11.h5
2020-05-10 01:09:25,440 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:09:25,440 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_12.h5
2020-05-10 01:09:25,554 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:09:25,554 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_13.h5
2020-05-10 01:09:25,617 [INFO] Reading complete. time_to_read=0.06 seconds
2020-05-10 01:09:25,617 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_2.h5
2020-05-10 01:09:25,734 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 01:09:25,734 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_3.h5
2020-05-10 01:09:25,841 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:09:25,841 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_4.h5
2020-05-10 01:09:26,054 [INFO] Reading complete. time_to_read=0.21 seconds
2020-05-10 01:09:26,054 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_5.h5
2020-05-10 01:09:26,256 [INFO] Reading complete. time_to_read=0.20 seconds
2020-05-10 01:09:26,256 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_6.h5
2020-05-10 01:09:26,443 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:09:26,443 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_7.h5
2020-05-10 01:09:26,630 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:09:26,630 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_8.h5
2020-05-10 01:09:26,667 [INFO] Reading complete. time_to_read=0.04 seconds
2020-05-10 01:09:26,667 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_9.h5
2020-05-10 01:09:26,776 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:09:29,739 [INFO] Preparing flow sequences
2020-05-10 01:10:44,365 [INFO] Extracting flows complete. time_taken = 74.63 sec
2020-05-10 01:10:48,637 [INFO] Initializing model
2020-05-10 01:10:48,759 [INFO] Model: "sequential_3"
2020-05-10 01:10:48,759 [INFO] _________________________________________________________________
2020-05-10 01:10:48,759 [INFO] Layer (type)                 Output Shape              Param #   
2020-05-10 01:10:48,759 [INFO] =================================================================
2020-05-10 01:10:48,759 [INFO] lstm_3 (LSTM)                (None, 32, 32)            14080     
2020-05-10 01:10:48,760 [INFO] _________________________________________________________________
2020-05-10 01:10:48,760 [INFO] batch_normalization_3 (Batch (None, 32, 32)            128       
2020-05-10 01:10:48,760 [INFO] _________________________________________________________________
2020-05-10 01:10:48,760 [INFO] dropout_3 (Dropout)          (None, 32, 32)            0         
2020-05-10 01:10:48,760 [INFO] _________________________________________________________________
2020-05-10 01:10:48,760 [INFO] time_distributed_3 (TimeDist (None, 32, 15)            495       
2020-05-10 01:10:48,760 [INFO] =================================================================
2020-05-10 01:10:48,760 [INFO] Total params: 14,703
2020-05-10 01:10:48,760 [INFO] Trainable params: 14,639
2020-05-10 01:10:48,760 [INFO] Non-trainable params: 64
2020-05-10 01:10:48,760 [INFO] _________________________________________________________________
2020-05-10 01:10:48,760 [INFO] Training model
2020-05-10 01:10:49.314984: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] layout failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:10:49.316271: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss_2/time_distributed_3_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss_2/time_distributed_3_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 01:10:49.321577: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:10:49.323984: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:10:49.345370: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:10:49.346728: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss_2/time_distributed_3_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss_2/time_distributed_3_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 01:10:49.348633: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:10:49.350326: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:10:49.354718: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:10:52.335727: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] layout failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:10:52.336033: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss_2/time_distributed_3_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss_2/time_distributed_3_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 01:10:52.337150: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:10:52.337657: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:10:52.341348: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:10:52.341645: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss_2/time_distributed_3_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss_2/time_distributed_3_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 01:10:52.341998: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:10:52.342307: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:10:52.343056: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
Train on 302572 samples, validate on 100857 samples
Epoch 1/80
 - 4s - loss: 0.2252 - val_loss: 0.2041
Epoch 2/80
 - 4s - loss: 0.1669 - val_loss: 0.1691
Epoch 3/80
 - 4s - loss: 0.1177 - val_loss: 0.1219
Epoch 4/80
 - 4s - loss: 0.0754 - val_loss: 0.0726
Epoch 5/80
 - 4s - loss: 0.0479 - val_loss: 0.0482
Epoch 6/80
 - 4s - loss: 0.0358 - val_loss: 0.0370
Epoch 7/80
 - 4s - loss: 0.0295 - val_loss: 0.0313
Epoch 8/80
 - 4s - loss: 0.0255 - val_loss: 0.0280
Epoch 9/80
 - 4s - loss: 0.0227 - val_loss: 0.0257
Epoch 10/80
 - 4s - loss: 0.0207 - val_loss: 0.0236
Epoch 11/80
 - 4s - loss: 0.0191 - val_loss: 0.0219
Epoch 12/80
 - 4s - loss: 0.0178 - val_loss: 0.0201
Epoch 13/80
 - 4s - loss: 0.0165 - val_loss: 0.0182
Epoch 14/80
 - 4s - loss: 0.0155 - val_loss: 0.0171
Epoch 15/80
 - 4s - loss: 0.0146 - val_loss: 0.0154
Epoch 16/80
 - 4s - loss: 0.0137 - val_loss: 0.0140
Epoch 17/80
 - 4s - loss: 0.0129 - val_loss: 0.0131
Epoch 18/80
 - 4s - loss: 0.0122 - val_loss: 0.0121
Epoch 19/80
 - 4s - loss: 0.0116 - val_loss: 0.0110
Epoch 20/80
 - 4s - loss: 0.0110 - val_loss: 0.0104
Epoch 21/80
 - 4s - loss: 0.0106 - val_loss: 0.0096
Epoch 22/80
 - 4s - loss: 0.0102 - val_loss: 0.0090
Epoch 23/80
 - 4s - loss: 0.0098 - val_loss: 0.0086
Epoch 24/80
 - 4s - loss: 0.0095 - val_loss: 0.0080
Epoch 25/80
 - 4s - loss: 0.0092 - val_loss: 0.0078
Epoch 26/80
 - 4s - loss: 0.0090 - val_loss: 0.0076
Epoch 27/80
 - 4s - loss: 0.0087 - val_loss: 0.0074
Epoch 28/80
 - 4s - loss: 0.0085 - val_loss: 0.0071
Epoch 29/80
 - 4s - loss: 0.0084 - val_loss: 0.0070
Epoch 30/80
 - 4s - loss: 0.0082 - val_loss: 0.0068
Epoch 31/80
 - 4s - loss: 0.0080 - val_loss: 0.0067
Epoch 32/80
 - 4s - loss: 0.0079 - val_loss: 0.0067
Epoch 33/80
 - 4s - loss: 0.0078 - val_loss: 0.0065
Epoch 34/80
 - 4s - loss: 0.0076 - val_loss: 0.0065
Epoch 35/80
 - 4s - loss: 0.0075 - val_loss: 0.0064
Epoch 36/80
 - 4s - loss: 0.0074 - val_loss: 0.0063
Epoch 37/80
 - 4s - loss: 0.0073 - val_loss: 0.0062
Epoch 38/80
 - 4s - loss: 0.0072 - val_loss: 0.0061
Epoch 39/80
 - 4s - loss: 0.0071 - val_loss: 0.0061
Epoch 40/80
 - 4s - loss: 0.0071 - val_loss: 0.0060
Epoch 41/80
 - 4s - loss: 0.0070 - val_loss: 0.0060
Epoch 42/80
 - 4s - loss: 0.0069 - val_loss: 0.0059
Epoch 43/80
 - 4s - loss: 0.0068 - val_loss: 0.0059
Epoch 44/80
 - 4s - loss: 0.0068 - val_loss: 0.0058
Epoch 45/80
 - 4s - loss: 0.0067 - val_loss: 0.0058
Epoch 46/80
 - 4s - loss: 0.0066 - val_loss: 0.0057
Epoch 47/80
 - 4s - loss: 0.0066 - val_loss: 0.0058
Epoch 48/80
 - 4s - loss: 0.0065 - val_loss: 0.0058
Epoch 49/80
 - 4s - loss: 0.0065 - val_loss: 0.0057
Epoch 50/80
 - 4s - loss: 0.0064 - val_loss: 0.0056
Epoch 51/80
 - 4s - loss: 0.0064 - val_loss: 0.0056
Epoch 52/80
 - 4s - loss: 0.0063 - val_loss: 0.0056
Epoch 53/80
 - 4s - loss: 0.0063 - val_loss: 0.0056
Epoch 54/80
 - 4s - loss: 0.0062 - val_loss: 0.0055
Epoch 55/80
 - 4s - loss: 0.0062 - val_loss: 0.0055
Epoch 56/80
 - 4s - loss: 0.0062 - val_loss: 0.0056
Epoch 57/80
 - 4s - loss: 0.0062 - val_loss: 0.0055
Epoch 58/80
 - 4s - loss: 0.0061 - val_loss: 0.0055
Epoch 59/80
 - 4s - loss: 0.0061 - val_loss: 0.0055
Epoch 60/80
 - 4s - loss: 0.0060 - val_loss: 0.0055
Epoch 61/80
 - 4s - loss: 0.0060 - val_loss: 0.0054
Epoch 62/80
 - 4s - loss: 0.0060 - val_loss: 0.0054
Epoch 63/80
 - 4s - loss: 0.0060 - val_loss: 0.0054
Epoch 64/80
 - 4s - loss: 0.0059 - val_loss: 0.0054
Epoch 65/80
 - 4s - loss: 0.0059 - val_loss: 0.0054
Epoch 66/80
 - 4s - loss: 0.0059 - val_loss: 0.0054
Epoch 67/80
 - 4s - loss: 0.0059 - val_loss: 0.0053
Epoch 68/80
 - 4s - loss: 0.0058 - val_loss: 0.0054
Epoch 69/80
 - 4s - loss: 0.0058 - val_loss: 0.0053
Epoch 70/80
 - 4s - loss: 0.0058 - val_loss: 0.0053
Epoch 71/80
 - 4s - loss: 0.0057 - val_loss: 0.0053
Epoch 72/80
 - 4s - loss: 0.0057 - val_loss: 0.0053
Epoch 73/80
 - 4s - loss: 0.0057 - val_loss: 0.0052
Epoch 74/80
 - 4s - loss: 0.0057 - val_loss: 0.0052
Epoch 75/80
 - 4s - loss: 0.0056 - val_loss: 0.0052
Epoch 76/80
 - 4s - loss: 0.0056 - val_loss: 0.0052
Epoch 77/80
 - 4s - loss: 0.0056 - val_loss: 0.0052
Epoch 78/80
 - 4s - loss: 0.0056 - val_loss: 0.0051
Epoch 79/80
 - 4s - loss: 0.0056 - val_loss: 0.0051
Epoch 80/80
 - 4s - loss: 0.0055 - val_loss: 0.0051
2020-05-10 01:15:35,605 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-05-10 01:15:35,606 [INFO] Training complete. time_to_train = 286.85 sec, 4.78 min
2020-05-10 01:15:35,610 [INFO] Model saved to results_selected_models/selected_ids18_full_lstm_shallow_rep3/best_model.pickle
2020-05-10 01:15:35,611 [INFO] Training history saved to: results_selected_models/selected_ids18_full_lstm_shallow_rep3/training_error_history.csv
2020-05-10 01:15:35,706 [INFO] Plot saved to: results_selected_models/selected_ids18_full_lstm_shallow_rep3/training_error_history.png
2020-05-10 01:15:35,706 [INFO] Making predictions on training, validation, testing data
2020-05-10 01:15:53,143 [INFO] Making predictions complete. time_to_predict = 17.44 sec, 0.29 min
2020-05-10 01:15:53,195 [INFO] Evaluating predictions (results)
/home/sunanda/.conda/envs/ml_env_gpu/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sunanda/research/ids_experiments/utility.py:328: RuntimeWarning: invalid value encountered in true_divide
  PPV = TP / (TP + FP)    # Precision or positive predictive value
/home/sunanda/research/ids_experiments/utility.py:332: RuntimeWarning: invalid value encountered in true_divide
  FDR = FP / (TP + FP)    # False discovery rate
2020-05-10 01:17:40,813 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate    avg f1
0     Micro avg      0.988812       0.988812                     0.988812              0.000799                 0.011188  0.988812
1     Macro avg      0.998508       0.759308                     0.706939              0.004145                 0.293061  0.715477
2  Weighted avg      0.990884       0.983802                     0.988812              0.050982                 0.011188  0.983837
2020-05-10 01:17:40,846 [INFO] Results saved to: results_selected_models/selected_ids18_full_lstm_shallow_rep3/selected_ids18_full_lstm_shallow_rep3_results.xlsx
2020-05-10 01:17:40,851 [INFO] ================= Finished running experiment no. 3 ================= 

2020-05-10 01:17:41,121 [INFO] Created directory: results_selected_models/selected_ids18_full_lstm_shallow_rep4
2020-05-10 01:17:41,121 [INFO] Initialized logging. log_filename = results_selected_models/selected_ids18_full_lstm_shallow_rep4/run_log.log
2020-05-10 01:17:41,121 [INFO] ================= Running experiment no. 4  ================= 

2020-05-10 01:17:41,121 [INFO] Experiment parameters given below
2020-05-10 01:17:41,121 [INFO] 
{'experiment_num': 4, 'results_dir': 'results_selected_models/selected_ids18_full_lstm_shallow_rep4', 'model': 'lstm', 'model_type': 'classifier', 'normal_label': 'BENIGN', 'lstm_time_steps': 32, 'lstm_layer_units': [32], 'lstm_layer_activations': ['relu'], 'lstm_layer_dropout_rates': [0.2], 'batch_size': 8192, 'epochs': 80, 'early_stop_patience': 20, 'dataset_dir': '../Datasets/full_datasets/ids2018', 'description': 'selected_ids18_full_lstm_shallow_rep4'}
2020-05-10 01:17:41,122 [INFO] Created tensorboard log directory: results_selected_models/selected_ids18_full_lstm_shallow_rep4/tf_logs_run_2020_05_10-01_17_41
2020-05-10 01:17:41,122 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2018
2020-05-10 01:17:41,122 [INFO] Reading X, y files
2020-05-10 01:17:41,122 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_1.h5
2020-05-10 01:17:42,508 [INFO] Reading complete. time_to_read=1.39 seconds
2020-05-10 01:17:42,508 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_10.h5
2020-05-10 01:17:43,893 [INFO] Reading complete. time_to_read=1.39 seconds
2020-05-10 01:17:43,893 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_11.h5
2020-05-10 01:17:45,281 [INFO] Reading complete. time_to_read=1.39 seconds
2020-05-10 01:17:45,281 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_12.h5
2020-05-10 01:17:46,511 [INFO] Reading complete. time_to_read=1.23 seconds
2020-05-10 01:17:46,511 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_13.h5
2020-05-10 01:17:47,326 [INFO] Reading complete. time_to_read=0.81 seconds
2020-05-10 01:17:47,326 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_2.h5
2020-05-10 01:17:48,582 [INFO] Reading complete. time_to_read=1.26 seconds
2020-05-10 01:17:48,582 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_3.h5
2020-05-10 01:17:49,963 [INFO] Reading complete. time_to_read=1.38 seconds
2020-05-10 01:17:49,963 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_4.h5
2020-05-10 01:17:52,609 [INFO] Reading complete. time_to_read=2.65 seconds
2020-05-10 01:17:52,609 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_5.h5
2020-05-10 01:17:55,213 [INFO] Reading complete. time_to_read=2.60 seconds
2020-05-10 01:17:55,213 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_6.h5
2020-05-10 01:17:57,810 [INFO] Reading complete. time_to_read=2.60 seconds
2020-05-10 01:17:57,811 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_7.h5
2020-05-10 01:18:00,423 [INFO] Reading complete. time_to_read=2.61 seconds
2020-05-10 01:18:00,423 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_8.h5
2020-05-10 01:18:00,861 [INFO] Reading complete. time_to_read=0.44 seconds
2020-05-10 01:18:00,861 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_9.h5
2020-05-10 01:18:02,239 [INFO] Reading complete. time_to_read=1.38 seconds
2020-05-10 01:18:02,239 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_1.h5
2020-05-10 01:18:02,696 [INFO] Reading complete. time_to_read=0.46 seconds
2020-05-10 01:18:02,696 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_10.h5
2020-05-10 01:18:03,155 [INFO] Reading complete. time_to_read=0.46 seconds
2020-05-10 01:18:03,155 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_11.h5
2020-05-10 01:18:03,620 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-10 01:18:03,621 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_12.h5
2020-05-10 01:18:04,035 [INFO] Reading complete. time_to_read=0.41 seconds
2020-05-10 01:18:04,035 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_13.h5
2020-05-10 01:18:04,301 [INFO] Reading complete. time_to_read=0.27 seconds
2020-05-10 01:18:04,302 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_2.h5
2020-05-10 01:18:04,724 [INFO] Reading complete. time_to_read=0.42 seconds
2020-05-10 01:18:04,725 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_3.h5
2020-05-10 01:18:05,189 [INFO] Reading complete. time_to_read=0.46 seconds
2020-05-10 01:18:05,189 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_4.h5
2020-05-10 01:18:06,073 [INFO] Reading complete. time_to_read=0.88 seconds
2020-05-10 01:18:06,073 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_5.h5
2020-05-10 01:18:06,941 [INFO] Reading complete. time_to_read=0.87 seconds
2020-05-10 01:18:06,941 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_6.h5
2020-05-10 01:18:07,812 [INFO] Reading complete. time_to_read=0.87 seconds
2020-05-10 01:18:07,812 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_7.h5
2020-05-10 01:18:08,687 [INFO] Reading complete. time_to_read=0.87 seconds
2020-05-10 01:18:08,687 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_8.h5
2020-05-10 01:18:08,834 [INFO] Reading complete. time_to_read=0.15 seconds
2020-05-10 01:18:08,834 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_9.h5
2020-05-10 01:18:09,295 [INFO] Reading complete. time_to_read=0.46 seconds
2020-05-10 01:18:09,295 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_1.h5
2020-05-10 01:18:09,758 [INFO] Reading complete. time_to_read=0.46 seconds
2020-05-10 01:18:09,758 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_10.h5
2020-05-10 01:18:10,223 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-10 01:18:10,223 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_11.h5
2020-05-10 01:18:10,688 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-10 01:18:10,688 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_12.h5
2020-05-10 01:18:11,103 [INFO] Reading complete. time_to_read=0.41 seconds
2020-05-10 01:18:11,103 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_13.h5
2020-05-10 01:18:11,368 [INFO] Reading complete. time_to_read=0.27 seconds
2020-05-10 01:18:11,368 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_2.h5
2020-05-10 01:18:11,791 [INFO] Reading complete. time_to_read=0.42 seconds
2020-05-10 01:18:11,791 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_3.h5
2020-05-10 01:18:12,257 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-10 01:18:12,257 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_4.h5
2020-05-10 01:18:13,143 [INFO] Reading complete. time_to_read=0.89 seconds
2020-05-10 01:18:13,143 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_5.h5
2020-05-10 01:18:14,013 [INFO] Reading complete. time_to_read=0.87 seconds
2020-05-10 01:18:14,013 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_6.h5
2020-05-10 01:18:14,885 [INFO] Reading complete. time_to_read=0.87 seconds
2020-05-10 01:18:14,885 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_7.h5
2020-05-10 01:18:15,758 [INFO] Reading complete. time_to_read=0.87 seconds
2020-05-10 01:18:15,758 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_8.h5
2020-05-10 01:18:15,905 [INFO] Reading complete. time_to_read=0.15 seconds
2020-05-10 01:18:15,905 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_9.h5
2020-05-10 01:18:16,367 [INFO] Reading complete. time_to_read=0.46 seconds
2020-05-10 01:18:16,368 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_1.h5
2020-05-10 01:18:16,664 [INFO] Reading complete. time_to_read=0.30 seconds
2020-05-10 01:18:16,664 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_10.h5
2020-05-10 01:18:16,974 [INFO] Reading complete. time_to_read=0.31 seconds
2020-05-10 01:18:16,974 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_11.h5
2020-05-10 01:18:17,280 [INFO] Reading complete. time_to_read=0.31 seconds
2020-05-10 01:18:17,280 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_12.h5
2020-05-10 01:18:17,605 [INFO] Reading complete. time_to_read=0.33 seconds
2020-05-10 01:18:17,606 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_13.h5
2020-05-10 01:18:17,784 [INFO] Reading complete. time_to_read=0.18 seconds
2020-05-10 01:18:17,784 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_2.h5
2020-05-10 01:18:18,124 [INFO] Reading complete. time_to_read=0.34 seconds
2020-05-10 01:18:18,124 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_3.h5
2020-05-10 01:18:18,434 [INFO] Reading complete. time_to_read=0.31 seconds
2020-05-10 01:18:18,434 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_4.h5
2020-05-10 01:18:19,053 [INFO] Reading complete. time_to_read=0.62 seconds
2020-05-10 01:18:19,053 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_5.h5
2020-05-10 01:18:19,590 [INFO] Reading complete. time_to_read=0.54 seconds
2020-05-10 01:18:19,590 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_6.h5
2020-05-10 01:18:20,135 [INFO] Reading complete. time_to_read=0.55 seconds
2020-05-10 01:18:20,135 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_7.h5
2020-05-10 01:18:20,731 [INFO] Reading complete. time_to_read=0.60 seconds
2020-05-10 01:18:20,731 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_8.h5
2020-05-10 01:18:20,826 [INFO] Reading complete. time_to_read=0.10 seconds
2020-05-10 01:18:20,826 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_9.h5
2020-05-10 01:18:21,132 [INFO] Reading complete. time_to_read=0.31 seconds
2020-05-10 01:18:21,132 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_1.h5
2020-05-10 01:18:21,234 [INFO] Reading complete. time_to_read=0.10 seconds
2020-05-10 01:18:21,234 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_10.h5
2020-05-10 01:18:21,341 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:18:21,341 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_11.h5
2020-05-10 01:18:21,449 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:18:21,449 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_12.h5
2020-05-10 01:18:21,564 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:18:21,564 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_13.h5
2020-05-10 01:18:21,626 [INFO] Reading complete. time_to_read=0.06 seconds
2020-05-10 01:18:21,626 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_2.h5
2020-05-10 01:18:21,742 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 01:18:21,742 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_3.h5
2020-05-10 01:18:21,848 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:18:21,849 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_4.h5
2020-05-10 01:18:22,058 [INFO] Reading complete. time_to_read=0.21 seconds
2020-05-10 01:18:22,058 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_5.h5
2020-05-10 01:18:22,241 [INFO] Reading complete. time_to_read=0.18 seconds
2020-05-10 01:18:22,241 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_6.h5
2020-05-10 01:18:22,443 [INFO] Reading complete. time_to_read=0.20 seconds
2020-05-10 01:18:22,443 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_7.h5
2020-05-10 01:18:22,631 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:18:22,631 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_8.h5
2020-05-10 01:18:22,668 [INFO] Reading complete. time_to_read=0.04 seconds
2020-05-10 01:18:22,668 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_9.h5
2020-05-10 01:18:22,775 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:18:22,775 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_1.h5
2020-05-10 01:18:22,875 [INFO] Reading complete. time_to_read=0.10 seconds
2020-05-10 01:18:22,875 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_10.h5
2020-05-10 01:18:22,981 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:18:22,981 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_11.h5
2020-05-10 01:18:23,088 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:18:23,088 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_12.h5
2020-05-10 01:18:23,200 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:18:23,200 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_13.h5
2020-05-10 01:18:23,263 [INFO] Reading complete. time_to_read=0.06 seconds
2020-05-10 01:18:23,263 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_2.h5
2020-05-10 01:18:23,381 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 01:18:23,381 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_3.h5
2020-05-10 01:18:23,487 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:18:23,487 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_4.h5
2020-05-10 01:18:23,697 [INFO] Reading complete. time_to_read=0.21 seconds
2020-05-10 01:18:23,697 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_5.h5
2020-05-10 01:18:23,899 [INFO] Reading complete. time_to_read=0.20 seconds
2020-05-10 01:18:23,899 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_6.h5
2020-05-10 01:18:24,083 [INFO] Reading complete. time_to_read=0.18 seconds
2020-05-10 01:18:24,083 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_7.h5
2020-05-10 01:18:24,269 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:18:24,269 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_8.h5
2020-05-10 01:18:24,305 [INFO] Reading complete. time_to_read=0.04 seconds
2020-05-10 01:18:24,305 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_9.h5
2020-05-10 01:18:24,411 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:18:27,389 [INFO] Preparing flow sequences
2020-05-10 01:19:42,017 [INFO] Extracting flows complete. time_taken = 74.63 sec
2020-05-10 01:19:46,211 [INFO] Initializing model
2020-05-10 01:19:46,569 [INFO] Model: "sequential_4"
2020-05-10 01:19:46,569 [INFO] _________________________________________________________________
2020-05-10 01:19:46,569 [INFO] Layer (type)                 Output Shape              Param #   
2020-05-10 01:19:46,569 [INFO] =================================================================
2020-05-10 01:19:46,569 [INFO] lstm_4 (LSTM)                (None, 32, 32)            14080     
2020-05-10 01:19:46,569 [INFO] _________________________________________________________________
2020-05-10 01:19:46,569 [INFO] batch_normalization_4 (Batch (None, 32, 32)            128       
2020-05-10 01:19:46,569 [INFO] _________________________________________________________________
2020-05-10 01:19:46,569 [INFO] dropout_4 (Dropout)          (None, 32, 32)            0         
2020-05-10 01:19:46,569 [INFO] _________________________________________________________________
2020-05-10 01:19:46,569 [INFO] time_distributed_4 (TimeDist (None, 32, 15)            495       
2020-05-10 01:19:46,569 [INFO] =================================================================
2020-05-10 01:19:46,569 [INFO] Total params: 14,703
2020-05-10 01:19:46,569 [INFO] Trainable params: 14,639
2020-05-10 01:19:46,569 [INFO] Non-trainable params: 64
2020-05-10 01:19:46,569 [INFO] _________________________________________________________________
2020-05-10 01:19:46,569 [INFO] Training model
2020-05-10 01:19:47.122248: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] layout failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:19:47.123528: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss_3/time_distributed_4_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss_3/time_distributed_4_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 01:19:47.128920: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:19:47.131337: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:19:47.153167: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:19:47.154520: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss_3/time_distributed_4_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss_3/time_distributed_4_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 01:19:47.156404: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:19:47.158109: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:19:47.162443: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:19:50.058517: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] layout failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:19:50.058821: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss_3/time_distributed_4_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss_3/time_distributed_4_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 01:19:50.059910: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:19:50.060395: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:19:50.064051: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:19:50.064351: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss_3/time_distributed_4_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss_3/time_distributed_4_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 01:19:50.064701: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:19:50.065009: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:19:50.065721: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
Train on 302572 samples, validate on 100857 samples
Epoch 1/80
 - 4s - loss: 0.2290 - val_loss: 0.1891
Epoch 2/80
 - 4s - loss: 0.1645 - val_loss: 0.1462
Epoch 3/80
 - 4s - loss: 0.1088 - val_loss: 0.0963
Epoch 4/80
 - 4s - loss: 0.0660 - val_loss: 0.0674
Epoch 5/80
 - 4s - loss: 0.0438 - val_loss: 0.0511
Epoch 6/80
 - 4s - loss: 0.0324 - val_loss: 0.0396
Epoch 7/80
 - 4s - loss: 0.0261 - val_loss: 0.0324
Epoch 8/80
 - 4s - loss: 0.0222 - val_loss: 0.0271
Epoch 9/80
 - 4s - loss: 0.0195 - val_loss: 0.0230
Epoch 10/80
 - 4s - loss: 0.0176 - val_loss: 0.0201
Epoch 11/80
 - 4s - loss: 0.0162 - val_loss: 0.0177
Epoch 12/80
 - 4s - loss: 0.0149 - val_loss: 0.0156
Epoch 13/80
 - 4s - loss: 0.0139 - val_loss: 0.0139
Epoch 14/80
 - 4s - loss: 0.0131 - val_loss: 0.0126
Epoch 15/80
 - 4s - loss: 0.0124 - val_loss: 0.0114
Epoch 16/80
 - 4s - loss: 0.0118 - val_loss: 0.0105
Epoch 17/80
 - 4s - loss: 0.0112 - val_loss: 0.0096
Epoch 18/80
 - 4s - loss: 0.0108 - val_loss: 0.0092
Epoch 19/80
 - 4s - loss: 0.0104 - val_loss: 0.0087
Epoch 20/80
 - 4s - loss: 0.0100 - val_loss: 0.0082
Epoch 21/80
 - 4s - loss: 0.0097 - val_loss: 0.0079
Epoch 22/80
 - 4s - loss: 0.0094 - val_loss: 0.0076
Epoch 23/80
 - 4s - loss: 0.0092 - val_loss: 0.0074
Epoch 24/80
 - 4s - loss: 0.0089 - val_loss: 0.0073
Epoch 25/80
 - 4s - loss: 0.0086 - val_loss: 0.0070
Epoch 26/80
 - 4s - loss: 0.0084 - val_loss: 0.0068
Epoch 27/80
 - 4s - loss: 0.0082 - val_loss: 0.0068
Epoch 28/80
 - 4s - loss: 0.0080 - val_loss: 0.0067
Epoch 29/80
 - 4s - loss: 0.0078 - val_loss: 0.0065
Epoch 30/80
 - 4s - loss: 0.0077 - val_loss: 0.0064
Epoch 31/80
 - 4s - loss: 0.0075 - val_loss: 0.0063
Epoch 32/80
 - 4s - loss: 0.0074 - val_loss: 0.0062
Epoch 33/80
 - 4s - loss: 0.0073 - val_loss: 0.0062
Epoch 34/80
 - 4s - loss: 0.0072 - val_loss: 0.0061
Epoch 35/80
 - 4s - loss: 0.0071 - val_loss: 0.0060
Epoch 36/80
 - 4s - loss: 0.0070 - val_loss: 0.0059
Epoch 37/80
 - 4s - loss: 0.0069 - val_loss: 0.0059
Epoch 38/80
 - 4s - loss: 0.0068 - val_loss: 0.0058
Epoch 39/80
 - 4s - loss: 0.0067 - val_loss: 0.0058
Epoch 40/80
 - 4s - loss: 0.0067 - val_loss: 0.0058
Epoch 41/80
 - 4s - loss: 0.0066 - val_loss: 0.0058
Epoch 42/80
 - 4s - loss: 0.0065 - val_loss: 0.0057
Epoch 43/80
 - 4s - loss: 0.0065 - val_loss: 0.0056
Epoch 44/80
 - 4s - loss: 0.0064 - val_loss: 0.0056
Epoch 45/80
 - 4s - loss: 0.0064 - val_loss: 0.0056
Epoch 46/80
 - 4s - loss: 0.0063 - val_loss: 0.0056
Epoch 47/80
 - 4s - loss: 0.0063 - val_loss: 0.0056
Epoch 48/80
 - 4s - loss: 0.0062 - val_loss: 0.0055
Epoch 49/80
 - 4s - loss: 0.0062 - val_loss: 0.0055
Epoch 50/80
 - 4s - loss: 0.0061 - val_loss: 0.0054
Epoch 51/80
 - 4s - loss: 0.0061 - val_loss: 0.0055
Epoch 52/80
 - 4s - loss: 0.0060 - val_loss: 0.0054
Epoch 53/80
 - 4s - loss: 0.0060 - val_loss: 0.0054
Epoch 54/80
 - 4s - loss: 0.0059 - val_loss: 0.0053
Epoch 55/80
 - 4s - loss: 0.0059 - val_loss: 0.0054
Epoch 56/80
 - 4s - loss: 0.0059 - val_loss: 0.0053
Epoch 57/80
 - 4s - loss: 0.0059 - val_loss: 0.0053
Epoch 58/80
 - 4s - loss: 0.0058 - val_loss: 0.0053
Epoch 59/80
 - 4s - loss: 0.0058 - val_loss: 0.0053
Epoch 60/80
 - 4s - loss: 0.0057 - val_loss: 0.0053
Epoch 61/80
 - 4s - loss: 0.0057 - val_loss: 0.0053
Epoch 62/80
 - 4s - loss: 0.0057 - val_loss: 0.0053
Epoch 63/80
 - 4s - loss: 0.0057 - val_loss: 0.0053
Epoch 64/80
 - 3s - loss: 0.0056 - val_loss: 0.0052
Epoch 65/80
 - 4s - loss: 0.0056 - val_loss: 0.0052
Epoch 66/80
 - 4s - loss: 0.0056 - val_loss: 0.0052
Epoch 67/80
 - 4s - loss: 0.0056 - val_loss: 0.0052
Epoch 68/80
 - 4s - loss: 0.0055 - val_loss: 0.0053
Epoch 69/80
 - 4s - loss: 0.0055 - val_loss: 0.0051
Epoch 70/80
 - 4s - loss: 0.0055 - val_loss: 0.0052
Epoch 71/80
 - 4s - loss: 0.0055 - val_loss: 0.0052
Epoch 72/80
 - 4s - loss: 0.0054 - val_loss: 0.0051
Epoch 73/80
 - 4s - loss: 0.0054 - val_loss: 0.0051
Epoch 74/80
 - 4s - loss: 0.0054 - val_loss: 0.0051
Epoch 75/80
 - 4s - loss: 0.0054 - val_loss: 0.0051
Epoch 76/80
 - 4s - loss: 0.0054 - val_loss: 0.0051
Epoch 77/80
 - 4s - loss: 0.0054 - val_loss: 0.0051
Epoch 78/80
 - 4s - loss: 0.0053 - val_loss: 0.0051
Epoch 79/80
 - 4s - loss: 0.0053 - val_loss: 0.0051
Epoch 80/80
 - 4s - loss: 0.0053 - val_loss: 0.0051
2020-05-10 01:24:30,662 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-05-10 01:24:30,664 [INFO] Training complete. time_to_train = 284.09 sec, 4.73 min
2020-05-10 01:24:30,669 [INFO] Model saved to results_selected_models/selected_ids18_full_lstm_shallow_rep4/best_model.pickle
2020-05-10 01:24:30,670 [INFO] Training history saved to: results_selected_models/selected_ids18_full_lstm_shallow_rep4/training_error_history.csv
2020-05-10 01:24:30,772 [INFO] Plot saved to: results_selected_models/selected_ids18_full_lstm_shallow_rep4/training_error_history.png
2020-05-10 01:24:30,772 [INFO] Making predictions on training, validation, testing data
2020-05-10 01:24:47,775 [INFO] Making predictions complete. time_to_predict = 17.00 sec, 0.28 min
2020-05-10 01:24:47,823 [INFO] Evaluating predictions (results)
/home/sunanda/.conda/envs/ml_env_gpu/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sunanda/research/ids_experiments/utility.py:328: RuntimeWarning: invalid value encountered in true_divide
  PPV = TP / (TP + FP)    # Precision or positive predictive value
/home/sunanda/research/ids_experiments/utility.py:332: RuntimeWarning: invalid value encountered in true_divide
  FDR = FP / (TP + FP)    # False discovery rate
2020-05-10 01:26:40,464 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate    avg f1
0     Micro avg      0.988967       0.988967                     0.988967              0.000788                 0.011033  0.988967
1     Macro avg      0.998529       0.762667                     0.716940              0.004129                 0.283060  0.720912
2  Weighted avg      0.990981       0.984769                     0.988967              0.050904                 0.011033  0.984041
2020-05-10 01:26:40,499 [INFO] Results saved to: results_selected_models/selected_ids18_full_lstm_shallow_rep4/selected_ids18_full_lstm_shallow_rep4_results.xlsx
2020-05-10 01:26:40,504 [INFO] ================= Finished running experiment no. 4 ================= 

2020-05-10 01:26:40,785 [INFO] Created directory: results_selected_models/selected_ids18_full_lstm_deep_rep1
2020-05-10 01:26:40,785 [INFO] Initialized logging. log_filename = results_selected_models/selected_ids18_full_lstm_deep_rep1/run_log.log
2020-05-10 01:26:40,785 [INFO] ================= Running experiment no. 1  ================= 

2020-05-10 01:26:40,785 [INFO] Experiment parameters given below
2020-05-10 01:26:40,785 [INFO] 
{'experiment_num': 1, 'results_dir': 'results_selected_models/selected_ids18_full_lstm_deep_rep1', 'model': 'lstm', 'model_type': 'classifier', 'normal_label': 'BENIGN', 'lstm_time_steps': 32, 'lstm_layer_units': [64, 32], 'lstm_layer_activations': ['relu', 'relu'], 'lstm_layer_dropout_rates': [0.2, 0.2], 'batch_size': 8192, 'epochs': 80, 'early_stop_patience': 20, 'dataset_dir': '../Datasets/full_datasets/ids2018', 'description': 'selected_ids18_full_lstm_deep_rep1'}
2020-05-10 01:26:40,785 [INFO] Created tensorboard log directory: results_selected_models/selected_ids18_full_lstm_deep_rep1/tf_logs_run_2020_05_10-01_26_40
2020-05-10 01:26:40,785 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2018
2020-05-10 01:26:40,786 [INFO] Reading X, y files
2020-05-10 01:26:40,786 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_1.h5
2020-05-10 01:26:42,229 [INFO] Reading complete. time_to_read=1.44 seconds
2020-05-10 01:26:42,229 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_10.h5
2020-05-10 01:26:43,674 [INFO] Reading complete. time_to_read=1.45 seconds
2020-05-10 01:26:43,674 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_11.h5
2020-05-10 01:26:45,121 [INFO] Reading complete. time_to_read=1.45 seconds
2020-05-10 01:26:45,122 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_12.h5
2020-05-10 01:26:46,407 [INFO] Reading complete. time_to_read=1.29 seconds
2020-05-10 01:26:46,407 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_13.h5
2020-05-10 01:26:47,246 [INFO] Reading complete. time_to_read=0.84 seconds
2020-05-10 01:26:47,246 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_2.h5
2020-05-10 01:26:48,557 [INFO] Reading complete. time_to_read=1.31 seconds
2020-05-10 01:26:48,557 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_3.h5
2020-05-10 01:26:49,998 [INFO] Reading complete. time_to_read=1.44 seconds
2020-05-10 01:26:49,998 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_4.h5
2020-05-10 01:26:52,754 [INFO] Reading complete. time_to_read=2.76 seconds
2020-05-10 01:26:52,754 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_5.h5
2020-05-10 01:26:55,470 [INFO] Reading complete. time_to_read=2.72 seconds
2020-05-10 01:26:55,470 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_6.h5
2020-05-10 01:26:58,181 [INFO] Reading complete. time_to_read=2.71 seconds
2020-05-10 01:26:58,181 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_7.h5
2020-05-10 01:27:00,903 [INFO] Reading complete. time_to_read=2.72 seconds
2020-05-10 01:27:00,903 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_8.h5
2020-05-10 01:27:01,360 [INFO] Reading complete. time_to_read=0.46 seconds
2020-05-10 01:27:01,360 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_9.h5
2020-05-10 01:27:02,795 [INFO] Reading complete. time_to_read=1.43 seconds
2020-05-10 01:27:02,795 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_1.h5
2020-05-10 01:27:03,273 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 01:27:03,273 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_10.h5
2020-05-10 01:27:03,759 [INFO] Reading complete. time_to_read=0.49 seconds
2020-05-10 01:27:03,759 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_11.h5
2020-05-10 01:27:04,246 [INFO] Reading complete. time_to_read=0.49 seconds
2020-05-10 01:27:04,246 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_12.h5
2020-05-10 01:27:04,679 [INFO] Reading complete. time_to_read=0.43 seconds
2020-05-10 01:27:04,679 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_13.h5
2020-05-10 01:27:04,959 [INFO] Reading complete. time_to_read=0.28 seconds
2020-05-10 01:27:04,959 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_2.h5
2020-05-10 01:27:05,400 [INFO] Reading complete. time_to_read=0.44 seconds
2020-05-10 01:27:05,400 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_3.h5
2020-05-10 01:27:05,887 [INFO] Reading complete. time_to_read=0.49 seconds
2020-05-10 01:27:05,887 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_4.h5
2020-05-10 01:27:06,809 [INFO] Reading complete. time_to_read=0.92 seconds
2020-05-10 01:27:06,809 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_5.h5
2020-05-10 01:27:07,713 [INFO] Reading complete. time_to_read=0.90 seconds
2020-05-10 01:27:07,713 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_6.h5
2020-05-10 01:27:08,620 [INFO] Reading complete. time_to_read=0.91 seconds
2020-05-10 01:27:08,620 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_7.h5
2020-05-10 01:27:09,530 [INFO] Reading complete. time_to_read=0.91 seconds
2020-05-10 01:27:09,530 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_8.h5
2020-05-10 01:27:09,684 [INFO] Reading complete. time_to_read=0.15 seconds
2020-05-10 01:27:09,684 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_9.h5
2020-05-10 01:27:10,164 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 01:27:10,165 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_1.h5
2020-05-10 01:27:10,648 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 01:27:10,648 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_10.h5
2020-05-10 01:27:11,134 [INFO] Reading complete. time_to_read=0.49 seconds
2020-05-10 01:27:11,134 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_11.h5
2020-05-10 01:27:11,620 [INFO] Reading complete. time_to_read=0.49 seconds
2020-05-10 01:27:11,621 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_12.h5
2020-05-10 01:27:12,053 [INFO] Reading complete. time_to_read=0.43 seconds
2020-05-10 01:27:12,053 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_13.h5
2020-05-10 01:27:12,330 [INFO] Reading complete. time_to_read=0.28 seconds
2020-05-10 01:27:12,330 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_2.h5
2020-05-10 01:27:12,770 [INFO] Reading complete. time_to_read=0.44 seconds
2020-05-10 01:27:12,770 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_3.h5
2020-05-10 01:27:13,257 [INFO] Reading complete. time_to_read=0.49 seconds
2020-05-10 01:27:13,257 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_4.h5
2020-05-10 01:27:14,182 [INFO] Reading complete. time_to_read=0.93 seconds
2020-05-10 01:27:14,182 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_5.h5
2020-05-10 01:27:15,087 [INFO] Reading complete. time_to_read=0.90 seconds
2020-05-10 01:27:15,087 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_6.h5
2020-05-10 01:27:15,993 [INFO] Reading complete. time_to_read=0.91 seconds
2020-05-10 01:27:15,993 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_7.h5
2020-05-10 01:27:16,902 [INFO] Reading complete. time_to_read=0.91 seconds
2020-05-10 01:27:16,902 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_8.h5
2020-05-10 01:27:17,058 [INFO] Reading complete. time_to_read=0.16 seconds
2020-05-10 01:27:17,058 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_9.h5
2020-05-10 01:27:17,540 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 01:27:17,540 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_1.h5
2020-05-10 01:27:17,845 [INFO] Reading complete. time_to_read=0.31 seconds
2020-05-10 01:27:17,845 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_10.h5
2020-05-10 01:27:18,164 [INFO] Reading complete. time_to_read=0.32 seconds
2020-05-10 01:27:18,164 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_11.h5
2020-05-10 01:27:18,493 [INFO] Reading complete. time_to_read=0.33 seconds
2020-05-10 01:27:18,493 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_12.h5
2020-05-10 01:27:18,832 [INFO] Reading complete. time_to_read=0.34 seconds
2020-05-10 01:27:18,832 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_13.h5
2020-05-10 01:27:19,016 [INFO] Reading complete. time_to_read=0.18 seconds
2020-05-10 01:27:19,016 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_2.h5
2020-05-10 01:27:19,368 [INFO] Reading complete. time_to_read=0.35 seconds
2020-05-10 01:27:19,369 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_3.h5
2020-05-10 01:27:19,684 [INFO] Reading complete. time_to_read=0.32 seconds
2020-05-10 01:27:19,684 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_4.h5
2020-05-10 01:27:20,316 [INFO] Reading complete. time_to_read=0.63 seconds
2020-05-10 01:27:20,316 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_5.h5
2020-05-10 01:27:20,870 [INFO] Reading complete. time_to_read=0.55 seconds
2020-05-10 01:27:20,870 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_6.h5
2020-05-10 01:27:21,424 [INFO] Reading complete. time_to_read=0.55 seconds
2020-05-10 01:27:21,424 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_7.h5
2020-05-10 01:27:21,981 [INFO] Reading complete. time_to_read=0.56 seconds
2020-05-10 01:27:21,981 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_8.h5
2020-05-10 01:27:22,084 [INFO] Reading complete. time_to_read=0.10 seconds
2020-05-10 01:27:22,084 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_9.h5
2020-05-10 01:27:22,406 [INFO] Reading complete. time_to_read=0.32 seconds
2020-05-10 01:27:22,406 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_1.h5
2020-05-10 01:27:22,512 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:27:22,512 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_10.h5
2020-05-10 01:27:22,675 [INFO] Reading complete. time_to_read=0.16 seconds
2020-05-10 01:27:22,676 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_11.h5
2020-05-10 01:27:22,786 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:27:22,786 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_12.h5
2020-05-10 01:27:22,904 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 01:27:22,904 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_13.h5
2020-05-10 01:27:22,969 [INFO] Reading complete. time_to_read=0.07 seconds
2020-05-10 01:27:22,970 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_2.h5
2020-05-10 01:27:23,093 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 01:27:23,093 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_3.h5
2020-05-10 01:27:23,204 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:27:23,204 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_4.h5
2020-05-10 01:27:23,423 [INFO] Reading complete. time_to_read=0.22 seconds
2020-05-10 01:27:23,423 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_5.h5
2020-05-10 01:27:23,617 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:27:23,617 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_6.h5
2020-05-10 01:27:23,810 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:27:23,810 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_7.h5
2020-05-10 01:27:24,007 [INFO] Reading complete. time_to_read=0.20 seconds
2020-05-10 01:27:24,007 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_8.h5
2020-05-10 01:27:24,045 [INFO] Reading complete. time_to_read=0.04 seconds
2020-05-10 01:27:24,045 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_9.h5
2020-05-10 01:27:24,155 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:27:24,155 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_1.h5
2020-05-10 01:27:24,278 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 01:27:24,278 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_10.h5
2020-05-10 01:27:24,389 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:27:24,389 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_11.h5
2020-05-10 01:27:24,501 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:27:24,501 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_12.h5
2020-05-10 01:27:24,620 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 01:27:24,620 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_13.h5
2020-05-10 01:27:24,685 [INFO] Reading complete. time_to_read=0.07 seconds
2020-05-10 01:27:24,686 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_2.h5
2020-05-10 01:27:24,808 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 01:27:24,808 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_3.h5
2020-05-10 01:27:24,922 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:27:24,922 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_4.h5
2020-05-10 01:27:25,147 [INFO] Reading complete. time_to_read=0.22 seconds
2020-05-10 01:27:25,147 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_5.h5
2020-05-10 01:27:25,346 [INFO] Reading complete. time_to_read=0.20 seconds
2020-05-10 01:27:25,346 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_6.h5
2020-05-10 01:27:25,540 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:27:25,540 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_7.h5
2020-05-10 01:27:25,734 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:27:25,734 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_8.h5
2020-05-10 01:27:25,773 [INFO] Reading complete. time_to_read=0.04 seconds
2020-05-10 01:27:25,773 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_9.h5
2020-05-10 01:27:25,902 [INFO] Reading complete. time_to_read=0.13 seconds
2020-05-10 01:27:29,038 [INFO] Preparing flow sequences
2020-05-10 01:28:46,931 [INFO] Extracting flows complete. time_taken = 77.89 sec
2020-05-10 01:28:51,248 [INFO] Initializing model
2020-05-10 01:28:51,444 [INFO] Model: "sequential_5"
2020-05-10 01:28:51,444 [INFO] _________________________________________________________________
2020-05-10 01:28:51,444 [INFO] Layer (type)                 Output Shape              Param #   
2020-05-10 01:28:51,444 [INFO] =================================================================
2020-05-10 01:28:51,444 [INFO] lstm_5 (LSTM)                (None, 32, 64)            36352     
2020-05-10 01:28:51,444 [INFO] _________________________________________________________________
2020-05-10 01:28:51,444 [INFO] batch_normalization_5 (Batch (None, 32, 64)            256       
2020-05-10 01:28:51,444 [INFO] _________________________________________________________________
2020-05-10 01:28:51,444 [INFO] dropout_5 (Dropout)          (None, 32, 64)            0         
2020-05-10 01:28:51,445 [INFO] _________________________________________________________________
2020-05-10 01:28:51,445 [INFO] lstm_6 (LSTM)                (None, 32, 32)            12416     
2020-05-10 01:28:51,445 [INFO] _________________________________________________________________
2020-05-10 01:28:51,445 [INFO] batch_normalization_6 (Batch (None, 32, 32)            128       
2020-05-10 01:28:51,445 [INFO] _________________________________________________________________
2020-05-10 01:28:51,445 [INFO] dropout_6 (Dropout)          (None, 32, 32)            0         
2020-05-10 01:28:51,445 [INFO] _________________________________________________________________
2020-05-10 01:28:51,445 [INFO] time_distributed_5 (TimeDist (None, 32, 15)            495       
2020-05-10 01:28:51,445 [INFO] =================================================================
2020-05-10 01:28:51,445 [INFO] Total params: 49,647
2020-05-10 01:28:51,445 [INFO] Trainable params: 49,455
2020-05-10 01:28:51,445 [INFO] Non-trainable params: 192
2020-05-10 01:28:51,445 [INFO] _________________________________________________________________
2020-05-10 01:28:51,445 [INFO] Training model
2020-05-10 01:28:52.524680: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] layout failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:28:52.526992: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss_4/time_distributed_5_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss_4/time_distributed_5_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 01:28:52.536954: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:28:52.541361: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:28:52.580643: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:28:52.583100: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss_4/time_distributed_5_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss_4/time_distributed_5_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 01:28:52.586528: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:28:52.589617: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:28:52.598188: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:28:57.142943: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] layout failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:28:57.143429: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss_4/time_distributed_5_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss_4/time_distributed_5_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 01:28:57.145254: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:28:57.146132: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:28:57.152487: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:28:57.152987: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss_4/time_distributed_5_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss_4/time_distributed_5_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 01:28:57.153606: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:28:57.154154: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:28:57.155513: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
Train on 302572 samples, validate on 100857 samples
Epoch 1/80
 - 6s - loss: 0.2249 - val_loss: 0.2167
Epoch 2/80
 - 5s - loss: 0.1661 - val_loss: 0.1626
Epoch 3/80
 - 5s - loss: 0.1037 - val_loss: 0.1032
Epoch 4/80
 - 5s - loss: 0.0597 - val_loss: 0.0687
Epoch 5/80
 - 5s - loss: 0.0414 - val_loss: 0.0582
Epoch 6/80
 - 5s - loss: 0.0336 - val_loss: 0.0524
Epoch 7/80
 - 5s - loss: 0.0287 - val_loss: 0.0470
Epoch 8/80
 - 5s - loss: 0.0250 - val_loss: 0.0425
Epoch 9/80
 - 5s - loss: 0.0223 - val_loss: 0.0391
Epoch 10/80
 - 5s - loss: 0.0201 - val_loss: 0.0344
Epoch 11/80
 - 5s - loss: 0.0184 - val_loss: 0.0296
Epoch 12/80
 - 5s - loss: 0.0170 - val_loss: 0.0244
Epoch 13/80
 - 5s - loss: 0.0161 - val_loss: 0.0213
Epoch 14/80
 - 5s - loss: 0.0158 - val_loss: 0.0203
Epoch 15/80
 - 5s - loss: 0.0148 - val_loss: 0.0170
Epoch 16/80
 - 5s - loss: 0.0139 - val_loss: 0.0159
Epoch 17/80
 - 5s - loss: 0.0131 - val_loss: 0.0145
Epoch 18/80
 - 5s - loss: 0.0124 - val_loss: 0.0126
Epoch 19/80
 - 5s - loss: 0.0120 - val_loss: 0.0134
Epoch 20/80
 - 5s - loss: 0.0119 - val_loss: 0.0132
Epoch 21/80
 - 5s - loss: 0.0112 - val_loss: 0.0126
Epoch 22/80
 - 5s - loss: 0.0117 - val_loss: 0.0118
Epoch 23/80
 - 5s - loss: 0.0107 - val_loss: 0.0133
Epoch 24/80
 - 5s - loss: 0.0099 - val_loss: 0.0125
Epoch 25/80
 - 5s - loss: 0.0096 - val_loss: 0.0124
Epoch 26/80
 - 5s - loss: 0.0092 - val_loss: 0.0118
Epoch 27/80
 - 5s - loss: 0.0089 - val_loss: 0.0107
Epoch 28/80
 - 5s - loss: 0.0086 - val_loss: 0.0104
Epoch 29/80
 - 5s - loss: 0.0084 - val_loss: 0.0100
Epoch 30/80
 - 5s - loss: 0.0083 - val_loss: 0.0098
Epoch 31/80
 - 5s - loss: 0.0080 - val_loss: 0.0087
Epoch 32/80
 - 5s - loss: 0.0079 - val_loss: 0.0086
Epoch 33/80
 - 5s - loss: 0.0077 - val_loss: 0.0090
Epoch 34/80
 - 5s - loss: 0.0075 - val_loss: 0.0086
Epoch 35/80
 - 5s - loss: 0.0074 - val_loss: 0.0072
Epoch 36/80
 - 5s - loss: 0.0073 - val_loss: 0.0072
Epoch 37/80
 - 5s - loss: 0.0072 - val_loss: 0.0068
Epoch 38/80
 - 5s - loss: 0.0071 - val_loss: 0.0067
Epoch 39/80
 - 5s - loss: 0.0070 - val_loss: 0.0065
Epoch 40/80
 - 5s - loss: 0.0069 - val_loss: 0.0064
Epoch 41/80
 - 5s - loss: 0.0068 - val_loss: 0.0065
Epoch 42/80
 - 5s - loss: 0.0067 - val_loss: 0.0062
Epoch 43/80
 - 5s - loss: 0.0066 - val_loss: 0.0062
Epoch 44/80
 - 5s - loss: 0.0066 - val_loss: 0.0062
Epoch 45/80
 - 5s - loss: 0.0066 - val_loss: 0.0059
Epoch 46/80
 - 5s - loss: 0.0065 - val_loss: 0.0060
Epoch 47/80
 - 5s - loss: 0.0064 - val_loss: 0.0059
Epoch 48/80
 - 5s - loss: 0.0064 - val_loss: 0.0058
Epoch 49/80
 - 5s - loss: 0.0063 - val_loss: 0.0057
Epoch 50/80
 - 5s - loss: 0.0063 - val_loss: 0.0057
Epoch 51/80
 - 5s - loss: 0.0062 - val_loss: 0.0057
Epoch 52/80
 - 5s - loss: 0.0062 - val_loss: 0.0056
Epoch 53/80
 - 5s - loss: 0.0061 - val_loss: 0.0056
Epoch 54/80
 - 5s - loss: 0.0061 - val_loss: 0.0057
Epoch 55/80
 - 5s - loss: 0.0061 - val_loss: 0.0056
Epoch 56/80
 - 5s - loss: 0.0060 - val_loss: 0.0055
Epoch 57/80
 - 5s - loss: 0.0060 - val_loss: 0.0054
Epoch 58/80
 - 5s - loss: 0.0060 - val_loss: 0.0054
Epoch 59/80
 - 5s - loss: 0.0059 - val_loss: 0.0054
Epoch 60/80
 - 5s - loss: 0.0059 - val_loss: 0.0055
Epoch 61/80
 - 5s - loss: 0.0059 - val_loss: 0.0054
Epoch 62/80
 - 5s - loss: 0.0058 - val_loss: 0.0054
Epoch 63/80
 - 5s - loss: 0.0058 - val_loss: 0.0053
Epoch 64/80
 - 5s - loss: 0.0059 - val_loss: 0.0052
Epoch 65/80
 - 5s - loss: 0.0059 - val_loss: 0.0052
Epoch 66/80
 - 5s - loss: 0.0058 - val_loss: 0.0053
Epoch 67/80
 - 5s - loss: 0.0058 - val_loss: 0.0052
Epoch 68/80
 - 5s - loss: 0.0057 - val_loss: 0.0052
Epoch 69/80
 - 5s - loss: 0.0057 - val_loss: 0.0052
Epoch 70/80
 - 5s - loss: 0.0057 - val_loss: 0.0051
Epoch 71/80
 - 5s - loss: 0.0057 - val_loss: 0.0053
Epoch 72/80
 - 5s - loss: 0.0056 - val_loss: 0.0051
Epoch 73/80
 - 5s - loss: 0.0056 - val_loss: 0.0051
Epoch 74/80
 - 5s - loss: 0.0056 - val_loss: 0.0051
Epoch 75/80
 - 5s - loss: 0.0056 - val_loss: 0.0052
Epoch 76/80
 - 5s - loss: 0.0055 - val_loss: 0.0052
Epoch 77/80
 - 5s - loss: 0.0055 - val_loss: 0.0051
Epoch 78/80
 - 5s - loss: 0.0055 - val_loss: 0.0052
Epoch 79/80
 - 5s - loss: 0.0055 - val_loss: 0.0050
Epoch 80/80
 - 5s - loss: 0.0054 - val_loss: 0.0050
2020-05-10 01:35:48,613 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-05-10 01:35:48,614 [INFO] Training complete. time_to_train = 417.17 sec, 6.95 min
2020-05-10 01:35:48,622 [INFO] Model saved to results_selected_models/selected_ids18_full_lstm_deep_rep1/best_model.pickle
2020-05-10 01:35:48,623 [INFO] Training history saved to: results_selected_models/selected_ids18_full_lstm_deep_rep1/training_error_history.csv
2020-05-10 01:35:48,722 [INFO] Plot saved to: results_selected_models/selected_ids18_full_lstm_deep_rep1/training_error_history.png
2020-05-10 01:35:48,722 [INFO] Making predictions on training, validation, testing data
2020-05-10 01:36:17,819 [INFO] Making predictions complete. time_to_predict = 29.10 sec, 0.48 min
2020-05-10 01:36:17,866 [INFO] Evaluating predictions (results)
/home/sunanda/.conda/envs/ml_env_gpu/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sunanda/research/ids_experiments/utility.py:328: RuntimeWarning: invalid value encountered in true_divide
  PPV = TP / (TP + FP)    # Precision or positive predictive value
/home/sunanda/research/ids_experiments/utility.py:332: RuntimeWarning: invalid value encountered in true_divide
  FDR = FP / (TP + FP)    # False discovery rate
/home/sunanda/research/ids_experiments/utility.py:334: RuntimeWarning: invalid value encountered in true_divide
  F1 = (2 * PPV * TPR) / (PPV + TPR)  # F1 score
2020-05-10 01:38:05,245 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate    avg f1
0     Micro avg      0.988670       0.988670                     0.988670              0.000809                 0.011330  0.988670
1     Macro avg      0.998489       0.761479                     0.706073              0.004291                 0.293927  0.715588
2  Weighted avg      0.990726       0.983784                     0.988670              0.053036                 0.011330  0.983696
2020-05-10 01:38:05,278 [INFO] Results saved to: results_selected_models/selected_ids18_full_lstm_deep_rep1/selected_ids18_full_lstm_deep_rep1_results.xlsx
2020-05-10 01:38:05,283 [INFO] ================= Finished running experiment no. 1 ================= 

2020-05-10 01:38:05,555 [INFO] Created directory: results_selected_models/selected_ids18_full_lstm_deep_rep2
2020-05-10 01:38:05,555 [INFO] Initialized logging. log_filename = results_selected_models/selected_ids18_full_lstm_deep_rep2/run_log.log
2020-05-10 01:38:05,555 [INFO] ================= Running experiment no. 2  ================= 

2020-05-10 01:38:05,555 [INFO] Experiment parameters given below
2020-05-10 01:38:05,555 [INFO] 
{'experiment_num': 2, 'results_dir': 'results_selected_models/selected_ids18_full_lstm_deep_rep2', 'model': 'lstm', 'model_type': 'classifier', 'normal_label': 'BENIGN', 'lstm_time_steps': 32, 'lstm_layer_units': [64, 32], 'lstm_layer_activations': ['relu', 'relu'], 'lstm_layer_dropout_rates': [0.2, 0.2], 'batch_size': 8192, 'epochs': 80, 'early_stop_patience': 20, 'dataset_dir': '../Datasets/full_datasets/ids2018', 'description': 'selected_ids18_full_lstm_deep_rep2'}
2020-05-10 01:38:05,555 [INFO] Created tensorboard log directory: results_selected_models/selected_ids18_full_lstm_deep_rep2/tf_logs_run_2020_05_10-01_38_05
2020-05-10 01:38:05,555 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2018
2020-05-10 01:38:05,556 [INFO] Reading X, y files
2020-05-10 01:38:05,556 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_1.h5
2020-05-10 01:38:06,961 [INFO] Reading complete. time_to_read=1.41 seconds
2020-05-10 01:38:06,961 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_10.h5
2020-05-10 01:38:08,369 [INFO] Reading complete. time_to_read=1.41 seconds
2020-05-10 01:38:08,369 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_11.h5
2020-05-10 01:38:09,776 [INFO] Reading complete. time_to_read=1.41 seconds
2020-05-10 01:38:09,777 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_12.h5
2020-05-10 01:38:11,028 [INFO] Reading complete. time_to_read=1.25 seconds
2020-05-10 01:38:11,028 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_13.h5
2020-05-10 01:38:11,857 [INFO] Reading complete. time_to_read=0.83 seconds
2020-05-10 01:38:11,858 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_2.h5
2020-05-10 01:38:13,134 [INFO] Reading complete. time_to_read=1.28 seconds
2020-05-10 01:38:13,135 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_3.h5
2020-05-10 01:38:14,538 [INFO] Reading complete. time_to_read=1.40 seconds
2020-05-10 01:38:14,538 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_4.h5
2020-05-10 01:38:17,224 [INFO] Reading complete. time_to_read=2.69 seconds
2020-05-10 01:38:17,224 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_5.h5
2020-05-10 01:38:19,871 [INFO] Reading complete. time_to_read=2.65 seconds
2020-05-10 01:38:19,871 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_6.h5
2020-05-10 01:38:22,510 [INFO] Reading complete. time_to_read=2.64 seconds
2020-05-10 01:38:22,510 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_7.h5
2020-05-10 01:38:25,164 [INFO] Reading complete. time_to_read=2.65 seconds
2020-05-10 01:38:25,164 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_8.h5
2020-05-10 01:38:25,609 [INFO] Reading complete. time_to_read=0.44 seconds
2020-05-10 01:38:25,609 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_9.h5
2020-05-10 01:38:27,008 [INFO] Reading complete. time_to_read=1.40 seconds
2020-05-10 01:38:27,008 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_1.h5
2020-05-10 01:38:27,473 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-10 01:38:27,473 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_10.h5
2020-05-10 01:38:27,940 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-10 01:38:27,940 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_11.h5
2020-05-10 01:38:28,413 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-10 01:38:28,413 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_12.h5
2020-05-10 01:38:28,834 [INFO] Reading complete. time_to_read=0.42 seconds
2020-05-10 01:38:28,834 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_13.h5
2020-05-10 01:38:29,105 [INFO] Reading complete. time_to_read=0.27 seconds
2020-05-10 01:38:29,105 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_2.h5
2020-05-10 01:38:29,535 [INFO] Reading complete. time_to_read=0.43 seconds
2020-05-10 01:38:29,535 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_3.h5
2020-05-10 01:38:30,007 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-10 01:38:30,007 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_4.h5
2020-05-10 01:38:30,905 [INFO] Reading complete. time_to_read=0.90 seconds
2020-05-10 01:38:30,905 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_5.h5
2020-05-10 01:38:31,786 [INFO] Reading complete. time_to_read=0.88 seconds
2020-05-10 01:38:31,786 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_6.h5
2020-05-10 01:38:32,671 [INFO] Reading complete. time_to_read=0.88 seconds
2020-05-10 01:38:32,671 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_7.h5
2020-05-10 01:38:33,558 [INFO] Reading complete. time_to_read=0.89 seconds
2020-05-10 01:38:33,559 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_8.h5
2020-05-10 01:38:33,708 [INFO] Reading complete. time_to_read=0.15 seconds
2020-05-10 01:38:33,708 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_9.h5
2020-05-10 01:38:34,177 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-10 01:38:34,177 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_1.h5
2020-05-10 01:38:34,647 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-10 01:38:34,647 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_10.h5
2020-05-10 01:38:35,120 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-10 01:38:35,120 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_11.h5
2020-05-10 01:38:35,593 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-10 01:38:35,593 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_12.h5
2020-05-10 01:38:36,014 [INFO] Reading complete. time_to_read=0.42 seconds
2020-05-10 01:38:36,014 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_13.h5
2020-05-10 01:38:36,284 [INFO] Reading complete. time_to_read=0.27 seconds
2020-05-10 01:38:36,284 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_2.h5
2020-05-10 01:38:36,712 [INFO] Reading complete. time_to_read=0.43 seconds
2020-05-10 01:38:36,712 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_3.h5
2020-05-10 01:38:37,186 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-10 01:38:37,186 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_4.h5
2020-05-10 01:38:38,087 [INFO] Reading complete. time_to_read=0.90 seconds
2020-05-10 01:38:38,087 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_5.h5
2020-05-10 01:38:38,970 [INFO] Reading complete. time_to_read=0.88 seconds
2020-05-10 01:38:38,970 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_6.h5
2020-05-10 01:38:39,855 [INFO] Reading complete. time_to_read=0.88 seconds
2020-05-10 01:38:39,855 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_7.h5
2020-05-10 01:38:40,741 [INFO] Reading complete. time_to_read=0.89 seconds
2020-05-10 01:38:40,741 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_8.h5
2020-05-10 01:38:40,891 [INFO] Reading complete. time_to_read=0.15 seconds
2020-05-10 01:38:40,891 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_9.h5
2020-05-10 01:38:41,360 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-10 01:38:41,360 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_1.h5
2020-05-10 01:38:41,655 [INFO] Reading complete. time_to_read=0.29 seconds
2020-05-10 01:38:41,655 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_10.h5
2020-05-10 01:38:41,969 [INFO] Reading complete. time_to_read=0.31 seconds
2020-05-10 01:38:41,969 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_11.h5
2020-05-10 01:38:42,283 [INFO] Reading complete. time_to_read=0.31 seconds
2020-05-10 01:38:42,283 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_12.h5
2020-05-10 01:38:42,614 [INFO] Reading complete. time_to_read=0.33 seconds
2020-05-10 01:38:42,614 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_13.h5
2020-05-10 01:38:42,791 [INFO] Reading complete. time_to_read=0.18 seconds
2020-05-10 01:38:42,791 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_2.h5
2020-05-10 01:38:43,129 [INFO] Reading complete. time_to_read=0.34 seconds
2020-05-10 01:38:43,129 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_3.h5
2020-05-10 01:38:43,436 [INFO] Reading complete. time_to_read=0.31 seconds
2020-05-10 01:38:43,437 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_4.h5
2020-05-10 01:38:44,050 [INFO] Reading complete. time_to_read=0.61 seconds
2020-05-10 01:38:44,050 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_5.h5
2020-05-10 01:38:44,583 [INFO] Reading complete. time_to_read=0.53 seconds
2020-05-10 01:38:44,583 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_6.h5
2020-05-10 01:38:45,119 [INFO] Reading complete. time_to_read=0.54 seconds
2020-05-10 01:38:45,119 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_7.h5
2020-05-10 01:38:45,672 [INFO] Reading complete. time_to_read=0.55 seconds
2020-05-10 01:38:45,673 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_8.h5
2020-05-10 01:38:45,771 [INFO] Reading complete. time_to_read=0.10 seconds
2020-05-10 01:38:45,771 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_9.h5
2020-05-10 01:38:46,140 [INFO] Reading complete. time_to_read=0.37 seconds
2020-05-10 01:38:46,141 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_1.h5
2020-05-10 01:38:46,245 [INFO] Reading complete. time_to_read=0.10 seconds
2020-05-10 01:38:46,245 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_10.h5
2020-05-10 01:38:46,351 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:38:46,352 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_11.h5
2020-05-10 01:38:46,459 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:38:46,459 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_12.h5
2020-05-10 01:38:46,574 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:38:46,574 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_13.h5
2020-05-10 01:38:46,637 [INFO] Reading complete. time_to_read=0.06 seconds
2020-05-10 01:38:46,637 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_2.h5
2020-05-10 01:38:46,755 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 01:38:46,755 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_3.h5
2020-05-10 01:38:46,862 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:38:46,862 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_4.h5
2020-05-10 01:38:47,073 [INFO] Reading complete. time_to_read=0.21 seconds
2020-05-10 01:38:47,073 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_5.h5
2020-05-10 01:38:47,260 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:38:47,260 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_6.h5
2020-05-10 01:38:47,446 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:38:47,446 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_7.h5
2020-05-10 01:38:47,634 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:38:47,634 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_8.h5
2020-05-10 01:38:47,693 [INFO] Reading complete. time_to_read=0.06 seconds
2020-05-10 01:38:47,693 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_9.h5
2020-05-10 01:38:47,800 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:38:47,800 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_1.h5
2020-05-10 01:38:47,902 [INFO] Reading complete. time_to_read=0.10 seconds
2020-05-10 01:38:47,902 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_10.h5
2020-05-10 01:38:48,010 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:38:48,010 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_11.h5
2020-05-10 01:38:48,117 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:38:48,117 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_12.h5
2020-05-10 01:38:48,233 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 01:38:48,233 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_13.h5
2020-05-10 01:38:48,296 [INFO] Reading complete. time_to_read=0.06 seconds
2020-05-10 01:38:48,296 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_2.h5
2020-05-10 01:38:48,416 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 01:38:48,416 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_3.h5
2020-05-10 01:38:48,523 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:38:48,523 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_4.h5
2020-05-10 01:38:48,737 [INFO] Reading complete. time_to_read=0.21 seconds
2020-05-10 01:38:48,737 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_5.h5
2020-05-10 01:38:48,926 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:38:48,926 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_6.h5
2020-05-10 01:38:49,112 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:38:49,112 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_7.h5
2020-05-10 01:38:49,317 [INFO] Reading complete. time_to_read=0.20 seconds
2020-05-10 01:38:49,317 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_8.h5
2020-05-10 01:38:49,355 [INFO] Reading complete. time_to_read=0.04 seconds
2020-05-10 01:38:49,355 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_9.h5
2020-05-10 01:38:49,462 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:38:52,466 [INFO] Preparing flow sequences
2020-05-10 01:40:08,593 [INFO] Extracting flows complete. time_taken = 76.13 sec
2020-05-10 01:40:12,821 [INFO] Initializing model
2020-05-10 01:40:13,013 [INFO] Model: "sequential_6"
2020-05-10 01:40:13,013 [INFO] _________________________________________________________________
2020-05-10 01:40:13,013 [INFO] Layer (type)                 Output Shape              Param #   
2020-05-10 01:40:13,013 [INFO] =================================================================
2020-05-10 01:40:13,013 [INFO] lstm_7 (LSTM)                (None, 32, 64)            36352     
2020-05-10 01:40:13,013 [INFO] _________________________________________________________________
2020-05-10 01:40:13,013 [INFO] batch_normalization_7 (Batch (None, 32, 64)            256       
2020-05-10 01:40:13,013 [INFO] _________________________________________________________________
2020-05-10 01:40:13,013 [INFO] dropout_7 (Dropout)          (None, 32, 64)            0         
2020-05-10 01:40:13,013 [INFO] _________________________________________________________________
2020-05-10 01:40:13,013 [INFO] lstm_8 (LSTM)                (None, 32, 32)            12416     
2020-05-10 01:40:13,013 [INFO] _________________________________________________________________
2020-05-10 01:40:13,013 [INFO] batch_normalization_8 (Batch (None, 32, 32)            128       
2020-05-10 01:40:13,013 [INFO] _________________________________________________________________
2020-05-10 01:40:13,014 [INFO] dropout_8 (Dropout)          (None, 32, 32)            0         
2020-05-10 01:40:13,014 [INFO] _________________________________________________________________
2020-05-10 01:40:13,014 [INFO] time_distributed_6 (TimeDist (None, 32, 15)            495       
2020-05-10 01:40:13,014 [INFO] =================================================================
2020-05-10 01:40:13,014 [INFO] Total params: 49,647
2020-05-10 01:40:13,014 [INFO] Trainable params: 49,455
2020-05-10 01:40:13,014 [INFO] Non-trainable params: 192
2020-05-10 01:40:13,014 [INFO] _________________________________________________________________
2020-05-10 01:40:13,014 [INFO] Training model
2020-05-10 01:40:13.945055: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] layout failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:40:13.947339: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss_5/time_distributed_6_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss_5/time_distributed_6_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 01:40:13.957232: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:40:13.961610: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:40:14.000570: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:40:14.003037: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss_5/time_distributed_6_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss_5/time_distributed_6_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 01:40:14.006457: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:40:14.009517: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:40:14.018092: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:40:18.535461: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] layout failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:40:18.535953: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss_5/time_distributed_6_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss_5/time_distributed_6_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 01:40:18.537772: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:40:18.538635: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:40:18.544892: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:40:18.545388: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss_5/time_distributed_6_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss_5/time_distributed_6_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 01:40:18.546002: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:40:18.546541: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:40:18.547867: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
Train on 302572 samples, validate on 100857 samples
Epoch 1/80
 - 6s - loss: 0.2278 - val_loss: 0.2194
Epoch 2/80
 - 5s - loss: 0.1826 - val_loss: 0.1767
Epoch 3/80
 - 5s - loss: 0.1357 - val_loss: 0.1285
Epoch 4/80
 - 5s - loss: 0.0945 - val_loss: 0.0894
Epoch 5/80
 - 5s - loss: 0.0627 - val_loss: 0.0675
Epoch 6/80
 - 5s - loss: 0.0473 - val_loss: 0.0562
Epoch 7/80
 - 5s - loss: 0.0411 - val_loss: 0.0474
Epoch 8/80
 - 5s - loss: 0.0376 - val_loss: 0.0416
Epoch 9/80
 - 5s - loss: 0.0340 - val_loss: 0.0386
Epoch 10/80
 - 5s - loss: 0.0313 - val_loss: 0.0360
Epoch 11/80
 - 5s - loss: 0.0292 - val_loss: 0.0328
Epoch 12/80
 - 5s - loss: 0.0273 - val_loss: 0.0301
Epoch 13/80
 - 5s - loss: 0.0259 - val_loss: 0.0275
Epoch 14/80
 - 5s - loss: 0.0245 - val_loss: 0.0253
Epoch 15/80
 - 5s - loss: 0.0234 - val_loss: 0.0233
Epoch 16/80
 - 5s - loss: 0.0224 - val_loss: 0.0221
Epoch 17/80
 - 5s - loss: 0.0215 - val_loss: 0.0207
Epoch 18/80
 - 5s - loss: 0.0207 - val_loss: 0.0193
Epoch 19/80
 - 5s - loss: 0.0200 - val_loss: 0.0190
Epoch 20/80
 - 5s - loss: 0.0194 - val_loss: 0.0179
Epoch 21/80
 - 5s - loss: 0.0187 - val_loss: 0.0173
Epoch 22/80
 - 5s - loss: 0.0181 - val_loss: 0.0166
Epoch 23/80
 - 5s - loss: 0.0176 - val_loss: 0.0164
Epoch 24/80
 - 5s - loss: 0.0170 - val_loss: 0.0157
Epoch 25/80
 - 5s - loss: 0.0165 - val_loss: 0.0151
Epoch 26/80
 - 5s - loss: 0.0161 - val_loss: 0.0143
Epoch 27/80
 - 5s - loss: 0.0156 - val_loss: 0.0144
Epoch 28/80
 - 5s - loss: 0.0150 - val_loss: 0.0137
Epoch 29/80
 - 5s - loss: 0.0145 - val_loss: 0.0126
Epoch 30/80
 - 5s - loss: 0.0141 - val_loss: 0.0117
Epoch 31/80
 - 5s - loss: 0.0137 - val_loss: 0.0111
Epoch 32/80
 - 5s - loss: 0.0134 - val_loss: 0.0109
Epoch 33/80
 - 5s - loss: 0.0132 - val_loss: 0.0102
Epoch 34/80
 - 5s - loss: 0.0128 - val_loss: 0.0099
Epoch 35/80
 - 5s - loss: 0.0125 - val_loss: 0.0094
Epoch 36/80
 - 5s - loss: 0.0122 - val_loss: 0.0089
Epoch 37/80
 - 5s - loss: 0.0119 - val_loss: 0.0087
Epoch 38/80
 - 5s - loss: 0.0116 - val_loss: 0.0084
Epoch 39/80
 - 5s - loss: 0.0113 - val_loss: 0.0083
Epoch 40/80
 - 5s - loss: 0.0110 - val_loss: 0.0085
Epoch 41/80
 - 5s - loss: 0.0113 - val_loss: 0.0082
Epoch 42/80
 - 5s - loss: 0.0110 - val_loss: 0.0079
Epoch 43/80
 - 5s - loss: 0.0107 - val_loss: 0.0081
Epoch 44/80
 - 5s - loss: 0.0105 - val_loss: 0.0076
Epoch 45/80
 - 5s - loss: 0.0102 - val_loss: 0.0074
Epoch 46/80
 - 5s - loss: 0.0100 - val_loss: 0.0073
Epoch 47/80
 - 5s - loss: 0.0098 - val_loss: 0.0071
Epoch 48/80
 - 5s - loss: 0.0096 - val_loss: 0.0070
Epoch 49/80
 - 5s - loss: 0.0094 - val_loss: 0.0069
Epoch 50/80
 - 5s - loss: 0.0093 - val_loss: 0.0068
Epoch 51/80
 - 5s - loss: 0.0092 - val_loss: 0.0067
Epoch 52/80
 - 5s - loss: 0.0090 - val_loss: 0.0066
Epoch 53/80
 - 5s - loss: 0.0089 - val_loss: 0.0065
Epoch 54/80
 - 5s - loss: 0.0088 - val_loss: 0.0064
Epoch 55/80
 - 5s - loss: 0.0087 - val_loss: 0.0064
Epoch 56/80
 - 5s - loss: 0.0086 - val_loss: 0.0063
Epoch 57/80
 - 5s - loss: 0.0085 - val_loss: 0.0062
Epoch 58/80
 - 5s - loss: 0.0084 - val_loss: 0.0062
Epoch 59/80
 - 5s - loss: 0.0083 - val_loss: 0.0061
Epoch 60/80
 - 5s - loss: 0.0083 - val_loss: 0.0061
Epoch 61/80
 - 5s - loss: 0.0083 - val_loss: 0.0062
Epoch 62/80
 - 5s - loss: 0.0082 - val_loss: 0.0061
Epoch 63/80
 - 5s - loss: 0.0081 - val_loss: 0.0060
Epoch 64/80
 - 5s - loss: 0.0080 - val_loss: 0.0060
Epoch 65/80
 - 5s - loss: 0.0080 - val_loss: 0.0060
Epoch 66/80
 - 5s - loss: 0.0079 - val_loss: 0.0059
Epoch 67/80
 - 5s - loss: 0.0078 - val_loss: 0.0059
Epoch 68/80
 - 5s - loss: 0.0078 - val_loss: 0.0059
Epoch 69/80
 - 5s - loss: 0.0077 - val_loss: 0.0058
Epoch 70/80
 - 5s - loss: 0.0077 - val_loss: 0.0058
Epoch 71/80
 - 5s - loss: 0.0076 - val_loss: 0.0058
Epoch 72/80
 - 5s - loss: 0.0076 - val_loss: 0.0058
Epoch 73/80
 - 5s - loss: 0.0076 - val_loss: 0.0058
Epoch 74/80
 - 5s - loss: 0.0075 - val_loss: 0.0058
Epoch 75/80
 - 5s - loss: 0.0074 - val_loss: 0.0057
Epoch 76/80
 - 5s - loss: 0.0073 - val_loss: 0.0057
Epoch 77/80
 - 5s - loss: 0.0073 - val_loss: 0.0056
Epoch 78/80
 - 5s - loss: 0.0072 - val_loss: 0.0056
Epoch 79/80
 - 5s - loss: 0.0071 - val_loss: 0.0055
Epoch 80/80
 - 5s - loss: 0.0071 - val_loss: 0.0055
2020-05-10 01:47:06,098 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-05-10 01:47:06,100 [INFO] Training complete. time_to_train = 413.09 sec, 6.88 min
2020-05-10 01:47:06,106 [INFO] Model saved to results_selected_models/selected_ids18_full_lstm_deep_rep2/best_model.pickle
2020-05-10 01:47:06,107 [INFO] Training history saved to: results_selected_models/selected_ids18_full_lstm_deep_rep2/training_error_history.csv
2020-05-10 01:47:06,202 [INFO] Plot saved to: results_selected_models/selected_ids18_full_lstm_deep_rep2/training_error_history.png
2020-05-10 01:47:06,203 [INFO] Making predictions on training, validation, testing data
2020-05-10 01:47:36,725 [INFO] Making predictions complete. time_to_predict = 30.52 sec, 0.51 min
2020-05-10 01:47:36,771 [INFO] Evaluating predictions (results)
/home/sunanda/.conda/envs/ml_env_gpu/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sunanda/research/ids_experiments/utility.py:328: RuntimeWarning: invalid value encountered in true_divide
  PPV = TP / (TP + FP)    # Precision or positive predictive value
/home/sunanda/research/ids_experiments/utility.py:332: RuntimeWarning: invalid value encountered in true_divide
  FDR = FP / (TP + FP)    # False discovery rate
2020-05-10 01:49:26,334 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate    avg f1
0     Micro avg      0.988147       0.988147                     0.988147              0.000847                 0.011853  0.988147
1     Macro avg      0.998420       0.766256                     0.700547              0.004295                 0.299453  0.710726
2  Weighted avg      0.990524       0.984487                     0.988147              0.052578                 0.011853  0.983157
2020-05-10 01:49:26,369 [INFO] Results saved to: results_selected_models/selected_ids18_full_lstm_deep_rep2/selected_ids18_full_lstm_deep_rep2_results.xlsx
2020-05-10 01:49:26,374 [INFO] ================= Finished running experiment no. 2 ================= 

2020-05-10 01:49:26,655 [INFO] Created directory: results_selected_models/selected_ids18_full_lstm_deep_rep3
2020-05-10 01:49:26,655 [INFO] Initialized logging. log_filename = results_selected_models/selected_ids18_full_lstm_deep_rep3/run_log.log
2020-05-10 01:49:26,655 [INFO] ================= Running experiment no. 3  ================= 

2020-05-10 01:49:26,655 [INFO] Experiment parameters given below
2020-05-10 01:49:26,655 [INFO] 
{'experiment_num': 3, 'results_dir': 'results_selected_models/selected_ids18_full_lstm_deep_rep3', 'model': 'lstm', 'model_type': 'classifier', 'normal_label': 'BENIGN', 'lstm_time_steps': 32, 'lstm_layer_units': [64, 32], 'lstm_layer_activations': ['relu', 'relu'], 'lstm_layer_dropout_rates': [0.2, 0.2], 'batch_size': 8192, 'epochs': 80, 'early_stop_patience': 20, 'dataset_dir': '../Datasets/full_datasets/ids2018', 'description': 'selected_ids18_full_lstm_deep_rep3'}
2020-05-10 01:49:26,655 [INFO] Created tensorboard log directory: results_selected_models/selected_ids18_full_lstm_deep_rep3/tf_logs_run_2020_05_10-01_49_26
2020-05-10 01:49:26,656 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2018
2020-05-10 01:49:26,656 [INFO] Reading X, y files
2020-05-10 01:49:26,656 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_1.h5
2020-05-10 01:49:28,110 [INFO] Reading complete. time_to_read=1.45 seconds
2020-05-10 01:49:28,110 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_10.h5
2020-05-10 01:49:29,566 [INFO] Reading complete. time_to_read=1.46 seconds
2020-05-10 01:49:29,566 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_11.h5
2020-05-10 01:49:31,023 [INFO] Reading complete. time_to_read=1.46 seconds
2020-05-10 01:49:31,023 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_12.h5
2020-05-10 01:49:32,316 [INFO] Reading complete. time_to_read=1.29 seconds
2020-05-10 01:49:32,317 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_13.h5
2020-05-10 01:49:33,172 [INFO] Reading complete. time_to_read=0.86 seconds
2020-05-10 01:49:33,172 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_2.h5
2020-05-10 01:49:34,492 [INFO] Reading complete. time_to_read=1.32 seconds
2020-05-10 01:49:34,492 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_3.h5
2020-05-10 01:49:35,943 [INFO] Reading complete. time_to_read=1.45 seconds
2020-05-10 01:49:35,943 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_4.h5
2020-05-10 01:49:38,720 [INFO] Reading complete. time_to_read=2.78 seconds
2020-05-10 01:49:38,720 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_5.h5
2020-05-10 01:49:41,455 [INFO] Reading complete. time_to_read=2.74 seconds
2020-05-10 01:49:41,455 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_6.h5
2020-05-10 01:49:44,187 [INFO] Reading complete. time_to_read=2.73 seconds
2020-05-10 01:49:44,187 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_7.h5
2020-05-10 01:49:46,932 [INFO] Reading complete. time_to_read=2.74 seconds
2020-05-10 01:49:46,932 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_8.h5
2020-05-10 01:49:47,391 [INFO] Reading complete. time_to_read=0.46 seconds
2020-05-10 01:49:47,391 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_9.h5
2020-05-10 01:49:48,835 [INFO] Reading complete. time_to_read=1.44 seconds
2020-05-10 01:49:48,836 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_1.h5
2020-05-10 01:49:49,316 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 01:49:49,316 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_10.h5
2020-05-10 01:49:49,805 [INFO] Reading complete. time_to_read=0.49 seconds
2020-05-10 01:49:49,805 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_11.h5
2020-05-10 01:49:50,294 [INFO] Reading complete. time_to_read=0.49 seconds
2020-05-10 01:49:50,294 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_12.h5
2020-05-10 01:49:50,729 [INFO] Reading complete. time_to_read=0.43 seconds
2020-05-10 01:49:50,729 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_13.h5
2020-05-10 01:49:51,009 [INFO] Reading complete. time_to_read=0.28 seconds
2020-05-10 01:49:51,009 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_2.h5
2020-05-10 01:49:51,453 [INFO] Reading complete. time_to_read=0.44 seconds
2020-05-10 01:49:51,453 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_3.h5
2020-05-10 01:49:51,941 [INFO] Reading complete. time_to_read=0.49 seconds
2020-05-10 01:49:51,941 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_4.h5
2020-05-10 01:49:52,868 [INFO] Reading complete. time_to_read=0.93 seconds
2020-05-10 01:49:52,868 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_5.h5
2020-05-10 01:49:53,780 [INFO] Reading complete. time_to_read=0.91 seconds
2020-05-10 01:49:53,780 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_6.h5
2020-05-10 01:49:54,695 [INFO] Reading complete. time_to_read=0.92 seconds
2020-05-10 01:49:54,695 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_7.h5
2020-05-10 01:49:55,614 [INFO] Reading complete. time_to_read=0.92 seconds
2020-05-10 01:49:55,614 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_8.h5
2020-05-10 01:49:55,768 [INFO] Reading complete. time_to_read=0.15 seconds
2020-05-10 01:49:55,768 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_9.h5
2020-05-10 01:49:56,252 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 01:49:56,253 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_1.h5
2020-05-10 01:49:56,739 [INFO] Reading complete. time_to_read=0.49 seconds
2020-05-10 01:49:56,739 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_10.h5
2020-05-10 01:49:57,228 [INFO] Reading complete. time_to_read=0.49 seconds
2020-05-10 01:49:57,228 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_11.h5
2020-05-10 01:49:57,717 [INFO] Reading complete. time_to_read=0.49 seconds
2020-05-10 01:49:57,717 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_12.h5
2020-05-10 01:49:58,152 [INFO] Reading complete. time_to_read=0.44 seconds
2020-05-10 01:49:58,152 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_13.h5
2020-05-10 01:49:58,432 [INFO] Reading complete. time_to_read=0.28 seconds
2020-05-10 01:49:58,432 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_2.h5
2020-05-10 01:49:58,875 [INFO] Reading complete. time_to_read=0.44 seconds
2020-05-10 01:49:58,875 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_3.h5
2020-05-10 01:49:59,364 [INFO] Reading complete. time_to_read=0.49 seconds
2020-05-10 01:49:59,364 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_4.h5
2020-05-10 01:50:00,295 [INFO] Reading complete. time_to_read=0.93 seconds
2020-05-10 01:50:00,295 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_5.h5
2020-05-10 01:50:01,208 [INFO] Reading complete. time_to_read=0.91 seconds
2020-05-10 01:50:01,208 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_6.h5
2020-05-10 01:50:02,123 [INFO] Reading complete. time_to_read=0.91 seconds
2020-05-10 01:50:02,123 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_7.h5
2020-05-10 01:50:03,039 [INFO] Reading complete. time_to_read=0.92 seconds
2020-05-10 01:50:03,040 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_8.h5
2020-05-10 01:50:03,194 [INFO] Reading complete. time_to_read=0.15 seconds
2020-05-10 01:50:03,194 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_9.h5
2020-05-10 01:50:03,679 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 01:50:03,679 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_1.h5
2020-05-10 01:50:03,982 [INFO] Reading complete. time_to_read=0.30 seconds
2020-05-10 01:50:03,982 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_10.h5
2020-05-10 01:50:04,298 [INFO] Reading complete. time_to_read=0.32 seconds
2020-05-10 01:50:04,298 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_11.h5
2020-05-10 01:50:04,628 [INFO] Reading complete. time_to_read=0.33 seconds
2020-05-10 01:50:04,628 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_12.h5
2020-05-10 01:50:04,971 [INFO] Reading complete. time_to_read=0.34 seconds
2020-05-10 01:50:04,971 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_13.h5
2020-05-10 01:50:05,157 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:50:05,158 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_2.h5
2020-05-10 01:50:05,510 [INFO] Reading complete. time_to_read=0.35 seconds
2020-05-10 01:50:05,510 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_3.h5
2020-05-10 01:50:05,828 [INFO] Reading complete. time_to_read=0.32 seconds
2020-05-10 01:50:05,829 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_4.h5
2020-05-10 01:50:06,466 [INFO] Reading complete. time_to_read=0.64 seconds
2020-05-10 01:50:06,466 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_5.h5
2020-05-10 01:50:07,024 [INFO] Reading complete. time_to_read=0.56 seconds
2020-05-10 01:50:07,024 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_6.h5
2020-05-10 01:50:07,577 [INFO] Reading complete. time_to_read=0.55 seconds
2020-05-10 01:50:07,577 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_7.h5
2020-05-10 01:50:08,139 [INFO] Reading complete. time_to_read=0.56 seconds
2020-05-10 01:50:08,139 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_8.h5
2020-05-10 01:50:08,242 [INFO] Reading complete. time_to_read=0.10 seconds
2020-05-10 01:50:08,242 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_9.h5
2020-05-10 01:50:08,565 [INFO] Reading complete. time_to_read=0.32 seconds
2020-05-10 01:50:08,565 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_1.h5
2020-05-10 01:50:08,672 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:50:08,672 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_10.h5
2020-05-10 01:50:08,834 [INFO] Reading complete. time_to_read=0.16 seconds
2020-05-10 01:50:08,835 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_11.h5
2020-05-10 01:50:08,944 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:50:08,944 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_12.h5
2020-05-10 01:50:09,062 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 01:50:09,062 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_13.h5
2020-05-10 01:50:09,127 [INFO] Reading complete. time_to_read=0.06 seconds
2020-05-10 01:50:09,127 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_2.h5
2020-05-10 01:50:09,248 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 01:50:09,248 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_3.h5
2020-05-10 01:50:09,358 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:50:09,358 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_4.h5
2020-05-10 01:50:09,574 [INFO] Reading complete. time_to_read=0.22 seconds
2020-05-10 01:50:09,574 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_5.h5
2020-05-10 01:50:09,766 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:50:09,767 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_6.h5
2020-05-10 01:50:09,959 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:50:09,959 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_7.h5
2020-05-10 01:50:10,153 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:50:10,154 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_8.h5
2020-05-10 01:50:10,192 [INFO] Reading complete. time_to_read=0.04 seconds
2020-05-10 01:50:10,192 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_9.h5
2020-05-10 01:50:10,302 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:50:10,303 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_1.h5
2020-05-10 01:50:10,424 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 01:50:10,424 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_10.h5
2020-05-10 01:50:10,534 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:50:10,534 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_11.h5
2020-05-10 01:50:10,646 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:50:10,646 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_12.h5
2020-05-10 01:50:10,764 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 01:50:10,764 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_13.h5
2020-05-10 01:50:10,828 [INFO] Reading complete. time_to_read=0.06 seconds
2020-05-10 01:50:10,828 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_2.h5
2020-05-10 01:50:10,951 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 01:50:10,951 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_3.h5
2020-05-10 01:50:11,062 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:50:11,062 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_4.h5
2020-05-10 01:50:11,280 [INFO] Reading complete. time_to_read=0.22 seconds
2020-05-10 01:50:11,280 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_5.h5
2020-05-10 01:50:11,471 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:50:11,472 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_6.h5
2020-05-10 01:50:11,666 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:50:11,666 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_7.h5
2020-05-10 01:50:11,859 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:50:11,859 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_8.h5
2020-05-10 01:50:11,897 [INFO] Reading complete. time_to_read=0.04 seconds
2020-05-10 01:50:11,897 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_9.h5
2020-05-10 01:50:12,026 [INFO] Reading complete. time_to_read=0.13 seconds
2020-05-10 01:50:15,052 [INFO] Preparing flow sequences
2020-05-10 01:51:33,124 [INFO] Extracting flows complete. time_taken = 78.07 sec
2020-05-10 01:51:37,478 [INFO] Initializing model
2020-05-10 01:51:37,692 [INFO] Model: "sequential_7"
2020-05-10 01:51:37,692 [INFO] _________________________________________________________________
2020-05-10 01:51:37,692 [INFO] Layer (type)                 Output Shape              Param #   
2020-05-10 01:51:37,692 [INFO] =================================================================
2020-05-10 01:51:37,692 [INFO] lstm_9 (LSTM)                (None, 32, 64)            36352     
2020-05-10 01:51:37,692 [INFO] _________________________________________________________________
2020-05-10 01:51:37,692 [INFO] batch_normalization_9 (Batch (None, 32, 64)            256       
2020-05-10 01:51:37,692 [INFO] _________________________________________________________________
2020-05-10 01:51:37,692 [INFO] dropout_9 (Dropout)          (None, 32, 64)            0         
2020-05-10 01:51:37,692 [INFO] _________________________________________________________________
2020-05-10 01:51:37,692 [INFO] lstm_10 (LSTM)               (None, 32, 32)            12416     
2020-05-10 01:51:37,692 [INFO] _________________________________________________________________
2020-05-10 01:51:37,693 [INFO] batch_normalization_10 (Batc (None, 32, 32)            128       
2020-05-10 01:51:37,693 [INFO] _________________________________________________________________
2020-05-10 01:51:37,693 [INFO] dropout_10 (Dropout)         (None, 32, 32)            0         
2020-05-10 01:51:37,693 [INFO] _________________________________________________________________
2020-05-10 01:51:37,693 [INFO] time_distributed_7 (TimeDist (None, 32, 15)            495       
2020-05-10 01:51:37,693 [INFO] =================================================================
2020-05-10 01:51:37,693 [INFO] Total params: 49,647
2020-05-10 01:51:37,693 [INFO] Trainable params: 49,455
2020-05-10 01:51:37,693 [INFO] Non-trainable params: 192
2020-05-10 01:51:37,693 [INFO] _________________________________________________________________
2020-05-10 01:51:37,693 [INFO] Training model
2020-05-10 01:51:38.894593: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] layout failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:51:38.896993: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss_6/time_distributed_7_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss_6/time_distributed_7_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 01:51:38.907253: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:51:38.911837: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:51:38.952378: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:51:38.954924: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss_6/time_distributed_7_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss_6/time_distributed_7_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 01:51:38.958466: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:51:38.961671: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:51:38.970661: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:51:43.420518: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] layout failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:51:43.421041: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss_6/time_distributed_7_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss_6/time_distributed_7_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 01:51:43.422956: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:51:43.423873: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:51:43.430461: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 01:51:43.430984: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss_6/time_distributed_7_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss_6/time_distributed_7_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 01:51:43.431630: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:51:43.432201: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 01:51:43.433607: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
Train on 302572 samples, validate on 100857 samples
Epoch 1/80
 - 6s - loss: 0.2279 - val_loss: 0.2212
Epoch 2/80
 - 5s - loss: 0.1720 - val_loss: 0.1773
Epoch 3/80
 - 5s - loss: 0.1185 - val_loss: 0.1193
Epoch 4/80
 - 5s - loss: 0.0771 - val_loss: 0.0827
Epoch 5/80
 - 5s - loss: 0.0518 - val_loss: 0.0655
Epoch 6/80
 - 5s - loss: 0.0421 - val_loss: 0.0569
Epoch 7/80
 - 5s - loss: 0.0369 - val_loss: 0.0472
Epoch 8/80
 - 5s - loss: 0.0352 - val_loss: 0.0471
Epoch 9/80
 - 5s - loss: 0.0323 - val_loss: 0.0484
Epoch 10/80
 - 5s - loss: 0.0303 - val_loss: 0.0467
Epoch 11/80
 - 5s - loss: 0.0282 - val_loss: 0.0448
Epoch 12/80
 - 5s - loss: 0.0267 - val_loss: 0.0417
Epoch 13/80
 - 5s - loss: 0.0255 - val_loss: 0.0401
Epoch 14/80
 - 5s - loss: 0.0243 - val_loss: 0.0370
Epoch 15/80
 - 5s - loss: 0.0233 - val_loss: 0.0354
Epoch 16/80
 - 5s - loss: 0.0223 - val_loss: 0.0336
Epoch 17/80
 - 5s - loss: 0.0215 - val_loss: 0.0320
Epoch 18/80
 - 5s - loss: 0.0208 - val_loss: 0.0312
Epoch 19/80
 - 5s - loss: 0.0199 - val_loss: 0.0295
Epoch 20/80
 - 5s - loss: 0.0192 - val_loss: 0.0286
Epoch 21/80
 - 5s - loss: 0.0186 - val_loss: 0.0280
Epoch 22/80
 - 5s - loss: 0.0179 - val_loss: 0.0257
Epoch 23/80
 - 5s - loss: 0.0173 - val_loss: 0.0240
Epoch 24/80
 - 5s - loss: 0.0169 - val_loss: 0.0223
Epoch 25/80
 - 5s - loss: 0.0163 - val_loss: 0.0212
Epoch 26/80
 - 5s - loss: 0.0158 - val_loss: 0.0214
Epoch 27/80
 - 5s - loss: 0.0153 - val_loss: 0.0208
Epoch 28/80
 - 5s - loss: 0.0148 - val_loss: 0.0199
Epoch 29/80
 - 5s - loss: 0.0143 - val_loss: 0.0196
Epoch 30/80
 - 5s - loss: 0.0140 - val_loss: 0.0196
Epoch 31/80
 - 5s - loss: 0.0135 - val_loss: 0.0191
Epoch 32/80
 - 5s - loss: 0.0131 - val_loss: 0.0183
Epoch 33/80
 - 5s - loss: 0.0128 - val_loss: 0.0179
Epoch 34/80
 - 5s - loss: 0.0125 - val_loss: 0.0169
Epoch 35/80
 - 5s - loss: 0.0121 - val_loss: 0.0169
Epoch 36/80
 - 5s - loss: 0.0119 - val_loss: 0.0170
Epoch 37/80
 - 5s - loss: 0.0117 - val_loss: 0.0166
Epoch 38/80
 - 5s - loss: 0.0115 - val_loss: 0.0160
Epoch 39/80
 - 5s - loss: 0.0113 - val_loss: 0.0154
Epoch 40/80
 - 5s - loss: 0.0111 - val_loss: 0.0153
Epoch 41/80
 - 5s - loss: 0.0109 - val_loss: 0.0154
Epoch 42/80
 - 5s - loss: 0.0108 - val_loss: 0.0148
Epoch 43/80
 - 5s - loss: 0.0107 - val_loss: 0.0142
Epoch 44/80
 - 5s - loss: 0.0105 - val_loss: 0.0146
Epoch 45/80
 - 5s - loss: 0.0103 - val_loss: 0.0145
Epoch 46/80
 - 5s - loss: 0.0102 - val_loss: 0.0141
Epoch 47/80
 - 5s - loss: 0.0101 - val_loss: 0.0139
Epoch 48/80
 - 5s - loss: 0.0100 - val_loss: 0.0140
Epoch 49/80
 - 5s - loss: 0.0098 - val_loss: 0.0131
Epoch 50/80
 - 5s - loss: 0.0098 - val_loss: 0.0138
Epoch 51/80
 - 5s - loss: 0.0097 - val_loss: 0.0131
Epoch 52/80
 - 5s - loss: 0.0096 - val_loss: 0.0127
Epoch 53/80
 - 5s - loss: 0.0095 - val_loss: 0.0135
Epoch 54/80
 - 5s - loss: 0.0094 - val_loss: 0.0124
Epoch 55/80
 - 5s - loss: 0.0093 - val_loss: 0.0124
Epoch 56/80
 - 5s - loss: 0.0092 - val_loss: 0.0130
Epoch 57/80
 - 5s - loss: 0.0092 - val_loss: 0.0129
Epoch 58/80
 - 5s - loss: 0.0090 - val_loss: 0.0129
Epoch 59/80
 - 5s - loss: 0.0088 - val_loss: 0.0123
Epoch 60/80
 - 5s - loss: 0.0087 - val_loss: 0.0119
Epoch 61/80
 - 5s - loss: 0.0086 - val_loss: 0.0118
Epoch 62/80
 - 5s - loss: 0.0085 - val_loss: 0.0117
Epoch 63/80
 - 5s - loss: 0.0085 - val_loss: 0.0117
Epoch 64/80
 - 5s - loss: 0.0084 - val_loss: 0.0109
Epoch 65/80
 - 5s - loss: 0.0083 - val_loss: 0.0116
Epoch 66/80
 - 5s - loss: 0.0082 - val_loss: 0.0121
Epoch 67/80
 - 5s - loss: 0.0081 - val_loss: 0.0112
Epoch 68/80
 - 5s - loss: 0.0082 - val_loss: 0.0116
Epoch 69/80
 - 5s - loss: 0.0080 - val_loss: 0.0109
Epoch 70/80
 - 5s - loss: 0.0079 - val_loss: 0.0107
Epoch 71/80
 - 5s - loss: 0.0079 - val_loss: 0.0098
Epoch 72/80
 - 5s - loss: 0.0078 - val_loss: 0.0101
Epoch 73/80
 - 5s - loss: 0.0077 - val_loss: 0.0101
Epoch 74/80
 - 5s - loss: 0.0077 - val_loss: 0.0100
Epoch 75/80
 - 5s - loss: 0.0074 - val_loss: 0.0092
Epoch 76/80
 - 5s - loss: 0.0074 - val_loss: 0.0083
Epoch 77/80
 - 5s - loss: 0.0073 - val_loss: 0.0079
Epoch 78/80
 - 5s - loss: 0.0072 - val_loss: 0.0071
Epoch 79/80
 - 5s - loss: 0.0073 - val_loss: 0.0068
Epoch 80/80
 - 5s - loss: 0.0073 - val_loss: 0.0064
2020-05-10 01:58:22,506 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-05-10 01:58:22,508 [INFO] Training complete. time_to_train = 404.82 sec, 6.75 min
2020-05-10 01:58:22,514 [INFO] Model saved to results_selected_models/selected_ids18_full_lstm_deep_rep3/best_model.pickle
2020-05-10 01:58:22,515 [INFO] Training history saved to: results_selected_models/selected_ids18_full_lstm_deep_rep3/training_error_history.csv
2020-05-10 01:58:22,612 [INFO] Plot saved to: results_selected_models/selected_ids18_full_lstm_deep_rep3/training_error_history.png
2020-05-10 01:58:22,612 [INFO] Making predictions on training, validation, testing data
2020-05-10 01:58:53,387 [INFO] Making predictions complete. time_to_predict = 30.78 sec, 0.51 min
2020-05-10 01:58:53,433 [INFO] Evaluating predictions (results)
/home/sunanda/.conda/envs/ml_env_gpu/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sunanda/research/ids_experiments/utility.py:328: RuntimeWarning: invalid value encountered in true_divide
  PPV = TP / (TP + FP)    # Precision or positive predictive value
/home/sunanda/research/ids_experiments/utility.py:332: RuntimeWarning: invalid value encountered in true_divide
  FDR = FP / (TP + FP)    # False discovery rate
2020-05-10 02:00:44,279 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate    avg f1
0     Micro avg      0.985239       0.985239                     0.985239              0.001054                 0.014761  0.985239
1     Macro avg      0.998032       0.754199                     0.689533              0.005541                 0.310467  0.705189
2  Weighted avg      0.987916       0.979696                     0.985239              0.068358                 0.014761  0.980204
2020-05-10 02:00:44,313 [INFO] Results saved to: results_selected_models/selected_ids18_full_lstm_deep_rep3/selected_ids18_full_lstm_deep_rep3_results.xlsx
2020-05-10 02:00:44,318 [INFO] ================= Finished running experiment no. 3 ================= 

2020-05-10 02:00:44,608 [INFO] Created directory: results_selected_models/selected_ids18_full_lstm_deep_rep4
2020-05-10 02:00:44,608 [INFO] Initialized logging. log_filename = results_selected_models/selected_ids18_full_lstm_deep_rep4/run_log.log
2020-05-10 02:00:44,609 [INFO] ================= Running experiment no. 4  ================= 

2020-05-10 02:00:44,609 [INFO] Experiment parameters given below
2020-05-10 02:00:44,609 [INFO] 
{'experiment_num': 4, 'results_dir': 'results_selected_models/selected_ids18_full_lstm_deep_rep4', 'model': 'lstm', 'model_type': 'classifier', 'normal_label': 'BENIGN', 'lstm_time_steps': 32, 'lstm_layer_units': [64, 32], 'lstm_layer_activations': ['relu', 'relu'], 'lstm_layer_dropout_rates': [0.2, 0.2], 'batch_size': 8192, 'epochs': 80, 'early_stop_patience': 20, 'dataset_dir': '../Datasets/full_datasets/ids2018', 'description': 'selected_ids18_full_lstm_deep_rep4'}
2020-05-10 02:00:44,609 [INFO] Created tensorboard log directory: results_selected_models/selected_ids18_full_lstm_deep_rep4/tf_logs_run_2020_05_10-02_00_44
2020-05-10 02:00:44,609 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2018
2020-05-10 02:00:44,609 [INFO] Reading X, y files
2020-05-10 02:00:44,609 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_1.h5
2020-05-10 02:00:46,049 [INFO] Reading complete. time_to_read=1.44 seconds
2020-05-10 02:00:46,049 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_10.h5
2020-05-10 02:00:47,488 [INFO] Reading complete. time_to_read=1.44 seconds
2020-05-10 02:00:47,488 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_11.h5
2020-05-10 02:00:48,930 [INFO] Reading complete. time_to_read=1.44 seconds
2020-05-10 02:00:48,930 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_12.h5
2020-05-10 02:00:50,211 [INFO] Reading complete. time_to_read=1.28 seconds
2020-05-10 02:00:50,211 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_13.h5
2020-05-10 02:00:51,047 [INFO] Reading complete. time_to_read=0.84 seconds
2020-05-10 02:00:51,047 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_2.h5
2020-05-10 02:00:52,354 [INFO] Reading complete. time_to_read=1.31 seconds
2020-05-10 02:00:52,354 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_3.h5
2020-05-10 02:00:53,789 [INFO] Reading complete. time_to_read=1.44 seconds
2020-05-10 02:00:53,789 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_4.h5
2020-05-10 02:00:56,534 [INFO] Reading complete. time_to_read=2.74 seconds
2020-05-10 02:00:56,534 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_5.h5
2020-05-10 02:00:59,238 [INFO] Reading complete. time_to_read=2.70 seconds
2020-05-10 02:00:59,238 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_6.h5
2020-05-10 02:01:01,936 [INFO] Reading complete. time_to_read=2.70 seconds
2020-05-10 02:01:01,936 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_7.h5
2020-05-10 02:01:04,646 [INFO] Reading complete. time_to_read=2.71 seconds
2020-05-10 02:01:04,647 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_8.h5
2020-05-10 02:01:05,101 [INFO] Reading complete. time_to_read=0.45 seconds
2020-05-10 02:01:05,101 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_9.h5
2020-05-10 02:01:06,530 [INFO] Reading complete. time_to_read=1.43 seconds
2020-05-10 02:01:06,530 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_1.h5
2020-05-10 02:01:07,006 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 02:01:07,006 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_10.h5
2020-05-10 02:01:07,483 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 02:01:07,483 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_11.h5
2020-05-10 02:01:07,967 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 02:01:07,967 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_12.h5
2020-05-10 02:01:08,398 [INFO] Reading complete. time_to_read=0.43 seconds
2020-05-10 02:01:08,398 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_13.h5
2020-05-10 02:01:08,676 [INFO] Reading complete. time_to_read=0.28 seconds
2020-05-10 02:01:08,676 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_2.h5
2020-05-10 02:01:09,116 [INFO] Reading complete. time_to_read=0.44 seconds
2020-05-10 02:01:09,116 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_3.h5
2020-05-10 02:01:09,599 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 02:01:09,599 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_4.h5
2020-05-10 02:01:10,516 [INFO] Reading complete. time_to_read=0.92 seconds
2020-05-10 02:01:10,516 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_5.h5
2020-05-10 02:01:11,418 [INFO] Reading complete. time_to_read=0.90 seconds
2020-05-10 02:01:11,418 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_6.h5
2020-05-10 02:01:12,323 [INFO] Reading complete. time_to_read=0.91 seconds
2020-05-10 02:01:12,324 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_7.h5
2020-05-10 02:01:13,232 [INFO] Reading complete. time_to_read=0.91 seconds
2020-05-10 02:01:13,232 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_8.h5
2020-05-10 02:01:13,385 [INFO] Reading complete. time_to_read=0.15 seconds
2020-05-10 02:01:13,385 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_9.h5
2020-05-10 02:01:13,865 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 02:01:13,865 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_1.h5
2020-05-10 02:01:14,346 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 02:01:14,346 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_10.h5
2020-05-10 02:01:14,829 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 02:01:14,829 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_11.h5
2020-05-10 02:01:15,313 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 02:01:15,313 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_12.h5
2020-05-10 02:01:15,744 [INFO] Reading complete. time_to_read=0.43 seconds
2020-05-10 02:01:15,744 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_13.h5
2020-05-10 02:01:16,020 [INFO] Reading complete. time_to_read=0.28 seconds
2020-05-10 02:01:16,020 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_2.h5
2020-05-10 02:01:16,458 [INFO] Reading complete. time_to_read=0.44 seconds
2020-05-10 02:01:16,458 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_3.h5
2020-05-10 02:01:16,943 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 02:01:16,943 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_4.h5
2020-05-10 02:01:17,863 [INFO] Reading complete. time_to_read=0.92 seconds
2020-05-10 02:01:17,863 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_5.h5
2020-05-10 02:01:18,767 [INFO] Reading complete. time_to_read=0.90 seconds
2020-05-10 02:01:18,767 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_6.h5
2020-05-10 02:01:19,673 [INFO] Reading complete. time_to_read=0.91 seconds
2020-05-10 02:01:19,673 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_7.h5
2020-05-10 02:01:20,579 [INFO] Reading complete. time_to_read=0.91 seconds
2020-05-10 02:01:20,579 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_8.h5
2020-05-10 02:01:20,733 [INFO] Reading complete. time_to_read=0.15 seconds
2020-05-10 02:01:20,733 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_9.h5
2020-05-10 02:01:21,213 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-10 02:01:21,213 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_1.h5
2020-05-10 02:01:21,517 [INFO] Reading complete. time_to_read=0.30 seconds
2020-05-10 02:01:21,517 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_10.h5
2020-05-10 02:01:21,831 [INFO] Reading complete. time_to_read=0.31 seconds
2020-05-10 02:01:21,831 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_11.h5
2020-05-10 02:01:22,151 [INFO] Reading complete. time_to_read=0.32 seconds
2020-05-10 02:01:22,151 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_12.h5
2020-05-10 02:01:22,490 [INFO] Reading complete. time_to_read=0.34 seconds
2020-05-10 02:01:22,490 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_13.h5
2020-05-10 02:01:22,673 [INFO] Reading complete. time_to_read=0.18 seconds
2020-05-10 02:01:22,673 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_2.h5
2020-05-10 02:01:23,022 [INFO] Reading complete. time_to_read=0.35 seconds
2020-05-10 02:01:23,022 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_3.h5
2020-05-10 02:01:23,338 [INFO] Reading complete. time_to_read=0.32 seconds
2020-05-10 02:01:23,338 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_4.h5
2020-05-10 02:01:23,973 [INFO] Reading complete. time_to_read=0.64 seconds
2020-05-10 02:01:23,973 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_5.h5
2020-05-10 02:01:24,525 [INFO] Reading complete. time_to_read=0.55 seconds
2020-05-10 02:01:24,525 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_6.h5
2020-05-10 02:01:25,073 [INFO] Reading complete. time_to_read=0.55 seconds
2020-05-10 02:01:25,074 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_7.h5
2020-05-10 02:01:25,678 [INFO] Reading complete. time_to_read=0.60 seconds
2020-05-10 02:01:25,678 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_8.h5
2020-05-10 02:01:25,779 [INFO] Reading complete. time_to_read=0.10 seconds
2020-05-10 02:01:25,779 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_9.h5
2020-05-10 02:01:26,095 [INFO] Reading complete. time_to_read=0.32 seconds
2020-05-10 02:01:26,095 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_1.h5
2020-05-10 02:01:26,200 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 02:01:26,201 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_10.h5
2020-05-10 02:01:26,310 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 02:01:26,310 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_11.h5
2020-05-10 02:01:26,420 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 02:01:26,420 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_12.h5
2020-05-10 02:01:26,536 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 02:01:26,537 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_13.h5
2020-05-10 02:01:26,600 [INFO] Reading complete. time_to_read=0.06 seconds
2020-05-10 02:01:26,601 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_2.h5
2020-05-10 02:01:26,721 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 02:01:26,722 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_3.h5
2020-05-10 02:01:26,832 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 02:01:26,832 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_4.h5
2020-05-10 02:01:27,047 [INFO] Reading complete. time_to_read=0.22 seconds
2020-05-10 02:01:27,047 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_5.h5
2020-05-10 02:01:27,239 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 02:01:27,239 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_6.h5
2020-05-10 02:01:27,451 [INFO] Reading complete. time_to_read=0.21 seconds
2020-05-10 02:01:27,451 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_7.h5
2020-05-10 02:01:27,644 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 02:01:27,644 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_8.h5
2020-05-10 02:01:27,683 [INFO] Reading complete. time_to_read=0.04 seconds
2020-05-10 02:01:27,683 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_9.h5
2020-05-10 02:01:27,792 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 02:01:27,792 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_1.h5
2020-05-10 02:01:27,898 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 02:01:27,898 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_10.h5
2020-05-10 02:01:28,007 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 02:01:28,007 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_11.h5
2020-05-10 02:01:28,118 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 02:01:28,118 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_12.h5
2020-05-10 02:01:28,235 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 02:01:28,235 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_13.h5
2020-05-10 02:01:28,300 [INFO] Reading complete. time_to_read=0.06 seconds
2020-05-10 02:01:28,300 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_2.h5
2020-05-10 02:01:28,420 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 02:01:28,420 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_3.h5
2020-05-10 02:01:28,529 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 02:01:28,529 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_4.h5
2020-05-10 02:01:28,746 [INFO] Reading complete. time_to_read=0.22 seconds
2020-05-10 02:01:28,746 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_5.h5
2020-05-10 02:01:28,956 [INFO] Reading complete. time_to_read=0.21 seconds
2020-05-10 02:01:28,956 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_6.h5
2020-05-10 02:01:29,149 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 02:01:29,149 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_7.h5
2020-05-10 02:01:29,341 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 02:01:29,341 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_8.h5
2020-05-10 02:01:29,379 [INFO] Reading complete. time_to_read=0.04 seconds
2020-05-10 02:01:29,379 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_9.h5
2020-05-10 02:01:29,490 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 02:01:32,553 [INFO] Preparing flow sequences
2020-05-10 02:02:50,074 [INFO] Extracting flows complete. time_taken = 77.52 sec
2020-05-10 02:02:54,471 [INFO] Initializing model
2020-05-10 02:02:54,691 [INFO] Model: "sequential_8"
2020-05-10 02:02:54,691 [INFO] _________________________________________________________________
2020-05-10 02:02:54,691 [INFO] Layer (type)                 Output Shape              Param #   
2020-05-10 02:02:54,691 [INFO] =================================================================
2020-05-10 02:02:54,691 [INFO] lstm_11 (LSTM)               (None, 32, 64)            36352     
2020-05-10 02:02:54,691 [INFO] _________________________________________________________________
2020-05-10 02:02:54,691 [INFO] batch_normalization_11 (Batc (None, 32, 64)            256       
2020-05-10 02:02:54,691 [INFO] _________________________________________________________________
2020-05-10 02:02:54,691 [INFO] dropout_11 (Dropout)         (None, 32, 64)            0         
2020-05-10 02:02:54,691 [INFO] _________________________________________________________________
2020-05-10 02:02:54,691 [INFO] lstm_12 (LSTM)               (None, 32, 32)            12416     
2020-05-10 02:02:54,691 [INFO] _________________________________________________________________
2020-05-10 02:02:54,691 [INFO] batch_normalization_12 (Batc (None, 32, 32)            128       
2020-05-10 02:02:54,691 [INFO] _________________________________________________________________
2020-05-10 02:02:54,691 [INFO] dropout_12 (Dropout)         (None, 32, 32)            0         
2020-05-10 02:02:54,691 [INFO] _________________________________________________________________
2020-05-10 02:02:54,691 [INFO] time_distributed_8 (TimeDist (None, 32, 15)            495       
2020-05-10 02:02:54,691 [INFO] =================================================================
2020-05-10 02:02:54,692 [INFO] Total params: 49,647
2020-05-10 02:02:54,692 [INFO] Trainable params: 49,455
2020-05-10 02:02:54,692 [INFO] Non-trainable params: 192
2020-05-10 02:02:54,692 [INFO] _________________________________________________________________
2020-05-10 02:02:54,692 [INFO] Training model
2020-05-10 02:02:55.657097: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] layout failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 02:02:55.659465: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss_7/time_distributed_8_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss_7/time_distributed_8_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 02:02:55.669706: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 02:02:55.674241: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 02:02:55.714522: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 02:02:55.717085: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss_7/time_distributed_8_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss_7/time_distributed_8_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 02:02:55.720639: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 02:02:55.723823: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 02:02:55.732602: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 02:03:00.409439: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] layout failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 02:03:00.409941: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss_7/time_distributed_8_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss_7/time_distributed_8_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 02:03:00.411830: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 02:03:00.412724: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 02:03:00.419208: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] arithmetic_optimizer failed: Invalid argument: The graph couldn't be sorted in topological order.
2020-05-10 02:03:00.419720: E tensorflow/core/grappler/optimizers/meta_optimizer.cc:561] remapper failed: Invalid argument: MutableGraphView::MutableGraphView error: node 'loss_7/time_distributed_8_loss/binary_crossentropy/weighted_loss/concat' has self cycle fanin 'loss_7/time_distributed_8_loss/binary_crossentropy/weighted_loss/concat'.
2020-05-10 02:03:00.420366: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 0, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 02:03:00.420923: E tensorflow/core/grappler/optimizers/dependency_optimizer.cc:717] Iteration = 1, topological sort failed with message: The graph couldn't be sorted in topological order.
2020-05-10 02:03:00.422277: W tensorflow/core/common_runtime/process_function_library_runtime.cc:697] Ignoring multi-device function optimization failure: Invalid argument: The graph couldn't be sorted in topological order.
Train on 302572 samples, validate on 100857 samples
Epoch 1/80
 - 6s - loss: 0.2282 - val_loss: 0.2239
Epoch 2/80
 - 5s - loss: 0.1848 - val_loss: 0.1922
Epoch 3/80
 - 5s - loss: 0.1442 - val_loss: 0.1493
Epoch 4/80
 - 5s - loss: 0.1060 - val_loss: 0.1059
Epoch 5/80
 - 5s - loss: 0.0751 - val_loss: 0.0783
Epoch 6/80
 - 5s - loss: 0.0554 - val_loss: 0.0628
Epoch 7/80
 - 5s - loss: 0.0471 - val_loss: 0.0615
Epoch 8/80
 - 5s - loss: 0.0453 - val_loss: 0.0550
Epoch 9/80
 - 5s - loss: 0.0418 - val_loss: 0.0475
Epoch 10/80
 - 5s - loss: 0.0387 - val_loss: 0.0426
Epoch 11/80
 - 5s - loss: 0.0372 - val_loss: 0.0406
Epoch 12/80
 - 5s - loss: 0.0350 - val_loss: 0.0374
Epoch 13/80
 - 5s - loss: 0.0333 - val_loss: 0.0350
Epoch 14/80
 - 5s - loss: 0.0319 - val_loss: 0.0331
Epoch 15/80
 - 5s - loss: 0.0305 - val_loss: 0.0311
Epoch 16/80
 - 5s - loss: 0.0294 - val_loss: 0.0293
Epoch 17/80
 - 5s - loss: 0.0283 - val_loss: 0.0275
Epoch 18/80
 - 5s - loss: 0.0273 - val_loss: 0.0258
Epoch 19/80
 - 5s - loss: 0.0264 - val_loss: 0.0246
Epoch 20/80
 - 5s - loss: 0.0256 - val_loss: 0.0238
Epoch 21/80
 - 5s - loss: 0.0248 - val_loss: 0.0221
Epoch 22/80
 - 5s - loss: 0.0269 - val_loss: 0.0244
Epoch 23/80
 - 5s - loss: 0.0253 - val_loss: 0.0225
Epoch 24/80
 - 5s - loss: 0.0240 - val_loss: 0.0220
Epoch 25/80
 - 5s - loss: 0.0229 - val_loss: 0.0215
Epoch 26/80
 - 5s - loss: 0.0220 - val_loss: 0.0208
Epoch 27/80
 - 5s - loss: 0.0213 - val_loss: 0.0200
Epoch 28/80
 - 5s - loss: 0.0207 - val_loss: 0.0194
Epoch 29/80
 - 5s - loss: 0.0206 - val_loss: 0.0186
Epoch 30/80
 - 5s - loss: 0.0204 - val_loss: 0.0178
Epoch 31/80
 - 5s - loss: 0.0196 - val_loss: 0.0170
Epoch 32/80
 - 5s - loss: 0.0190 - val_loss: 0.0164
Epoch 33/80
 - 5s - loss: 0.0185 - val_loss: 0.0159
Epoch 34/80
 - 5s - loss: 0.0181 - val_loss: 0.0156
Epoch 35/80
 - 5s - loss: 0.0177 - val_loss: 0.0150
Epoch 36/80
 - 5s - loss: 0.0173 - val_loss: 0.0147
Epoch 37/80
 - 5s - loss: 0.0169 - val_loss: 0.0145
Epoch 38/80
 - 5s - loss: 0.0165 - val_loss: 0.0141
Epoch 39/80
 - 5s - loss: 0.0162 - val_loss: 0.0138
Epoch 40/80
 - 5s - loss: 0.0159 - val_loss: 0.0135
Epoch 41/80
 - 5s - loss: 0.0159 - val_loss: 0.0137
Epoch 42/80
 - 5s - loss: 0.0157 - val_loss: 0.0137
Epoch 43/80
 - 5s - loss: 0.0154 - val_loss: 0.0135
Epoch 44/80
 - 5s - loss: 0.0153 - val_loss: 0.0141
Epoch 45/80
 - 5s - loss: 0.0149 - val_loss: 0.0141
Epoch 46/80
 - 5s - loss: 0.0145 - val_loss: 0.0138
Epoch 47/80
 - 5s - loss: 0.0143 - val_loss: 0.0138
Epoch 48/80
 - 5s - loss: 0.0141 - val_loss: 0.0131
Epoch 49/80
 - 5s - loss: 0.0139 - val_loss: 0.0133
Epoch 50/80
 - 5s - loss: 0.0138 - val_loss: 0.0129
Epoch 51/80
 - 5s - loss: 0.0135 - val_loss: 0.0124
Epoch 52/80
 - 5s - loss: 0.0133 - val_loss: 0.0121
Epoch 53/80
 - 5s - loss: 0.0131 - val_loss: 0.0123
Epoch 54/80
 - 5s - loss: 0.0128 - val_loss: 0.0117
Epoch 55/80
 - 5s - loss: 0.0126 - val_loss: 0.0113
Epoch 56/80
 - 5s - loss: 0.0124 - val_loss: 0.0112
Epoch 57/80
 - 5s - loss: 0.0122 - val_loss: 0.0111
Epoch 58/80
 - 5s - loss: 0.0120 - val_loss: 0.0107
Epoch 59/80
 - 5s - loss: 0.0118 - val_loss: 0.0104
Epoch 60/80
 - 5s - loss: 0.0116 - val_loss: 0.0102
Epoch 61/80
 - 5s - loss: 0.0114 - val_loss: 0.0099
Epoch 62/80
 - 5s - loss: 0.0112 - val_loss: 0.0099
Epoch 63/80
 - 5s - loss: 0.0110 - val_loss: 0.0097
Epoch 64/80
 - 5s - loss: 0.0108 - val_loss: 0.0094
Epoch 65/80
 - 5s - loss: 0.0107 - val_loss: 0.0091
Epoch 66/80
 - 5s - loss: 0.0105 - val_loss: 0.0089
Epoch 67/80
 - 5s - loss: 0.0103 - val_loss: 0.0089
Epoch 68/80
 - 5s - loss: 0.0103 - val_loss: 0.0088
Epoch 69/80
 - 5s - loss: 0.0102 - val_loss: 0.0086
Epoch 70/80
 - 5s - loss: 0.0100 - val_loss: 0.0087
Epoch 71/80
 - 5s - loss: 0.0098 - val_loss: 0.0087
Epoch 72/80
 - 5s - loss: 0.0097 - val_loss: 0.0085
Epoch 73/80
 - 5s - loss: 0.0096 - val_loss: 0.0084
Epoch 74/80
 - 5s - loss: 0.0095 - val_loss: 0.0084
Epoch 75/80
 - 5s - loss: 0.0094 - val_loss: 0.0081
Epoch 76/80
 - 5s - loss: 0.0093 - val_loss: 0.0082
Epoch 77/80
 - 5s - loss: 0.0092 - val_loss: 0.0080
Epoch 78/80
 - 5s - loss: 0.0091 - val_loss: 0.0081
Epoch 79/80
 - 5s - loss: 0.0089 - val_loss: 0.0082
Epoch 80/80
 - 5s - loss: 0.0088 - val_loss: 0.0079
2020-05-10 02:09:37,861 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-05-10 02:09:37,863 [INFO] Training complete. time_to_train = 403.17 sec, 6.72 min
2020-05-10 02:09:37,868 [INFO] Model saved to results_selected_models/selected_ids18_full_lstm_deep_rep4/best_model.pickle
2020-05-10 02:09:37,869 [INFO] Training history saved to: results_selected_models/selected_ids18_full_lstm_deep_rep4/training_error_history.csv
2020-05-10 02:09:37,967 [INFO] Plot saved to: results_selected_models/selected_ids18_full_lstm_deep_rep4/training_error_history.png
2020-05-10 02:09:37,967 [INFO] Making predictions on training, validation, testing data
2020-05-10 02:10:08,248 [INFO] Making predictions complete. time_to_predict = 30.28 sec, 0.50 min
2020-05-10 02:10:08,294 [INFO] Evaluating predictions (results)
/home/sunanda/.conda/envs/ml_env_gpu/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/sunanda/research/ids_experiments/utility.py:328: RuntimeWarning: invalid value encountered in true_divide
  PPV = TP / (TP + FP)    # Precision or positive predictive value
/home/sunanda/research/ids_experiments/utility.py:332: RuntimeWarning: invalid value encountered in true_divide
  FDR = FP / (TP + FP)    # False discovery rate
/home/sunanda/research/ids_experiments/utility.py:334: RuntimeWarning: invalid value encountered in true_divide
  F1 = (2 * PPV * TPR) / (PPV + TPR)  # F1 score
2020-05-10 02:12:01,701 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate    avg f1
0     Micro avg      0.981987       0.981987                     0.981987              0.001287                 0.018013  0.981987
1     Macro avg      0.997598       0.720905                     0.654614              0.006702                 0.345386  0.681416
2  Weighted avg      0.985346       0.972214                     0.981987              0.082511                 0.018013  0.976726
2020-05-10 02:12:01,736 [INFO] Results saved to: results_selected_models/selected_ids18_full_lstm_deep_rep4/selected_ids18_full_lstm_deep_rep4_results.xlsx
2020-05-10 02:12:01,740 [INFO] ================= Finished running experiment no. 4 ================= 

2020-05-10 02:12:02,021 [INFO] ================= Finished running 8 experiments ================= 

