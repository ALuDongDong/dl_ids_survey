2020-05-09 12:27:29,262 [INFO] Initialized logging. log_filename = results_selected_models/selected_ids18_full_ann_shallow_rep2/run_log.log
2020-05-09 12:27:29,262 [INFO] ================= Running experiment no. 2  ================= 

2020-05-09 12:27:29,262 [INFO] Experiment parameters given below
2020-05-09 12:27:29,262 [INFO] 
{'experiment_num': 2, 'results_dir': 'results_selected_models/selected_ids18_full_ann_shallow_rep2', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [512], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 25, 'batch_size': 8192, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/full_datasets/ids2018', 'description': 'selected_ids18_full_ann_shallow_rep2'}
2020-05-09 12:27:29,262 [INFO] Created tensorboard log directory: results_selected_models/selected_ids18_full_ann_shallow_rep2/tf_logs_run_2020_05_09-12_27_29
2020-05-09 12:27:29,262 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2018
2020-05-09 12:27:29,263 [INFO] Reading X, y files
2020-05-09 12:27:29,263 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_1.h5
2020-05-09 12:27:29,268 [INFO] Note: NumExpr detected 24 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2020-05-09 12:27:29,268 [INFO] NumExpr defaulting to 8 threads.
2020-05-09 12:27:30,672 [INFO] Reading complete. time_to_read=1.41 seconds
2020-05-09 12:27:30,673 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_10.h5
2020-05-09 12:27:32,079 [INFO] Reading complete. time_to_read=1.41 seconds
2020-05-09 12:27:32,079 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_11.h5
2020-05-09 12:27:33,483 [INFO] Reading complete. time_to_read=1.40 seconds
2020-05-09 12:27:33,483 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_12.h5
2020-05-09 12:27:34,729 [INFO] Reading complete. time_to_read=1.25 seconds
2020-05-09 12:27:34,730 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_13.h5
2020-05-09 12:27:35,555 [INFO] Reading complete. time_to_read=0.83 seconds
2020-05-09 12:27:35,555 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_2.h5
2020-05-09 12:27:36,829 [INFO] Reading complete. time_to_read=1.27 seconds
2020-05-09 12:27:36,829 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_3.h5
2020-05-09 12:27:38,229 [INFO] Reading complete. time_to_read=1.40 seconds
2020-05-09 12:27:38,230 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_4.h5
2020-05-09 12:27:40,911 [INFO] Reading complete. time_to_read=2.68 seconds
2020-05-09 12:27:40,911 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_5.h5
2020-05-09 12:27:43,547 [INFO] Reading complete. time_to_read=2.64 seconds
2020-05-09 12:27:43,547 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_6.h5
2020-05-09 12:27:46,180 [INFO] Reading complete. time_to_read=2.63 seconds
2020-05-09 12:27:46,180 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_7.h5
2020-05-09 12:27:48,828 [INFO] Reading complete. time_to_read=2.65 seconds
2020-05-09 12:27:48,828 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_8.h5
2020-05-09 12:27:49,277 [INFO] Reading complete. time_to_read=0.45 seconds
2020-05-09 12:27:49,277 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_9.h5
2020-05-09 12:27:50,671 [INFO] Reading complete. time_to_read=1.39 seconds
2020-05-09 12:27:50,671 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_1.h5
2020-05-09 12:27:51,141 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-09 12:27:51,141 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_10.h5
2020-05-09 12:27:51,614 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-09 12:27:51,614 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_11.h5
2020-05-09 12:27:52,084 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-09 12:27:52,085 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_12.h5
2020-05-09 12:27:52,504 [INFO] Reading complete. time_to_read=0.42 seconds
2020-05-09 12:27:52,505 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_13.h5
2020-05-09 12:27:52,779 [INFO] Reading complete. time_to_read=0.27 seconds
2020-05-09 12:27:52,779 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_2.h5
2020-05-09 12:27:53,205 [INFO] Reading complete. time_to_read=0.43 seconds
2020-05-09 12:27:53,205 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_3.h5
2020-05-09 12:27:53,676 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-09 12:27:53,676 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_4.h5
2020-05-09 12:27:54,572 [INFO] Reading complete. time_to_read=0.90 seconds
2020-05-09 12:27:54,572 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_5.h5
2020-05-09 12:27:55,451 [INFO] Reading complete. time_to_read=0.88 seconds
2020-05-09 12:27:55,451 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_6.h5
2020-05-09 12:27:56,333 [INFO] Reading complete. time_to_read=0.88 seconds
2020-05-09 12:27:56,333 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_7.h5
2020-05-09 12:27:57,219 [INFO] Reading complete. time_to_read=0.89 seconds
2020-05-09 12:27:57,220 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_8.h5
2020-05-09 12:27:57,370 [INFO] Reading complete. time_to_read=0.15 seconds
2020-05-09 12:27:57,370 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_9.h5
2020-05-09 12:27:57,838 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-09 12:27:57,838 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_1.h5
2020-05-09 12:27:58,307 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-09 12:27:58,307 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_10.h5
2020-05-09 12:27:58,779 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-09 12:27:58,779 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_11.h5
2020-05-09 12:27:59,249 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-09 12:27:59,249 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_12.h5
2020-05-09 12:27:59,669 [INFO] Reading complete. time_to_read=0.42 seconds
2020-05-09 12:27:59,669 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_13.h5
2020-05-09 12:27:59,941 [INFO] Reading complete. time_to_read=0.27 seconds
2020-05-09 12:27:59,941 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_2.h5
2020-05-09 12:28:00,369 [INFO] Reading complete. time_to_read=0.43 seconds
2020-05-09 12:28:00,369 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_3.h5
2020-05-09 12:28:00,841 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-09 12:28:00,841 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_4.h5
2020-05-09 12:28:01,740 [INFO] Reading complete. time_to_read=0.90 seconds
2020-05-09 12:28:01,740 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_5.h5
2020-05-09 12:28:02,620 [INFO] Reading complete. time_to_read=0.88 seconds
2020-05-09 12:28:02,620 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_6.h5
2020-05-09 12:28:03,502 [INFO] Reading complete. time_to_read=0.88 seconds
2020-05-09 12:28:03,502 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_7.h5
2020-05-09 12:28:04,389 [INFO] Reading complete. time_to_read=0.89 seconds
2020-05-09 12:28:04,389 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_8.h5
2020-05-09 12:28:04,541 [INFO] Reading complete. time_to_read=0.15 seconds
2020-05-09 12:28:04,541 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_9.h5
2020-05-09 12:28:05,009 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-09 12:28:05,009 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_1.h5
2020-05-09 12:28:05,329 [INFO] Reading complete. time_to_read=0.32 seconds
2020-05-09 12:28:05,330 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_10.h5
2020-05-09 12:28:05,661 [INFO] Reading complete. time_to_read=0.33 seconds
2020-05-09 12:28:05,661 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_11.h5
2020-05-09 12:28:06,003 [INFO] Reading complete. time_to_read=0.34 seconds
2020-05-09 12:28:06,003 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_12.h5
2020-05-09 12:28:06,356 [INFO] Reading complete. time_to_read=0.35 seconds
2020-05-09 12:28:06,356 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_13.h5
2020-05-09 12:28:06,549 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-09 12:28:06,549 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_2.h5
2020-05-09 12:28:06,915 [INFO] Reading complete. time_to_read=0.37 seconds
2020-05-09 12:28:06,915 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_3.h5
2020-05-09 12:28:07,251 [INFO] Reading complete. time_to_read=0.34 seconds
2020-05-09 12:28:07,251 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_4.h5
2020-05-09 12:28:07,924 [INFO] Reading complete. time_to_read=0.67 seconds
2020-05-09 12:28:07,925 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_5.h5
2020-05-09 12:28:08,523 [INFO] Reading complete. time_to_read=0.60 seconds
2020-05-09 12:28:08,523 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_6.h5
2020-05-09 12:28:09,114 [INFO] Reading complete. time_to_read=0.59 seconds
2020-05-09 12:28:09,115 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_7.h5
2020-05-09 12:28:09,704 [INFO] Reading complete. time_to_read=0.59 seconds
2020-05-09 12:28:09,704 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_8.h5
2020-05-09 12:28:09,811 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-09 12:28:09,812 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_9.h5
2020-05-09 12:28:10,198 [INFO] Reading complete. time_to_read=0.39 seconds
2020-05-09 12:28:10,198 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_1.h5
2020-05-09 12:28:10,310 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-09 12:28:10,311 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_10.h5
2020-05-09 12:28:10,427 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-09 12:28:10,427 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_11.h5
2020-05-09 12:28:10,542 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-09 12:28:10,542 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_12.h5
2020-05-09 12:28:10,664 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-09 12:28:10,664 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_13.h5
2020-05-09 12:28:10,731 [INFO] Reading complete. time_to_read=0.07 seconds
2020-05-09 12:28:10,731 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_2.h5
2020-05-09 12:28:10,857 [INFO] Reading complete. time_to_read=0.13 seconds
2020-05-09 12:28:10,857 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_3.h5
2020-05-09 12:28:10,972 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-09 12:28:10,972 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_4.h5
2020-05-09 12:28:11,202 [INFO] Reading complete. time_to_read=0.23 seconds
2020-05-09 12:28:11,202 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_5.h5
2020-05-09 12:28:11,402 [INFO] Reading complete. time_to_read=0.20 seconds
2020-05-09 12:28:11,402 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_6.h5
2020-05-09 12:28:11,625 [INFO] Reading complete. time_to_read=0.22 seconds
2020-05-09 12:28:11,625 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_7.h5
2020-05-09 12:28:11,831 [INFO] Reading complete. time_to_read=0.21 seconds
2020-05-09 12:28:11,831 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_8.h5
2020-05-09 12:28:11,871 [INFO] Reading complete. time_to_read=0.04 seconds
2020-05-09 12:28:11,871 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_9.h5
2020-05-09 12:28:11,987 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-09 12:28:11,987 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_1.h5
2020-05-09 12:28:12,098 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-09 12:28:12,098 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_10.h5
2020-05-09 12:28:12,211 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-09 12:28:12,212 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_11.h5
2020-05-09 12:28:12,327 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-09 12:28:12,327 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_12.h5
2020-05-09 12:28:12,448 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-09 12:28:12,448 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_13.h5
2020-05-09 12:28:12,515 [INFO] Reading complete. time_to_read=0.07 seconds
2020-05-09 12:28:12,516 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_2.h5
2020-05-09 12:28:12,640 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-09 12:28:12,640 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_3.h5
2020-05-09 12:28:12,769 [INFO] Reading complete. time_to_read=0.13 seconds
2020-05-09 12:28:12,769 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_4.h5
2020-05-09 12:28:12,997 [INFO] Reading complete. time_to_read=0.23 seconds
2020-05-09 12:28:12,997 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_5.h5
2020-05-09 12:28:13,192 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-09 12:28:13,192 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_6.h5
2020-05-09 12:28:13,385 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-09 12:28:13,385 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_7.h5
2020-05-09 12:28:13,587 [INFO] Reading complete. time_to_read=0.20 seconds
2020-05-09 12:28:13,588 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_8.h5
2020-05-09 12:28:13,627 [INFO] Reading complete. time_to_read=0.04 seconds
2020-05-09 12:28:13,627 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_9.h5
2020-05-09 12:28:13,742 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-09 12:28:20,703 [INFO] Initializing model
2020-05-09 12:28:21,165 [INFO] Model: "sequential_1"
2020-05-09 12:28:21,165 [INFO] _________________________________________________________________
2020-05-09 12:28:21,165 [INFO] Layer (type)                 Output Shape              Param #   
2020-05-09 12:28:21,165 [INFO] =================================================================
2020-05-09 12:28:21,165 [INFO] dense_1 (Dense)              (None, 512)               39936     
2020-05-09 12:28:21,165 [INFO] _________________________________________________________________
2020-05-09 12:28:21,166 [INFO] batch_normalization_1 (Batch (None, 512)               2048      
2020-05-09 12:28:21,166 [INFO] _________________________________________________________________
2020-05-09 12:28:21,166 [INFO] dropout_1 (Dropout)          (None, 512)               0         
2020-05-09 12:28:21,166 [INFO] _________________________________________________________________
2020-05-09 12:28:21,166 [INFO] dense_2 (Dense)              (None, 15)                7695      
2020-05-09 12:28:21,166 [INFO] =================================================================
2020-05-09 12:28:21,166 [INFO] Total params: 49,679
2020-05-09 12:28:21,166 [INFO] Trainable params: 48,655
2020-05-09 12:28:21,166 [INFO] Non-trainable params: 1,024
2020-05-09 12:28:21,166 [INFO] _________________________________________________________________
2020-05-09 12:28:21,166 [INFO] Training model
2020-05-09 12:49:57,122 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-05-09 12:49:57,123 [INFO] Training complete. time_to_train = 1295.96 sec, 21.60 min
2020-05-09 12:49:57,129 [INFO] Model saved to results_selected_models/selected_ids18_full_ann_shallow_rep2/best_model.pickle
2020-05-09 12:49:57,132 [INFO] Training history saved to: results_selected_models/selected_ids18_full_ann_shallow_rep2/training_error_history.csv
2020-05-09 12:49:57,267 [INFO] Plot saved to: results_selected_models/selected_ids18_full_ann_shallow_rep2/training_error_history.png
2020-05-09 12:49:57,267 [INFO] Making predictions on training, validation, testing data
2020-05-09 12:50:52,134 [INFO] Making predictions complete. time_to_predict = 54.87 sec, 0.91 min
2020-05-09 12:50:52,185 [INFO] Evaluating predictions (results)
2020-05-09 12:52:38,963 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate    avg f1
0     Micro avg      0.983785       0.983785                     0.983785              0.001158                 0.016215  0.983785
1     Macro avg      0.997838       0.894696                     0.781964              0.004406                 0.218036  0.802097
2  Weighted avg      0.991125       0.978880                     0.983785              0.049876                 0.016215  0.978663
2020-05-09 12:52:38,998 [INFO] Results saved to: results_selected_models/selected_ids18_full_ann_shallow_rep2/selected_ids18_full_ann_shallow_rep2_results.xlsx
2020-05-09 12:52:39,004 [INFO] ================= Finished running experiment no. 2 ================= 

2020-05-09 12:52:39,157 [INFO] Created directory: results_selected_models/selected_ids18_full_ann_shallow_rep3
