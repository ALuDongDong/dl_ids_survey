2020-01-08 10:22:17,336 [INFO] Initialized logging. log_filename = results_additional_exps/semi_sup_perf_ids18_subset_dbn_rep1/run_log.log
2020-01-08 10:22:17,336 [INFO] ================= Running experiment no. 1  ================= 

2020-01-08 10:22:17,336 [INFO] Experiment parameters given below
2020-01-08 10:22:17,336 [INFO] 
{'experiment_num': 1, 'results_dir': 'results_additional_exps/semi_sup_perf_ids18_subset_dbn_rep1', 'model_type': 'classifier', 'model': 'dbn', 'normal_label': 'BENIGN', 'dbn_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'random_seed': 42, 'unsupervised_ratio': 0.75, 'dbn_learning_rate': 0.0001, 'pretrain_epochs': 50, 'fine_tune_epochs': 200, 'early_stop_patience': 50, 'batch_size': 256, 'dataset_dir': '../Datasets/small_datasets/ids2018', 'description': 'semi_sup_perf_ids18_subset_dbn_rep1'}
2020-01-08 10:22:17,336 [INFO] Created tensorboard log directory: results_additional_exps/semi_sup_perf_ids18_subset_dbn_rep1/tf_logs_run_2020_01_08-10_22_17
2020-01-08 10:22:17,336 [INFO] Loading datsets from: ../Datasets/small_datasets/ids2018
2020-01-08 10:22:17,341 [INFO] Reading X, y files
2020-01-08 10:22:17,341 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_train.h5
2020-01-08 10:22:17,350 [INFO] NumExpr defaulting to 8 threads.
2020-01-08 10:22:22,370 [INFO] Reading complete. time_to_read=5.03 seconds
2020-01-08 10:22:22,371 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_val.h5
2020-01-08 10:22:23,834 [INFO] Reading complete. time_to_read=1.46 seconds
2020-01-08 10:22:23,834 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_test.h5
2020-01-08 10:22:25,274 [INFO] Reading complete. time_to_read=1.44 seconds
2020-01-08 10:22:25,274 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_train.h5
2020-01-08 10:22:25,682 [INFO] Reading complete. time_to_read=0.41 seconds
2020-01-08 10:22:25,683 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_val.h5
2020-01-08 10:22:25,816 [INFO] Reading complete. time_to_read=0.13 seconds
2020-01-08 10:22:25,816 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_test.h5
2020-01-08 10:22:25,946 [INFO] Reading complete. time_to_read=0.13 seconds
2020-01-08 10:22:29,404 [INFO] Initializing model
2020-01-08 10:22:29,405 [INFO] Training model
2020-01-08 10:22:29,405 [INFO] Splitting train set into 2 sets (unsupervised, supervised), random_seed = None
2020-01-08 10:22:58,741 [INFO] Split sizes (instances). total = 1936462, unsupervised = 1452346, supervised = 484116, unsupervised dataset hash = 263977417d04133c563ce973abc26bd2a7c2f804
2020-01-08 10:22:58,741 [INFO] Pretraining Deep Belief Network
2020-01-08 10:39:32,331 [INFO] Pretraining Complete
2020-01-08 10:39:32,332 [INFO] Getting pretrained weights
2020-01-08 10:39:32,332 [INFO] Creating and initializing feed forward neural network
2020-01-08 10:39:32,346 [WARNING] From /home/sunanda/anaconda3/envs/ml_env_cpu/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
2020-01-08 10:39:32,418 [WARNING] From /home/sunanda/anaconda3/envs/ml_env_cpu/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2020-01-08 10:39:32,460 [INFO] _________________________________________________________________
2020-01-08 10:39:32,461 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-08 10:39:32,461 [INFO] =================================================================
2020-01-08 10:39:32,461 [INFO] dense_1 (Dense)              (None, 64)                4992      
2020-01-08 10:39:32,461 [INFO] _________________________________________________________________
2020-01-08 10:39:32,461 [INFO] batch_normalization_1 (Batch (None, 64)                256       
2020-01-08 10:39:32,461 [INFO] _________________________________________________________________
2020-01-08 10:39:32,461 [INFO] dropout_1 (Dropout)          (None, 64)                0         
2020-01-08 10:39:32,461 [INFO] _________________________________________________________________
2020-01-08 10:39:32,461 [INFO] dense_2 (Dense)              (None, 15)                975       
2020-01-08 10:39:32,461 [INFO] =================================================================
2020-01-08 10:39:32,461 [INFO] Total params: 6,223
2020-01-08 10:39:32,462 [INFO] Trainable params: 6,095
2020-01-08 10:39:32,462 [INFO] Non-trainable params: 128
2020-01-08 10:39:32,462 [INFO] _________________________________________________________________
2020-01-08 10:39:32,566 [INFO] Fine-tuning final neural network
2020-01-08 10:39:32,968 [WARNING] From /home/sunanda/anaconda3/envs/ml_env_cpu/lib/python3.7/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2020-01-08 10:45:40,442 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/semi_sup_perf_ids18_subset_dbn_rep1/ann_model_epoch_20.pickle
2020-01-08 10:51:36,039 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/semi_sup_perf_ids18_subset_dbn_rep1/ann_model_epoch_40.pickle
2020-01-08 10:57:32,363 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/semi_sup_perf_ids18_subset_dbn_rep1/ann_model_epoch_60.pickle
2020-01-08 11:03:28,999 [INFO] epoch = 80. Intermediate model saved to results_additional_exps/semi_sup_perf_ids18_subset_dbn_rep1/ann_model_epoch_80.pickle
2020-01-08 11:09:25,735 [INFO] epoch = 100. Intermediate model saved to results_additional_exps/semi_sup_perf_ids18_subset_dbn_rep1/ann_model_epoch_100.pickle
2020-01-08 11:15:22,845 [INFO] epoch = 120. Intermediate model saved to results_additional_exps/semi_sup_perf_ids18_subset_dbn_rep1/ann_model_epoch_120.pickle
2020-01-08 11:21:20,298 [INFO] epoch = 140. Intermediate model saved to results_additional_exps/semi_sup_perf_ids18_subset_dbn_rep1/ann_model_epoch_140.pickle
2020-01-08 11:27:17,910 [INFO] epoch = 160. Intermediate model saved to results_additional_exps/semi_sup_perf_ids18_subset_dbn_rep1/ann_model_epoch_160.pickle
2020-01-08 11:33:15,299 [INFO] epoch = 180. Intermediate model saved to results_additional_exps/semi_sup_perf_ids18_subset_dbn_rep1/ann_model_epoch_180.pickle
2020-01-08 11:39:05,610 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-08 11:39:24,429 [INFO] Last epoch loss evaluation: train_loss = 0.008080, val_loss = 0.008147
2020-01-08 11:39:24,433 [INFO] Training complete. time_to_train = 4615.03 sec, 76.92 min
2020-01-08 11:39:24,437 [INFO] Model saved to results_additional_exps/semi_sup_perf_ids18_subset_dbn_rep1/best_model.pickle
2020-01-08 11:39:24,441 [INFO] Training history saved to: results_additional_exps/semi_sup_perf_ids18_subset_dbn_rep1/training_error_history.csv
2020-01-08 11:39:24,642 [INFO] Plot saved to: results_additional_exps/semi_sup_perf_ids18_subset_dbn_rep1/training_error_history.png
2020-01-08 11:39:24,830 [INFO] Plot saved to: results_additional_exps/semi_sup_perf_ids18_subset_dbn_rep1/training_f1_history.png
2020-01-08 11:39:24,831 [INFO] Making predictions on training, validation, testing data
2020-01-08 11:40:09,489 [INFO] Evaluating predictions (results)
2020-01-08 11:40:32,769 [INFO] Dataset: Testing. Classification report below
2020-01-08 11:40:32,770 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       0.00      0.00      0.00        24
        Brute Force -XSS       0.00      0.00      0.00         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.84      0.64      0.73        67
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23010
   DoS attacks-GoldenEye       0.99      0.99      0.99      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.73      0.46      0.57      5596
   DoS attacks-Slowloris       0.97      0.96      0.96       440
          FTP-BruteForce       0.69      0.87      0.77      7718
           Infilteration       0.39      0.01      0.02      6404
           SQL Injection       0.00      0.00      0.00         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

                accuracy                           0.98    645488
               macro avg       0.71      0.66      0.67    645488
            weighted avg       0.98      0.98      0.98    645488

2020-01-08 11:40:32,770 [INFO] Overall accuracy (micro avg): 0.9830794685571227
2020-01-08 11:40:57,696 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9831         0.9831                       0.9831                0.0012                   0.0169  0.9831
1     Macro avg        0.9977         0.7058                       0.6621                0.0045                   0.3379  0.6681
2  Weighted avg        0.9909         0.9774                       0.9831                0.0500                   0.0169  0.9780
2020-01-08 11:41:20,819 [INFO] Dataset: Validation. Classification report below
2020-01-08 11:41:20,819 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       0.00      0.00      0.00        25
        Brute Force -XSS       0.00      0.00      0.00         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.93      0.59      0.72        68
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23009
   DoS attacks-GoldenEye       0.99      0.99      0.99      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.73      0.46      0.56      5596
   DoS attacks-Slowloris       0.95      0.96      0.96       439
          FTP-BruteForce       0.69      0.88      0.77      7718
           Infilteration       0.35      0.01      0.01      6403
           SQL Injection       0.00      0.00      0.00         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

                accuracy                           0.98    645487
               macro avg       0.71      0.66      0.67    645487
            weighted avg       0.98      0.98      0.98    645487

2020-01-08 11:41:20,819 [INFO] Overall accuracy (micro avg): 0.9830964837401838
2020-01-08 11:41:45,734 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9831         0.9831                       0.9831                0.0012                   0.0169  0.9831
1     Macro avg        0.9977         0.7087                       0.6584                0.0045                   0.3416  0.6669
2  Weighted avg        0.9909         0.9770                       0.9831                0.0499                   0.0169  0.9780
2020-01-08 11:43:01,392 [INFO] Dataset: Training. Classification report below
2020-01-08 11:43:01,392 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99   1606949
                     Bot       1.00      1.00      1.00     34396
        Brute Force -Web       0.00      0.00      0.00        73
        Brute Force -XSS       0.00      0.00      0.00        26
        DDOS attack-HOIC       1.00      1.00      1.00     82341
    DDOS attack-LOIC-UDP       0.89      0.67      0.77       203
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     69029
   DoS attacks-GoldenEye       0.99      1.00      0.99      4954
        DoS attacks-Hulk       1.00      1.00      1.00     55435
DoS attacks-SlowHTTPTest       0.73      0.46      0.56     16787
   DoS attacks-Slowloris       0.97      0.97      0.97      1318
          FTP-BruteForce       0.69      0.88      0.77     23153
           Infilteration       0.43      0.01      0.02     19210
           SQL Injection       0.00      0.00      0.00        12
          SSH-Bruteforce       1.00      1.00      1.00     22576

                accuracy                           0.98   1936462
               macro avg       0.71      0.67      0.67   1936462
            weighted avg       0.98      0.98      0.98   1936462

2020-01-08 11:43:01,392 [INFO] Overall accuracy (micro avg): 0.9831367721132663
2020-01-08 11:44:22,972 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9831         0.9831                       0.9831                0.0012                   0.0169  0.9831
1     Macro avg        0.9978         0.7120                       0.6651                0.0044                   0.3349  0.6712
2  Weighted avg        0.9909         0.9778                       0.9831                0.0498                   0.0169  0.9780
2020-01-08 11:44:23,047 [INFO] Results saved to: results_additional_exps/semi_sup_perf_ids18_subset_dbn_rep1/semi_sup_perf_ids18_subset_dbn_rep1_results.xlsx
2020-01-08 11:44:23,052 [INFO] ================= Finished running experiment no. 1 ================= 

2020-01-08 11:44:23,101 [INFO] Created directory: results_additional_exps/semi_sup_perf_ids18_subset_dbn_rep2
