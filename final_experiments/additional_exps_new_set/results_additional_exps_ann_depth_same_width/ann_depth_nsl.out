Using TensorFlow backend.
2020-01-08 13:57:13,037 [INFO] Read 10 experiments from file: experiment_specs/additional_exps/ann_depth.csv
2020-01-08 13:57:13,037 [INFO] ================= Started running experiments ================= 

2020-01-08 13:57:13,038 [INFO] Created directory: results_additional_exps/ann_depth_nsl_layers_1
2020-01-08 13:57:13,038 [INFO] Initialized logging. log_filename = results_additional_exps/ann_depth_nsl_layers_1/run_log.log
2020-01-08 13:57:13,038 [INFO] ================= Running experiment no. 1  ================= 

2020-01-08 13:57:13,038 [INFO] Experiment parameters given below
2020-01-08 13:57:13,038 [INFO] 
{'experiment_num': 1, 'results_dir': 'results_additional_exps/ann_depth_nsl_layers_1', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [64], 'ann_layer_activations': ['relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu'], 'ann_layer_dropout_rates': [0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2], 'epochs': 200, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/nsl_kdd_five_classes', 'description': 'ann_depth_nsl_layers_1'}
2020-01-08 13:57:13,038 [INFO] Created tensorboard log directory: results_additional_exps/ann_depth_nsl_layers_1/tf_logs_run_2020_01_08-13_57_13
2020-01-08 13:57:13,038 [INFO] Loading datsets from: ../Datasets/small_datasets/nsl_kdd_five_classes
2020-01-08 13:57:13,039 [INFO] Reading X, y files
2020-01-08 13:57:13,039 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_train.h5
2020-01-08 13:57:13,302 [INFO] Reading complete. time_to_read=0.26 seconds
2020-01-08 13:57:13,302 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_val.h5
2020-01-08 13:57:13,367 [INFO] Reading complete. time_to_read=0.07 seconds
2020-01-08 13:57:13,367 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_test.h5
2020-01-08 13:57:13,427 [INFO] Reading complete. time_to_read=0.06 seconds
2020-01-08 13:57:13,427 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_train.h5
2020-01-08 13:57:13,434 [INFO] Reading complete. time_to_read=0.01 seconds
2020-01-08 13:57:13,434 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_val.h5
2020-01-08 13:57:13,438 [INFO] Reading complete. time_to_read=0.00 seconds
2020-01-08 13:57:13,438 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_test.h5
2020-01-08 13:57:13,441 [INFO] Reading complete. time_to_read=0.00 seconds
2020-01-08 13:57:13,639 [INFO] Initializing model
WARNING:tensorflow:From /home/sunanda/test/ml_env/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
2020-01-08 13:57:13,651 [WARNING] From /home/sunanda/test/ml_env/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /home/sunanda/test/ml_env/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2020-01-08 13:57:13,715 [WARNING] From /home/sunanda/test/ml_env/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2020-01-08 13:57:13,753 [INFO] _________________________________________________________________
2020-01-08 13:57:13,753 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-08 13:57:13,753 [INFO] =================================================================
2020-01-08 13:57:13,753 [INFO] dense_1 (Dense)              (None, 64)                7872      
2020-01-08 13:57:13,753 [INFO] _________________________________________________________________
2020-01-08 13:57:13,753 [INFO] batch_normalization_1 (Batch (None, 64)                256       
2020-01-08 13:57:13,753 [INFO] _________________________________________________________________
2020-01-08 13:57:13,753 [INFO] dropout_1 (Dropout)          (None, 64)                0         
2020-01-08 13:57:13,753 [INFO] _________________________________________________________________
2020-01-08 13:57:13,754 [INFO] dense_2 (Dense)              (None, 5)                 325       
2020-01-08 13:57:13,754 [INFO] =================================================================
2020-01-08 13:57:13,754 [INFO] Total params: 8,453
2020-01-08 13:57:13,754 [INFO] Trainable params: 8,325
2020-01-08 13:57:13,754 [INFO] Non-trainable params: 128
2020-01-08 13:57:13,754 [INFO] _________________________________________________________________
2020-01-08 13:57:13,754 [INFO] Training model
WARNING:tensorflow:From /home/sunanda/test/ml_env/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2020-01-08 13:57:14,127 [WARNING] From /home/sunanda/test/ml_env/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2020-01-08 13:57:14.406253: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-01-08 13:57:14.428753: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3299620000 Hz
2020-01-08 13:57:14.428964: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x19af9b0 executing computations on platform Host. Devices:
2020-01-08 13:57:14.428988: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
Train on 100778 samples, validate on 25195 samples
Epoch 1/200
 - 1s - loss: 0.1019 - val_loss: 0.0294
 - val_f1: 0.9760
Epoch 2/200
 - 1s - loss: 0.0256 - val_loss: 0.0152
 - val_f1: 0.9883
Epoch 3/200
 - 1s - loss: 0.0172 - val_loss: 0.0116
 - val_f1: 0.9911
Epoch 4/200
 - 1s - loss: 0.0143 - val_loss: 0.0105
 - val_f1: 0.9917
Epoch 5/200
 - 1s - loss: 0.0129 - val_loss: 0.0101
 - val_f1: 0.9924
Epoch 6/200
 - 1s - loss: 0.0121 - val_loss: 0.0098
 - val_f1: 0.9935
Epoch 7/200
 - 1s - loss: 0.0112 - val_loss: 0.0101
 - val_f1: 0.9941
Epoch 8/200
 - 1s - loss: 0.0107 - val_loss: 0.0090
 - val_f1: 0.9944
Epoch 9/200
 - 1s - loss: 0.0097 - val_loss: 0.0087
 - val_f1: 0.9947
Epoch 10/200
 - 1s - loss: 0.0097 - val_loss: 0.0086
 - val_f1: 0.9940
Epoch 11/200
 - 1s - loss: 0.0094 - val_loss: 0.0078
 - val_f1: 0.9944
Epoch 12/200
 - 1s - loss: 0.0093 - val_loss: 0.0086
 - val_f1: 0.9948
Epoch 13/200
 - 1s - loss: 0.0087 - val_loss: 0.0086
 - val_f1: 0.9924
Epoch 14/200
 - 1s - loss: 0.0087 - val_loss: 0.0083
 - val_f1: 0.9950
Epoch 15/200
 - 1s - loss: 0.0083 - val_loss: 0.0073
 - val_f1: 0.9948
Epoch 16/200
 - 1s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9942
Epoch 17/200
 - 1s - loss: 0.0079 - val_loss: 0.0081
 - val_f1: 0.9945
Epoch 18/200
 - 1s - loss: 0.0076 - val_loss: 0.0081
 - val_f1: 0.9953
Epoch 19/200
 - 1s - loss: 0.0073 - val_loss: 0.0080
 - val_f1: 0.9945
Epoch 20/200
 - 1s - loss: 0.0072 - val_loss: 0.0076
 - val_f1: 0.9957
Epoch 21/200
 - 1s - loss: 0.0067 - val_loss: 0.0070
/home/sunanda/test/ml_env/lib/python3.6/site-packages/sklearn/metrics/classification.py:1143: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no predicted samples.
  'precision', 'predicted', average, warn_for)
2020-01-08 13:57:37,461 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_1/ann_model_epoch_20.pickle
 - val_f1: 0.9960
Epoch 22/200
 - 1s - loss: 0.0069 - val_loss: 0.0076
 - val_f1: 0.9957
Epoch 23/200
 - 1s - loss: 0.0066 - val_loss: 0.0075
 - val_f1: 0.9957
Epoch 24/200
 - 1s - loss: 0.0064 - val_loss: 0.0074
 - val_f1: 0.9959
Epoch 25/200
 - 1s - loss: 0.0064 - val_loss: 0.0072
 - val_f1: 0.9958
Epoch 26/200
 - 1s - loss: 0.0063 - val_loss: 0.0066
 - val_f1: 0.9963
Epoch 27/200
 - 1s - loss: 0.0063 - val_loss: 0.0083
 - val_f1: 0.9954
Epoch 28/200
 - 1s - loss: 0.0061 - val_loss: 0.0070
 - val_f1: 0.9962
Epoch 29/200
 - 1s - loss: 0.0057 - val_loss: 0.0070
 - val_f1: 0.9959
Epoch 30/200
 - 1s - loss: 0.0062 - val_loss: 0.0066
 - val_f1: 0.9963
Epoch 31/200
 - 1s - loss: 0.0055 - val_loss: 0.0068
 - val_f1: 0.9961
Epoch 32/200
 - 1s - loss: 0.0056 - val_loss: 0.0068
 - val_f1: 0.9959
Epoch 33/200
 - 1s - loss: 0.0055 - val_loss: 0.0068
 - val_f1: 0.9963
Epoch 34/200
 - 1s - loss: 0.0054 - val_loss: 0.0067
 - val_f1: 0.9965
Epoch 35/200
 - 1s - loss: 0.0056 - val_loss: 0.0068
 - val_f1: 0.9964
Epoch 36/200
 - 1s - loss: 0.0054 - val_loss: 0.0071
 - val_f1: 0.9959
Epoch 37/200
 - 1s - loss: 0.0053 - val_loss: 0.0064
 - val_f1: 0.9962
Epoch 38/200
 - 1s - loss: 0.0052 - val_loss: 0.0067
 - val_f1: 0.9964
Epoch 39/200
 - 1s - loss: 0.0052 - val_loss: 0.0063
 - val_f1: 0.9965
Epoch 40/200
 - 1s - loss: 0.0053 - val_loss: 0.0069
 - val_f1: 0.9959
Epoch 41/200
 - 1s - loss: 0.0049 - val_loss: 0.0074
2020-01-08 13:57:59,288 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_1/ann_model_epoch_40.pickle
 - val_f1: 0.9960
Epoch 42/200
 - 1s - loss: 0.0052 - val_loss: 0.0065
 - val_f1: 0.9963
Epoch 43/200
 - 1s - loss: 0.0050 - val_loss: 0.0064
 - val_f1: 0.9962
Epoch 44/200
 - 1s - loss: 0.0052 - val_loss: 0.0060
 - val_f1: 0.9963
Epoch 45/200
 - 1s - loss: 0.0052 - val_loss: 0.0062
 - val_f1: 0.9963
Epoch 46/200
 - 1s - loss: 0.0047 - val_loss: 0.0060
 - val_f1: 0.9965
Epoch 47/200
 - 1s - loss: 0.0050 - val_loss: 0.0065
 - val_f1: 0.9961
Epoch 48/200
 - 1s - loss: 0.0050 - val_loss: 0.0065
 - val_f1: 0.9962
Epoch 49/200
 - 1s - loss: 0.0050 - val_loss: 0.0068
 - val_f1: 0.9963
Epoch 50/200
 - 1s - loss: 0.0047 - val_loss: 0.0066
 - val_f1: 0.9968
Epoch 51/200
 - 1s - loss: 0.0049 - val_loss: 0.0065
 - val_f1: 0.9966
Epoch 52/200
 - 1s - loss: 0.0048 - val_loss: 0.0068
 - val_f1: 0.9964
Epoch 53/200
 - 1s - loss: 0.0048 - val_loss: 0.0068
 - val_f1: 0.9966
Epoch 54/200
 - 1s - loss: 0.0048 - val_loss: 0.0066
 - val_f1: 0.9959
Epoch 55/200
 - 1s - loss: 0.0048 - val_loss: 0.0064
 - val_f1: 0.9966
Epoch 56/200
 - 1s - loss: 0.0049 - val_loss: 0.0064
 - val_f1: 0.9962
Epoch 57/200
 - 1s - loss: 0.0046 - val_loss: 0.0060
 - val_f1: 0.9966
Epoch 58/200
 - 1s - loss: 0.0048 - val_loss: 0.0061
 - val_f1: 0.9966
Epoch 59/200
 - 1s - loss: 0.0049 - val_loss: 0.0064
 - val_f1: 0.9967
Epoch 60/200
 - 1s - loss: 0.0047 - val_loss: 0.0061
 - val_f1: 0.9967
Epoch 61/200
 - 1s - loss: 0.0047 - val_loss: 0.0068
2020-01-08 13:58:21,094 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_1/ann_model_epoch_60.pickle
 - val_f1: 0.9964
Epoch 62/200
 - 1s - loss: 0.0047 - val_loss: 0.0060
 - val_f1: 0.9968
Epoch 63/200
 - 1s - loss: 0.0046 - val_loss: 0.0062
 - val_f1: 0.9963
Epoch 64/200
 - 1s - loss: 0.0046 - val_loss: 0.0058
 - val_f1: 0.9968
Epoch 65/200
 - 1s - loss: 0.0046 - val_loss: 0.0062
 - val_f1: 0.9965
Epoch 66/200
 - 1s - loss: 0.0049 - val_loss: 0.0060
 - val_f1: 0.9964
Epoch 67/200
 - 1s - loss: 0.0048 - val_loss: 0.0061
 - val_f1: 0.9963
Epoch 68/200
 - 1s - loss: 0.0047 - val_loss: 0.0067
 - val_f1: 0.9963
Epoch 69/200
 - 1s - loss: 0.0047 - val_loss: 0.0062
 - val_f1: 0.9965
Epoch 70/200
 - 1s - loss: 0.0044 - val_loss: 0.0059
 - val_f1: 0.9969
Epoch 71/200
 - 1s - loss: 0.0045 - val_loss: 0.0058
 - val_f1: 0.9966
Epoch 72/200
 - 1s - loss: 0.0045 - val_loss: 0.0061
 - val_f1: 0.9964
Epoch 73/200
 - 1s - loss: 0.0045 - val_loss: 0.0060
 - val_f1: 0.9967
Epoch 74/200
 - 1s - loss: 0.0045 - val_loss: 0.0070
 - val_f1: 0.9962
Epoch 75/200
 - 1s - loss: 0.0051 - val_loss: 0.0066
 - val_f1: 0.9963
Epoch 76/200
 - 1s - loss: 0.0047 - val_loss: 0.0065
 - val_f1: 0.9962
Epoch 77/200
 - 1s - loss: 0.0044 - val_loss: 0.0065
 - val_f1: 0.9962
Epoch 78/200
 - 1s - loss: 0.0046 - val_loss: 0.0062
 - val_f1: 0.9967
Epoch 79/200
 - 1s - loss: 0.0045 - val_loss: 0.0062
 - val_f1: 0.9965
Epoch 80/200
 - 1s - loss: 0.0044 - val_loss: 0.0066
 - val_f1: 0.9962
Epoch 81/200
 - 1s - loss: 0.0047 - val_loss: 0.0062
2020-01-08 13:58:42,866 [INFO] epoch = 80. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_1/ann_model_epoch_80.pickle
 - val_f1: 0.9963
Epoch 82/200
 - 1s - loss: 0.0042 - val_loss: 0.0065
 - val_f1: 0.9965
Epoch 83/200
 - 1s - loss: 0.0043 - val_loss: 0.0062
 - val_f1: 0.9964
Epoch 84/200
 - 1s - loss: 0.0042 - val_loss: 0.0061
 - val_f1: 0.9965
Epoch 85/200
 - 1s - loss: 0.0046 - val_loss: 0.0067
 - val_f1: 0.9961
Epoch 86/200
 - 1s - loss: 0.0045 - val_loss: 0.0062
 - val_f1: 0.9964
Epoch 87/200
 - 1s - loss: 0.0041 - val_loss: 0.0060
 - val_f1: 0.9966
Epoch 88/200
 - 1s - loss: 0.0042 - val_loss: 0.0062
 - val_f1: 0.9961
Epoch 89/200
 - 1s - loss: 0.0042 - val_loss: 0.0059
 - val_f1: 0.9968
Epoch 90/200
 - 1s - loss: 0.0042 - val_loss: 0.0058
 - val_f1: 0.9968
Epoch 91/200
 - 1s - loss: 0.0040 - val_loss: 0.0065
 - val_f1: 0.9963
Epoch 92/200
 - 1s - loss: 0.0042 - val_loss: 0.0061
 - val_f1: 0.9966
Epoch 93/200
 - 1s - loss: 0.0039 - val_loss: 0.0061
 - val_f1: 0.9965
Epoch 94/200
 - 1s - loss: 0.0041 - val_loss: 0.0058
 - val_f1: 0.9966
Epoch 95/200
 - 1s - loss: 0.0040 - val_loss: 0.0060
 - val_f1: 0.9967
Epoch 96/200
 - 1s - loss: 0.0041 - val_loss: 0.0061
 - val_f1: 0.9966
Epoch 97/200
 - 1s - loss: 0.0040 - val_loss: 0.0065
 - val_f1: 0.9965
Epoch 98/200
 - 1s - loss: 0.0042 - val_loss: 0.0059
 - val_f1: 0.9966
Epoch 99/200
 - 1s - loss: 0.0041 - val_loss: 0.0059
 - val_f1: 0.9968
Epoch 100/200
 - 1s - loss: 0.0042 - val_loss: 0.0060
 - val_f1: 0.9966
Epoch 101/200
 - 1s - loss: 0.0040 - val_loss: 0.0058
2020-01-08 13:59:04,549 [INFO] epoch = 100. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_1/ann_model_epoch_100.pickle
 - val_f1: 0.9966
Epoch 102/200
 - 1s - loss: 0.0042 - val_loss: 0.0063
 - val_f1: 0.9963
Epoch 103/200
 - 1s - loss: 0.0040 - val_loss: 0.0062
 - val_f1: 0.9967
Epoch 104/200
 - 1s - loss: 0.0036 - val_loss: 0.0057
 - val_f1: 0.9968
Epoch 105/200
 - 1s - loss: 0.0038 - val_loss: 0.0062
 - val_f1: 0.9963
Epoch 106/200
 - 1s - loss: 0.0041 - val_loss: 0.0066
 - val_f1: 0.9958
Epoch 107/200
 - 1s - loss: 0.0044 - val_loss: 0.0051
 - val_f1: 0.9965
Epoch 108/200
 - 1s - loss: 0.0041 - val_loss: 0.0065
 - val_f1: 0.9965
Epoch 109/200
 - 1s - loss: 0.0041 - val_loss: 0.0055
 - val_f1: 0.9965
Epoch 110/200
 - 1s - loss: 0.0038 - val_loss: 0.0058
 - val_f1: 0.9965
Epoch 111/200
 - 1s - loss: 0.0041 - val_loss: 0.0066
 - val_f1: 0.9961
Epoch 112/200
 - 1s - loss: 0.0039 - val_loss: 0.0061
 - val_f1: 0.9963
Epoch 113/200
 - 1s - loss: 0.0040 - val_loss: 0.0061
 - val_f1: 0.9967
Epoch 114/200
 - 1s - loss: 0.0041 - val_loss: 0.0059
 - val_f1: 0.9969
Epoch 115/200
 - 1s - loss: 0.0041 - val_loss: 0.0057
 - val_f1: 0.9969
Epoch 116/200
 - 1s - loss: 0.0040 - val_loss: 0.0059
 - val_f1: 0.9967
Epoch 117/200
 - 1s - loss: 0.0041 - val_loss: 0.0056
 - val_f1: 0.9968
Epoch 118/200
 - 1s - loss: 0.0042 - val_loss: 0.0062
 - val_f1: 0.9967
Epoch 119/200
 - 1s - loss: 0.0043 - val_loss: 0.0061
 - val_f1: 0.9965
Epoch 120/200
 - 1s - loss: 0.0040 - val_loss: 0.0059
 - val_f1: 0.9964
Epoch 121/200
 - 1s - loss: 0.0037 - val_loss: 0.0060
2020-01-08 13:59:26,364 [INFO] epoch = 120. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_1/ann_model_epoch_120.pickle
 - val_f1: 0.9968
Epoch 122/200
 - 1s - loss: 0.0038 - val_loss: 0.0059
 - val_f1: 0.9966
Epoch 123/200
 - 1s - loss: 0.0037 - val_loss: 0.0064
 - val_f1: 0.9968
Epoch 124/200
 - 1s - loss: 0.0040 - val_loss: 0.0061
 - val_f1: 0.9965
Epoch 125/200
 - 1s - loss: 0.0037 - val_loss: 0.0058
 - val_f1: 0.9969
Epoch 126/200
 - 1s - loss: 0.0038 - val_loss: 0.0069
 - val_f1: 0.9965
Epoch 127/200
 - 1s - loss: 0.0041 - val_loss: 0.0061
 - val_f1: 0.9969
Epoch 128/200
 - 1s - loss: 0.0038 - val_loss: 0.0066
 - val_f1: 0.9964
Epoch 129/200
 - 1s - loss: 0.0040 - val_loss: 0.0064
 - val_f1: 0.9959
Epoch 130/200
 - 1s - loss: 0.0039 - val_loss: 0.0060
 - val_f1: 0.9965
Epoch 131/200
 - 1s - loss: 0.0039 - val_loss: 0.0056
 - val_f1: 0.9968
Epoch 132/200
 - 1s - loss: 0.0039 - val_loss: 0.0056
 - val_f1: 0.9971
Epoch 133/200
 - 1s - loss: 0.0040 - val_loss: 0.0057
 - val_f1: 0.9967
Epoch 134/200
 - 1s - loss: 0.0038 - val_loss: 0.0057
 - val_f1: 0.9967
Epoch 135/200
 - 1s - loss: 0.0038 - val_loss: 0.0058
 - val_f1: 0.9965
Epoch 136/200
 - 1s - loss: 0.0036 - val_loss: 0.0062
 - val_f1: 0.9968
Epoch 137/200
 - 1s - loss: 0.0038 - val_loss: 0.0061
 - val_f1: 0.9967
Epoch 138/200
 - 1s - loss: 0.0036 - val_loss: 0.0063
 - val_f1: 0.9966
Epoch 139/200
 - 1s - loss: 0.0038 - val_loss: 0.0063
 - val_f1: 0.9966
Epoch 140/200
 - 1s - loss: 0.0039 - val_loss: 0.0066
 - val_f1: 0.9965
Epoch 141/200
 - 1s - loss: 0.0039 - val_loss: 0.0060
2020-01-08 13:59:48,057 [INFO] epoch = 140. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_1/ann_model_epoch_140.pickle
 - val_f1: 0.9967
Epoch 142/200
 - 1s - loss: 0.0036 - val_loss: 0.0056
 - val_f1: 0.9970
Epoch 143/200
 - 1s - loss: 0.0038 - val_loss: 0.0063
 - val_f1: 0.9966
Epoch 144/200
 - 1s - loss: 0.0036 - val_loss: 0.0063
 - val_f1: 0.9963
Epoch 145/200
 - 1s - loss: 0.0036 - val_loss: 0.0061
 - val_f1: 0.9969
Epoch 146/200
 - 1s - loss: 0.0036 - val_loss: 0.0064
 - val_f1: 0.9969
Epoch 147/200
 - 1s - loss: 0.0038 - val_loss: 0.0063
 - val_f1: 0.9966
Epoch 148/200
 - 1s - loss: 0.0035 - val_loss: 0.0066
 - val_f1: 0.9963
Epoch 149/200
 - 1s - loss: 0.0039 - val_loss: 0.0068
 - val_f1: 0.9961
Epoch 150/200
 - 1s - loss: 0.0037 - val_loss: 0.0063
 - val_f1: 0.9966
Epoch 151/200
 - 1s - loss: 0.0037 - val_loss: 0.0063
 - val_f1: 0.9968
Epoch 152/200
 - 1s - loss: 0.0036 - val_loss: 0.0064
 - val_f1: 0.9965
Epoch 153/200
 - 1s - loss: 0.0037 - val_loss: 0.0066
 - val_f1: 0.9962
Epoch 154/200
 - 1s - loss: 0.0036 - val_loss: 0.0065
 - val_f1: 0.9966
Epoch 155/200
 - 1s - loss: 0.0034 - val_loss: 0.0062
 - val_f1: 0.9967
Epoch 156/200
 - 1s - loss: 0.0037 - val_loss: 0.0062
 - val_f1: 0.9966
Epoch 157/200
 - 1s - loss: 0.0034 - val_loss: 0.0067
2020-01-08 14:00:05,650 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-08 14:00:07,027 [INFO] Last epoch loss evaluation: train_loss = 0.003135, val_loss = 0.005128
2020-01-08 14:00:07,027 [INFO] Training complete. time_to_train = 173.27 sec, 2.89 min
2020-01-08 14:00:07,030 [INFO] Model saved to results_additional_exps/ann_depth_nsl_layers_1/best_model.pickle
2020-01-08 14:00:07,034 [INFO] Training history saved to: results_additional_exps/ann_depth_nsl_layers_1/training_error_history.csv
2020-01-08 14:00:07,225 [INFO] Plot saved to: results_additional_exps/ann_depth_nsl_layers_1/training_error_history.png
2020-01-08 14:00:07,393 [INFO] Plot saved to: results_additional_exps/ann_depth_nsl_layers_1/training_f1_history.png
2020-01-08 14:00:07,393 [INFO] Making predictions on training, validation, testing data
2020-01-08 14:00:08,601 [INFO] Evaluating predictions (results)
2020-01-08 14:00:08,953 [INFO] Dataset: Testing. Classification report below
2020-01-08 14:00:08,953 [INFO] 
              precision    recall  f1-score   support

         dos       0.97      0.84      0.90      7458
      normal       0.68      0.97      0.80      9711
       probe       0.84      0.67      0.74      2421
         r2l       0.95      0.10      0.18      2421
         u2r       0.70      0.04      0.07       533

   micro avg       0.78      0.78      0.78     22544
   macro avg       0.83      0.52      0.54     22544
weighted avg       0.82      0.78      0.74     22544

2020-01-08 14:00:08,953 [INFO] Overall accuracy (micro avg): 0.7778122782114976
2020-01-08 14:00:09,250 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.7778         0.7778                       0.7778                0.0555                   0.2222  0.7778
1     Macro avg        0.9111         0.8274                       0.5226                0.0757                   0.4774  0.5387
2  Weighted avg        0.8716         0.8209                       0.7778                0.1564                   0.2222  0.7417
2020-01-08 14:00:09,583 [INFO] Dataset: Validation. Classification report below
2020-01-08 14:00:09,583 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00      9186
      normal       1.00      1.00      1.00     13469
       probe       0.99      0.99      0.99      2331
         r2l       0.94      0.88      0.91       199
         u2r       0.86      0.60      0.71        10

   micro avg       1.00      1.00      1.00     25195
   macro avg       0.96      0.89      0.92     25195
weighted avg       1.00      1.00      1.00     25195

2020-01-08 14:00:09,583 [INFO] Overall accuracy (micro avg): 0.9965866243302243
2020-01-08 14:00:09,939 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9966         0.9966                       0.9966                0.0009                   0.0034  0.9966
1     Macro avg        0.9986         0.9570                       0.8941                0.0011                   0.1059  0.9208
2  Weighted avg        0.9979         0.9965                       0.9966                0.0023                   0.0034  0.9965
2020-01-08 14:00:11,380 [INFO] Dataset: Training. Classification report below
2020-01-08 14:00:11,380 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00     36741
      normal       1.00      1.00      1.00     53874
       probe       1.00      1.00      1.00      9325
         r2l       0.94      0.89      0.91       796
         u2r       0.97      0.74      0.84        42

   micro avg       1.00      1.00      1.00    100778
   macro avg       0.98      0.92      0.95    100778
weighted avg       1.00      1.00      1.00    100778

2020-01-08 14:00:11,380 [INFO] Overall accuracy (micro avg): 0.9974200718410764
2020-01-08 14:00:13,001 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9974         0.9974                       0.9974                0.0006                   0.0026  0.9974
1     Macro avg        0.9990         0.9795                       0.9240                0.0009                   0.0760  0.9485
2  Weighted avg        0.9984         0.9974                       0.9974                0.0019                   0.0026  0.9974
2020-01-08 14:00:13,041 [INFO] Results saved to: results_additional_exps/ann_depth_nsl_layers_1/ann_depth_nsl_layers_1_results.xlsx
2020-01-08 14:00:13,041 [INFO] ================= Finished running experiment no. 1 ================= 

2020-01-08 14:00:13,046 [INFO] Created directory: results_additional_exps/ann_depth_nsl_layers_2
2020-01-08 14:00:13,046 [INFO] Initialized logging. log_filename = results_additional_exps/ann_depth_nsl_layers_2/run_log.log
2020-01-08 14:00:13,046 [INFO] ================= Running experiment no. 2  ================= 

2020-01-08 14:00:13,046 [INFO] Experiment parameters given below
2020-01-08 14:00:13,046 [INFO] 
{'experiment_num': 2, 'results_dir': 'results_additional_exps/ann_depth_nsl_layers_2', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [64, 64], 'ann_layer_activations': ['relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu'], 'ann_layer_dropout_rates': [0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2], 'epochs': 200, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/nsl_kdd_five_classes', 'description': 'ann_depth_nsl_layers_2'}
2020-01-08 14:00:13,046 [INFO] Created tensorboard log directory: results_additional_exps/ann_depth_nsl_layers_2/tf_logs_run_2020_01_08-14_00_13
2020-01-08 14:00:13,046 [INFO] Loading datsets from: ../Datasets/small_datasets/nsl_kdd_five_classes
2020-01-08 14:00:13,046 [INFO] Reading X, y files
2020-01-08 14:00:13,046 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_train.h5
2020-01-08 14:00:13,290 [INFO] Reading complete. time_to_read=0.24 seconds
2020-01-08 14:00:13,290 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_val.h5
2020-01-08 14:00:13,355 [INFO] Reading complete. time_to_read=0.06 seconds
2020-01-08 14:00:13,355 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_test.h5
2020-01-08 14:00:13,413 [INFO] Reading complete. time_to_read=0.06 seconds
2020-01-08 14:00:13,414 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_train.h5
2020-01-08 14:00:13,421 [INFO] Reading complete. time_to_read=0.01 seconds
2020-01-08 14:00:13,421 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_val.h5
2020-01-08 14:00:13,424 [INFO] Reading complete. time_to_read=0.00 seconds
2020-01-08 14:00:13,425 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_test.h5
2020-01-08 14:00:13,428 [INFO] Reading complete. time_to_read=0.00 seconds
2020-01-08 14:00:13,618 [INFO] Initializing model
2020-01-08 14:00:13,860 [INFO] _________________________________________________________________
2020-01-08 14:00:13,860 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-08 14:00:13,860 [INFO] =================================================================
2020-01-08 14:00:13,861 [INFO] dense_3 (Dense)              (None, 64)                7872      
2020-01-08 14:00:13,861 [INFO] _________________________________________________________________
2020-01-08 14:00:13,861 [INFO] batch_normalization_2 (Batch (None, 64)                256       
2020-01-08 14:00:13,861 [INFO] _________________________________________________________________
2020-01-08 14:00:13,861 [INFO] dropout_2 (Dropout)          (None, 64)                0         
2020-01-08 14:00:13,861 [INFO] _________________________________________________________________
2020-01-08 14:00:13,861 [INFO] dense_4 (Dense)              (None, 64)                4160      
2020-01-08 14:00:13,861 [INFO] _________________________________________________________________
2020-01-08 14:00:13,861 [INFO] batch_normalization_3 (Batch (None, 64)                256       
2020-01-08 14:00:13,861 [INFO] _________________________________________________________________
2020-01-08 14:00:13,861 [INFO] dropout_3 (Dropout)          (None, 64)                0         
2020-01-08 14:00:13,861 [INFO] _________________________________________________________________
2020-01-08 14:00:13,861 [INFO] dense_5 (Dense)              (None, 5)                 325       
2020-01-08 14:00:13,861 [INFO] =================================================================
2020-01-08 14:00:13,861 [INFO] Total params: 12,869
2020-01-08 14:00:13,861 [INFO] Trainable params: 12,613
2020-01-08 14:00:13,861 [INFO] Non-trainable params: 256
2020-01-08 14:00:13,862 [INFO] _________________________________________________________________
2020-01-08 14:00:13,862 [INFO] Training model
 - val_f1: 0.9968
Epoch 00157: early stopping
Train on 100778 samples, validate on 25195 samples
Epoch 1/200
 - 1s - loss: 0.0882 - val_loss: 0.0196
 - val_f1: 0.9809
Epoch 2/200
 - 1s - loss: 0.0230 - val_loss: 0.0137
 - val_f1: 0.9895
Epoch 3/200
 - 1s - loss: 0.0171 - val_loss: 0.0115
 - val_f1: 0.9892
Epoch 4/200
 - 1s - loss: 0.0144 - val_loss: 0.0098
 - val_f1: 0.9921
Epoch 5/200
 - 1s - loss: 0.0128 - val_loss: 0.0094
 - val_f1: 0.9928
Epoch 6/200
 - 1s - loss: 0.0118 - val_loss: 0.0082
 - val_f1: 0.9939
Epoch 7/200
 - 1s - loss: 0.0110 - val_loss: 0.0082
 - val_f1: 0.9937
Epoch 8/200
 - 1s - loss: 0.0107 - val_loss: 0.0085
 - val_f1: 0.9918
Epoch 9/200
 - 1s - loss: 0.0103 - val_loss: 0.0085
 - val_f1: 0.9926
Epoch 10/200
 - 1s - loss: 0.0096 - val_loss: 0.0082
 - val_f1: 0.9940
Epoch 11/200
 - 1s - loss: 0.0093 - val_loss: 0.0073
 - val_f1: 0.9940
Epoch 12/200
 - 1s - loss: 0.0089 - val_loss: 0.0073
 - val_f1: 0.9944
Epoch 13/200
 - 1s - loss: 0.0088 - val_loss: 0.0072
 - val_f1: 0.9946
Epoch 14/200
 - 1s - loss: 0.0081 - val_loss: 0.0072
 - val_f1: 0.9950
Epoch 15/200
 - 1s - loss: 0.0080 - val_loss: 0.0066
 - val_f1: 0.9954
Epoch 16/200
 - 1s - loss: 0.0079 - val_loss: 0.0068
 - val_f1: 0.9949
Epoch 17/200
 - 1s - loss: 0.0076 - val_loss: 0.0070
 - val_f1: 0.9949
Epoch 18/200
 - 1s - loss: 0.0073 - val_loss: 0.0066
 - val_f1: 0.9947
Epoch 19/200
 - 1s - loss: 0.0072 - val_loss: 0.0064
 - val_f1: 0.9953
Epoch 20/200
 - 1s - loss: 0.0072 - val_loss: 0.0062
 - val_f1: 0.9956
Epoch 21/200
 - 1s - loss: 0.0068 - val_loss: 0.0059
2020-01-08 14:00:44,415 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_2/ann_model_epoch_20.pickle
 - val_f1: 0.9954
Epoch 22/200
 - 1s - loss: 0.0067 - val_loss: 0.0055
 - val_f1: 0.9962
Epoch 23/200
 - 1s - loss: 0.0065 - val_loss: 0.0057
 - val_f1: 0.9958
Epoch 24/200
 - 1s - loss: 0.0063 - val_loss: 0.0059
 - val_f1: 0.9957
Epoch 25/200
 - 1s - loss: 0.0059 - val_loss: 0.0055
 - val_f1: 0.9958
Epoch 26/200
 - 1s - loss: 0.0060 - val_loss: 0.0052
 - val_f1: 0.9960
Epoch 27/200
 - 1s - loss: 0.0060 - val_loss: 0.0054
 - val_f1: 0.9960
Epoch 28/200
 - 1s - loss: 0.0059 - val_loss: 0.0055
 - val_f1: 0.9960
Epoch 29/200
 - 1s - loss: 0.0056 - val_loss: 0.0058
 - val_f1: 0.9957
Epoch 30/200
 - 1s - loss: 0.0056 - val_loss: 0.0051
 - val_f1: 0.9962
Epoch 31/200
 - 1s - loss: 0.0060 - val_loss: 0.0051
 - val_f1: 0.9960
Epoch 32/200
 - 1s - loss: 0.0056 - val_loss: 0.0053
 - val_f1: 0.9958
Epoch 33/200
 - 1s - loss: 0.0056 - val_loss: 0.0049
 - val_f1: 0.9959
Epoch 34/200
 - 1s - loss: 0.0054 - val_loss: 0.0048
 - val_f1: 0.9964
Epoch 35/200
 - 1s - loss: 0.0053 - val_loss: 0.0052
 - val_f1: 0.9958
Epoch 36/200
 - 1s - loss: 0.0051 - val_loss: 0.0047
 - val_f1: 0.9962
Epoch 37/200
 - 1s - loss: 0.0052 - val_loss: 0.0054
 - val_f1: 0.9959
Epoch 38/200
 - 1s - loss: 0.0051 - val_loss: 0.0048
 - val_f1: 0.9961
Epoch 39/200
 - 1s - loss: 0.0051 - val_loss: 0.0048
 - val_f1: 0.9964
Epoch 40/200
 - 1s - loss: 0.0050 - val_loss: 0.0048
 - val_f1: 0.9959
Epoch 41/200
 - 1s - loss: 0.0050 - val_loss: 0.0049
2020-01-08 14:01:12,091 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_2/ann_model_epoch_40.pickle
 - val_f1: 0.9961
Epoch 42/200
 - 1s - loss: 0.0049 - val_loss: 0.0049
 - val_f1: 0.9964
Epoch 43/200
 - 1s - loss: 0.0046 - val_loss: 0.0050
 - val_f1: 0.9961
Epoch 44/200
 - 1s - loss: 0.0047 - val_loss: 0.0050
 - val_f1: 0.9960
Epoch 45/200
 - 1s - loss: 0.0048 - val_loss: 0.0048
 - val_f1: 0.9963
Epoch 46/200
 - 1s - loss: 0.0046 - val_loss: 0.0048
 - val_f1: 0.9963
Epoch 47/200
 - 1s - loss: 0.0044 - val_loss: 0.0046
 - val_f1: 0.9965
Epoch 48/200
 - 1s - loss: 0.0047 - val_loss: 0.0046
 - val_f1: 0.9961
Epoch 49/200
 - 1s - loss: 0.0045 - val_loss: 0.0046
 - val_f1: 0.9966
Epoch 50/200
 - 1s - loss: 0.0049 - val_loss: 0.0048
 - val_f1: 0.9964
Epoch 51/200
 - 1s - loss: 0.0047 - val_loss: 0.0049
 - val_f1: 0.9966
Epoch 52/200
 - 1s - loss: 0.0046 - val_loss: 0.0047
 - val_f1: 0.9966
Epoch 53/200
 - 1s - loss: 0.0046 - val_loss: 0.0046
 - val_f1: 0.9963
Epoch 54/200
 - 1s - loss: 0.0045 - val_loss: 0.0047
 - val_f1: 0.9964
Epoch 55/200
 - 1s - loss: 0.0042 - val_loss: 0.0044
 - val_f1: 0.9966
Epoch 56/200
 - 1s - loss: 0.0043 - val_loss: 0.0047
 - val_f1: 0.9964
Epoch 57/200
 - 1s - loss: 0.0044 - val_loss: 0.0051
 - val_f1: 0.9966
Epoch 58/200
 - 1s - loss: 0.0048 - val_loss: 0.0049
 - val_f1: 0.9966
Epoch 59/200
 - 1s - loss: 0.0043 - val_loss: 0.0046
 - val_f1: 0.9969
Epoch 60/200
 - 1s - loss: 0.0044 - val_loss: 0.0046
 - val_f1: 0.9964
Epoch 61/200
 - 1s - loss: 0.0042 - val_loss: 0.0046
2020-01-08 14:01:39,757 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_2/ann_model_epoch_60.pickle
 - val_f1: 0.9965
Epoch 62/200
 - 1s - loss: 0.0043 - val_loss: 0.0044
 - val_f1: 0.9965
Epoch 63/200
 - 1s - loss: 0.0045 - val_loss: 0.0048
 - val_f1: 0.9958
Epoch 64/200
 - 1s - loss: 0.0043 - val_loss: 0.0045
 - val_f1: 0.9966
Epoch 65/200
 - 1s - loss: 0.0042 - val_loss: 0.0044
 - val_f1: 0.9965
Epoch 66/200
 - 1s - loss: 0.0041 - val_loss: 0.0045
 - val_f1: 0.9967
Epoch 67/200
 - 1s - loss: 0.0042 - val_loss: 0.0044
 - val_f1: 0.9967
Epoch 68/200
 - 1s - loss: 0.0040 - val_loss: 0.0046
 - val_f1: 0.9969
Epoch 69/200
 - 1s - loss: 0.0043 - val_loss: 0.0045
 - val_f1: 0.9967
Epoch 70/200
 - 1s - loss: 0.0043 - val_loss: 0.0048
 - val_f1: 0.9963
Epoch 71/200
 - 1s - loss: 0.0041 - val_loss: 0.0050
 - val_f1: 0.9960
Epoch 72/200
 - 1s - loss: 0.0041 - val_loss: 0.0046
 - val_f1: 0.9965
Epoch 73/200
 - 1s - loss: 0.0042 - val_loss: 0.0051
 - val_f1: 0.9966
Epoch 74/200
 - 1s - loss: 0.0041 - val_loss: 0.0047
 - val_f1: 0.9965
Epoch 75/200
 - 1s - loss: 0.0039 - val_loss: 0.0046
 - val_f1: 0.9964
Epoch 76/200
 - 1s - loss: 0.0040 - val_loss: 0.0044
 - val_f1: 0.9966
Epoch 77/200
 - 1s - loss: 0.0040 - val_loss: 0.0049
 - val_f1: 0.9964
Epoch 78/200
 - 1s - loss: 0.0039 - val_loss: 0.0044
 - val_f1: 0.9967
Epoch 79/200
 - 1s - loss: 0.0040 - val_loss: 0.0043
 - val_f1: 0.9968
Epoch 80/200
 - 1s - loss: 0.0039 - val_loss: 0.0044
 - val_f1: 0.9969
Epoch 81/200
 - 1s - loss: 0.0038 - val_loss: 0.0044
2020-01-08 14:02:07,639 [INFO] epoch = 80. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_2/ann_model_epoch_80.pickle
 - val_f1: 0.9970
Epoch 82/200
 - 1s - loss: 0.0038 - val_loss: 0.0043
 - val_f1: 0.9969
Epoch 83/200
 - 1s - loss: 0.0036 - val_loss: 0.0042
 - val_f1: 0.9967
Epoch 84/200
 - 1s - loss: 0.0040 - val_loss: 0.0043
 - val_f1: 0.9967
Epoch 85/200
 - 1s - loss: 0.0039 - val_loss: 0.0044
 - val_f1: 0.9967
Epoch 86/200
 - 1s - loss: 0.0040 - val_loss: 0.0049
 - val_f1: 0.9964
Epoch 87/200
 - 1s - loss: 0.0037 - val_loss: 0.0048
 - val_f1: 0.9965
Epoch 88/200
 - 1s - loss: 0.0038 - val_loss: 0.0045
 - val_f1: 0.9970
Epoch 89/200
 - 1s - loss: 0.0040 - val_loss: 0.0043
 - val_f1: 0.9968
Epoch 90/200
 - 1s - loss: 0.0038 - val_loss: 0.0043
 - val_f1: 0.9968
Epoch 91/200
 - 1s - loss: 0.0040 - val_loss: 0.0045
 - val_f1: 0.9969
Epoch 92/200
 - 1s - loss: 0.0037 - val_loss: 0.0043
 - val_f1: 0.9967
Epoch 93/200
 - 1s - loss: 0.0037 - val_loss: 0.0047
 - val_f1: 0.9964
Epoch 94/200
 - 1s - loss: 0.0038 - val_loss: 0.0046
 - val_f1: 0.9970
Epoch 95/200
 - 1s - loss: 0.0036 - val_loss: 0.0044
 - val_f1: 0.9970
Epoch 96/200
 - 1s - loss: 0.0036 - val_loss: 0.0047
 - val_f1: 0.9968
Epoch 97/200
 - 1s - loss: 0.0037 - val_loss: 0.0040
 - val_f1: 0.9971
Epoch 98/200
 - 1s - loss: 0.0036 - val_loss: 0.0044
 - val_f1: 0.9968
Epoch 99/200
 - 1s - loss: 0.0036 - val_loss: 0.0042
 - val_f1: 0.9971
Epoch 100/200
 - 1s - loss: 0.0037 - val_loss: 0.0042
 - val_f1: 0.9972
Epoch 101/200
 - 1s - loss: 0.0035 - val_loss: 0.0045
2020-01-08 14:02:35,406 [INFO] epoch = 100. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_2/ann_model_epoch_100.pickle
 - val_f1: 0.9971
Epoch 102/200
 - 1s - loss: 0.0035 - val_loss: 0.0047
 - val_f1: 0.9965
Epoch 103/200
 - 1s - loss: 0.0037 - val_loss: 0.0043
 - val_f1: 0.9970
Epoch 104/200
 - 1s - loss: 0.0034 - val_loss: 0.0043
 - val_f1: 0.9969
Epoch 105/200
 - 1s - loss: 0.0034 - val_loss: 0.0042
 - val_f1: 0.9972
Epoch 106/200
 - 1s - loss: 0.0037 - val_loss: 0.0040
 - val_f1: 0.9973
Epoch 107/200
 - 1s - loss: 0.0033 - val_loss: 0.0043
 - val_f1: 0.9968
Epoch 108/200
 - 1s - loss: 0.0034 - val_loss: 0.0047
 - val_f1: 0.9968
Epoch 109/200
 - 1s - loss: 0.0036 - val_loss: 0.0045
 - val_f1: 0.9970
Epoch 110/200
 - 1s - loss: 0.0035 - val_loss: 0.0044
 - val_f1: 0.9969
Epoch 111/200
 - 1s - loss: 0.0036 - val_loss: 0.0045
 - val_f1: 0.9970
Epoch 112/200
 - 1s - loss: 0.0035 - val_loss: 0.0045
 - val_f1: 0.9968
Epoch 113/200
 - 1s - loss: 0.0036 - val_loss: 0.0041
 - val_f1: 0.9973
Epoch 114/200
 - 1s - loss: 0.0037 - val_loss: 0.0041
 - val_f1: 0.9970
Epoch 115/200
 - 1s - loss: 0.0036 - val_loss: 0.0043
 - val_f1: 0.9970
Epoch 116/200
 - 1s - loss: 0.0032 - val_loss: 0.0042
 - val_f1: 0.9973
Epoch 117/200
 - 1s - loss: 0.0035 - val_loss: 0.0042
 - val_f1: 0.9972
Epoch 118/200
 - 1s - loss: 0.0034 - val_loss: 0.0043
 - val_f1: 0.9969
Epoch 119/200
 - 1s - loss: 0.0033 - val_loss: 0.0043
 - val_f1: 0.9972
Epoch 120/200
 - 1s - loss: 0.0034 - val_loss: 0.0041
 - val_f1: 0.9971
Epoch 121/200
 - 1s - loss: 0.0034 - val_loss: 0.0041
2020-01-08 14:03:03,156 [INFO] epoch = 120. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_2/ann_model_epoch_120.pickle
 - val_f1: 0.9971
Epoch 122/200
 - 1s - loss: 0.0033 - val_loss: 0.0042
 - val_f1: 0.9971
Epoch 123/200
 - 1s - loss: 0.0034 - val_loss: 0.0045
 - val_f1: 0.9969
Epoch 124/200
 - 1s - loss: 0.0035 - val_loss: 0.0041
 - val_f1: 0.9971
Epoch 125/200
 - 1s - loss: 0.0035 - val_loss: 0.0044
 - val_f1: 0.9971
Epoch 126/200
 - 1s - loss: 0.0032 - val_loss: 0.0042
 - val_f1: 0.9968
Epoch 127/200
 - 1s - loss: 0.0033 - val_loss: 0.0041
 - val_f1: 0.9972
Epoch 128/200
 - 1s - loss: 0.0034 - val_loss: 0.0043
 - val_f1: 0.9969
Epoch 129/200
 - 1s - loss: 0.0032 - val_loss: 0.0043
 - val_f1: 0.9970
Epoch 130/200
 - 1s - loss: 0.0032 - val_loss: 0.0045
 - val_f1: 0.9967
Epoch 131/200
 - 1s - loss: 0.0032 - val_loss: 0.0043
 - val_f1: 0.9968
Epoch 132/200
 - 1s - loss: 0.0034 - val_loss: 0.0040
 - val_f1: 0.9973
Epoch 133/200
 - 1s - loss: 0.0033 - val_loss: 0.0042
 - val_f1: 0.9972
Epoch 134/200
 - 1s - loss: 0.0033 - val_loss: 0.0041
 - val_f1: 0.9973
Epoch 135/200
 - 1s - loss: 0.0033 - val_loss: 0.0039
 - val_f1: 0.9972
Epoch 136/200
 - 1s - loss: 0.0031 - val_loss: 0.0041
 - val_f1: 0.9974
Epoch 137/200
 - 1s - loss: 0.0033 - val_loss: 0.0041
 - val_f1: 0.9973
Epoch 138/200
 - 1s - loss: 0.0031 - val_loss: 0.0039
 - val_f1: 0.9974
Epoch 139/200
 - 1s - loss: 0.0031 - val_loss: 0.0043
 - val_f1: 0.9969
Epoch 140/200
 - 1s - loss: 0.0033 - val_loss: 0.0041
 - val_f1: 0.9970
Epoch 141/200
 - 1s - loss: 0.0032 - val_loss: 0.0041
2020-01-08 14:03:30,959 [INFO] epoch = 140. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_2/ann_model_epoch_140.pickle
 - val_f1: 0.9972
Epoch 142/200
 - 1s - loss: 0.0033 - val_loss: 0.0042
 - val_f1: 0.9971
Epoch 143/200
 - 1s - loss: 0.0032 - val_loss: 0.0040
 - val_f1: 0.9975
Epoch 144/200
 - 1s - loss: 0.0034 - val_loss: 0.0041
 - val_f1: 0.9971
Epoch 145/200
 - 1s - loss: 0.0030 - val_loss: 0.0041
 - val_f1: 0.9970
Epoch 146/200
 - 1s - loss: 0.0033 - val_loss: 0.0047
 - val_f1: 0.9968
Epoch 147/200
 - 1s - loss: 0.0033 - val_loss: 0.0042
 - val_f1: 0.9969
Epoch 148/200
 - 1s - loss: 0.0030 - val_loss: 0.0041
 - val_f1: 0.9973
Epoch 149/200
 - 1s - loss: 0.0033 - val_loss: 0.0043
 - val_f1: 0.9969
Epoch 150/200
 - 1s - loss: 0.0032 - val_loss: 0.0039
 - val_f1: 0.9974
Epoch 151/200
 - 1s - loss: 0.0033 - val_loss: 0.0044
 - val_f1: 0.9966
Epoch 152/200
 - 1s - loss: 0.0033 - val_loss: 0.0046
 - val_f1: 0.9971
Epoch 153/200
 - 1s - loss: 0.0032 - val_loss: 0.0044
 - val_f1: 0.9968
Epoch 154/200
 - 1s - loss: 0.0031 - val_loss: 0.0045
 - val_f1: 0.9969
Epoch 155/200
 - 1s - loss: 0.0031 - val_loss: 0.0042
 - val_f1: 0.9973
Epoch 156/200
 - 1s - loss: 0.0033 - val_loss: 0.0043
 - val_f1: 0.9969
Epoch 157/200
 - 1s - loss: 0.0031 - val_loss: 0.0043
 - val_f1: 0.9971
Epoch 158/200
 - 1s - loss: 0.0032 - val_loss: 0.0041
 - val_f1: 0.9973
Epoch 159/200
 - 1s - loss: 0.0031 - val_loss: 0.0042
 - val_f1: 0.9969
Epoch 160/200
 - 1s - loss: 0.0032 - val_loss: 0.0044
 - val_f1: 0.9972
Epoch 161/200
 - 1s - loss: 0.0032 - val_loss: 0.0045
2020-01-08 14:03:58,664 [INFO] epoch = 160. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_2/ann_model_epoch_160.pickle
 - val_f1: 0.9972
Epoch 162/200
 - 1s - loss: 0.0030 - val_loss: 0.0041
 - val_f1: 0.9973
Epoch 163/200
 - 1s - loss: 0.0032 - val_loss: 0.0043
 - val_f1: 0.9971
Epoch 164/200
 - 1s - loss: 0.0032 - val_loss: 0.0044
 - val_f1: 0.9970
Epoch 165/200
 - 1s - loss: 0.0030 - val_loss: 0.0042
 - val_f1: 0.9971
Epoch 166/200
 - 1s - loss: 0.0033 - val_loss: 0.0041
 - val_f1: 0.9973
Epoch 167/200
 - 1s - loss: 0.0033 - val_loss: 0.0040
 - val_f1: 0.9973
Epoch 168/200
 - 1s - loss: 0.0029 - val_loss: 0.0040
 - val_f1: 0.9973
Epoch 169/200
 - 1s - loss: 0.0030 - val_loss: 0.0043
 - val_f1: 0.9969
Epoch 170/200
 - 1s - loss: 0.0030 - val_loss: 0.0044
 - val_f1: 0.9972
Epoch 171/200
 - 1s - loss: 0.0034 - val_loss: 0.0042
 - val_f1: 0.9968
Epoch 172/200
 - 1s - loss: 0.0029 - val_loss: 0.0041
 - val_f1: 0.9971
Epoch 173/200
 - 1s - loss: 0.0029 - val_loss: 0.0044
 - val_f1: 0.9970
Epoch 174/200
 - 1s - loss: 0.0031 - val_loss: 0.0043
 - val_f1: 0.9972
Epoch 175/200
 - 1s - loss: 0.0032 - val_loss: 0.0045
 - val_f1: 0.9971
Epoch 176/200
 - 1s - loss: 0.0032 - val_loss: 0.0044
 - val_f1: 0.9971
Epoch 177/200
 - 1s - loss: 0.0030 - val_loss: 0.0045
 - val_f1: 0.9969
Epoch 178/200
 - 1s - loss: 0.0031 - val_loss: 0.0046
 - val_f1: 0.9969
Epoch 179/200
 - 1s - loss: 0.0029 - val_loss: 0.0043
 - val_f1: 0.9970
Epoch 180/200
 - 1s - loss: 0.0030 - val_loss: 0.0042
 - val_f1: 0.9971
Epoch 181/200
 - 1s - loss: 0.0032 - val_loss: 0.0044
2020-01-08 14:04:26,451 [INFO] epoch = 180. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_2/ann_model_epoch_180.pickle
 - val_f1: 0.9972
Epoch 182/200
 - 1s - loss: 0.0031 - val_loss: 0.0045
 - val_f1: 0.9969
Epoch 183/200
 - 1s - loss: 0.0030 - val_loss: 0.0043
 - val_f1: 0.9973
Epoch 184/200
 - 1s - loss: 0.0031 - val_loss: 0.0045
 - val_f1: 0.9972
Epoch 185/200
 - 1s - loss: 0.0032 - val_loss: 0.0044
2020-01-08 14:04:32,280 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-08 14:04:33,937 [INFO] Last epoch loss evaluation: train_loss = 0.001938, val_loss = 0.003866
2020-01-08 14:04:33,937 [INFO] Training complete. time_to_train = 260.08 sec, 4.33 min
2020-01-08 14:04:33,942 [INFO] Model saved to results_additional_exps/ann_depth_nsl_layers_2/best_model.pickle
2020-01-08 14:04:33,945 [INFO] Training history saved to: results_additional_exps/ann_depth_nsl_layers_2/training_error_history.csv
2020-01-08 14:04:34,119 [INFO] Plot saved to: results_additional_exps/ann_depth_nsl_layers_2/training_error_history.png
2020-01-08 14:04:34,294 [INFO] Plot saved to: results_additional_exps/ann_depth_nsl_layers_2/training_f1_history.png
2020-01-08 14:04:34,294 [INFO] Making predictions on training, validation, testing data
2020-01-08 14:04:35,818 [INFO] Evaluating predictions (results)
2020-01-08 14:04:36,079 [INFO] Dataset: Testing. Classification report below
2020-01-08 14:04:36,079 [INFO] 
              precision    recall  f1-score   support

         dos       0.96      0.83      0.89      7458
      normal       0.67      0.97      0.80      9711
       probe       0.84      0.63      0.72      2421
         r2l       0.69      0.07      0.13      2421
         u2r       0.84      0.04      0.08       533

   micro avg       0.77      0.77      0.77     22544
   macro avg       0.80      0.51      0.52     22544
weighted avg       0.79      0.77      0.73     22544

2020-01-08 14:04:36,079 [INFO] Overall accuracy (micro avg): 0.7684528034066714
2020-01-08 14:04:36,373 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.7685         0.7685                       0.7685                0.0579                   0.2315  0.7685
1     Macro avg        0.9074         0.8004                       0.5088                0.0786                   0.4912  0.5225
2  Weighted avg        0.8671         0.7910                       0.7685                0.1612                   0.2315  0.7297
2020-01-08 14:04:36,707 [INFO] Dataset: Validation. Classification report below
2020-01-08 14:04:36,707 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00      9186
      normal       1.00      1.00      1.00     13469
       probe       0.99      0.99      0.99      2331
         r2l       0.97      0.91      0.94       199
         u2r       0.83      0.50      0.62        10

   micro avg       1.00      1.00      1.00     25195
   macro avg       0.96      0.88      0.91     25195
weighted avg       1.00      1.00      1.00     25195

2020-01-08 14:04:36,707 [INFO] Overall accuracy (micro avg): 0.9973010517959913
2020-01-08 14:04:37,063 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9973         0.9973                       0.9973                0.0007                   0.0027  0.9973
1     Macro avg        0.9989         0.9583                       0.8802                0.0009                   0.1198  0.9107
2  Weighted avg        0.9983         0.9973                       0.9973                0.0020                   0.0027  0.9973
2020-01-08 14:04:38,502 [INFO] Dataset: Training. Classification report below
2020-01-08 14:04:38,502 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00     36741
      normal       1.00      1.00      1.00     53874
       probe       1.00      1.00      1.00      9325
         r2l       0.98      0.93      0.95       796
         u2r       0.97      0.79      0.87        42

   micro avg       1.00      1.00      1.00    100778
   macro avg       0.99      0.94      0.96    100778
weighted avg       1.00      1.00      1.00    100778

2020-01-08 14:04:38,502 [INFO] Overall accuracy (micro avg): 0.9982039730893647
2020-01-08 14:04:40,119 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9982         0.9982                       0.9982                0.0004                   0.0018  0.9982
1     Macro avg        0.9993         0.9882                       0.9424                0.0007                   0.0576  0.9633
2  Weighted avg        0.9989         0.9982                       0.9982                0.0015                   0.0018  0.9982
2020-01-08 14:04:40,158 [INFO] Results saved to: results_additional_exps/ann_depth_nsl_layers_2/ann_depth_nsl_layers_2_results.xlsx
2020-01-08 14:04:40,158 [INFO] ================= Finished running experiment no. 2 ================= 

2020-01-08 14:04:40,162 [INFO] Created directory: results_additional_exps/ann_depth_nsl_layers_3
2020-01-08 14:04:40,162 [INFO] Initialized logging. log_filename = results_additional_exps/ann_depth_nsl_layers_3/run_log.log
2020-01-08 14:04:40,162 [INFO] ================= Running experiment no. 3  ================= 

2020-01-08 14:04:40,162 [INFO] Experiment parameters given below
2020-01-08 14:04:40,162 [INFO] 
{'experiment_num': 3, 'results_dir': 'results_additional_exps/ann_depth_nsl_layers_3', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [64, 64, 64], 'ann_layer_activations': ['relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu'], 'ann_layer_dropout_rates': [0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2], 'epochs': 200, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/nsl_kdd_five_classes', 'description': 'ann_depth_nsl_layers_3'}
2020-01-08 14:04:40,163 [INFO] Created tensorboard log directory: results_additional_exps/ann_depth_nsl_layers_3/tf_logs_run_2020_01_08-14_04_40
2020-01-08 14:04:40,163 [INFO] Loading datsets from: ../Datasets/small_datasets/nsl_kdd_five_classes
2020-01-08 14:04:40,163 [INFO] Reading X, y files
2020-01-08 14:04:40,163 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_train.h5
2020-01-08 14:04:40,409 [INFO] Reading complete. time_to_read=0.25 seconds
2020-01-08 14:04:40,409 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_val.h5
2020-01-08 14:04:40,471 [INFO] Reading complete. time_to_read=0.06 seconds
2020-01-08 14:04:40,471 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_test.h5
2020-01-08 14:04:40,527 [INFO] Reading complete. time_to_read=0.06 seconds
2020-01-08 14:04:40,527 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_train.h5
2020-01-08 14:04:40,534 [INFO] Reading complete. time_to_read=0.01 seconds
2020-01-08 14:04:40,534 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_val.h5
2020-01-08 14:04:40,538 [INFO] Reading complete. time_to_read=0.00 seconds
2020-01-08 14:04:40,538 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_test.h5
2020-01-08 14:04:40,542 [INFO] Reading complete. time_to_read=0.00 seconds
2020-01-08 14:04:40,732 [INFO] Initializing model
2020-01-08 14:04:41,059 [INFO] _________________________________________________________________
2020-01-08 14:04:41,061 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-08 14:04:41,061 [INFO] =================================================================
2020-01-08 14:04:41,061 [INFO] dense_6 (Dense)              (None, 64)                7872      
2020-01-08 14:04:41,062 [INFO] _________________________________________________________________
2020-01-08 14:04:41,062 [INFO] batch_normalization_4 (Batch (None, 64)                256       
2020-01-08 14:04:41,062 [INFO] _________________________________________________________________
2020-01-08 14:04:41,062 [INFO] dropout_4 (Dropout)          (None, 64)                0         
2020-01-08 14:04:41,062 [INFO] _________________________________________________________________
2020-01-08 14:04:41,062 [INFO] dense_7 (Dense)              (None, 64)                4160      
2020-01-08 14:04:41,062 [INFO] _________________________________________________________________
2020-01-08 14:04:41,062 [INFO] batch_normalization_5 (Batch (None, 64)                256       
2020-01-08 14:04:41,062 [INFO] _________________________________________________________________
2020-01-08 14:04:41,062 [INFO] dropout_5 (Dropout)          (None, 64)                0         
2020-01-08 14:04:41,062 [INFO] _________________________________________________________________
2020-01-08 14:04:41,062 [INFO] dense_8 (Dense)              (None, 64)                4160      
2020-01-08 14:04:41,062 [INFO] _________________________________________________________________
2020-01-08 14:04:41,062 [INFO] batch_normalization_6 (Batch (None, 64)                256       
2020-01-08 14:04:41,062 [INFO] _________________________________________________________________
2020-01-08 14:04:41,062 [INFO] dropout_6 (Dropout)          (None, 64)                0         
2020-01-08 14:04:41,062 [INFO] _________________________________________________________________
2020-01-08 14:04:41,063 [INFO] dense_9 (Dense)              (None, 5)                 325       
2020-01-08 14:04:41,063 [INFO] =================================================================
2020-01-08 14:04:41,063 [INFO] Total params: 17,285
2020-01-08 14:04:41,063 [INFO] Trainable params: 16,901
2020-01-08 14:04:41,063 [INFO] Non-trainable params: 384
2020-01-08 14:04:41,063 [INFO] _________________________________________________________________
2020-01-08 14:04:41,063 [INFO] Training model
 - val_f1: 0.9971
Epoch 00185: early stopping
Train on 100778 samples, validate on 25195 samples
Epoch 1/200
 - 2s - loss: 0.0854 - val_loss: 0.0204
 - val_f1: 0.9784
Epoch 2/200
 - 1s - loss: 0.0261 - val_loss: 0.0134
 - val_f1: 0.9885
Epoch 3/200
 - 1s - loss: 0.0192 - val_loss: 0.0111
 - val_f1: 0.9922
Epoch 4/200
 - 1s - loss: 0.0164 - val_loss: 0.0105
 - val_f1: 0.9934
Epoch 5/200
 - 1s - loss: 0.0146 - val_loss: 0.0102
 - val_f1: 0.9932
Epoch 6/200
 - 1s - loss: 0.0134 - val_loss: 0.0089
 - val_f1: 0.9941
Epoch 7/200
 - 1s - loss: 0.0126 - val_loss: 0.0091
 - val_f1: 0.9933
Epoch 8/200
 - 1s - loss: 0.0117 - val_loss: 0.0085
 - val_f1: 0.9940
Epoch 9/200
 - 1s - loss: 0.0111 - val_loss: 0.0089
 - val_f1: 0.9936
Epoch 10/200
 - 1s - loss: 0.0103 - val_loss: 0.0081
 - val_f1: 0.9939
Epoch 11/200
 - 1s - loss: 0.0099 - val_loss: 0.0075
 - val_f1: 0.9945
Epoch 12/200
 - 1s - loss: 0.0097 - val_loss: 0.0071
 - val_f1: 0.9953
Epoch 13/200
 - 1s - loss: 0.0094 - val_loss: 0.0069
 - val_f1: 0.9953
Epoch 14/200
 - 1s - loss: 0.0089 - val_loss: 0.0067
 - val_f1: 0.9952
Epoch 15/200
 - 1s - loss: 0.0087 - val_loss: 0.0069
 - val_f1: 0.9950
Epoch 16/200
 - 1s - loss: 0.0084 - val_loss: 0.0066
 - val_f1: 0.9953
Epoch 17/200
 - 1s - loss: 0.0084 - val_loss: 0.0068
 - val_f1: 0.9953
Epoch 18/200
 - 1s - loss: 0.0078 - val_loss: 0.0072
 - val_f1: 0.9950
Epoch 19/200
 - 1s - loss: 0.0077 - val_loss: 0.0068
 - val_f1: 0.9952
Epoch 20/200
 - 1s - loss: 0.0075 - val_loss: 0.0063
 - val_f1: 0.9949
Epoch 21/200
 - 1s - loss: 0.0073 - val_loss: 0.0063
2020-01-08 14:05:19,222 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_3/ann_model_epoch_20.pickle
 - val_f1: 0.9950
Epoch 22/200
 - 1s - loss: 0.0071 - val_loss: 0.0063
 - val_f1: 0.9954
Epoch 23/200
 - 1s - loss: 0.0070 - val_loss: 0.0058
 - val_f1: 0.9960
Epoch 24/200
 - 1s - loss: 0.0067 - val_loss: 0.0058
 - val_f1: 0.9950
Epoch 25/200
 - 1s - loss: 0.0067 - val_loss: 0.0059
 - val_f1: 0.9957
Epoch 26/200
 - 1s - loss: 0.0066 - val_loss: 0.0057
 - val_f1: 0.9957
Epoch 27/200
 - 1s - loss: 0.0064 - val_loss: 0.0063
 - val_f1: 0.9949
Epoch 28/200
 - 1s - loss: 0.0061 - val_loss: 0.0057
 - val_f1: 0.9959
Epoch 29/200
 - 1s - loss: 0.0063 - val_loss: 0.0056
 - val_f1: 0.9957
Epoch 30/200
 - 1s - loss: 0.0063 - val_loss: 0.0054
 - val_f1: 0.9958
Epoch 31/200
 - 1s - loss: 0.0062 - val_loss: 0.0057
 - val_f1: 0.9962
Epoch 32/200
 - 1s - loss: 0.0058 - val_loss: 0.0052
 - val_f1: 0.9960
Epoch 33/200
 - 1s - loss: 0.0058 - val_loss: 0.0055
 - val_f1: 0.9960
Epoch 34/200
 - 1s - loss: 0.0060 - val_loss: 0.0053
 - val_f1: 0.9959
Epoch 35/200
 - 1s - loss: 0.0056 - val_loss: 0.0049
 - val_f1: 0.9964
Epoch 36/200
 - 1s - loss: 0.0057 - val_loss: 0.0052
 - val_f1: 0.9959
Epoch 37/200
 - 1s - loss: 0.0057 - val_loss: 0.0051
 - val_f1: 0.9962
Epoch 38/200
 - 1s - loss: 0.0056 - val_loss: 0.0051
 - val_f1: 0.9959
Epoch 39/200
 - 1s - loss: 0.0053 - val_loss: 0.0051
 - val_f1: 0.9959
Epoch 40/200
 - 1s - loss: 0.0053 - val_loss: 0.0050
 - val_f1: 0.9960
Epoch 41/200
 - 1s - loss: 0.0052 - val_loss: 0.0055
2020-01-08 14:05:53,672 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_3/ann_model_epoch_40.pickle
 - val_f1: 0.9957
Epoch 42/200
 - 1s - loss: 0.0056 - val_loss: 0.0054
 - val_f1: 0.9952
Epoch 43/200
 - 1s - loss: 0.0051 - val_loss: 0.0050
 - val_f1: 0.9961
Epoch 44/200
 - 1s - loss: 0.0051 - val_loss: 0.0049
 - val_f1: 0.9963
Epoch 45/200
 - 1s - loss: 0.0051 - val_loss: 0.0049
 - val_f1: 0.9963
Epoch 46/200
 - 1s - loss: 0.0051 - val_loss: 0.0053
 - val_f1: 0.9959
Epoch 47/200
 - 1s - loss: 0.0051 - val_loss: 0.0049
 - val_f1: 0.9962
Epoch 48/200
 - 1s - loss: 0.0050 - val_loss: 0.0051
 - val_f1: 0.9959
Epoch 49/200
 - 1s - loss: 0.0049 - val_loss: 0.0051
 - val_f1: 0.9963
Epoch 50/200
 - 1s - loss: 0.0050 - val_loss: 0.0049
 - val_f1: 0.9963
Epoch 51/200
 - 1s - loss: 0.0049 - val_loss: 0.0050
 - val_f1: 0.9962
Epoch 52/200
 - 1s - loss: 0.0050 - val_loss: 0.0052
 - val_f1: 0.9962
Epoch 53/200
 - 1s - loss: 0.0050 - val_loss: 0.0057
 - val_f1: 0.9956
Epoch 54/200
 - 1s - loss: 0.0047 - val_loss: 0.0052
 - val_f1: 0.9963
Epoch 55/200
 - 1s - loss: 0.0046 - val_loss: 0.0051
 - val_f1: 0.9964
Epoch 56/200
 - 1s - loss: 0.0045 - val_loss: 0.0053
 - val_f1: 0.9961
Epoch 57/200
 - 1s - loss: 0.0048 - val_loss: 0.0053
 - val_f1: 0.9960
Epoch 58/200
 - 1s - loss: 0.0047 - val_loss: 0.0049
 - val_f1: 0.9963
Epoch 59/200
 - 1s - loss: 0.0047 - val_loss: 0.0049
 - val_f1: 0.9963
Epoch 60/200
 - 1s - loss: 0.0046 - val_loss: 0.0049
 - val_f1: 0.9960
Epoch 61/200
 - 1s - loss: 0.0045 - val_loss: 0.0050
2020-01-08 14:06:28,147 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_3/ann_model_epoch_60.pickle
 - val_f1: 0.9963
Epoch 62/200
 - 1s - loss: 0.0045 - val_loss: 0.0050
 - val_f1: 0.9963
Epoch 63/200
 - 1s - loss: 0.0047 - val_loss: 0.0049
 - val_f1: 0.9965
Epoch 64/200
 - 1s - loss: 0.0046 - val_loss: 0.0049
 - val_f1: 0.9961
Epoch 65/200
 - 1s - loss: 0.0045 - val_loss: 0.0051
 - val_f1: 0.9962
Epoch 66/200
 - 1s - loss: 0.0045 - val_loss: 0.0049
 - val_f1: 0.9962
Epoch 67/200
 - 1s - loss: 0.0044 - val_loss: 0.0049
 - val_f1: 0.9964
Epoch 68/200
 - 1s - loss: 0.0044 - val_loss: 0.0048
 - val_f1: 0.9962
Epoch 69/200
 - 1s - loss: 0.0044 - val_loss: 0.0050
 - val_f1: 0.9961
Epoch 70/200
 - 1s - loss: 0.0047 - val_loss: 0.0049
 - val_f1: 0.9964
Epoch 71/200
 - 1s - loss: 0.0046 - val_loss: 0.0042
 - val_f1: 0.9965
Epoch 72/200
 - 1s - loss: 0.0043 - val_loss: 0.0046
 - val_f1: 0.9962
Epoch 73/200
 - 1s - loss: 0.0041 - val_loss: 0.0046
 - val_f1: 0.9963
Epoch 74/200
 - 1s - loss: 0.0044 - val_loss: 0.0046
 - val_f1: 0.9962
Epoch 75/200
 - 1s - loss: 0.0044 - val_loss: 0.0049
 - val_f1: 0.9963
Epoch 76/200
 - 1s - loss: 0.0044 - val_loss: 0.0049
 - val_f1: 0.9963
Epoch 77/200
 - 1s - loss: 0.0044 - val_loss: 0.0048
 - val_f1: 0.9964
Epoch 78/200
 - 1s - loss: 0.0042 - val_loss: 0.0045
 - val_f1: 0.9965
Epoch 79/200
 - 1s - loss: 0.0043 - val_loss: 0.0050
 - val_f1: 0.9960
Epoch 80/200
 - 1s - loss: 0.0045 - val_loss: 0.0048
 - val_f1: 0.9962
Epoch 81/200
 - 1s - loss: 0.0042 - val_loss: 0.0045
2020-01-08 14:07:02,641 [INFO] epoch = 80. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_3/ann_model_epoch_80.pickle
 - val_f1: 0.9964
Epoch 82/200
 - 1s - loss: 0.0042 - val_loss: 0.0045
 - val_f1: 0.9965
Epoch 83/200
 - 1s - loss: 0.0041 - val_loss: 0.0044
 - val_f1: 0.9962
Epoch 84/200
 - 1s - loss: 0.0042 - val_loss: 0.0046
 - val_f1: 0.9964
Epoch 85/200
 - 1s - loss: 0.0043 - val_loss: 0.0043
 - val_f1: 0.9963
Epoch 86/200
 - 1s - loss: 0.0040 - val_loss: 0.0044
 - val_f1: 0.9964
Epoch 87/200
 - 1s - loss: 0.0039 - val_loss: 0.0045
 - val_f1: 0.9963
Epoch 88/200
 - 1s - loss: 0.0040 - val_loss: 0.0047
 - val_f1: 0.9959
Epoch 89/200
 - 1s - loss: 0.0039 - val_loss: 0.0047
 - val_f1: 0.9964
Epoch 90/200
 - 1s - loss: 0.0042 - val_loss: 0.0043
 - val_f1: 0.9966
Epoch 91/200
 - 1s - loss: 0.0040 - val_loss: 0.0048
 - val_f1: 0.9962
Epoch 92/200
 - 1s - loss: 0.0039 - val_loss: 0.0048
 - val_f1: 0.9963
Epoch 93/200
 - 1s - loss: 0.0042 - val_loss: 0.0045
 - val_f1: 0.9966
Epoch 94/200
 - 1s - loss: 0.0042 - val_loss: 0.0042
 - val_f1: 0.9967
Epoch 95/200
 - 1s - loss: 0.0040 - val_loss: 0.0045
 - val_f1: 0.9965
Epoch 96/200
 - 1s - loss: 0.0039 - val_loss: 0.0043
 - val_f1: 0.9967
Epoch 97/200
 - 1s - loss: 0.0038 - val_loss: 0.0043
 - val_f1: 0.9965
Epoch 98/200
 - 1s - loss: 0.0038 - val_loss: 0.0046
 - val_f1: 0.9962
Epoch 99/200
 - 1s - loss: 0.0038 - val_loss: 0.0043
 - val_f1: 0.9963
Epoch 100/200
 - 1s - loss: 0.0040 - val_loss: 0.0043
 - val_f1: 0.9966
Epoch 101/200
 - 1s - loss: 0.0039 - val_loss: 0.0048
2020-01-08 14:07:37,125 [INFO] epoch = 100. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_3/ann_model_epoch_100.pickle
 - val_f1: 0.9967
Epoch 102/200
 - 1s - loss: 0.0039 - val_loss: 0.0042
 - val_f1: 0.9964
Epoch 103/200
 - 1s - loss: 0.0037 - val_loss: 0.0045
 - val_f1: 0.9965
Epoch 104/200
 - 1s - loss: 0.0037 - val_loss: 0.0044
 - val_f1: 0.9965
Epoch 105/200
 - 1s - loss: 0.0039 - val_loss: 0.0044
 - val_f1: 0.9965
Epoch 106/200
 - 1s - loss: 0.0037 - val_loss: 0.0041
 - val_f1: 0.9967
Epoch 107/200
 - 1s - loss: 0.0038 - val_loss: 0.0043
 - val_f1: 0.9967
Epoch 108/200
 - 1s - loss: 0.0039 - val_loss: 0.0040
 - val_f1: 0.9970
Epoch 109/200
 - 1s - loss: 0.0040 - val_loss: 0.0044
 - val_f1: 0.9966
Epoch 110/200
 - 1s - loss: 0.0039 - val_loss: 0.0080
 - val_f1: 0.9943
Epoch 111/200
 - 1s - loss: 0.0037 - val_loss: 0.0041
 - val_f1: 0.9967
Epoch 112/200
 - 1s - loss: 0.0038 - val_loss: 0.0045
 - val_f1: 0.9966
Epoch 113/200
 - 1s - loss: 0.0039 - val_loss: 0.0049
 - val_f1: 0.9962
Epoch 114/200
 - 1s - loss: 0.0038 - val_loss: 0.0045
 - val_f1: 0.9967
Epoch 115/200
 - 1s - loss: 0.0035 - val_loss: 0.0043
 - val_f1: 0.9968
Epoch 116/200
 - 1s - loss: 0.0038 - val_loss: 0.0046
 - val_f1: 0.9965
Epoch 117/200
 - 1s - loss: 0.0036 - val_loss: 0.0042
 - val_f1: 0.9966
Epoch 118/200
 - 1s - loss: 0.0037 - val_loss: 0.0045
 - val_f1: 0.9965
Epoch 119/200
 - 1s - loss: 0.0037 - val_loss: 0.0043
 - val_f1: 0.9966
Epoch 120/200
 - 1s - loss: 0.0035 - val_loss: 0.0043
 - val_f1: 0.9965
Epoch 121/200
 - 1s - loss: 0.0036 - val_loss: 0.0044
2020-01-08 14:08:11,633 [INFO] epoch = 120. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_3/ann_model_epoch_120.pickle
 - val_f1: 0.9968
Epoch 122/200
 - 1s - loss: 0.0036 - val_loss: 0.0046
 - val_f1: 0.9965
Epoch 123/200
 - 1s - loss: 0.0036 - val_loss: 0.0043
 - val_f1: 0.9967
Epoch 124/200
 - 1s - loss: 0.0034 - val_loss: 0.0044
 - val_f1: 0.9966
Epoch 125/200
 - 1s - loss: 0.0036 - val_loss: 0.0045
 - val_f1: 0.9964
Epoch 126/200
 - 1s - loss: 0.0036 - val_loss: 0.0045
 - val_f1: 0.9967
Epoch 127/200
 - 1s - loss: 0.0035 - val_loss: 0.0042
 - val_f1: 0.9968
Epoch 128/200
 - 1s - loss: 0.0035 - val_loss: 0.0043
 - val_f1: 0.9967
Epoch 129/200
 - 1s - loss: 0.0036 - val_loss: 0.0039
 - val_f1: 0.9968
Epoch 130/200
 - 1s - loss: 0.0038 - val_loss: 0.0042
 - val_f1: 0.9966
Epoch 131/200
 - 1s - loss: 0.0034 - val_loss: 0.0040
 - val_f1: 0.9967
Epoch 132/200
 - 1s - loss: 0.0035 - val_loss: 0.0041
 - val_f1: 0.9969
Epoch 133/200
 - 1s - loss: 0.0036 - val_loss: 0.0045
 - val_f1: 0.9965
Epoch 134/200
 - 1s - loss: 0.0037 - val_loss: 0.0042
 - val_f1: 0.9967
Epoch 135/200
 - 1s - loss: 0.0037 - val_loss: 0.0041
 - val_f1: 0.9969
Epoch 136/200
 - 1s - loss: 0.0036 - val_loss: 0.0040
 - val_f1: 0.9968
Epoch 137/200
 - 1s - loss: 0.0035 - val_loss: 0.0044
 - val_f1: 0.9967
Epoch 138/200
 - 1s - loss: 0.0034 - val_loss: 0.0041
 - val_f1: 0.9968
Epoch 139/200
 - 1s - loss: 0.0035 - val_loss: 0.0042
 - val_f1: 0.9968
Epoch 140/200
 - 1s - loss: 0.0034 - val_loss: 0.0042
 - val_f1: 0.9967
Epoch 141/200
 - 1s - loss: 0.0034 - val_loss: 0.0045
2020-01-08 14:08:46,173 [INFO] epoch = 140. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_3/ann_model_epoch_140.pickle
 - val_f1: 0.9967
Epoch 142/200
 - 1s - loss: 0.0037 - val_loss: 0.0040
 - val_f1: 0.9969
Epoch 143/200
 - 1s - loss: 0.0036 - val_loss: 0.0041
 - val_f1: 0.9965
Epoch 144/200
 - 1s - loss: 0.0035 - val_loss: 0.0039
 - val_f1: 0.9970
Epoch 145/200
 - 1s - loss: 0.0035 - val_loss: 0.0038
 - val_f1: 0.9970
Epoch 146/200
 - 1s - loss: 0.0035 - val_loss: 0.0039
 - val_f1: 0.9967
Epoch 147/200
 - 1s - loss: 0.0034 - val_loss: 0.0038
 - val_f1: 0.9971
Epoch 148/200
 - 1s - loss: 0.0033 - val_loss: 0.0041
 - val_f1: 0.9965
Epoch 149/200
 - 1s - loss: 0.0033 - val_loss: 0.0039
 - val_f1: 0.9969
Epoch 150/200
 - 1s - loss: 0.0034 - val_loss: 0.0039
 - val_f1: 0.9970
Epoch 151/200
 - 1s - loss: 0.0034 - val_loss: 0.0038
 - val_f1: 0.9971
Epoch 152/200
 - 1s - loss: 0.0036 - val_loss: 0.0041
 - val_f1: 0.9967
Epoch 153/200
 - 1s - loss: 0.0035 - val_loss: 0.0042
 - val_f1: 0.9966
Epoch 154/200
 - 1s - loss: 0.0037 - val_loss: 0.0039
 - val_f1: 0.9968
Epoch 155/200
 - 1s - loss: 0.0034 - val_loss: 0.0038
 - val_f1: 0.9970
Epoch 156/200
 - 1s - loss: 0.0034 - val_loss: 0.0041
 - val_f1: 0.9967
Epoch 157/200
 - 1s - loss: 0.0034 - val_loss: 0.0039
 - val_f1: 0.9968
Epoch 158/200
 - 1s - loss: 0.0033 - val_loss: 0.0039
 - val_f1: 0.9969
Epoch 159/200
 - 1s - loss: 0.0032 - val_loss: 0.0042
 - val_f1: 0.9967
Epoch 160/200
 - 1s - loss: 0.0035 - val_loss: 0.0040
 - val_f1: 0.9968
Epoch 161/200
 - 1s - loss: 0.0033 - val_loss: 0.0039
2020-01-08 14:09:20,632 [INFO] epoch = 160. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_3/ann_model_epoch_160.pickle
 - val_f1: 0.9969
Epoch 162/200
 - 1s - loss: 0.0035 - val_loss: 0.0039
 - val_f1: 0.9967
Epoch 163/200
 - 1s - loss: 0.0034 - val_loss: 0.0039
 - val_f1: 0.9967
Epoch 164/200
 - 1s - loss: 0.0032 - val_loss: 0.0041
 - val_f1: 0.9965
Epoch 165/200
 - 1s - loss: 0.0034 - val_loss: 0.0039
 - val_f1: 0.9966
Epoch 166/200
 - 1s - loss: 0.0034 - val_loss: 0.0044
 - val_f1: 0.9965
Epoch 167/200
 - 1s - loss: 0.0033 - val_loss: 0.0044
 - val_f1: 0.9967
Epoch 168/200
 - 1s - loss: 0.0033 - val_loss: 0.0042
 - val_f1: 0.9965
Epoch 169/200
 - 1s - loss: 0.0035 - val_loss: 0.0040
 - val_f1: 0.9970
Epoch 170/200
 - 1s - loss: 0.0034 - val_loss: 0.0040
 - val_f1: 0.9968
Epoch 171/200
 - 1s - loss: 0.0035 - val_loss: 0.0042
 - val_f1: 0.9967
Epoch 172/200
 - 1s - loss: 0.0033 - val_loss: 0.0040
 - val_f1: 0.9970
Epoch 173/200
 - 1s - loss: 0.0031 - val_loss: 0.0041
 - val_f1: 0.9968
Epoch 174/200
 - 1s - loss: 0.0032 - val_loss: 0.0041
 - val_f1: 0.9969
Epoch 175/200
 - 1s - loss: 0.0033 - val_loss: 0.0039
 - val_f1: 0.9967
Epoch 176/200
 - 1s - loss: 0.0032 - val_loss: 0.0039
 - val_f1: 0.9970
Epoch 177/200
 - 1s - loss: 0.0033 - val_loss: 0.0040
 - val_f1: 0.9968
Epoch 178/200
 - 1s - loss: 0.0033 - val_loss: 0.0038
 - val_f1: 0.9971
Epoch 179/200
 - 1s - loss: 0.0033 - val_loss: 0.0037
 - val_f1: 0.9970
Epoch 180/200
 - 1s - loss: 0.0032 - val_loss: 0.0038
 - val_f1: 0.9970
Epoch 181/200
 - 1s - loss: 0.0031 - val_loss: 0.0040
2020-01-08 14:09:55,132 [INFO] epoch = 180. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_3/ann_model_epoch_180.pickle
 - val_f1: 0.9972
Epoch 182/200
 - 1s - loss: 0.0033 - val_loss: 0.0038
 - val_f1: 0.9969
Epoch 183/200
 - 1s - loss: 0.0032 - val_loss: 0.0043
 - val_f1: 0.9967
Epoch 184/200
 - 1s - loss: 0.0030 - val_loss: 0.0043
 - val_f1: 0.9967
Epoch 185/200
 - 1s - loss: 0.0033 - val_loss: 0.0041
 - val_f1: 0.9968
Epoch 186/200
 - 1s - loss: 0.0029 - val_loss: 0.0041
 - val_f1: 0.9968
Epoch 187/200
 - 1s - loss: 0.0030 - val_loss: 0.0041
 - val_f1: 0.9970
Epoch 188/200
 - 1s - loss: 0.0030 - val_loss: 0.0038
 - val_f1: 0.9971
Epoch 189/200
 - 1s - loss: 0.0033 - val_loss: 0.0036
 - val_f1: 0.9971
Epoch 190/200
 - 1s - loss: 0.0032 - val_loss: 0.0040
 - val_f1: 0.9969
Epoch 191/200
 - 1s - loss: 0.0030 - val_loss: 0.0037
 - val_f1: 0.9971
Epoch 192/200
 - 1s - loss: 0.0033 - val_loss: 0.0038
 - val_f1: 0.9968
Epoch 193/200
 - 1s - loss: 0.0031 - val_loss: 0.0039
 - val_f1: 0.9969
Epoch 194/200
 - 1s - loss: 0.0031 - val_loss: 0.0037
 - val_f1: 0.9966
Epoch 195/200
 - 1s - loss: 0.0031 - val_loss: 0.0040
 - val_f1: 0.9969
Epoch 196/200
 - 1s - loss: 0.0032 - val_loss: 0.0039
 - val_f1: 0.9969
Epoch 197/200
 - 1s - loss: 0.0031 - val_loss: 0.0043
 - val_f1: 0.9965
Epoch 198/200
 - 1s - loss: 0.0033 - val_loss: 0.0038
 - val_f1: 0.9971
Epoch 199/200
 - 1s - loss: 0.0032 - val_loss: 0.0038
 - val_f1: 0.9971
Epoch 200/200
 - 1s - loss: 0.0031 - val_loss: 0.0038
2020-01-08 14:10:28,244 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-08 14:10:30,188 [INFO] Last epoch loss evaluation: train_loss = 0.001909, val_loss = 0.003641
2020-01-08 14:10:30,188 [INFO] Training complete. time_to_train = 349.13 sec, 5.82 min
2020-01-08 14:10:30,195 [INFO] Model saved to results_additional_exps/ann_depth_nsl_layers_3/best_model.pickle
2020-01-08 14:10:30,198 [INFO] Training history saved to: results_additional_exps/ann_depth_nsl_layers_3/training_error_history.csv
2020-01-08 14:10:30,457 [INFO] Plot saved to: results_additional_exps/ann_depth_nsl_layers_3/training_error_history.png
2020-01-08 14:10:30,641 [INFO] Plot saved to: results_additional_exps/ann_depth_nsl_layers_3/training_f1_history.png
2020-01-08 14:10:30,641 [INFO] Making predictions on training, validation, testing data
2020-01-08 14:10:32,406 [INFO] Evaluating predictions (results)
2020-01-08 14:10:32,666 [INFO] Dataset: Testing. Classification report below
2020-01-08 14:10:32,666 [INFO] 
              precision    recall  f1-score   support

         dos       0.96      0.84      0.90      7458
      normal       0.68      0.97      0.80      9711
       probe       0.85      0.67      0.75      2421
         r2l       0.76      0.10      0.17      2421
         u2r       0.81      0.05      0.09       533

   micro avg       0.78      0.78      0.78     22544
   macro avg       0.81      0.53      0.54     22544
weighted avg       0.80      0.78      0.74     22544

2020-01-08 14:10:32,666 [INFO] Overall accuracy (micro avg): 0.7796309439318666
2020-01-08 14:10:32,961 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.7796         0.7796                       0.7796                0.0551                   0.2204  0.7796
1     Macro avg        0.9119         0.8127                       0.5250                0.0747                   0.4750  0.5422
2  Weighted avg        0.8739         0.8044                       0.7796                0.1534                   0.2204  0.7435
2020-01-08 14:10:33,294 [INFO] Dataset: Validation. Classification report below
2020-01-08 14:10:33,294 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00      9186
      normal       1.00      1.00      1.00     13469
       probe       1.00      0.99      0.99      2331
         r2l       0.94      0.94      0.94       199
         u2r       0.86      0.60      0.71        10

   micro avg       1.00      1.00      1.00     25195
   macro avg       0.96      0.91      0.93     25195
weighted avg       1.00      1.00      1.00     25195

2020-01-08 14:10:33,294 [INFO] Overall accuracy (micro avg): 0.9971819805516967
2020-01-08 14:10:33,650 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9972         0.9972                       0.9972                0.0007                   0.0028  0.9972
1     Macro avg        0.9989         0.9567                       0.9056                0.0009                   0.0944  0.9266
2  Weighted avg        0.9983         0.9972                       0.9972                0.0019                   0.0028  0.9972
2020-01-08 14:10:35,093 [INFO] Dataset: Training. Classification report below
2020-01-08 14:10:35,093 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00     36741
      normal       1.00      1.00      1.00     53874
       probe       1.00      0.99      1.00      9325
         r2l       0.95      0.97      0.96       796
         u2r       0.94      0.71      0.81        42

   micro avg       1.00      1.00      1.00    100778
   macro avg       0.98      0.94      0.95    100778
weighted avg       1.00      1.00      1.00    100778

2020-01-08 14:10:35,093 [INFO] Overall accuracy (micro avg): 0.998213895889976
2020-01-08 14:10:36,717 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9982         0.9982                       0.9982                0.0004                   0.0018  0.9982
1     Macro avg        0.9993         0.9758                       0.9359                0.0006                   0.0641  0.9528
2  Weighted avg        0.9989         0.9982                       0.9982                0.0012                   0.0018  0.9982
2020-01-08 14:10:36,755 [INFO] Results saved to: results_additional_exps/ann_depth_nsl_layers_3/ann_depth_nsl_layers_3_results.xlsx
2020-01-08 14:10:36,755 [INFO] ================= Finished running experiment no. 3 ================= 

2020-01-08 14:10:36,759 [INFO] Created directory: results_additional_exps/ann_depth_nsl_layers_4
2020-01-08 14:10:36,759 [INFO] Initialized logging. log_filename = results_additional_exps/ann_depth_nsl_layers_4/run_log.log
2020-01-08 14:10:36,759 [INFO] ================= Running experiment no. 4  ================= 

2020-01-08 14:10:36,759 [INFO] Experiment parameters given below
2020-01-08 14:10:36,759 [INFO] 
{'experiment_num': 4, 'results_dir': 'results_additional_exps/ann_depth_nsl_layers_4', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [64, 64, 64, 64], 'ann_layer_activations': ['relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu'], 'ann_layer_dropout_rates': [0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2], 'epochs': 200, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/nsl_kdd_five_classes', 'description': 'ann_depth_nsl_layers_4'}
2020-01-08 14:10:36,760 [INFO] Created tensorboard log directory: results_additional_exps/ann_depth_nsl_layers_4/tf_logs_run_2020_01_08-14_10_36
2020-01-08 14:10:36,760 [INFO] Loading datsets from: ../Datasets/small_datasets/nsl_kdd_five_classes
2020-01-08 14:10:36,760 [INFO] Reading X, y files
2020-01-08 14:10:36,760 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_train.h5
2020-01-08 14:10:37,007 [INFO] Reading complete. time_to_read=0.25 seconds
2020-01-08 14:10:37,007 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_val.h5
2020-01-08 14:10:37,069 [INFO] Reading complete. time_to_read=0.06 seconds
2020-01-08 14:10:37,070 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_test.h5
2020-01-08 14:10:37,126 [INFO] Reading complete. time_to_read=0.06 seconds
2020-01-08 14:10:37,126 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_train.h5
2020-01-08 14:10:37,133 [INFO] Reading complete. time_to_read=0.01 seconds
2020-01-08 14:10:37,133 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_val.h5
2020-01-08 14:10:37,137 [INFO] Reading complete. time_to_read=0.00 seconds
2020-01-08 14:10:37,137 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_test.h5
2020-01-08 14:10:37,141 [INFO] Reading complete. time_to_read=0.00 seconds
2020-01-08 14:10:37,331 [INFO] Initializing model
2020-01-08 14:10:37,660 [INFO] _________________________________________________________________
2020-01-08 14:10:37,660 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-08 14:10:37,660 [INFO] =================================================================
2020-01-08 14:10:37,660 [INFO] dense_10 (Dense)             (None, 64)                7872      
2020-01-08 14:10:37,660 [INFO] _________________________________________________________________
2020-01-08 14:10:37,660 [INFO] batch_normalization_7 (Batch (None, 64)                256       
2020-01-08 14:10:37,660 [INFO] _________________________________________________________________
2020-01-08 14:10:37,660 [INFO] dropout_7 (Dropout)          (None, 64)                0         
2020-01-08 14:10:37,660 [INFO] _________________________________________________________________
2020-01-08 14:10:37,660 [INFO] dense_11 (Dense)             (None, 64)                4160      
2020-01-08 14:10:37,660 [INFO] _________________________________________________________________
2020-01-08 14:10:37,661 [INFO] batch_normalization_8 (Batch (None, 64)                256       
2020-01-08 14:10:37,661 [INFO] _________________________________________________________________
2020-01-08 14:10:37,661 [INFO] dropout_8 (Dropout)          (None, 64)                0         
2020-01-08 14:10:37,661 [INFO] _________________________________________________________________
2020-01-08 14:10:37,661 [INFO] dense_12 (Dense)             (None, 64)                4160      
2020-01-08 14:10:37,661 [INFO] _________________________________________________________________
2020-01-08 14:10:37,661 [INFO] batch_normalization_9 (Batch (None, 64)                256       
2020-01-08 14:10:37,661 [INFO] _________________________________________________________________
2020-01-08 14:10:37,661 [INFO] dropout_9 (Dropout)          (None, 64)                0         
2020-01-08 14:10:37,661 [INFO] _________________________________________________________________
2020-01-08 14:10:37,661 [INFO] dense_13 (Dense)             (None, 64)                4160      
2020-01-08 14:10:37,661 [INFO] _________________________________________________________________
2020-01-08 14:10:37,661 [INFO] batch_normalization_10 (Batc (None, 64)                256       
2020-01-08 14:10:37,661 [INFO] _________________________________________________________________
2020-01-08 14:10:37,661 [INFO] dropout_10 (Dropout)         (None, 64)                0         
2020-01-08 14:10:37,661 [INFO] _________________________________________________________________
2020-01-08 14:10:37,661 [INFO] dense_14 (Dense)             (None, 5)                 325       
2020-01-08 14:10:37,661 [INFO] =================================================================
2020-01-08 14:10:37,662 [INFO] Total params: 21,701
2020-01-08 14:10:37,662 [INFO] Trainable params: 21,189
2020-01-08 14:10:37,662 [INFO] Non-trainable params: 512
2020-01-08 14:10:37,662 [INFO] _________________________________________________________________
2020-01-08 14:10:37,662 [INFO] Training model
 - val_f1: 0.9969
Train on 100778 samples, validate on 25195 samples
Epoch 1/200
 - 2s - loss: 0.1031 - val_loss: 0.0192
 - val_f1: 0.9792
Epoch 2/200
 - 2s - loss: 0.0295 - val_loss: 0.0146
 - val_f1: 0.9859
Epoch 3/200
 - 2s - loss: 0.0220 - val_loss: 0.0121
 - val_f1: 0.9901
Epoch 4/200
 - 2s - loss: 0.0186 - val_loss: 0.0113
 - val_f1: 0.9916
Epoch 5/200
 - 2s - loss: 0.0166 - val_loss: 0.0103
 - val_f1: 0.9909
Epoch 6/200
 - 2s - loss: 0.0151 - val_loss: 0.0108
 - val_f1: 0.9915
Epoch 7/200
 - 2s - loss: 0.0141 - val_loss: 0.0101
 - val_f1: 0.9908
Epoch 8/200
 - 2s - loss: 0.0134 - val_loss: 0.0095
 - val_f1: 0.9911
Epoch 9/200
 - 2s - loss: 0.0124 - val_loss: 0.0087
 - val_f1: 0.9915
Epoch 10/200
 - 2s - loss: 0.0119 - val_loss: 0.0090
 - val_f1: 0.9906
Epoch 11/200
 - 2s - loss: 0.0115 - val_loss: 0.0083
 - val_f1: 0.9930
Epoch 12/200
 - 2s - loss: 0.0110 - val_loss: 0.0080
 - val_f1: 0.9937
Epoch 13/200
 - 2s - loss: 0.0107 - val_loss: 0.0078
 - val_f1: 0.9941
Epoch 14/200
 - 2s - loss: 0.0099 - val_loss: 0.0079
 - val_f1: 0.9935
Epoch 15/200
 - 2s - loss: 0.0099 - val_loss: 0.0074
 - val_f1: 0.9943
Epoch 16/200
 - 2s - loss: 0.0095 - val_loss: 0.0076
 - val_f1: 0.9933
Epoch 17/200
 - 2s - loss: 0.0093 - val_loss: 0.0069
 - val_f1: 0.9946
Epoch 18/200
 - 2s - loss: 0.0089 - val_loss: 0.0069
 - val_f1: 0.9946
Epoch 19/200
 - 2s - loss: 0.0087 - val_loss: 0.0070
 - val_f1: 0.9948
Epoch 20/200
 - 2s - loss: 0.0087 - val_loss: 0.0065
 - val_f1: 0.9950
Epoch 21/200
 - 2s - loss: 0.0083 - val_loss: 0.0064
2020-01-08 14:11:24,337 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_4/ann_model_epoch_20.pickle
 - val_f1: 0.9950
Epoch 22/200
 - 2s - loss: 0.0077 - val_loss: 0.0064
 - val_f1: 0.9951
Epoch 23/200
 - 2s - loss: 0.0080 - val_loss: 0.0064
 - val_f1: 0.9946
Epoch 24/200
 - 2s - loss: 0.0078 - val_loss: 0.0060
 - val_f1: 0.9951
Epoch 25/200
 - 2s - loss: 0.0075 - val_loss: 0.0064
 - val_f1: 0.9951
Epoch 26/200
 - 2s - loss: 0.0075 - val_loss: 0.0058
 - val_f1: 0.9959
Epoch 27/200
 - 2s - loss: 0.0074 - val_loss: 0.0057
 - val_f1: 0.9957
Epoch 28/200
 - 2s - loss: 0.0070 - val_loss: 0.0059
 - val_f1: 0.9950
Epoch 29/200
 - 2s - loss: 0.0071 - val_loss: 0.0056
 - val_f1: 0.9958
Epoch 30/200
 - 2s - loss: 0.0068 - val_loss: 0.0065
 - val_f1: 0.9941
Epoch 31/200
 - 2s - loss: 0.0068 - val_loss: 0.0059
 - val_f1: 0.9952
Epoch 32/200
 - 2s - loss: 0.0063 - val_loss: 0.0054
 - val_f1: 0.9961
Epoch 33/200
 - 2s - loss: 0.0063 - val_loss: 0.0059
 - val_f1: 0.9952
Epoch 34/200
 - 2s - loss: 0.0066 - val_loss: 0.0051
 - val_f1: 0.9957
Epoch 35/200
 - 2s - loss: 0.0061 - val_loss: 0.0054
 - val_f1: 0.9956
Epoch 36/200
 - 2s - loss: 0.0062 - val_loss: 0.0049
 - val_f1: 0.9962
Epoch 37/200
 - 2s - loss: 0.0063 - val_loss: 0.0052
 - val_f1: 0.9961
Epoch 38/200
 - 2s - loss: 0.0059 - val_loss: 0.0055
 - val_f1: 0.9959
Epoch 39/200
 - 2s - loss: 0.0060 - val_loss: 0.0049
 - val_f1: 0.9965
Epoch 40/200
 - 2s - loss: 0.0059 - val_loss: 0.0051
 - val_f1: 0.9963
Epoch 41/200
 - 2s - loss: 0.0058 - val_loss: 0.0051
2020-01-08 14:12:05,720 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_4/ann_model_epoch_40.pickle
 - val_f1: 0.9963
Epoch 42/200
 - 2s - loss: 0.0056 - val_loss: 0.0051
 - val_f1: 0.9964
Epoch 43/200
 - 2s - loss: 0.0060 - val_loss: 0.0052
 - val_f1: 0.9960
Epoch 44/200
 - 2s - loss: 0.0063 - val_loss: 0.0059
 - val_f1: 0.9955
Epoch 45/200
 - 2s - loss: 0.0058 - val_loss: 0.0054
 - val_f1: 0.9962
Epoch 46/200
 - 2s - loss: 0.0058 - val_loss: 0.0055
 - val_f1: 0.9956
Epoch 47/200
 - 2s - loss: 0.0057 - val_loss: 0.0054
 - val_f1: 0.9961
Epoch 48/200
 - 2s - loss: 0.0056 - val_loss: 0.0052
 - val_f1: 0.9959
Epoch 49/200
 - 2s - loss: 0.0057 - val_loss: 0.0046
 - val_f1: 0.9962
Epoch 50/200
 - 2s - loss: 0.0052 - val_loss: 0.0046
 - val_f1: 0.9964
Epoch 51/200
 - 2s - loss: 0.0052 - val_loss: 0.0050
 - val_f1: 0.9964
Epoch 52/200
 - 2s - loss: 0.0056 - val_loss: 0.0048
 - val_f1: 0.9967
Epoch 53/200
 - 2s - loss: 0.0053 - val_loss: 0.0050
 - val_f1: 0.9963
Epoch 54/200
 - 2s - loss: 0.0051 - val_loss: 0.0049
 - val_f1: 0.9962
Epoch 55/200
 - 2s - loss: 0.0050 - val_loss: 0.0046
 - val_f1: 0.9966
Epoch 56/200
 - 2s - loss: 0.0050 - val_loss: 0.0049
 - val_f1: 0.9962
Epoch 57/200
 - 2s - loss: 0.0054 - val_loss: 0.0045
 - val_f1: 0.9965
Epoch 58/200
 - 2s - loss: 0.0050 - val_loss: 0.0046
 - val_f1: 0.9965
Epoch 59/200
 - 2s - loss: 0.0051 - val_loss: 0.0046
 - val_f1: 0.9964
Epoch 60/200
 - 2s - loss: 0.0049 - val_loss: 0.0048
 - val_f1: 0.9966
Epoch 61/200
 - 2s - loss: 0.0045 - val_loss: 0.0047
2020-01-08 14:12:47,006 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_4/ann_model_epoch_60.pickle
 - val_f1: 0.9964
Epoch 62/200
 - 2s - loss: 0.0049 - val_loss: 0.0050
 - val_f1: 0.9959
Epoch 63/200
 - 2s - loss: 0.0046 - val_loss: 0.0046
 - val_f1: 0.9965
Epoch 64/200
 - 2s - loss: 0.0047 - val_loss: 0.0049
 - val_f1: 0.9964
Epoch 65/200
 - 2s - loss: 0.0048 - val_loss: 0.0045
 - val_f1: 0.9965
Epoch 66/200
 - 2s - loss: 0.0046 - val_loss: 0.0046
 - val_f1: 0.9965
Epoch 67/200
 - 2s - loss: 0.0046 - val_loss: 0.0046
 - val_f1: 0.9967
Epoch 68/200
 - 2s - loss: 0.0047 - val_loss: 0.0047
 - val_f1: 0.9963
Epoch 69/200
 - 2s - loss: 0.0047 - val_loss: 0.0045
 - val_f1: 0.9967
Epoch 70/200
 - 2s - loss: 0.0048 - val_loss: 0.0046
 - val_f1: 0.9967
Epoch 71/200
 - 2s - loss: 0.0050 - val_loss: 0.0046
 - val_f1: 0.9968
Epoch 72/200
 - 2s - loss: 0.0044 - val_loss: 0.0045
 - val_f1: 0.9968
Epoch 73/200
 - 2s - loss: 0.0047 - val_loss: 0.0046
 - val_f1: 0.9966
Epoch 74/200
 - 2s - loss: 0.0046 - val_loss: 0.0047
 - val_f1: 0.9964
Epoch 75/200
 - 2s - loss: 0.0045 - val_loss: 0.0047
 - val_f1: 0.9961
Epoch 76/200
 - 2s - loss: 0.0044 - val_loss: 0.0046
 - val_f1: 0.9966
Epoch 77/200
 - 2s - loss: 0.0046 - val_loss: 0.0046
 - val_f1: 0.9965
Epoch 78/200
 - 2s - loss: 0.0046 - val_loss: 0.0044
 - val_f1: 0.9968
Epoch 79/200
 - 2s - loss: 0.0045 - val_loss: 0.0046
 - val_f1: 0.9966
Epoch 80/200
 - 2s - loss: 0.0045 - val_loss: 0.0046
 - val_f1: 0.9966
Epoch 81/200
 - 2s - loss: 0.0045 - val_loss: 0.0047
2020-01-08 14:13:28,358 [INFO] epoch = 80. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_4/ann_model_epoch_80.pickle
 - val_f1: 0.9967
Epoch 82/200
 - 2s - loss: 0.0044 - val_loss: 0.0044
 - val_f1: 0.9966
Epoch 83/200
 - 2s - loss: 0.0044 - val_loss: 0.0046
 - val_f1: 0.9966
Epoch 84/200
 - 2s - loss: 0.0043 - val_loss: 0.0044
 - val_f1: 0.9965
Epoch 85/200
 - 2s - loss: 0.0043 - val_loss: 0.0044
 - val_f1: 0.9970
Epoch 86/200
 - 2s - loss: 0.0043 - val_loss: 0.0045
 - val_f1: 0.9965
Epoch 87/200
 - 2s - loss: 0.0045 - val_loss: 0.0044
 - val_f1: 0.9965
Epoch 88/200
 - 2s - loss: 0.0041 - val_loss: 0.0048
 - val_f1: 0.9964
Epoch 89/200
 - 2s - loss: 0.0042 - val_loss: 0.0046
 - val_f1: 0.9965
Epoch 90/200
 - 2s - loss: 0.0044 - val_loss: 0.0044
 - val_f1: 0.9969
Epoch 91/200
 - 2s - loss: 0.0043 - val_loss: 0.0043
 - val_f1: 0.9967
Epoch 92/200
 - 2s - loss: 0.0042 - val_loss: 0.0044
 - val_f1: 0.9966
Epoch 93/200
 - 2s - loss: 0.0043 - val_loss: 0.0048
 - val_f1: 0.9966
Epoch 94/200
 - 2s - loss: 0.0043 - val_loss: 0.0044
 - val_f1: 0.9969
Epoch 95/200
 - 2s - loss: 0.0042 - val_loss: 0.0043
 - val_f1: 0.9967
Epoch 96/200
 - 2s - loss: 0.0044 - val_loss: 0.0043
 - val_f1: 0.9968
Epoch 97/200
 - 2s - loss: 0.0045 - val_loss: 0.0042
 - val_f1: 0.9970
Epoch 98/200
 - 2s - loss: 0.0043 - val_loss: 0.0042
 - val_f1: 0.9967
Epoch 99/200
 - 2s - loss: 0.0039 - val_loss: 0.0045
 - val_f1: 0.9967
Epoch 100/200
 - 2s - loss: 0.0040 - val_loss: 0.0042
 - val_f1: 0.9969
Epoch 101/200
 - 2s - loss: 0.0045 - val_loss: 0.0044
2020-01-08 14:14:09,668 [INFO] epoch = 100. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_4/ann_model_epoch_100.pickle
 - val_f1: 0.9968
Epoch 102/200
 - 2s - loss: 0.0043 - val_loss: 0.0044
 - val_f1: 0.9967
Epoch 103/200
 - 2s - loss: 0.0041 - val_loss: 0.0040
 - val_f1: 0.9968
Epoch 104/200
 - 2s - loss: 0.0041 - val_loss: 0.0045
 - val_f1: 0.9968
Epoch 105/200
 - 2s - loss: 0.0038 - val_loss: 0.0046
 - val_f1: 0.9967
Epoch 106/200
 - 2s - loss: 0.0041 - val_loss: 0.0043
 - val_f1: 0.9969
Epoch 107/200
 - 2s - loss: 0.0038 - val_loss: 0.0044
 - val_f1: 0.9970
Epoch 108/200
 - 2s - loss: 0.0041 - val_loss: 0.0042
 - val_f1: 0.9971
Epoch 109/200
 - 2s - loss: 0.0041 - val_loss: 0.0045
 - val_f1: 0.9966
Epoch 110/200
 - 2s - loss: 0.0044 - val_loss: 0.0042
 - val_f1: 0.9968
Epoch 111/200
 - 2s - loss: 0.0041 - val_loss: 0.0043
 - val_f1: 0.9968
Epoch 112/200
 - 2s - loss: 0.0040 - val_loss: 0.0043
 - val_f1: 0.9968
Epoch 113/200
 - 2s - loss: 0.0041 - val_loss: 0.0044
 - val_f1: 0.9966
Epoch 114/200
 - 2s - loss: 0.0039 - val_loss: 0.0042
 - val_f1: 0.9969
Epoch 115/200
 - 2s - loss: 0.0040 - val_loss: 0.0043
 - val_f1: 0.9969
Epoch 116/200
 - 2s - loss: 0.0041 - val_loss: 0.0044
 - val_f1: 0.9967
Epoch 117/200
 - 2s - loss: 0.0037 - val_loss: 0.0044
 - val_f1: 0.9972
Epoch 118/200
 - 2s - loss: 0.0039 - val_loss: 0.0044
 - val_f1: 0.9968
Epoch 119/200
 - 2s - loss: 0.0039 - val_loss: 0.0043
 - val_f1: 0.9967
Epoch 120/200
 - 2s - loss: 0.0041 - val_loss: 0.0042
 - val_f1: 0.9970
Epoch 121/200
 - 2s - loss: 0.0037 - val_loss: 0.0043
2020-01-08 14:14:51,019 [INFO] epoch = 120. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_4/ann_model_epoch_120.pickle
 - val_f1: 0.9970
Epoch 122/200
 - 2s - loss: 0.0040 - val_loss: 0.0042
 - val_f1: 0.9970
Epoch 123/200
 - 2s - loss: 0.0038 - val_loss: 0.0046
 - val_f1: 0.9965
Epoch 124/200
 - 2s - loss: 0.0037 - val_loss: 0.0042
 - val_f1: 0.9971
Epoch 125/200
 - 2s - loss: 0.0039 - val_loss: 0.0044
 - val_f1: 0.9969
Epoch 126/200
 - 2s - loss: 0.0038 - val_loss: 0.0045
 - val_f1: 0.9970
Epoch 127/200
 - 2s - loss: 0.0039 - val_loss: 0.0043
 - val_f1: 0.9972
Epoch 128/200
 - 2s - loss: 0.0039 - val_loss: 0.0042
 - val_f1: 0.9970
Epoch 129/200
 - 2s - loss: 0.0037 - val_loss: 0.0043
 - val_f1: 0.9971
Epoch 130/200
 - 2s - loss: 0.0038 - val_loss: 0.0044
 - val_f1: 0.9970
Epoch 131/200
 - 2s - loss: 0.0039 - val_loss: 0.0043
 - val_f1: 0.9970
Epoch 132/200
 - 2s - loss: 0.0037 - val_loss: 0.0043
 - val_f1: 0.9972
Epoch 133/200
 - 2s - loss: 0.0039 - val_loss: 0.0044
 - val_f1: 0.9970
Epoch 134/200
 - 2s - loss: 0.0036 - val_loss: 0.0042
 - val_f1: 0.9973
Epoch 135/200
 - 2s - loss: 0.0038 - val_loss: 0.0044
 - val_f1: 0.9969
Epoch 136/200
 - 2s - loss: 0.0039 - val_loss: 0.0042
 - val_f1: 0.9968
Epoch 137/200
 - 2s - loss: 0.0038 - val_loss: 0.0042
 - val_f1: 0.9972
Epoch 138/200
 - 2s - loss: 0.0036 - val_loss: 0.0043
 - val_f1: 0.9972
Epoch 139/200
 - 2s - loss: 0.0035 - val_loss: 0.0046
 - val_f1: 0.9968
Epoch 140/200
 - 2s - loss: 0.0038 - val_loss: 0.0042
 - val_f1: 0.9970
Epoch 141/200
 - 2s - loss: 0.0038 - val_loss: 0.0041
2020-01-08 14:15:32,396 [INFO] epoch = 140. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_4/ann_model_epoch_140.pickle
 - val_f1: 0.9971
Epoch 142/200
 - 2s - loss: 0.0038 - val_loss: 0.0042
 - val_f1: 0.9971
Epoch 143/200
 - 2s - loss: 0.0036 - val_loss: 0.0043
 - val_f1: 0.9969
Epoch 144/200
 - 2s - loss: 0.0037 - val_loss: 0.0043
 - val_f1: 0.9968
Epoch 145/200
 - 2s - loss: 0.0037 - val_loss: 0.0042
 - val_f1: 0.9969
Epoch 146/200
 - 2s - loss: 0.0035 - val_loss: 0.0043
 - val_f1: 0.9969
Epoch 147/200
 - 2s - loss: 0.0033 - val_loss: 0.0046
 - val_f1: 0.9964
Epoch 148/200
 - 2s - loss: 0.0038 - val_loss: 0.0044
 - val_f1: 0.9968
Epoch 149/200
 - 2s - loss: 0.0036 - val_loss: 0.0043
 - val_f1: 0.9971
Epoch 150/200
 - 2s - loss: 0.0036 - val_loss: 0.0048
 - val_f1: 0.9965
Epoch 151/200
 - 2s - loss: 0.0036 - val_loss: 0.0042
 - val_f1: 0.9970
Epoch 152/200
 - 2s - loss: 0.0033 - val_loss: 0.0045
 - val_f1: 0.9968
Epoch 153/200
 - 2s - loss: 0.0035 - val_loss: 0.0045
2020-01-08 14:15:57,567 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-08 14:15:59,845 [INFO] Last epoch loss evaluation: train_loss = 0.002549, val_loss = 0.003960
2020-01-08 14:15:59,847 [INFO] Training complete. time_to_train = 322.19 sec, 5.37 min
2020-01-08 14:15:59,854 [INFO] Model saved to results_additional_exps/ann_depth_nsl_layers_4/best_model.pickle
2020-01-08 14:15:59,857 [INFO] Training history saved to: results_additional_exps/ann_depth_nsl_layers_4/training_error_history.csv
2020-01-08 14:16:00,032 [INFO] Plot saved to: results_additional_exps/ann_depth_nsl_layers_4/training_error_history.png
2020-01-08 14:16:00,208 [INFO] Plot saved to: results_additional_exps/ann_depth_nsl_layers_4/training_f1_history.png
2020-01-08 14:16:00,208 [INFO] Making predictions on training, validation, testing data
2020-01-08 14:16:02,317 [INFO] Evaluating predictions (results)
2020-01-08 14:16:02,582 [INFO] Dataset: Testing. Classification report below
2020-01-08 14:16:02,582 [INFO] 
              precision    recall  f1-score   support

         dos       0.96      0.83      0.89      7458
      normal       0.69      0.97      0.80      9711
       probe       0.84      0.71      0.77      2421
         r2l       0.95      0.10      0.18      2421
         u2r       0.95      0.04      0.07       533

   micro avg       0.78      0.78      0.78     22544
   macro avg       0.88      0.53      0.54     22544
weighted avg       0.83      0.78      0.75     22544

2020-01-08 14:16:02,582 [INFO] Overall accuracy (micro avg): 0.7822480482611781
2020-01-08 14:16:02,877 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.7822         0.7822                       0.7822                0.0544                   0.2178  0.7822
1     Macro avg        0.9129         0.8777                       0.5306                0.0740                   0.4694  0.5435
2  Weighted avg        0.8745         0.8280                       0.7822                0.1523                   0.2178  0.7453
2020-01-08 14:16:03,210 [INFO] Dataset: Validation. Classification report below
2020-01-08 14:16:03,210 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00      9186
      normal       1.00      1.00      1.00     13469
       probe       1.00      0.99      0.99      2331
         r2l       0.97      0.89      0.93       199
         u2r       1.00      0.40      0.57        10

   micro avg       1.00      1.00      1.00     25195
   macro avg       0.99      0.86      0.90     25195
weighted avg       1.00      1.00      1.00     25195

2020-01-08 14:16:03,210 [INFO] Overall accuracy (micro avg): 0.9967850764040485
2020-01-08 14:16:03,568 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9968         0.9968                       0.9968                0.0008                   0.0032  0.9968
1     Macro avg        0.9987         0.9915                       0.8562                0.0012                   0.1438  0.8979
2  Weighted avg        0.9980         0.9968                       0.9968                0.0026                   0.0032  0.9967
2020-01-08 14:16:05,011 [INFO] Dataset: Training. Classification report below
2020-01-08 14:16:05,011 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00     36741
      normal       1.00      1.00      1.00     53874
       probe       1.00      0.99      0.99      9325
         r2l       0.98      0.90      0.94       796
         u2r       1.00      0.60      0.75        42

   micro avg       1.00      1.00      1.00    100778
   macro avg       0.99      0.90      0.94    100778
weighted avg       1.00      1.00      1.00    100778

2020-01-08 14:16:05,013 [INFO] Overall accuracy (micro avg): 0.9975192998471889
2020-01-08 14:16:06,635 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9975         0.9975                       0.9975                0.0006                   0.0025  0.9975
1     Macro avg        0.9990         0.9946                       0.8977                0.0010                   0.1023  0.9356
2  Weighted avg        0.9984         0.9975                       0.9975                0.0023                   0.0025  0.9975
2020-01-08 14:16:06,672 [INFO] Results saved to: results_additional_exps/ann_depth_nsl_layers_4/ann_depth_nsl_layers_4_results.xlsx
2020-01-08 14:16:06,673 [INFO] ================= Finished running experiment no. 4 ================= 

2020-01-08 14:16:06,676 [INFO] Created directory: results_additional_exps/ann_depth_nsl_layers_5
2020-01-08 14:16:06,677 [INFO] Initialized logging. log_filename = results_additional_exps/ann_depth_nsl_layers_5/run_log.log
2020-01-08 14:16:06,677 [INFO] ================= Running experiment no. 5  ================= 

2020-01-08 14:16:06,677 [INFO] Experiment parameters given below
2020-01-08 14:16:06,677 [INFO] 
{'experiment_num': 5, 'results_dir': 'results_additional_exps/ann_depth_nsl_layers_5', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [64, 64, 64, 64, 64], 'ann_layer_activations': ['relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu'], 'ann_layer_dropout_rates': [0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2], 'epochs': 200, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/nsl_kdd_five_classes', 'description': 'ann_depth_nsl_layers_5'}
2020-01-08 14:16:06,677 [INFO] Created tensorboard log directory: results_additional_exps/ann_depth_nsl_layers_5/tf_logs_run_2020_01_08-14_16_06
2020-01-08 14:16:06,677 [INFO] Loading datsets from: ../Datasets/small_datasets/nsl_kdd_five_classes
2020-01-08 14:16:06,677 [INFO] Reading X, y files
2020-01-08 14:16:06,677 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_train.h5
2020-01-08 14:16:06,926 [INFO] Reading complete. time_to_read=0.25 seconds
2020-01-08 14:16:06,926 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_val.h5
2020-01-08 14:16:06,989 [INFO] Reading complete. time_to_read=0.06 seconds
2020-01-08 14:16:06,989 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_test.h5
2020-01-08 14:16:07,046 [INFO] Reading complete. time_to_read=0.06 seconds
2020-01-08 14:16:07,046 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_train.h5
2020-01-08 14:16:07,053 [INFO] Reading complete. time_to_read=0.01 seconds
2020-01-08 14:16:07,053 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_val.h5
2020-01-08 14:16:07,057 [INFO] Reading complete. time_to_read=0.00 seconds
2020-01-08 14:16:07,057 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_test.h5
2020-01-08 14:16:07,060 [INFO] Reading complete. time_to_read=0.00 seconds
2020-01-08 14:16:07,250 [INFO] Initializing model
2020-01-08 14:16:07,658 [INFO] _________________________________________________________________
2020-01-08 14:16:07,658 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-08 14:16:07,658 [INFO] =================================================================
2020-01-08 14:16:07,658 [INFO] dense_15 (Dense)             (None, 64)                7872      
2020-01-08 14:16:07,658 [INFO] _________________________________________________________________
2020-01-08 14:16:07,658 [INFO] batch_normalization_11 (Batc (None, 64)                256       
2020-01-08 14:16:07,658 [INFO] _________________________________________________________________
2020-01-08 14:16:07,658 [INFO] dropout_11 (Dropout)         (None, 64)                0         
2020-01-08 14:16:07,658 [INFO] _________________________________________________________________
2020-01-08 14:16:07,658 [INFO] dense_16 (Dense)             (None, 64)                4160      
2020-01-08 14:16:07,658 [INFO] _________________________________________________________________
2020-01-08 14:16:07,658 [INFO] batch_normalization_12 (Batc (None, 64)                256       
2020-01-08 14:16:07,658 [INFO] _________________________________________________________________
2020-01-08 14:16:07,658 [INFO] dropout_12 (Dropout)         (None, 64)                0         
2020-01-08 14:16:07,658 [INFO] _________________________________________________________________
2020-01-08 14:16:07,658 [INFO] dense_17 (Dense)             (None, 64)                4160      
2020-01-08 14:16:07,659 [INFO] _________________________________________________________________
2020-01-08 14:16:07,659 [INFO] batch_normalization_13 (Batc (None, 64)                256       
2020-01-08 14:16:07,659 [INFO] _________________________________________________________________
2020-01-08 14:16:07,659 [INFO] dropout_13 (Dropout)         (None, 64)                0         
2020-01-08 14:16:07,659 [INFO] _________________________________________________________________
2020-01-08 14:16:07,659 [INFO] dense_18 (Dense)             (None, 64)                4160      
2020-01-08 14:16:07,659 [INFO] _________________________________________________________________
2020-01-08 14:16:07,659 [INFO] batch_normalization_14 (Batc (None, 64)                256       
2020-01-08 14:16:07,659 [INFO] _________________________________________________________________
2020-01-08 14:16:07,659 [INFO] dropout_14 (Dropout)         (None, 64)                0         
2020-01-08 14:16:07,659 [INFO] _________________________________________________________________
2020-01-08 14:16:07,659 [INFO] dense_19 (Dense)             (None, 64)                4160      
2020-01-08 14:16:07,659 [INFO] _________________________________________________________________
2020-01-08 14:16:07,659 [INFO] batch_normalization_15 (Batc (None, 64)                256       
2020-01-08 14:16:07,659 [INFO] _________________________________________________________________
2020-01-08 14:16:07,659 [INFO] dropout_15 (Dropout)         (None, 64)                0         
2020-01-08 14:16:07,659 [INFO] _________________________________________________________________
2020-01-08 14:16:07,659 [INFO] dense_20 (Dense)             (None, 5)                 325       
2020-01-08 14:16:07,659 [INFO] =================================================================
2020-01-08 14:16:07,660 [INFO] Total params: 26,117
2020-01-08 14:16:07,660 [INFO] Trainable params: 25,477
2020-01-08 14:16:07,660 [INFO] Non-trainable params: 640
2020-01-08 14:16:07,660 [INFO] _________________________________________________________________
2020-01-08 14:16:07,660 [INFO] Training model
 - val_f1: 0.9969
Epoch 00153: early stopping
Train on 100778 samples, validate on 25195 samples
Epoch 1/200
 - 3s - loss: 0.1008 - val_loss: 0.0193
 - val_f1: 0.9801
Epoch 2/200
 - 2s - loss: 0.0304 - val_loss: 0.0149
 - val_f1: 0.9878
Epoch 3/200
 - 2s - loss: 0.0229 - val_loss: 0.0119
 - val_f1: 0.9881
Epoch 4/200
 - 2s - loss: 0.0192 - val_loss: 0.0119
 - val_f1: 0.9901
Epoch 5/200
 - 2s - loss: 0.0178 - val_loss: 0.0102
 - val_f1: 0.9907
Epoch 6/200
 - 2s - loss: 0.0161 - val_loss: 0.0099
 - val_f1: 0.9909
Epoch 7/200
 - 2s - loss: 0.0147 - val_loss: 0.0100
 - val_f1: 0.9907
Epoch 8/200
 - 2s - loss: 0.0136 - val_loss: 0.0098
 - val_f1: 0.9909
Epoch 9/200
 - 2s - loss: 0.0134 - val_loss: 0.0089
 - val_f1: 0.9927
Epoch 10/200
 - 2s - loss: 0.0128 - val_loss: 0.0108
 - val_f1: 0.9923
Epoch 11/200
 - 2s - loss: 0.0115 - val_loss: 0.0086
 - val_f1: 0.9939
Epoch 12/200
 - 2s - loss: 0.0118 - val_loss: 0.0088
 - val_f1: 0.9917
Epoch 13/200
 - 2s - loss: 0.0109 - val_loss: 0.0081
 - val_f1: 0.9936
Epoch 14/200
 - 2s - loss: 0.0108 - val_loss: 0.0080
 - val_f1: 0.9943
Epoch 15/200
 - 2s - loss: 0.0102 - val_loss: 0.0076
 - val_f1: 0.9944
Epoch 16/200
 - 2s - loss: 0.0099 - val_loss: 0.0078
 - val_f1: 0.9943
Epoch 17/200
 - 2s - loss: 0.0094 - val_loss: 0.0076
 - val_f1: 0.9943
Epoch 18/200
 - 2s - loss: 0.0091 - val_loss: 0.0073
 - val_f1: 0.9951
Epoch 19/200
 - 2s - loss: 0.0093 - val_loss: 0.0071
 - val_f1: 0.9942
Epoch 20/200
 - 2s - loss: 0.0090 - val_loss: 0.0067
 - val_f1: 0.9952
Epoch 21/200
 - 2s - loss: 0.0087 - val_loss: 0.0066
2020-01-08 14:17:03,079 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_5/ann_model_epoch_20.pickle
 - val_f1: 0.9946
Epoch 22/200
 - 2s - loss: 0.0081 - val_loss: 0.0068
 - val_f1: 0.9948
Epoch 23/200
 - 2s - loss: 0.0081 - val_loss: 0.0072
 - val_f1: 0.9939
Epoch 24/200
 - 2s - loss: 0.0083 - val_loss: 0.0065
 - val_f1: 0.9954
Epoch 25/200
 - 2s - loss: 0.0078 - val_loss: 0.0066
 - val_f1: 0.9956
Epoch 26/200
 - 2s - loss: 0.0078 - val_loss: 0.0060
 - val_f1: 0.9956
Epoch 27/200
 - 2s - loss: 0.0077 - val_loss: 0.0062
 - val_f1: 0.9956
Epoch 28/200
 - 2s - loss: 0.0074 - val_loss: 0.0062
 - val_f1: 0.9957
Epoch 29/200
 - 2s - loss: 0.0073 - val_loss: 0.0061
 - val_f1: 0.9956
Epoch 30/200
 - 2s - loss: 0.0071 - val_loss: 0.0056
 - val_f1: 0.9958
Epoch 31/200
 - 2s - loss: 0.0072 - val_loss: 0.0059
 - val_f1: 0.9961
Epoch 32/200
 - 2s - loss: 0.0068 - val_loss: 0.0061
 - val_f1: 0.9958
Epoch 33/200
 - 2s - loss: 0.0067 - val_loss: 0.0056
 - val_f1: 0.9962
Epoch 34/200
 - 2s - loss: 0.0066 - val_loss: 0.0060
 - val_f1: 0.9958
Epoch 35/200
 - 2s - loss: 0.0065 - val_loss: 0.0061
 - val_f1: 0.9957
Epoch 36/200
 - 2s - loss: 0.0066 - val_loss: 0.0059
 - val_f1: 0.9955
Epoch 37/200
 - 2s - loss: 0.0064 - val_loss: 0.0052
 - val_f1: 0.9963
Epoch 38/200
 - 2s - loss: 0.0062 - val_loss: 0.0051
 - val_f1: 0.9962
Epoch 39/200
 - 2s - loss: 0.0061 - val_loss: 0.0055
 - val_f1: 0.9958
Epoch 40/200
 - 2s - loss: 0.0065 - val_loss: 0.0051
 - val_f1: 0.9964
Epoch 41/200
 - 2s - loss: 0.0063 - val_loss: 0.0058
2020-01-08 14:17:51,382 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_5/ann_model_epoch_40.pickle
 - val_f1: 0.9960
Epoch 42/200
 - 2s - loss: 0.0060 - val_loss: 0.0055
 - val_f1: 0.9960
Epoch 43/200
 - 2s - loss: 0.0061 - val_loss: 0.0051
 - val_f1: 0.9961
Epoch 44/200
 - 2s - loss: 0.0058 - val_loss: 0.0050
 - val_f1: 0.9966
Epoch 45/200
 - 2s - loss: 0.0059 - val_loss: 0.0051
 - val_f1: 0.9964
Epoch 46/200
 - 2s - loss: 0.0056 - val_loss: 0.0048
 - val_f1: 0.9965
Epoch 47/200
 - 2s - loss: 0.0057 - val_loss: 0.0053
 - val_f1: 0.9962
Epoch 48/200
 - 2s - loss: 0.0056 - val_loss: 0.0053
 - val_f1: 0.9963
Epoch 49/200
 - 2s - loss: 0.0054 - val_loss: 0.0048
 - val_f1: 0.9967
Epoch 50/200
 - 2s - loss: 0.0056 - val_loss: 0.0049
 - val_f1: 0.9959
Epoch 51/200
 - 2s - loss: 0.0057 - val_loss: 0.0047
 - val_f1: 0.9965
Epoch 52/200
 - 2s - loss: 0.0056 - val_loss: 0.0048
 - val_f1: 0.9967
Epoch 53/200
 - 2s - loss: 0.0054 - val_loss: 0.0049
 - val_f1: 0.9968
Epoch 54/200
 - 2s - loss: 0.0054 - val_loss: 0.0049
 - val_f1: 0.9963
Epoch 55/200
 - 2s - loss: 0.0054 - val_loss: 0.0050
 - val_f1: 0.9965
Epoch 56/200
 - 2s - loss: 0.0052 - val_loss: 0.0050
 - val_f1: 0.9965
Epoch 57/200
 - 2s - loss: 0.0052 - val_loss: 0.0050
 - val_f1: 0.9960
Epoch 58/200
 - 2s - loss: 0.0054 - val_loss: 0.0051
 - val_f1: 0.9965
Epoch 59/200
 - 2s - loss: 0.0052 - val_loss: 0.0048
 - val_f1: 0.9963
Epoch 60/200
 - 2s - loss: 0.0054 - val_loss: 0.0048
 - val_f1: 0.9967
Epoch 61/200
 - 2s - loss: 0.0052 - val_loss: 0.0049
2020-01-08 14:18:39,730 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_5/ann_model_epoch_60.pickle
 - val_f1: 0.9967
Epoch 62/200
 - 2s - loss: 0.0053 - val_loss: 0.0049
 - val_f1: 0.9960
Epoch 63/200
 - 2s - loss: 0.0052 - val_loss: 0.0048
 - val_f1: 0.9961
Epoch 64/200
 - 2s - loss: 0.0050 - val_loss: 0.0052
 - val_f1: 0.9965
Epoch 65/200
 - 2s - loss: 0.0050 - val_loss: 0.0050
 - val_f1: 0.9962
Epoch 66/200
 - 2s - loss: 0.0050 - val_loss: 0.0047
 - val_f1: 0.9965
Epoch 67/200
 - 2s - loss: 0.0050 - val_loss: 0.0049
 - val_f1: 0.9968
Epoch 68/200
 - 2s - loss: 0.0048 - val_loss: 0.0051
 - val_f1: 0.9966
Epoch 69/200
 - 2s - loss: 0.0050 - val_loss: 0.0046
 - val_f1: 0.9966
Epoch 70/200
 - 2s - loss: 0.0047 - val_loss: 0.0049
 - val_f1: 0.9965
Epoch 71/200
 - 2s - loss: 0.0051 - val_loss: 0.0048
 - val_f1: 0.9966
Epoch 72/200
 - 2s - loss: 0.0048 - val_loss: 0.0047
 - val_f1: 0.9966
Epoch 73/200
 - 2s - loss: 0.0046 - val_loss: 0.0047
 - val_f1: 0.9967
Epoch 74/200
 - 2s - loss: 0.0047 - val_loss: 0.0045
 - val_f1: 0.9968
Epoch 75/200
 - 2s - loss: 0.0046 - val_loss: 0.0048
 - val_f1: 0.9966
Epoch 76/200
 - 2s - loss: 0.0046 - val_loss: 0.0044
 - val_f1: 0.9968
Epoch 77/200
 - 2s - loss: 0.0047 - val_loss: 0.0047
 - val_f1: 0.9968
Epoch 78/200
 - 2s - loss: 0.0046 - val_loss: 0.0044
 - val_f1: 0.9969
Epoch 79/200
 - 2s - loss: 0.0047 - val_loss: 0.0046
 - val_f1: 0.9965
Epoch 80/200
 - 2s - loss: 0.0047 - val_loss: 0.0048
 - val_f1: 0.9966
Epoch 81/200
 - 2s - loss: 0.0046 - val_loss: 0.0046
2020-01-08 14:19:28,026 [INFO] epoch = 80. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_5/ann_model_epoch_80.pickle
 - val_f1: 0.9967
Epoch 82/200
 - 2s - loss: 0.0043 - val_loss: 0.0046
 - val_f1: 0.9965
Epoch 83/200
 - 2s - loss: 0.0047 - val_loss: 0.0046
 - val_f1: 0.9966
Epoch 84/200
 - 2s - loss: 0.0043 - val_loss: 0.0049
 - val_f1: 0.9967
Epoch 85/200
 - 2s - loss: 0.0045 - val_loss: 0.0046
 - val_f1: 0.9966
Epoch 86/200
 - 2s - loss: 0.0044 - val_loss: 0.0046
 - val_f1: 0.9966
Epoch 87/200
 - 2s - loss: 0.0045 - val_loss: 0.0047
 - val_f1: 0.9967
Epoch 88/200
 - 2s - loss: 0.0045 - val_loss: 0.0046
 - val_f1: 0.9966
Epoch 89/200
 - 2s - loss: 0.0042 - val_loss: 0.0043
 - val_f1: 0.9968
Epoch 90/200
 - 2s - loss: 0.0047 - val_loss: 0.0046
 - val_f1: 0.9964
Epoch 91/200
 - 2s - loss: 0.0041 - val_loss: 0.0048
 - val_f1: 0.9965
Epoch 92/200
 - 2s - loss: 0.0046 - val_loss: 0.0044
 - val_f1: 0.9968
Epoch 93/200
 - 2s - loss: 0.0044 - val_loss: 0.0049
 - val_f1: 0.9964
Epoch 94/200
 - 2s - loss: 0.0043 - val_loss: 0.0047
 - val_f1: 0.9968
Epoch 95/200
 - 2s - loss: 0.0044 - val_loss: 0.0047
 - val_f1: 0.9966
Epoch 96/200
 - 2s - loss: 0.0043 - val_loss: 0.0046
 - val_f1: 0.9968
Epoch 97/200
 - 2s - loss: 0.0043 - val_loss: 0.0041
 - val_f1: 0.9971
Epoch 98/200
 - 2s - loss: 0.0044 - val_loss: 0.0046
 - val_f1: 0.9969
Epoch 99/200
 - 2s - loss: 0.0044 - val_loss: 0.0044
 - val_f1: 0.9967
Epoch 100/200
 - 2s - loss: 0.0042 - val_loss: 0.0046
 - val_f1: 0.9967
Epoch 101/200
 - 2s - loss: 0.0041 - val_loss: 0.0048
2020-01-08 14:20:16,374 [INFO] epoch = 100. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_5/ann_model_epoch_100.pickle
 - val_f1: 0.9966
Epoch 102/200
 - 2s - loss: 0.0041 - val_loss: 0.0048
 - val_f1: 0.9969
Epoch 103/200
 - 2s - loss: 0.0042 - val_loss: 0.0047
 - val_f1: 0.9965
Epoch 104/200
 - 2s - loss: 0.0042 - val_loss: 0.0047
 - val_f1: 0.9967
Epoch 105/200
 - 2s - loss: 0.0042 - val_loss: 0.0045
 - val_f1: 0.9968
Epoch 106/200
 - 2s - loss: 0.0040 - val_loss: 0.0044
 - val_f1: 0.9969
Epoch 107/200
 - 2s - loss: 0.0041 - val_loss: 0.0046
 - val_f1: 0.9967
Epoch 108/200
 - 2s - loss: 0.0040 - val_loss: 0.0046
 - val_f1: 0.9968
Epoch 109/200
 - 2s - loss: 0.0041 - val_loss: 0.0050
 - val_f1: 0.9967
Epoch 110/200
 - 2s - loss: 0.0041 - val_loss: 0.0046
 - val_f1: 0.9968
Epoch 111/200
 - 2s - loss: 0.0040 - val_loss: 0.0047
 - val_f1: 0.9968
Epoch 112/200
 - 2s - loss: 0.0042 - val_loss: 0.0042
 - val_f1: 0.9969
Epoch 113/200
 - 2s - loss: 0.0041 - val_loss: 0.0047
 - val_f1: 0.9966
Epoch 114/200
 - 2s - loss: 0.0040 - val_loss: 0.0048
 - val_f1: 0.9967
Epoch 115/200
 - 2s - loss: 0.0043 - val_loss: 0.0049
 - val_f1: 0.9967
Epoch 116/200
 - 2s - loss: 0.0038 - val_loss: 0.0047
 - val_f1: 0.9967
Epoch 117/200
 - 2s - loss: 0.0040 - val_loss: 0.0044
 - val_f1: 0.9968
Epoch 118/200
 - 2s - loss: 0.0041 - val_loss: 0.0045
 - val_f1: 0.9967
Epoch 119/200
 - 2s - loss: 0.0040 - val_loss: 0.0051
 - val_f1: 0.9967
Epoch 120/200
 - 2s - loss: 0.0040 - val_loss: 0.0046
 - val_f1: 0.9968
Epoch 121/200
 - 2s - loss: 0.0042 - val_loss: 0.0044
2020-01-08 14:21:04,629 [INFO] epoch = 120. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_5/ann_model_epoch_120.pickle
 - val_f1: 0.9967
Epoch 122/200
 - 2s - loss: 0.0040 - val_loss: 0.0046
 - val_f1: 0.9965
Epoch 123/200
 - 2s - loss: 0.0039 - val_loss: 0.0046
 - val_f1: 0.9967
Epoch 124/200
 - 2s - loss: 0.0040 - val_loss: 0.0045
 - val_f1: 0.9968
Epoch 125/200
 - 2s - loss: 0.0038 - val_loss: 0.0046
 - val_f1: 0.9969
Epoch 126/200
 - 2s - loss: 0.0037 - val_loss: 0.0043
 - val_f1: 0.9968
Epoch 127/200
 - 2s - loss: 0.0039 - val_loss: 0.0046
 - val_f1: 0.9964
Epoch 128/200
 - 2s - loss: 0.0038 - val_loss: 0.0045
 - val_f1: 0.9969
Epoch 129/200
 - 2s - loss: 0.0038 - val_loss: 0.0046
 - val_f1: 0.9969
Epoch 130/200
 - 2s - loss: 0.0040 - val_loss: 0.0046
 - val_f1: 0.9963
Epoch 131/200
 - 2s - loss: 0.0039 - val_loss: 0.0047
 - val_f1: 0.9964
Epoch 132/200
 - 2s - loss: 0.0037 - val_loss: 0.0048
 - val_f1: 0.9969
Epoch 133/200
 - 2s - loss: 0.0040 - val_loss: 0.0044
 - val_f1: 0.9969
Epoch 134/200
 - 2s - loss: 0.0041 - val_loss: 0.0046
 - val_f1: 0.9968
Epoch 135/200
 - 2s - loss: 0.0038 - val_loss: 0.0044
 - val_f1: 0.9968
Epoch 136/200
 - 2s - loss: 0.0038 - val_loss: 0.0044
 - val_f1: 0.9969
Epoch 137/200
 - 2s - loss: 0.0035 - val_loss: 0.0042
 - val_f1: 0.9972
Epoch 138/200
 - 2s - loss: 0.0038 - val_loss: 0.0042
 - val_f1: 0.9971
Epoch 139/200
 - 2s - loss: 0.0037 - val_loss: 0.0046
 - val_f1: 0.9968
Epoch 140/200
 - 2s - loss: 0.0039 - val_loss: 0.0045
 - val_f1: 0.9971
Epoch 141/200
 - 2s - loss: 0.0037 - val_loss: 0.0044
2020-01-08 14:21:52,851 [INFO] epoch = 140. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_5/ann_model_epoch_140.pickle
 - val_f1: 0.9968
Epoch 142/200
 - 2s - loss: 0.0037 - val_loss: 0.0045
 - val_f1: 0.9970
Epoch 143/200
 - 2s - loss: 0.0036 - val_loss: 0.0046
 - val_f1: 0.9970
Epoch 144/200
 - 2s - loss: 0.0039 - val_loss: 0.0042
 - val_f1: 0.9967
Epoch 145/200
 - 2s - loss: 0.0035 - val_loss: 0.0047
 - val_f1: 0.9968
Epoch 146/200
 - 2s - loss: 0.0041 - val_loss: 0.0042
 - val_f1: 0.9968
Epoch 147/200
 - 2s - loss: 0.0038 - val_loss: 0.0042
2020-01-08 14:22:07,756 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-08 14:22:10,432 [INFO] Last epoch loss evaluation: train_loss = 0.002661, val_loss = 0.004142
2020-01-08 14:22:10,433 [INFO] Training complete. time_to_train = 362.77 sec, 6.05 min
2020-01-08 14:22:10,441 [INFO] Model saved to results_additional_exps/ann_depth_nsl_layers_5/best_model.pickle
2020-01-08 14:22:10,444 [INFO] Training history saved to: results_additional_exps/ann_depth_nsl_layers_5/training_error_history.csv
2020-01-08 14:22:10,622 [INFO] Plot saved to: results_additional_exps/ann_depth_nsl_layers_5/training_error_history.png
2020-01-08 14:22:10,800 [INFO] Plot saved to: results_additional_exps/ann_depth_nsl_layers_5/training_f1_history.png
2020-01-08 14:22:10,800 [INFO] Making predictions on training, validation, testing data
2020-01-08 14:22:13,316 [INFO] Evaluating predictions (results)
2020-01-08 14:22:13,577 [INFO] Dataset: Testing. Classification report below
2020-01-08 14:22:13,577 [INFO] 
              precision    recall  f1-score   support

         dos       0.96      0.84      0.89      7458
      normal       0.68      0.95      0.79      9711
       probe       0.77      0.63      0.69      2421
         r2l       0.59      0.09      0.15      2421
         u2r       0.89      0.05      0.09       533

   micro avg       0.77      0.77      0.77     22544
   macro avg       0.78      0.51      0.52     22544
weighted avg       0.78      0.77      0.73     22544

2020-01-08 14:22:13,577 [INFO] Overall accuracy (micro avg): 0.7661905606813343
2020-01-08 14:22:13,874 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.7662         0.7662                       0.7662                0.0585                   0.2338  0.7662
1     Macro avg        0.9065         0.7772                       0.5113                0.0781                   0.4887  0.5248
2  Weighted avg        0.8675         0.7755                       0.7662                0.1566                   0.2338  0.7304
2020-01-08 14:22:14,208 [INFO] Dataset: Validation. Classification report below
2020-01-08 14:22:14,208 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00      9186
      normal       1.00      1.00      1.00     13469
       probe       1.00      0.99      0.99      2331
         r2l       0.97      0.90      0.94       199
         u2r       0.83      0.50      0.62        10

   micro avg       1.00      1.00      1.00     25195
   macro avg       0.96      0.88      0.91     25195
weighted avg       1.00      1.00      1.00     25195

2020-01-08 14:22:14,208 [INFO] Overall accuracy (micro avg): 0.9970629093074023
2020-01-08 14:22:14,564 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9971         0.9971                       0.9971                0.0007                   0.0029  0.9971
1     Macro avg        0.9988         0.9585                       0.8787                0.0011                   0.1213  0.9100
2  Weighted avg        0.9982         0.9970                       0.9971                0.0023                   0.0029  0.9970
2020-01-08 14:22:16,011 [INFO] Dataset: Training. Classification report below
2020-01-08 14:22:16,012 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00     36741
      normal       1.00      1.00      1.00     53874
       probe       1.00      0.99      1.00      9325
         r2l       0.98      0.90      0.94       796
         u2r       0.88      0.67      0.76        42

   micro avg       1.00      1.00      1.00    100778
   macro avg       0.97      0.91      0.94    100778
weighted avg       1.00      1.00      1.00    100778

2020-01-08 14:22:16,012 [INFO] Overall accuracy (micro avg): 0.9974895314453551
2020-01-08 14:22:17,638 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9975         0.9975                       0.9975                0.0006                   0.0025  0.9975
1     Macro avg        0.9990         0.9692                       0.9121                0.0009                   0.0879  0.9375
2  Weighted avg        0.9984         0.9975                       0.9975                0.0022                   0.0025  0.9975
2020-01-08 14:22:17,676 [INFO] Results saved to: results_additional_exps/ann_depth_nsl_layers_5/ann_depth_nsl_layers_5_results.xlsx
2020-01-08 14:22:17,676 [INFO] ================= Finished running experiment no. 5 ================= 

2020-01-08 14:22:17,680 [INFO] Created directory: results_additional_exps/ann_depth_nsl_layers_6
2020-01-08 14:22:17,680 [INFO] Initialized logging. log_filename = results_additional_exps/ann_depth_nsl_layers_6/run_log.log
2020-01-08 14:22:17,680 [INFO] ================= Running experiment no. 6  ================= 

2020-01-08 14:22:17,680 [INFO] Experiment parameters given below
2020-01-08 14:22:17,680 [INFO] 
{'experiment_num': 6, 'results_dir': 'results_additional_exps/ann_depth_nsl_layers_6', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [64, 64, 64, 64, 64, 64], 'ann_layer_activations': ['relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu'], 'ann_layer_dropout_rates': [0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2], 'epochs': 200, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/nsl_kdd_five_classes', 'description': 'ann_depth_nsl_layers_6'}
2020-01-08 14:22:17,680 [INFO] Created tensorboard log directory: results_additional_exps/ann_depth_nsl_layers_6/tf_logs_run_2020_01_08-14_22_17
2020-01-08 14:22:17,680 [INFO] Loading datsets from: ../Datasets/small_datasets/nsl_kdd_five_classes
2020-01-08 14:22:17,681 [INFO] Reading X, y files
2020-01-08 14:22:17,681 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_train.h5
2020-01-08 14:22:17,930 [INFO] Reading complete. time_to_read=0.25 seconds
2020-01-08 14:22:17,930 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_val.h5
2020-01-08 14:22:17,993 [INFO] Reading complete. time_to_read=0.06 seconds
2020-01-08 14:22:17,994 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_test.h5
2020-01-08 14:22:18,050 [INFO] Reading complete. time_to_read=0.06 seconds
2020-01-08 14:22:18,050 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_train.h5
2020-01-08 14:22:18,057 [INFO] Reading complete. time_to_read=0.01 seconds
2020-01-08 14:22:18,058 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_val.h5
2020-01-08 14:22:18,061 [INFO] Reading complete. time_to_read=0.00 seconds
2020-01-08 14:22:18,061 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_test.h5
2020-01-08 14:22:18,065 [INFO] Reading complete. time_to_read=0.00 seconds
2020-01-08 14:22:18,251 [INFO] Initializing model
2020-01-08 14:22:18,742 [INFO] _________________________________________________________________
2020-01-08 14:22:18,742 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-08 14:22:18,742 [INFO] =================================================================
2020-01-08 14:22:18,742 [INFO] dense_21 (Dense)             (None, 64)                7872      
2020-01-08 14:22:18,742 [INFO] _________________________________________________________________
2020-01-08 14:22:18,742 [INFO] batch_normalization_16 (Batc (None, 64)                256       
2020-01-08 14:22:18,742 [INFO] _________________________________________________________________
2020-01-08 14:22:18,742 [INFO] dropout_16 (Dropout)         (None, 64)                0         
2020-01-08 14:22:18,742 [INFO] _________________________________________________________________
2020-01-08 14:22:18,742 [INFO] dense_22 (Dense)             (None, 64)                4160      
2020-01-08 14:22:18,742 [INFO] _________________________________________________________________
2020-01-08 14:22:18,742 [INFO] batch_normalization_17 (Batc (None, 64)                256       
2020-01-08 14:22:18,742 [INFO] _________________________________________________________________
2020-01-08 14:22:18,742 [INFO] dropout_17 (Dropout)         (None, 64)                0         
2020-01-08 14:22:18,742 [INFO] _________________________________________________________________
2020-01-08 14:22:18,742 [INFO] dense_23 (Dense)             (None, 64)                4160      
2020-01-08 14:22:18,743 [INFO] _________________________________________________________________
2020-01-08 14:22:18,743 [INFO] batch_normalization_18 (Batc (None, 64)                256       
2020-01-08 14:22:18,743 [INFO] _________________________________________________________________
2020-01-08 14:22:18,743 [INFO] dropout_18 (Dropout)         (None, 64)                0         
2020-01-08 14:22:18,743 [INFO] _________________________________________________________________
2020-01-08 14:22:18,743 [INFO] dense_24 (Dense)             (None, 64)                4160      
2020-01-08 14:22:18,743 [INFO] _________________________________________________________________
2020-01-08 14:22:18,743 [INFO] batch_normalization_19 (Batc (None, 64)                256       
2020-01-08 14:22:18,743 [INFO] _________________________________________________________________
2020-01-08 14:22:18,743 [INFO] dropout_19 (Dropout)         (None, 64)                0         
2020-01-08 14:22:18,743 [INFO] _________________________________________________________________
2020-01-08 14:22:18,743 [INFO] dense_25 (Dense)             (None, 64)                4160      
2020-01-08 14:22:18,743 [INFO] _________________________________________________________________
2020-01-08 14:22:18,743 [INFO] batch_normalization_20 (Batc (None, 64)                256       
2020-01-08 14:22:18,743 [INFO] _________________________________________________________________
2020-01-08 14:22:18,743 [INFO] dropout_20 (Dropout)         (None, 64)                0         
2020-01-08 14:22:18,743 [INFO] _________________________________________________________________
2020-01-08 14:22:18,743 [INFO] dense_26 (Dense)             (None, 64)                4160      
2020-01-08 14:22:18,744 [INFO] _________________________________________________________________
2020-01-08 14:22:18,744 [INFO] batch_normalization_21 (Batc (None, 64)                256       
2020-01-08 14:22:18,744 [INFO] _________________________________________________________________
2020-01-08 14:22:18,744 [INFO] dropout_21 (Dropout)         (None, 64)                0         
2020-01-08 14:22:18,744 [INFO] _________________________________________________________________
2020-01-08 14:22:18,744 [INFO] dense_27 (Dense)             (None, 5)                 325       
2020-01-08 14:22:18,744 [INFO] =================================================================
2020-01-08 14:22:18,744 [INFO] Total params: 30,533
2020-01-08 14:22:18,744 [INFO] Trainable params: 29,765
2020-01-08 14:22:18,744 [INFO] Non-trainable params: 768
2020-01-08 14:22:18,744 [INFO] _________________________________________________________________
2020-01-08 14:22:18,744 [INFO] Training model
 - val_f1: 0.9971
Epoch 00147: early stopping
Train on 100778 samples, validate on 25195 samples
Epoch 1/200
 - 3s - loss: 0.1113 - val_loss: 0.0245
 - val_f1: 0.9721
Epoch 2/200
 - 2s - loss: 0.0361 - val_loss: 0.0163
 - val_f1: 0.9868
Epoch 3/200
 - 2s - loss: 0.0256 - val_loss: 0.0127
 - val_f1: 0.9892
Epoch 4/200
 - 2s - loss: 0.0211 - val_loss: 0.0125
 - val_f1: 0.9901
Epoch 5/200
 - 2s - loss: 0.0186 - val_loss: 0.0119
 - val_f1: 0.9905
Epoch 6/200
 - 2s - loss: 0.0174 - val_loss: 0.0115
 - val_f1: 0.9916
Epoch 7/200
 - 2s - loss: 0.0160 - val_loss: 0.0108
 - val_f1: 0.9907
Epoch 8/200
 - 2s - loss: 0.0147 - val_loss: 0.0105
 - val_f1: 0.9909
Epoch 9/200
 - 2s - loss: 0.0139 - val_loss: 0.0094
 - val_f1: 0.9913
Epoch 10/200
 - 2s - loss: 0.0133 - val_loss: 0.0089
 - val_f1: 0.9915
Epoch 11/200
 - 2s - loss: 0.0128 - val_loss: 0.0092
 - val_f1: 0.9935
Epoch 12/200
 - 2s - loss: 0.0121 - val_loss: 0.0094
 - val_f1: 0.9915
Epoch 13/200
 - 2s - loss: 0.0115 - val_loss: 0.0088
 - val_f1: 0.9937
Epoch 14/200
 - 2s - loss: 0.0113 - val_loss: 0.0083
 - val_f1: 0.9941
Epoch 15/200
 - 2s - loss: 0.0110 - val_loss: 0.0081
 - val_f1: 0.9920
Epoch 16/200
 - 2s - loss: 0.0106 - val_loss: 0.0080
 - val_f1: 0.9925
Epoch 17/200
 - 2s - loss: 0.0103 - val_loss: 0.0077
 - val_f1: 0.9947
Epoch 18/200
 - 2s - loss: 0.0105 - val_loss: 0.0071
 - val_f1: 0.9946
Epoch 19/200
 - 2s - loss: 0.0098 - val_loss: 0.0074
 - val_f1: 0.9945
Epoch 20/200
 - 2s - loss: 0.0096 - val_loss: 0.0070
 - val_f1: 0.9947
Epoch 21/200
 - 2s - loss: 0.0088 - val_loss: 0.0073
2020-01-08 14:23:24,246 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_6/ann_model_epoch_20.pickle
 - val_f1: 0.9949
Epoch 22/200
 - 2s - loss: 0.0091 - val_loss: 0.0067
 - val_f1: 0.9953
Epoch 23/200
 - 2s - loss: 0.0086 - val_loss: 0.0066
 - val_f1: 0.9949
Epoch 24/200
 - 2s - loss: 0.0084 - val_loss: 0.0061
 - val_f1: 0.9957
Epoch 25/200
 - 2s - loss: 0.0079 - val_loss: 0.0063
 - val_f1: 0.9958
Epoch 26/200
 - 2s - loss: 0.0080 - val_loss: 0.0066
 - val_f1: 0.9956
Epoch 27/200
 - 2s - loss: 0.0080 - val_loss: 0.0061
 - val_f1: 0.9960
Epoch 28/200
 - 2s - loss: 0.0077 - val_loss: 0.0061
 - val_f1: 0.9958
Epoch 29/200
 - 2s - loss: 0.0074 - val_loss: 0.0060
 - val_f1: 0.9953
Epoch 30/200
 - 2s - loss: 0.0074 - val_loss: 0.0061
 - val_f1: 0.9958
Epoch 31/200
 - 2s - loss: 0.0073 - val_loss: 0.0059
 - val_f1: 0.9960
Epoch 32/200
 - 2s - loss: 0.0071 - val_loss: 0.0060
 - val_f1: 0.9959
Epoch 33/200
 - 2s - loss: 0.0069 - val_loss: 0.0060
 - val_f1: 0.9958
Epoch 34/200
 - 2s - loss: 0.0070 - val_loss: 0.0056
 - val_f1: 0.9960
Epoch 35/200
 - 2s - loss: 0.0071 - val_loss: 0.0060
 - val_f1: 0.9958
Epoch 36/200
 - 2s - loss: 0.0062 - val_loss: 0.0057
 - val_f1: 0.9955
Epoch 37/200
 - 2s - loss: 0.0068 - val_loss: 0.0055
 - val_f1: 0.9963
Epoch 38/200
 - 2s - loss: 0.0065 - val_loss: 0.0057
 - val_f1: 0.9960
Epoch 39/200
 - 2s - loss: 0.0064 - val_loss: 0.0056
 - val_f1: 0.9962
Epoch 40/200
 - 2s - loss: 0.0062 - val_loss: 0.0058
 - val_f1: 0.9963
Epoch 41/200
 - 2s - loss: 0.0064 - val_loss: 0.0056
2020-01-08 14:24:20,539 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_6/ann_model_epoch_40.pickle
 - val_f1: 0.9959
Epoch 42/200
 - 2s - loss: 0.0060 - val_loss: 0.0054
 - val_f1: 0.9960
Epoch 43/200
 - 2s - loss: 0.0059 - val_loss: 0.0056
 - val_f1: 0.9960
Epoch 44/200
 - 2s - loss: 0.0062 - val_loss: 0.0054
 - val_f1: 0.9960
Epoch 45/200
 - 2s - loss: 0.0061 - val_loss: 0.0056
 - val_f1: 0.9961
Epoch 46/200
 - 2s - loss: 0.0062 - val_loss: 0.0052
 - val_f1: 0.9961
Epoch 47/200
 - 2s - loss: 0.0061 - val_loss: 0.0054
 - val_f1: 0.9960
Epoch 48/200
 - 2s - loss: 0.0056 - val_loss: 0.0055
 - val_f1: 0.9960
Epoch 49/200
 - 2s - loss: 0.0058 - val_loss: 0.0055
 - val_f1: 0.9962
Epoch 50/200
 - 2s - loss: 0.0059 - val_loss: 0.0058
 - val_f1: 0.9957
Epoch 51/200
 - 2s - loss: 0.0059 - val_loss: 0.0053
 - val_f1: 0.9959
Epoch 52/200
 - 2s - loss: 0.0058 - val_loss: 0.0051
 - val_f1: 0.9961
Epoch 53/200
 - 2s - loss: 0.0057 - val_loss: 0.0052
 - val_f1: 0.9962
Epoch 54/200
 - 2s - loss: 0.0057 - val_loss: 0.0054
 - val_f1: 0.9964
Epoch 55/200
 - 2s - loss: 0.0055 - val_loss: 0.0058
 - val_f1: 0.9958
Epoch 56/200
 - 2s - loss: 0.0060 - val_loss: 0.0053
 - val_f1: 0.9960
Epoch 57/200
 - 2s - loss: 0.0056 - val_loss: 0.0052
 - val_f1: 0.9960
Epoch 58/200
 - 2s - loss: 0.0054 - val_loss: 0.0056
 - val_f1: 0.9961
Epoch 59/200
 - 2s - loss: 0.0057 - val_loss: 0.0053
 - val_f1: 0.9962
Epoch 60/200
 - 2s - loss: 0.0057 - val_loss: 0.0050
 - val_f1: 0.9962
Epoch 61/200
 - 2s - loss: 0.0057 - val_loss: 0.0049
2020-01-08 14:25:16,667 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_6/ann_model_epoch_60.pickle
 - val_f1: 0.9965
Epoch 62/200
 - 2s - loss: 0.0058 - val_loss: 0.0051
 - val_f1: 0.9964
Epoch 63/200
 - 2s - loss: 0.0055 - val_loss: 0.0050
 - val_f1: 0.9961
Epoch 64/200
 - 2s - loss: 0.0057 - val_loss: 0.0051
 - val_f1: 0.9963
Epoch 65/200
 - 2s - loss: 0.0052 - val_loss: 0.0048
 - val_f1: 0.9963
Epoch 66/200
 - 2s - loss: 0.0056 - val_loss: 0.0050
 - val_f1: 0.9964
Epoch 67/200
 - 2s - loss: 0.0052 - val_loss: 0.0053
 - val_f1: 0.9962
Epoch 68/200
 - 2s - loss: 0.0054 - val_loss: 0.0055
 - val_f1: 0.9963
Epoch 69/200
 - 2s - loss: 0.0052 - val_loss: 0.0050
 - val_f1: 0.9963
Epoch 70/200
 - 2s - loss: 0.0050 - val_loss: 0.0052
 - val_f1: 0.9962
Epoch 71/200
 - 2s - loss: 0.0054 - val_loss: 0.0053
 - val_f1: 0.9962
Epoch 72/200
 - 2s - loss: 0.0053 - val_loss: 0.0055
 - val_f1: 0.9958
Epoch 73/200
 - 2s - loss: 0.0051 - val_loss: 0.0053
 - val_f1: 0.9964
Epoch 74/200
 - 2s - loss: 0.0050 - val_loss: 0.0057
 - val_f1: 0.9960
Epoch 75/200
 - 2s - loss: 0.0052 - val_loss: 0.0054
 - val_f1: 0.9964
Epoch 76/200
 - 2s - loss: 0.0051 - val_loss: 0.0048
 - val_f1: 0.9965
Epoch 77/200
 - 2s - loss: 0.0049 - val_loss: 0.0049
 - val_f1: 0.9965
Epoch 78/200
 - 2s - loss: 0.0050 - val_loss: 0.0051
 - val_f1: 0.9963
Epoch 79/200
 - 2s - loss: 0.0051 - val_loss: 0.0049
 - val_f1: 0.9965
Epoch 80/200
 - 2s - loss: 0.0048 - val_loss: 0.0050
 - val_f1: 0.9964
Epoch 81/200
 - 2s - loss: 0.0049 - val_loss: 0.0051
2020-01-08 14:26:12,875 [INFO] epoch = 80. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_6/ann_model_epoch_80.pickle
 - val_f1: 0.9962
Epoch 82/200
 - 2s - loss: 0.0053 - val_loss: 0.0045
 - val_f1: 0.9965
Epoch 83/200
 - 2s - loss: 0.0051 - val_loss: 0.0046
 - val_f1: 0.9967
Epoch 84/200
 - 2s - loss: 0.0047 - val_loss: 0.0046
 - val_f1: 0.9965
Epoch 85/200
 - 2s - loss: 0.0049 - val_loss: 0.0051
 - val_f1: 0.9960
Epoch 86/200
 - 2s - loss: 0.0046 - val_loss: 0.0047
 - val_f1: 0.9964
Epoch 87/200
 - 2s - loss: 0.0047 - val_loss: 0.0046
 - val_f1: 0.9964
Epoch 88/200
 - 2s - loss: 0.0045 - val_loss: 0.0048
 - val_f1: 0.9964
Epoch 89/200
 - 2s - loss: 0.0046 - val_loss: 0.0048
 - val_f1: 0.9965
Epoch 90/200
 - 2s - loss: 0.0052 - val_loss: 0.0050
 - val_f1: 0.9962
Epoch 91/200
 - 2s - loss: 0.0047 - val_loss: 0.0048
 - val_f1: 0.9963
Epoch 92/200
 - 2s - loss: 0.0044 - val_loss: 0.0049
 - val_f1: 0.9966
Epoch 93/200
 - 2s - loss: 0.0048 - val_loss: 0.0048
 - val_f1: 0.9965
Epoch 94/200
 - 2s - loss: 0.0047 - val_loss: 0.0046
 - val_f1: 0.9963
Epoch 95/200
 - 2s - loss: 0.0044 - val_loss: 0.0050
 - val_f1: 0.9958
Epoch 96/200
 - 2s - loss: 0.0045 - val_loss: 0.0051
 - val_f1: 0.9959
Epoch 97/200
 - 2s - loss: 0.0045 - val_loss: 0.0048
 - val_f1: 0.9964
Epoch 98/200
 - 2s - loss: 0.0045 - val_loss: 0.0049
 - val_f1: 0.9965
Epoch 99/200
 - 2s - loss: 0.0046 - val_loss: 0.0047
 - val_f1: 0.9963
Epoch 100/200
 - 2s - loss: 0.0047 - val_loss: 0.0048
 - val_f1: 0.9964
Epoch 101/200
 - 2s - loss: 0.0042 - val_loss: 0.0045
2020-01-08 14:27:09,099 [INFO] epoch = 100. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_6/ann_model_epoch_100.pickle
 - val_f1: 0.9968
Epoch 102/200
 - 2s - loss: 0.0041 - val_loss: 0.0045
 - val_f1: 0.9966
Epoch 103/200
 - 2s - loss: 0.0044 - val_loss: 0.0049
 - val_f1: 0.9963
Epoch 104/200
 - 2s - loss: 0.0042 - val_loss: 0.0052
 - val_f1: 0.9964
Epoch 105/200
 - 2s - loss: 0.0041 - val_loss: 0.0049
 - val_f1: 0.9965
Epoch 106/200
 - 2s - loss: 0.0045 - val_loss: 0.0050
 - val_f1: 0.9964
Epoch 107/200
 - 2s - loss: 0.0044 - val_loss: 0.0047
 - val_f1: 0.9967
Epoch 108/200
 - 2s - loss: 0.0045 - val_loss: 0.0044
 - val_f1: 0.9967
Epoch 109/200
 - 2s - loss: 0.0045 - val_loss: 0.0045
 - val_f1: 0.9964
Epoch 110/200
 - 2s - loss: 0.0042 - val_loss: 0.0045
 - val_f1: 0.9967
Epoch 111/200
 - 2s - loss: 0.0044 - val_loss: 0.0045
 - val_f1: 0.9962
Epoch 112/200
 - 2s - loss: 0.0042 - val_loss: 0.0047
 - val_f1: 0.9965
Epoch 113/200
 - 2s - loss: 0.0044 - val_loss: 0.0044
 - val_f1: 0.9965
Epoch 114/200
 - 2s - loss: 0.0043 - val_loss: 0.0048
 - val_f1: 0.9965
Epoch 115/200
 - 2s - loss: 0.0042 - val_loss: 0.0047
 - val_f1: 0.9965
Epoch 116/200
 - 2s - loss: 0.0041 - val_loss: 0.0049
 - val_f1: 0.9962
Epoch 117/200
 - 2s - loss: 0.0045 - val_loss: 0.0044
 - val_f1: 0.9968
Epoch 118/200
 - 2s - loss: 0.0043 - val_loss: 0.0046
 - val_f1: 0.9965
Epoch 119/200
 - 2s - loss: 0.0042 - val_loss: 0.0047
 - val_f1: 0.9966
Epoch 120/200
 - 2s - loss: 0.0042 - val_loss: 0.0045
 - val_f1: 0.9964
Epoch 121/200
 - 2s - loss: 0.0045 - val_loss: 0.0046
2020-01-08 14:28:05,212 [INFO] epoch = 120. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_6/ann_model_epoch_120.pickle
 - val_f1: 0.9965
Epoch 122/200
 - 2s - loss: 0.0039 - val_loss: 0.0042
 - val_f1: 0.9967
Epoch 123/200
 - 2s - loss: 0.0041 - val_loss: 0.0047
 - val_f1: 0.9965
Epoch 124/200
 - 2s - loss: 0.0043 - val_loss: 0.0044
 - val_f1: 0.9967
Epoch 125/200
 - 2s - loss: 0.0044 - val_loss: 0.0047
 - val_f1: 0.9965
Epoch 126/200
 - 2s - loss: 0.0040 - val_loss: 0.0044
 - val_f1: 0.9968
Epoch 127/200
 - 2s - loss: 0.0040 - val_loss: 0.0043
 - val_f1: 0.9968
Epoch 128/200
 - 2s - loss: 0.0040 - val_loss: 0.0044
 - val_f1: 0.9964
Epoch 129/200
 - 2s - loss: 0.0044 - val_loss: 0.0042
 - val_f1: 0.9966
Epoch 130/200
 - 2s - loss: 0.0043 - val_loss: 0.0046
 - val_f1: 0.9967
Epoch 131/200
 - 2s - loss: 0.0042 - val_loss: 0.0043
 - val_f1: 0.9968
Epoch 132/200
 - 2s - loss: 0.0042 - val_loss: 0.0045
 - val_f1: 0.9967
Epoch 133/200
 - 2s - loss: 0.0042 - val_loss: 0.0042
 - val_f1: 0.9968
Epoch 134/200
 - 2s - loss: 0.0040 - val_loss: 0.0045
 - val_f1: 0.9964
Epoch 135/200
 - 2s - loss: 0.0040 - val_loss: 0.0046
 - val_f1: 0.9967
Epoch 136/200
 - 2s - loss: 0.0041 - val_loss: 0.0045
 - val_f1: 0.9965
Epoch 137/200
 - 2s - loss: 0.0040 - val_loss: 0.0050
 - val_f1: 0.9963
Epoch 138/200
 - 2s - loss: 0.0041 - val_loss: 0.0044
 - val_f1: 0.9968
Epoch 139/200
 - 2s - loss: 0.0039 - val_loss: 0.0046
 - val_f1: 0.9965
Epoch 140/200
 - 2s - loss: 0.0038 - val_loss: 0.0046
 - val_f1: 0.9969
Epoch 141/200
 - 2s - loss: 0.0039 - val_loss: 0.0045
2020-01-08 14:29:01,479 [INFO] epoch = 140. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_6/ann_model_epoch_140.pickle
 - val_f1: 0.9965
Epoch 142/200
 - 2s - loss: 0.0040 - val_loss: 0.0046
 - val_f1: 0.9965
Epoch 143/200
 - 2s - loss: 0.0040 - val_loss: 0.0045
 - val_f1: 0.9968
Epoch 144/200
 - 2s - loss: 0.0040 - val_loss: 0.0044
 - val_f1: 0.9969
Epoch 145/200
 - 2s - loss: 0.0038 - val_loss: 0.0046
 - val_f1: 0.9967
Epoch 146/200
 - 2s - loss: 0.0038 - val_loss: 0.0042
 - val_f1: 0.9968
Epoch 147/200
 - 2s - loss: 0.0040 - val_loss: 0.0042
 - val_f1: 0.9967
Epoch 148/200
 - 2s - loss: 0.0039 - val_loss: 0.0041
 - val_f1: 0.9967
Epoch 149/200
 - 2s - loss: 0.0038 - val_loss: 0.0040
 - val_f1: 0.9967
Epoch 150/200
 - 2s - loss: 0.0038 - val_loss: 0.0044
 - val_f1: 0.9963
Epoch 151/200
 - 2s - loss: 0.0036 - val_loss: 0.0045
 - val_f1: 0.9967
Epoch 152/200
 - 2s - loss: 0.0038 - val_loss: 0.0045
 - val_f1: 0.9965
Epoch 153/200
 - 2s - loss: 0.0039 - val_loss: 0.0043
 - val_f1: 0.9968
Epoch 154/200
 - 2s - loss: 0.0039 - val_loss: 0.0046
 - val_f1: 0.9962
Epoch 155/200
 - 2s - loss: 0.0037 - val_loss: 0.0041
 - val_f1: 0.9969
Epoch 156/200
 - 2s - loss: 0.0037 - val_loss: 0.0041
 - val_f1: 0.9968
Epoch 157/200
 - 2s - loss: 0.0038 - val_loss: 0.0045
 - val_f1: 0.9967
Epoch 158/200
 - 2s - loss: 0.0038 - val_loss: 0.0043
 - val_f1: 0.9967
Epoch 159/200
 - 2s - loss: 0.0039 - val_loss: 0.0042
 - val_f1: 0.9972
Epoch 160/200
 - 2s - loss: 0.0034 - val_loss: 0.0041
 - val_f1: 0.9970
Epoch 161/200
 - 2s - loss: 0.0038 - val_loss: 0.0043
2020-01-08 14:29:57,784 [INFO] epoch = 160. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_6/ann_model_epoch_160.pickle
 - val_f1: 0.9970
Epoch 162/200
 - 2s - loss: 0.0037 - val_loss: 0.0045
 - val_f1: 0.9967
Epoch 163/200
 - 2s - loss: 0.0037 - val_loss: 0.0043
 - val_f1: 0.9967
Epoch 164/200
 - 2s - loss: 0.0036 - val_loss: 0.0044
 - val_f1: 0.9969
Epoch 165/200
 - 2s - loss: 0.0038 - val_loss: 0.0045
 - val_f1: 0.9967
Epoch 166/200
 - 2s - loss: 0.0037 - val_loss: 0.0043
 - val_f1: 0.9968
Epoch 167/200
 - 2s - loss: 0.0036 - val_loss: 0.0045
 - val_f1: 0.9968
Epoch 168/200
 - 2s - loss: 0.0036 - val_loss: 0.0048
 - val_f1: 0.9968
Epoch 169/200
 - 2s - loss: 0.0038 - val_loss: 0.0044
 - val_f1: 0.9968
Epoch 170/200
 - 2s - loss: 0.0040 - val_loss: 0.0044
 - val_f1: 0.9966
Epoch 171/200
 - 2s - loss: 0.0037 - val_loss: 0.0044
 - val_f1: 0.9968
Epoch 172/200
 - 2s - loss: 0.0037 - val_loss: 0.0043
 - val_f1: 0.9969
Epoch 173/200
 - 2s - loss: 0.0035 - val_loss: 0.0045
 - val_f1: 0.9969
Epoch 174/200
 - 2s - loss: 0.0038 - val_loss: 0.0041
 - val_f1: 0.9969
Epoch 175/200
 - 2s - loss: 0.0038 - val_loss: 0.0042
 - val_f1: 0.9968
Epoch 176/200
 - 2s - loss: 0.0035 - val_loss: 0.0043
 - val_f1: 0.9972
Epoch 177/200
 - 2s - loss: 0.0036 - val_loss: 0.0044
 - val_f1: 0.9966
Epoch 178/200
 - 2s - loss: 0.0036 - val_loss: 0.0045
 - val_f1: 0.9967
Epoch 179/200
 - 2s - loss: 0.0036 - val_loss: 0.0046
 - val_f1: 0.9968
Epoch 180/200
 - 2s - loss: 0.0036 - val_loss: 0.0039
 - val_f1: 0.9970
Epoch 181/200
 - 2s - loss: 0.0036 - val_loss: 0.0042
2020-01-08 14:30:53,955 [INFO] epoch = 180. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_6/ann_model_epoch_180.pickle
 - val_f1: 0.9969
Epoch 182/200
 - 2s - loss: 0.0037 - val_loss: 0.0044
 - val_f1: 0.9967
Epoch 183/200
 - 2s - loss: 0.0035 - val_loss: 0.0048
 - val_f1: 0.9968
Epoch 184/200
 - 2s - loss: 0.0033 - val_loss: 0.0046
 - val_f1: 0.9968
Epoch 185/200
 - 2s - loss: 0.0037 - val_loss: 0.0045
 - val_f1: 0.9969
Epoch 186/200
 - 2s - loss: 0.0037 - val_loss: 0.0043
 - val_f1: 0.9970
Epoch 187/200
 - 2s - loss: 0.0037 - val_loss: 0.0042
 - val_f1: 0.9969
Epoch 188/200
 - 2s - loss: 0.0036 - val_loss: 0.0042
 - val_f1: 0.9970
Epoch 189/200
 - 2s - loss: 0.0036 - val_loss: 0.0042
 - val_f1: 0.9971
Epoch 190/200
 - 2s - loss: 0.0035 - val_loss: 0.0041
 - val_f1: 0.9970
Epoch 191/200
 - 2s - loss: 0.0038 - val_loss: 0.0045
 - val_f1: 0.9969
Epoch 192/200
 - 2s - loss: 0.0032 - val_loss: 0.0051
 - val_f1: 0.9955
Epoch 193/200
 - 2s - loss: 0.0036 - val_loss: 0.0047
 - val_f1: 0.9968
Epoch 194/200
 - 2s - loss: 0.0036 - val_loss: 0.0047
 - val_f1: 0.9965
Epoch 195/200
 - 2s - loss: 0.0036 - val_loss: 0.0046
 - val_f1: 0.9968
Epoch 196/200
 - 2s - loss: 0.0032 - val_loss: 0.0046
 - val_f1: 0.9968
Epoch 197/200
 - 2s - loss: 0.0035 - val_loss: 0.0044
 - val_f1: 0.9966
Epoch 198/200
 - 2s - loss: 0.0035 - val_loss: 0.0045
 - val_f1: 0.9968
Epoch 199/200
 - 2s - loss: 0.0034 - val_loss: 0.0047
 - val_f1: 0.9967
Epoch 200/200
 - 2s - loss: 0.0035 - val_loss: 0.0045
2020-01-08 14:31:47,874 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-08 14:31:51,025 [INFO] Last epoch loss evaluation: train_loss = 0.002229, val_loss = 0.003872
2020-01-08 14:31:51,025 [INFO] Training complete. time_to_train = 572.28 sec, 9.54 min
2020-01-08 14:31:51,036 [INFO] Model saved to results_additional_exps/ann_depth_nsl_layers_6/best_model.pickle
2020-01-08 14:31:51,040 [INFO] Training history saved to: results_additional_exps/ann_depth_nsl_layers_6/training_error_history.csv
2020-01-08 14:31:51,220 [INFO] Plot saved to: results_additional_exps/ann_depth_nsl_layers_6/training_error_history.png
2020-01-08 14:31:51,389 [INFO] Plot saved to: results_additional_exps/ann_depth_nsl_layers_6/training_f1_history.png
2020-01-08 14:31:51,389 [INFO] Making predictions on training, validation, testing data
2020-01-08 14:31:54,319 [INFO] Evaluating predictions (results)
2020-01-08 14:31:54,586 [INFO] Dataset: Testing. Classification report below
2020-01-08 14:31:54,586 [INFO] 
              precision    recall  f1-score   support

         dos       0.96      0.83      0.89      7458
      normal       0.69      0.97      0.80      9711
       probe       0.84      0.73      0.78      2421
         r2l       0.75      0.08      0.15      2421
         u2r       0.90      0.03      0.07       533

   micro avg       0.78      0.78      0.78     22544
   macro avg       0.83      0.53      0.54     22544
weighted avg       0.81      0.78      0.74     22544

2020-01-08 14:31:54,586 [INFO] Overall accuracy (micro avg): 0.7810503903477644
2020-01-08 14:31:54,884 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.7811         0.7811                       0.7811                0.0547                   0.2189  0.7811
1     Macro avg        0.9124         0.8276                       0.5298                0.0741                   0.4702  0.5382
2  Weighted avg        0.8742         0.8057                       0.7811                0.1515                   0.2189  0.7429
2020-01-08 14:31:55,217 [INFO] Dataset: Validation. Classification report below
2020-01-08 14:31:55,217 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00      9186
      normal       1.00      1.00      1.00     13469
       probe       0.99      0.99      0.99      2331
         r2l       0.97      0.89      0.93       199
         u2r       0.83      0.50      0.62        10

   micro avg       1.00      1.00      1.00     25195
   macro avg       0.96      0.88      0.91     25195
weighted avg       1.00      1.00      1.00     25195

2020-01-08 14:31:55,217 [INFO] Overall accuracy (micro avg): 0.9971025997221671
2020-01-08 14:31:55,574 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9971         0.9971                       0.9971                0.0007                   0.0029  0.9971
1     Macro avg        0.9988         0.9582                       0.8760                0.0010                   0.1240  0.9084
2  Weighted avg        0.9982         0.9971                       0.9971                0.0023                   0.0029  0.9971
2020-01-08 14:31:57,020 [INFO] Dataset: Training. Classification report below
2020-01-08 14:31:57,020 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00     36741
      normal       1.00      1.00      1.00     53874
       probe       1.00      0.99      1.00      9325
         r2l       0.97      0.91      0.94       796
         u2r       0.97      0.71      0.82        42

   micro avg       1.00      1.00      1.00    100778
   macro avg       0.99      0.92      0.95    100778
weighted avg       1.00      1.00      1.00    100778

2020-01-08 14:31:57,020 [INFO] Overall accuracy (micro avg): 0.9979360574728612
2020-01-08 14:31:58,646 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9979         0.9979                       0.9979                0.0005                   0.0021  0.9979
1     Macro avg        0.9992         0.9868                       0.9239                0.0008                   0.0761  0.9513
2  Weighted avg        0.9987         0.9979                       0.9979                0.0018                   0.0021  0.9979
2020-01-08 14:31:58,685 [INFO] Results saved to: results_additional_exps/ann_depth_nsl_layers_6/ann_depth_nsl_layers_6_results.xlsx
2020-01-08 14:31:58,686 [INFO] ================= Finished running experiment no. 6 ================= 

2020-01-08 14:31:58,690 [INFO] Created directory: results_additional_exps/ann_depth_nsl_layers_7
2020-01-08 14:31:58,690 [INFO] Initialized logging. log_filename = results_additional_exps/ann_depth_nsl_layers_7/run_log.log
2020-01-08 14:31:58,690 [INFO] ================= Running experiment no. 7  ================= 

2020-01-08 14:31:58,690 [INFO] Experiment parameters given below
2020-01-08 14:31:58,690 [INFO] 
{'experiment_num': 7, 'results_dir': 'results_additional_exps/ann_depth_nsl_layers_7', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [64, 64, 64, 64, 64, 64, 64], 'ann_layer_activations': ['relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu'], 'ann_layer_dropout_rates': [0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2], 'epochs': 200, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/nsl_kdd_five_classes', 'description': 'ann_depth_nsl_layers_7'}
2020-01-08 14:31:58,690 [INFO] Created tensorboard log directory: results_additional_exps/ann_depth_nsl_layers_7/tf_logs_run_2020_01_08-14_31_58
2020-01-08 14:31:58,690 [INFO] Loading datsets from: ../Datasets/small_datasets/nsl_kdd_five_classes
2020-01-08 14:31:58,690 [INFO] Reading X, y files
2020-01-08 14:31:58,690 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_train.h5
2020-01-08 14:31:58,942 [INFO] Reading complete. time_to_read=0.25 seconds
2020-01-08 14:31:58,942 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_val.h5
2020-01-08 14:31:59,006 [INFO] Reading complete. time_to_read=0.06 seconds
2020-01-08 14:31:59,006 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_test.h5
2020-01-08 14:31:59,063 [INFO] Reading complete. time_to_read=0.06 seconds
2020-01-08 14:31:59,063 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_train.h5
2020-01-08 14:31:59,070 [INFO] Reading complete. time_to_read=0.01 seconds
2020-01-08 14:31:59,071 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_val.h5
2020-01-08 14:31:59,075 [INFO] Reading complete. time_to_read=0.00 seconds
2020-01-08 14:31:59,075 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_test.h5
2020-01-08 14:31:59,078 [INFO] Reading complete. time_to_read=0.00 seconds
2020-01-08 14:31:59,268 [INFO] Initializing model
2020-01-08 14:31:59,847 [INFO] _________________________________________________________________
2020-01-08 14:31:59,847 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-08 14:31:59,847 [INFO] =================================================================
2020-01-08 14:31:59,847 [INFO] dense_28 (Dense)             (None, 64)                7872      
2020-01-08 14:31:59,847 [INFO] _________________________________________________________________
2020-01-08 14:31:59,848 [INFO] batch_normalization_22 (Batc (None, 64)                256       
2020-01-08 14:31:59,848 [INFO] _________________________________________________________________
2020-01-08 14:31:59,848 [INFO] dropout_22 (Dropout)         (None, 64)                0         
2020-01-08 14:31:59,848 [INFO] _________________________________________________________________
2020-01-08 14:31:59,848 [INFO] dense_29 (Dense)             (None, 64)                4160      
2020-01-08 14:31:59,848 [INFO] _________________________________________________________________
2020-01-08 14:31:59,848 [INFO] batch_normalization_23 (Batc (None, 64)                256       
2020-01-08 14:31:59,848 [INFO] _________________________________________________________________
2020-01-08 14:31:59,848 [INFO] dropout_23 (Dropout)         (None, 64)                0         
2020-01-08 14:31:59,848 [INFO] _________________________________________________________________
2020-01-08 14:31:59,848 [INFO] dense_30 (Dense)             (None, 64)                4160      
2020-01-08 14:31:59,848 [INFO] _________________________________________________________________
2020-01-08 14:31:59,848 [INFO] batch_normalization_24 (Batc (None, 64)                256       
2020-01-08 14:31:59,848 [INFO] _________________________________________________________________
2020-01-08 14:31:59,848 [INFO] dropout_24 (Dropout)         (None, 64)                0         
2020-01-08 14:31:59,848 [INFO] _________________________________________________________________
2020-01-08 14:31:59,848 [INFO] dense_31 (Dense)             (None, 64)                4160      
2020-01-08 14:31:59,848 [INFO] _________________________________________________________________
2020-01-08 14:31:59,849 [INFO] batch_normalization_25 (Batc (None, 64)                256       
2020-01-08 14:31:59,849 [INFO] _________________________________________________________________
2020-01-08 14:31:59,849 [INFO] dropout_25 (Dropout)         (None, 64)                0         
2020-01-08 14:31:59,849 [INFO] _________________________________________________________________
2020-01-08 14:31:59,849 [INFO] dense_32 (Dense)             (None, 64)                4160      
2020-01-08 14:31:59,849 [INFO] _________________________________________________________________
2020-01-08 14:31:59,849 [INFO] batch_normalization_26 (Batc (None, 64)                256       
2020-01-08 14:31:59,849 [INFO] _________________________________________________________________
2020-01-08 14:31:59,849 [INFO] dropout_26 (Dropout)         (None, 64)                0         
2020-01-08 14:31:59,849 [INFO] _________________________________________________________________
2020-01-08 14:31:59,849 [INFO] dense_33 (Dense)             (None, 64)                4160      
2020-01-08 14:31:59,849 [INFO] _________________________________________________________________
2020-01-08 14:31:59,849 [INFO] batch_normalization_27 (Batc (None, 64)                256       
2020-01-08 14:31:59,849 [INFO] _________________________________________________________________
2020-01-08 14:31:59,849 [INFO] dropout_27 (Dropout)         (None, 64)                0         
2020-01-08 14:31:59,849 [INFO] _________________________________________________________________
2020-01-08 14:31:59,849 [INFO] dense_34 (Dense)             (None, 64)                4160      
2020-01-08 14:31:59,849 [INFO] _________________________________________________________________
2020-01-08 14:31:59,850 [INFO] batch_normalization_28 (Batc (None, 64)                256       
2020-01-08 14:31:59,850 [INFO] _________________________________________________________________
2020-01-08 14:31:59,850 [INFO] dropout_28 (Dropout)         (None, 64)                0         
2020-01-08 14:31:59,850 [INFO] _________________________________________________________________
2020-01-08 14:31:59,850 [INFO] dense_35 (Dense)             (None, 5)                 325       
2020-01-08 14:31:59,850 [INFO] =================================================================
2020-01-08 14:31:59,850 [INFO] Total params: 34,949
2020-01-08 14:31:59,850 [INFO] Trainable params: 34,053
2020-01-08 14:31:59,850 [INFO] Non-trainable params: 896
2020-01-08 14:31:59,850 [INFO] _________________________________________________________________
2020-01-08 14:31:59,850 [INFO] Training model
 - val_f1: 0.9970
Train on 100778 samples, validate on 25195 samples
Epoch 1/200
 - 4s - loss: 0.1399 - val_loss: 0.0334
 - val_f1: 0.9687
Epoch 2/200
 - 3s - loss: 0.0423 - val_loss: 0.0164
 - val_f1: 0.9817
Epoch 3/200
 - 3s - loss: 0.0291 - val_loss: 0.0139
 - val_f1: 0.9881
Epoch 4/200
 - 3s - loss: 0.0240 - val_loss: 0.0130
 - val_f1: 0.9886
Epoch 5/200
 - 3s - loss: 0.0213 - val_loss: 0.0115
 - val_f1: 0.9902
Epoch 6/200
 - 3s - loss: 0.0185 - val_loss: 0.0107
 - val_f1: 0.9912
Epoch 7/200
 - 3s - loss: 0.0171 - val_loss: 0.0101
 - val_f1: 0.9911
Epoch 8/200
 - 3s - loss: 0.0165 - val_loss: 0.0096
 - val_f1: 0.9927
Epoch 9/200
 - 3s - loss: 0.0152 - val_loss: 0.0096
 - val_f1: 0.9915
Epoch 10/200
 - 3s - loss: 0.0139 - val_loss: 0.0092
 - val_f1: 0.9934
Epoch 11/200
 - 3s - loss: 0.0133 - val_loss: 0.0092
 - val_f1: 0.9932
Epoch 12/200
 - 3s - loss: 0.0126 - val_loss: 0.0090
 - val_f1: 0.9926
Epoch 13/200
 - 3s - loss: 0.0127 - val_loss: 0.0084
 - val_f1: 0.9918
Epoch 14/200
 - 3s - loss: 0.0117 - val_loss: 0.0081
 - val_f1: 0.9943
Epoch 15/200
 - 3s - loss: 0.0115 - val_loss: 0.0079
 - val_f1: 0.9943
Epoch 16/200
 - 3s - loss: 0.0110 - val_loss: 0.0083
 - val_f1: 0.9943
Epoch 17/200
 - 3s - loss: 0.0112 - val_loss: 0.0080
 - val_f1: 0.9940
Epoch 18/200
 - 3s - loss: 0.0105 - val_loss: 0.0079
 - val_f1: 0.9936
Epoch 19/200
 - 3s - loss: 0.0106 - val_loss: 0.0075
 - val_f1: 0.9945
Epoch 20/200
 - 3s - loss: 0.0101 - val_loss: 0.0072
 - val_f1: 0.9949
Epoch 21/200
 - 3s - loss: 0.0099 - val_loss: 0.0075
2020-01-08 14:33:16,609 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_7/ann_model_epoch_20.pickle
 - val_f1: 0.9948
Epoch 22/200
 - 3s - loss: 0.0097 - val_loss: 0.0075
 - val_f1: 0.9938
Epoch 23/200
 - 3s - loss: 0.0097 - val_loss: 0.0074
 - val_f1: 0.9939
Epoch 24/200
 - 3s - loss: 0.0092 - val_loss: 0.0071
 - val_f1: 0.9937
Epoch 25/200
 - 3s - loss: 0.0093 - val_loss: 0.0070
 - val_f1: 0.9943
Epoch 26/200
 - 3s - loss: 0.0086 - val_loss: 0.0065
 - val_f1: 0.9949
Epoch 27/200
 - 3s - loss: 0.0088 - val_loss: 0.0073
 - val_f1: 0.9941
Epoch 28/200
 - 3s - loss: 0.0087 - val_loss: 0.0070
 - val_f1: 0.9945
Epoch 29/200
 - 3s - loss: 0.0088 - val_loss: 0.0071
 - val_f1: 0.9939
Epoch 30/200
 - 3s - loss: 0.0082 - val_loss: 0.0061
 - val_f1: 0.9953
Epoch 31/200
 - 3s - loss: 0.0083 - val_loss: 0.0062
 - val_f1: 0.9953
Epoch 32/200
 - 3s - loss: 0.0081 - val_loss: 0.0064
 - val_f1: 0.9949
Epoch 33/200
 - 3s - loss: 0.0081 - val_loss: 0.0062
 - val_f1: 0.9952
Epoch 34/200
 - 3s - loss: 0.0079 - val_loss: 0.0061
 - val_f1: 0.9953
Epoch 35/200
 - 3s - loss: 0.0079 - val_loss: 0.0061
 - val_f1: 0.9957
Epoch 36/200
 - 3s - loss: 0.0077 - val_loss: 0.0061
 - val_f1: 0.9956
Epoch 37/200
 - 3s - loss: 0.0075 - val_loss: 0.0062
 - val_f1: 0.9953
Epoch 38/200
 - 3s - loss: 0.0074 - val_loss: 0.0061
 - val_f1: 0.9951
Epoch 39/200
 - 3s - loss: 0.0075 - val_loss: 0.0063
 - val_f1: 0.9951
Epoch 40/200
 - 3s - loss: 0.0074 - val_loss: 0.0060
 - val_f1: 0.9954
Epoch 41/200
 - 3s - loss: 0.0072 - val_loss: 0.0059
2020-01-08 14:34:21,362 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_7/ann_model_epoch_40.pickle
 - val_f1: 0.9955
Epoch 42/200
 - 3s - loss: 0.0072 - val_loss: 0.0061
 - val_f1: 0.9950
Epoch 43/200
 - 3s - loss: 0.0073 - val_loss: 0.0056
 - val_f1: 0.9956
Epoch 44/200
 - 3s - loss: 0.0072 - val_loss: 0.0055
 - val_f1: 0.9956
Epoch 45/200
 - 3s - loss: 0.0070 - val_loss: 0.0056
 - val_f1: 0.9957
Epoch 46/200
 - 3s - loss: 0.0067 - val_loss: 0.0057
 - val_f1: 0.9956
Epoch 47/200
 - 3s - loss: 0.0067 - val_loss: 0.0054
 - val_f1: 0.9958
Epoch 48/200
 - 3s - loss: 0.0068 - val_loss: 0.0055
 - val_f1: 0.9953
Epoch 49/200
 - 3s - loss: 0.0066 - val_loss: 0.0059
 - val_f1: 0.9957
Epoch 50/200
 - 3s - loss: 0.0068 - val_loss: 0.0052
 - val_f1: 0.9958
Epoch 51/200
 - 3s - loss: 0.0069 - val_loss: 0.0059
 - val_f1: 0.9956
Epoch 52/200
 - 3s - loss: 0.0063 - val_loss: 0.0053
 - val_f1: 0.9959
Epoch 53/200
 - 3s - loss: 0.0069 - val_loss: 0.0053
 - val_f1: 0.9959
Epoch 54/200
 - 3s - loss: 0.0065 - val_loss: 0.0053
 - val_f1: 0.9956
Epoch 55/200
 - 3s - loss: 0.0064 - val_loss: 0.0056
 - val_f1: 0.9956
Epoch 56/200
 - 3s - loss: 0.0064 - val_loss: 0.0054
 - val_f1: 0.9957
Epoch 57/200
 - 3s - loss: 0.0064 - val_loss: 0.0054
 - val_f1: 0.9957
Epoch 58/200
 - 3s - loss: 0.0062 - val_loss: 0.0053
 - val_f1: 0.9956
Epoch 59/200
 - 3s - loss: 0.0063 - val_loss: 0.0050
 - val_f1: 0.9960
Epoch 60/200
 - 3s - loss: 0.0061 - val_loss: 0.0059
 - val_f1: 0.9953
Epoch 61/200
 - 3s - loss: 0.0064 - val_loss: 0.0054
2020-01-08 14:35:26,214 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_7/ann_model_epoch_60.pickle
 - val_f1: 0.9961
Epoch 62/200
 - 3s - loss: 0.0059 - val_loss: 0.0052
 - val_f1: 0.9957
Epoch 63/200
 - 3s - loss: 0.0060 - val_loss: 0.0054
 - val_f1: 0.9956
Epoch 64/200
 - 3s - loss: 0.0060 - val_loss: 0.0051
 - val_f1: 0.9961
Epoch 65/200
 - 3s - loss: 0.0060 - val_loss: 0.0051
 - val_f1: 0.9962
Epoch 66/200
 - 3s - loss: 0.0058 - val_loss: 0.0052
 - val_f1: 0.9959
Epoch 67/200
 - 3s - loss: 0.0060 - val_loss: 0.0054
 - val_f1: 0.9960
Epoch 68/200
 - 3s - loss: 0.0058 - val_loss: 0.0053
 - val_f1: 0.9959
Epoch 69/200
 - 3s - loss: 0.0056 - val_loss: 0.0051
 - val_f1: 0.9958
Epoch 70/200
 - 3s - loss: 0.0058 - val_loss: 0.0052
 - val_f1: 0.9960
Epoch 71/200
 - 3s - loss: 0.0057 - val_loss: 0.0050
 - val_f1: 0.9957
Epoch 72/200
 - 3s - loss: 0.0056 - val_loss: 0.0053
 - val_f1: 0.9958
Epoch 73/200
 - 3s - loss: 0.0055 - val_loss: 0.0053
 - val_f1: 0.9961
Epoch 74/200
 - 3s - loss: 0.0057 - val_loss: 0.0058
 - val_f1: 0.9955
Epoch 75/200
 - 3s - loss: 0.0056 - val_loss: 0.0053
 - val_f1: 0.9958
Epoch 76/200
 - 3s - loss: 0.0055 - val_loss: 0.0049
 - val_f1: 0.9962
Epoch 77/200
 - 3s - loss: 0.0052 - val_loss: 0.0057
 - val_f1: 0.9958
Epoch 78/200
 - 3s - loss: 0.0054 - val_loss: 0.0048
 - val_f1: 0.9959
Epoch 79/200
 - 3s - loss: 0.0056 - val_loss: 0.0051
 - val_f1: 0.9961
Epoch 80/200
 - 3s - loss: 0.0052 - val_loss: 0.0050
 - val_f1: 0.9964
Epoch 81/200
 - 3s - loss: 0.0053 - val_loss: 0.0048
2020-01-08 14:36:31,073 [INFO] epoch = 80. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_7/ann_model_epoch_80.pickle
 - val_f1: 0.9959
Epoch 82/200
 - 3s - loss: 0.0053 - val_loss: 0.0046
 - val_f1: 0.9963
Epoch 83/200
 - 3s - loss: 0.0054 - val_loss: 0.0048
 - val_f1: 0.9963
Epoch 84/200
 - 3s - loss: 0.0051 - val_loss: 0.0046
 - val_f1: 0.9964
Epoch 85/200
 - 3s - loss: 0.0052 - val_loss: 0.0047
 - val_f1: 0.9964
Epoch 86/200
 - 3s - loss: 0.0052 - val_loss: 0.0050
 - val_f1: 0.9962
Epoch 87/200
 - 3s - loss: 0.0056 - val_loss: 0.0048
 - val_f1: 0.9964
Epoch 88/200
 - 3s - loss: 0.0052 - val_loss: 0.0047
 - val_f1: 0.9967
Epoch 89/200
 - 3s - loss: 0.0052 - val_loss: 0.0047
 - val_f1: 0.9963
Epoch 90/200
 - 3s - loss: 0.0049 - val_loss: 0.0047
 - val_f1: 0.9965
Epoch 91/200
 - 3s - loss: 0.0050 - val_loss: 0.0050
 - val_f1: 0.9964
Epoch 92/200
 - 3s - loss: 0.0048 - val_loss: 0.0047
 - val_f1: 0.9965
Epoch 93/200
 - 3s - loss: 0.0052 - val_loss: 0.0046
 - val_f1: 0.9964
Epoch 94/200
 - 3s - loss: 0.0049 - val_loss: 0.0050
 - val_f1: 0.9958
Epoch 95/200
 - 3s - loss: 0.0050 - val_loss: 0.0045
 - val_f1: 0.9964
Epoch 96/200
 - 3s - loss: 0.0051 - val_loss: 0.0048
 - val_f1: 0.9965
Epoch 97/200
 - 3s - loss: 0.0049 - val_loss: 0.0047
 - val_f1: 0.9963
Epoch 98/200
 - 3s - loss: 0.0048 - val_loss: 0.0049
 - val_f1: 0.9962
Epoch 99/200
 - 3s - loss: 0.0049 - val_loss: 0.0046
 - val_f1: 0.9963
Epoch 100/200
 - 3s - loss: 0.0049 - val_loss: 0.0047
 - val_f1: 0.9963
Epoch 101/200
 - 3s - loss: 0.0050 - val_loss: 0.0045
2020-01-08 14:37:35,986 [INFO] epoch = 100. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_7/ann_model_epoch_100.pickle
 - val_f1: 0.9965
Epoch 102/200
 - 3s - loss: 0.0052 - val_loss: 0.0047
 - val_f1: 0.9962
Epoch 103/200
 - 3s - loss: 0.0051 - val_loss: 0.0059
 - val_f1: 0.9950
Epoch 104/200
 - 3s - loss: 0.0050 - val_loss: 0.0046
 - val_f1: 0.9962
Epoch 105/200
 - 3s - loss: 0.0045 - val_loss: 0.0060
 - val_f1: 0.9951
Epoch 106/200
 - 3s - loss: 0.0052 - val_loss: 0.0047
 - val_f1: 0.9961
Epoch 107/200
 - 3s - loss: 0.0051 - val_loss: 0.0046
 - val_f1: 0.9961
Epoch 108/200
 - 3s - loss: 0.0052 - val_loss: 0.0050
 - val_f1: 0.9959
Epoch 109/200
 - 3s - loss: 0.0052 - val_loss: 0.0049
 - val_f1: 0.9960
Epoch 110/200
 - 3s - loss: 0.0050 - val_loss: 0.0050
 - val_f1: 0.9958
Epoch 111/200
 - 3s - loss: 0.0050 - val_loss: 0.0048
 - val_f1: 0.9959
Epoch 112/200
 - 3s - loss: 0.0049 - val_loss: 0.0045
 - val_f1: 0.9965
Epoch 113/200
 - 3s - loss: 0.0050 - val_loss: 0.0044
 - val_f1: 0.9963
Epoch 114/200
 - 3s - loss: 0.0045 - val_loss: 0.0045
 - val_f1: 0.9961
Epoch 115/200
 - 3s - loss: 0.0045 - val_loss: 0.0049
 - val_f1: 0.9956
Epoch 116/200
 - 3s - loss: 0.0047 - val_loss: 0.0043
 - val_f1: 0.9964
Epoch 117/200
 - 3s - loss: 0.0043 - val_loss: 0.0046
 - val_f1: 0.9964
Epoch 118/200
 - 3s - loss: 0.0046 - val_loss: 0.0046
 - val_f1: 0.9964
Epoch 119/200
 - 3s - loss: 0.0045 - val_loss: 0.0046
 - val_f1: 0.9962
Epoch 120/200
 - 3s - loss: 0.0047 - val_loss: 0.0042
 - val_f1: 0.9968
Epoch 121/200
 - 3s - loss: 0.0044 - val_loss: 0.0050
2020-01-08 14:38:41,028 [INFO] epoch = 120. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_7/ann_model_epoch_120.pickle
 - val_f1: 0.9956
Epoch 122/200
 - 3s - loss: 0.0043 - val_loss: 0.0044
 - val_f1: 0.9968
Epoch 123/200
 - 3s - loss: 0.0043 - val_loss: 0.0045
 - val_f1: 0.9970
Epoch 124/200
 - 3s - loss: 0.0044 - val_loss: 0.0044
 - val_f1: 0.9967
Epoch 125/200
 - 3s - loss: 0.0044 - val_loss: 0.0046
 - val_f1: 0.9970
Epoch 126/200
 - 3s - loss: 0.0043 - val_loss: 0.0043
 - val_f1: 0.9967
Epoch 127/200
 - 3s - loss: 0.0044 - val_loss: 0.0044
 - val_f1: 0.9963
Epoch 128/200
 - 3s - loss: 0.0044 - val_loss: 0.0046
 - val_f1: 0.9964
Epoch 129/200
 - 3s - loss: 0.0042 - val_loss: 0.0045
 - val_f1: 0.9968
Epoch 130/200
 - 3s - loss: 0.0045 - val_loss: 0.0046
 - val_f1: 0.9965
Epoch 131/200
 - 3s - loss: 0.0043 - val_loss: 0.0047
 - val_f1: 0.9967
Epoch 132/200
 - 3s - loss: 0.0041 - val_loss: 0.0045
 - val_f1: 0.9969
Epoch 133/200
 - 3s - loss: 0.0043 - val_loss: 0.0047
 - val_f1: 0.9964
Epoch 134/200
 - 3s - loss: 0.0045 - val_loss: 0.0043
 - val_f1: 0.9969
Epoch 135/200
 - 3s - loss: 0.0043 - val_loss: 0.0046
 - val_f1: 0.9969
Epoch 136/200
 - 3s - loss: 0.0044 - val_loss: 0.0043
 - val_f1: 0.9968
Epoch 137/200
 - 3s - loss: 0.0043 - val_loss: 0.0042
 - val_f1: 0.9969
Epoch 138/200
 - 3s - loss: 0.0043 - val_loss: 0.0047
 - val_f1: 0.9967
Epoch 139/200
 - 3s - loss: 0.0044 - val_loss: 0.0045
 - val_f1: 0.9968
Epoch 140/200
 - 3s - loss: 0.0044 - val_loss: 0.0044
 - val_f1: 0.9968
Epoch 141/200
 - 3s - loss: 0.0044 - val_loss: 0.0044
2020-01-08 14:39:46,114 [INFO] epoch = 140. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_7/ann_model_epoch_140.pickle
 - val_f1: 0.9968
Epoch 142/200
 - 3s - loss: 0.0045 - val_loss: 0.0044
 - val_f1: 0.9970
Epoch 143/200
 - 3s - loss: 0.0042 - val_loss: 0.0046
 - val_f1: 0.9969
Epoch 144/200
 - 3s - loss: 0.0042 - val_loss: 0.0044
 - val_f1: 0.9965
Epoch 145/200
 - 3s - loss: 0.0041 - val_loss: 0.0048
 - val_f1: 0.9964
Epoch 146/200
 - 3s - loss: 0.0041 - val_loss: 0.0044
 - val_f1: 0.9969
Epoch 147/200
 - 3s - loss: 0.0041 - val_loss: 0.0045
 - val_f1: 0.9967
Epoch 148/200
 - 3s - loss: 0.0044 - val_loss: 0.0045
 - val_f1: 0.9964
Epoch 149/200
 - 3s - loss: 0.0047 - val_loss: 0.0047
 - val_f1: 0.9970
Epoch 150/200
 - 3s - loss: 0.0041 - val_loss: 0.0047
 - val_f1: 0.9965
Epoch 151/200
 - 3s - loss: 0.0042 - val_loss: 0.0048
 - val_f1: 0.9969
Epoch 152/200
 - 3s - loss: 0.0047 - val_loss: 0.0044
 - val_f1: 0.9973
Epoch 153/200
 - 3s - loss: 0.0042 - val_loss: 0.0042
 - val_f1: 0.9965
Epoch 154/200
 - 3s - loss: 0.0041 - val_loss: 0.0042
 - val_f1: 0.9968
Epoch 155/200
 - 3s - loss: 0.0042 - val_loss: 0.0043
 - val_f1: 0.9966
Epoch 156/200
 - 3s - loss: 0.0040 - val_loss: 0.0044
 - val_f1: 0.9971
Epoch 157/200
 - 3s - loss: 0.0040 - val_loss: 0.0044
 - val_f1: 0.9966
Epoch 158/200
 - 3s - loss: 0.0042 - val_loss: 0.0044
 - val_f1: 0.9970
Epoch 159/200
 - 3s - loss: 0.0043 - val_loss: 0.0046
 - val_f1: 0.9965
Epoch 160/200
 - 3s - loss: 0.0039 - val_loss: 0.0045
 - val_f1: 0.9968
Epoch 161/200
 - 3s - loss: 0.0038 - val_loss: 0.0046
2020-01-08 14:40:51,043 [INFO] epoch = 160. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_7/ann_model_epoch_160.pickle
 - val_f1: 0.9968
Epoch 162/200
 - 3s - loss: 0.0043 - val_loss: 0.0045
 - val_f1: 0.9969
Epoch 163/200
 - 3s - loss: 0.0044 - val_loss: 0.0046
 - val_f1: 0.9969
Epoch 164/200
 - 3s - loss: 0.0042 - val_loss: 0.0046
 - val_f1: 0.9971
Epoch 165/200
 - 3s - loss: 0.0040 - val_loss: 0.0046
 - val_f1: 0.9966
Epoch 166/200
 - 3s - loss: 0.0038 - val_loss: 0.0045
 - val_f1: 0.9968
Epoch 167/200
 - 3s - loss: 0.0040 - val_loss: 0.0044
 - val_f1: 0.9970
Epoch 168/200
 - 3s - loss: 0.0039 - val_loss: 0.0046
 - val_f1: 0.9966
Epoch 169/200
 - 3s - loss: 0.0037 - val_loss: 0.0047
 - val_f1: 0.9967
Epoch 170/200
 - 3s - loss: 0.0039 - val_loss: 0.0047
2020-01-08 14:41:20,829 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-08 14:41:24,515 [INFO] Last epoch loss evaluation: train_loss = 0.002810, val_loss = 0.004186
2020-01-08 14:41:24,515 [INFO] Training complete. time_to_train = 564.66 sec, 9.41 min
2020-01-08 14:41:24,529 [INFO] Model saved to results_additional_exps/ann_depth_nsl_layers_7/best_model.pickle
2020-01-08 14:41:24,532 [INFO] Training history saved to: results_additional_exps/ann_depth_nsl_layers_7/training_error_history.csv
2020-01-08 14:41:24,715 [INFO] Plot saved to: results_additional_exps/ann_depth_nsl_layers_7/training_error_history.png
2020-01-08 14:41:24,883 [INFO] Plot saved to: results_additional_exps/ann_depth_nsl_layers_7/training_f1_history.png
2020-01-08 14:41:24,884 [INFO] Making predictions on training, validation, testing data
2020-01-08 14:41:28,236 [INFO] Evaluating predictions (results)
2020-01-08 14:41:28,504 [INFO] Dataset: Testing. Classification report below
2020-01-08 14:41:28,505 [INFO] 
              precision    recall  f1-score   support

         dos       0.97      0.85      0.90      7458
      normal       0.68      0.96      0.79      9711
       probe       0.81      0.69      0.74      2421
         r2l       0.85      0.07      0.13      2421
         u2r       0.79      0.04      0.08       533

   micro avg       0.78      0.78      0.78     22544
   macro avg       0.82      0.52      0.53     22544
weighted avg       0.81      0.78      0.74     22544

2020-01-08 14:41:28,506 [INFO] Overall accuracy (micro avg): 0.77541696238467
2020-01-08 14:41:28,803 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.7754         0.7754                       0.7754                0.0561                   0.2246  0.7754
1     Macro avg        0.9102         0.8193                       0.5214                0.0760                   0.4786  0.5308
2  Weighted avg        0.8710         0.8087                       0.7754                0.1554                   0.2246  0.7367
2020-01-08 14:41:29,136 [INFO] Dataset: Validation. Classification report below
2020-01-08 14:41:29,136 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00      9186
      normal       1.00      1.00      1.00     13469
       probe       1.00      0.99      0.99      2331
         r2l       0.97      0.89      0.93       199
         u2r       0.83      0.50      0.62        10

   micro avg       1.00      1.00      1.00     25195
   macro avg       0.96      0.88      0.91     25195
weighted avg       1.00      1.00      1.00     25195

2020-01-08 14:41:29,136 [INFO] Overall accuracy (micro avg): 0.9968247668188133
2020-01-08 14:41:29,492 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9968         0.9968                       0.9968                0.0008                   0.0032  0.9968
1     Macro avg        0.9987         0.9595                       0.8759                0.0012                   0.1241  0.9090
2  Weighted avg        0.9980         0.9968                       0.9968                0.0029                   0.0032  0.9968
2020-01-08 14:41:30,934 [INFO] Dataset: Training. Classification report below
2020-01-08 14:41:30,934 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00     36741
      normal       1.00      1.00      1.00     53874
       probe       1.00      0.99      0.99      9325
         r2l       0.98      0.89      0.93       796
         u2r       0.85      0.69      0.76        42

   micro avg       1.00      1.00      1.00    100778
   macro avg       0.96      0.91      0.94    100778
weighted avg       1.00      1.00      1.00    100778

2020-01-08 14:41:30,934 [INFO] Overall accuracy (micro avg): 0.9973903034392427
2020-01-08 14:41:32,555 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9974         0.9974                       0.9974                0.0007                   0.0026  0.9974
1     Macro avg        0.9990         0.9650                       0.9132                0.0010                   0.0868  0.9369
2  Weighted avg        0.9984         0.9974                       0.9974                0.0026                   0.0026  0.9974
2020-01-08 14:41:32,593 [INFO] Results saved to: results_additional_exps/ann_depth_nsl_layers_7/ann_depth_nsl_layers_7_results.xlsx
2020-01-08 14:41:32,594 [INFO] ================= Finished running experiment no. 7 ================= 

2020-01-08 14:41:32,597 [INFO] Created directory: results_additional_exps/ann_depth_nsl_layers_8
2020-01-08 14:41:32,597 [INFO] Initialized logging. log_filename = results_additional_exps/ann_depth_nsl_layers_8/run_log.log
2020-01-08 14:41:32,597 [INFO] ================= Running experiment no. 8  ================= 

2020-01-08 14:41:32,597 [INFO] Experiment parameters given below
2020-01-08 14:41:32,597 [INFO] 
{'experiment_num': 8, 'results_dir': 'results_additional_exps/ann_depth_nsl_layers_8', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [64, 64, 64, 64, 64, 64, 64, 64], 'ann_layer_activations': ['relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu'], 'ann_layer_dropout_rates': [0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2], 'epochs': 200, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/nsl_kdd_five_classes', 'description': 'ann_depth_nsl_layers_8'}
2020-01-08 14:41:32,597 [INFO] Created tensorboard log directory: results_additional_exps/ann_depth_nsl_layers_8/tf_logs_run_2020_01_08-14_41_32
2020-01-08 14:41:32,597 [INFO] Loading datsets from: ../Datasets/small_datasets/nsl_kdd_five_classes
2020-01-08 14:41:32,598 [INFO] Reading X, y files
2020-01-08 14:41:32,598 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_train.h5
2020-01-08 14:41:32,849 [INFO] Reading complete. time_to_read=0.25 seconds
2020-01-08 14:41:32,849 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_val.h5
2020-01-08 14:41:32,912 [INFO] Reading complete. time_to_read=0.06 seconds
2020-01-08 14:41:32,912 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_test.h5
2020-01-08 14:41:32,972 [INFO] Reading complete. time_to_read=0.06 seconds
2020-01-08 14:41:32,972 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_train.h5
2020-01-08 14:41:32,980 [INFO] Reading complete. time_to_read=0.01 seconds
2020-01-08 14:41:32,980 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_val.h5
2020-01-08 14:41:32,984 [INFO] Reading complete. time_to_read=0.00 seconds
2020-01-08 14:41:32,984 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_test.h5
2020-01-08 14:41:32,987 [INFO] Reading complete. time_to_read=0.00 seconds
2020-01-08 14:41:33,176 [INFO] Initializing model
2020-01-08 14:41:33,850 [INFO] _________________________________________________________________
2020-01-08 14:41:33,853 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-08 14:41:33,853 [INFO] =================================================================
2020-01-08 14:41:33,853 [INFO] dense_36 (Dense)             (None, 64)                7872      
2020-01-08 14:41:33,853 [INFO] _________________________________________________________________
2020-01-08 14:41:33,853 [INFO] batch_normalization_29 (Batc (None, 64)                256       
2020-01-08 14:41:33,853 [INFO] _________________________________________________________________
2020-01-08 14:41:33,853 [INFO] dropout_29 (Dropout)         (None, 64)                0         
2020-01-08 14:41:33,853 [INFO] _________________________________________________________________
2020-01-08 14:41:33,853 [INFO] dense_37 (Dense)             (None, 64)                4160      
2020-01-08 14:41:33,853 [INFO] _________________________________________________________________
2020-01-08 14:41:33,853 [INFO] batch_normalization_30 (Batc (None, 64)                256       
2020-01-08 14:41:33,853 [INFO] _________________________________________________________________
2020-01-08 14:41:33,853 [INFO] dropout_30 (Dropout)         (None, 64)                0         
2020-01-08 14:41:33,853 [INFO] _________________________________________________________________
2020-01-08 14:41:33,853 [INFO] dense_38 (Dense)             (None, 64)                4160      
2020-01-08 14:41:33,853 [INFO] _________________________________________________________________
2020-01-08 14:41:33,854 [INFO] batch_normalization_31 (Batc (None, 64)                256       
2020-01-08 14:41:33,854 [INFO] _________________________________________________________________
2020-01-08 14:41:33,854 [INFO] dropout_31 (Dropout)         (None, 64)                0         
2020-01-08 14:41:33,854 [INFO] _________________________________________________________________
2020-01-08 14:41:33,854 [INFO] dense_39 (Dense)             (None, 64)                4160      
2020-01-08 14:41:33,854 [INFO] _________________________________________________________________
2020-01-08 14:41:33,854 [INFO] batch_normalization_32 (Batc (None, 64)                256       
2020-01-08 14:41:33,854 [INFO] _________________________________________________________________
2020-01-08 14:41:33,854 [INFO] dropout_32 (Dropout)         (None, 64)                0         
2020-01-08 14:41:33,854 [INFO] _________________________________________________________________
2020-01-08 14:41:33,854 [INFO] dense_40 (Dense)             (None, 64)                4160      
2020-01-08 14:41:33,854 [INFO] _________________________________________________________________
2020-01-08 14:41:33,854 [INFO] batch_normalization_33 (Batc (None, 64)                256       
2020-01-08 14:41:33,854 [INFO] _________________________________________________________________
2020-01-08 14:41:33,854 [INFO] dropout_33 (Dropout)         (None, 64)                0         
2020-01-08 14:41:33,854 [INFO] _________________________________________________________________
2020-01-08 14:41:33,854 [INFO] dense_41 (Dense)             (None, 64)                4160      
2020-01-08 14:41:33,854 [INFO] _________________________________________________________________
2020-01-08 14:41:33,855 [INFO] batch_normalization_34 (Batc (None, 64)                256       
2020-01-08 14:41:33,855 [INFO] _________________________________________________________________
2020-01-08 14:41:33,855 [INFO] dropout_34 (Dropout)         (None, 64)                0         
2020-01-08 14:41:33,855 [INFO] _________________________________________________________________
2020-01-08 14:41:33,855 [INFO] dense_42 (Dense)             (None, 64)                4160      
2020-01-08 14:41:33,855 [INFO] _________________________________________________________________
2020-01-08 14:41:33,855 [INFO] batch_normalization_35 (Batc (None, 64)                256       
2020-01-08 14:41:33,855 [INFO] _________________________________________________________________
2020-01-08 14:41:33,855 [INFO] dropout_35 (Dropout)         (None, 64)                0         
2020-01-08 14:41:33,855 [INFO] _________________________________________________________________
2020-01-08 14:41:33,855 [INFO] dense_43 (Dense)             (None, 64)                4160      
2020-01-08 14:41:33,855 [INFO] _________________________________________________________________
2020-01-08 14:41:33,855 [INFO] batch_normalization_36 (Batc (None, 64)                256       
2020-01-08 14:41:33,855 [INFO] _________________________________________________________________
2020-01-08 14:41:33,855 [INFO] dropout_36 (Dropout)         (None, 64)                0         
2020-01-08 14:41:33,855 [INFO] _________________________________________________________________
2020-01-08 14:41:33,855 [INFO] dense_44 (Dense)             (None, 5)                 325       
2020-01-08 14:41:33,855 [INFO] =================================================================
2020-01-08 14:41:33,856 [INFO] Total params: 39,365
2020-01-08 14:41:33,856 [INFO] Trainable params: 38,341
2020-01-08 14:41:33,856 [INFO] Non-trainable params: 1,024
2020-01-08 14:41:33,856 [INFO] _________________________________________________________________
2020-01-08 14:41:33,856 [INFO] Training model
 - val_f1: 0.9969
Epoch 00170: early stopping
Train on 100778 samples, validate on 25195 samples
Epoch 1/200
 - 4s - loss: 0.1622 - val_loss: 0.0493
 - val_f1: 0.9688
Epoch 2/200
 - 3s - loss: 0.0498 - val_loss: 0.0221
 - val_f1: 0.9789
Epoch 3/200
 - 3s - loss: 0.0335 - val_loss: 0.0162
 - val_f1: 0.9855
Epoch 4/200
 - 3s - loss: 0.0270 - val_loss: 0.0135
 - val_f1: 0.9903
Epoch 5/200
 - 3s - loss: 0.0222 - val_loss: 0.0125
 - val_f1: 0.9899
Epoch 6/200
 - 3s - loss: 0.0202 - val_loss: 0.0117
 - val_f1: 0.9900
Epoch 7/200
 - 3s - loss: 0.0185 - val_loss: 0.0112
 - val_f1: 0.9913
Epoch 8/200
 - 3s - loss: 0.0174 - val_loss: 0.0111
 - val_f1: 0.9903
Epoch 9/200
 - 3s - loss: 0.0159 - val_loss: 0.0105
 - val_f1: 0.9913
Epoch 10/200
 - 3s - loss: 0.0155 - val_loss: 0.0099
 - val_f1: 0.9928
Epoch 11/200
 - 3s - loss: 0.0144 - val_loss: 0.0099
 - val_f1: 0.9912
Epoch 12/200
 - 3s - loss: 0.0140 - val_loss: 0.0092
 - val_f1: 0.9927
Epoch 13/200
 - 3s - loss: 0.0131 - val_loss: 0.0094
 - val_f1: 0.9927
Epoch 14/200
 - 3s - loss: 0.0131 - val_loss: 0.0091
 - val_f1: 0.9930
Epoch 15/200
 - 3s - loss: 0.0128 - val_loss: 0.0088
 - val_f1: 0.9942
Epoch 16/200
 - 3s - loss: 0.0121 - val_loss: 0.0086
 - val_f1: 0.9939
Epoch 17/200
 - 3s - loss: 0.0116 - val_loss: 0.0087
 - val_f1: 0.9930
Epoch 18/200
 - 3s - loss: 0.0117 - val_loss: 0.0087
 - val_f1: 0.9923
Epoch 19/200
 - 3s - loss: 0.0111 - val_loss: 0.0085
 - val_f1: 0.9930
Epoch 20/200
 - 3s - loss: 0.0108 - val_loss: 0.0082
 - val_f1: 0.9927
Epoch 21/200
 - 3s - loss: 0.0107 - val_loss: 0.0086
2020-01-08 14:43:02,738 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_8/ann_model_epoch_20.pickle
 - val_f1: 0.9936
Epoch 22/200
 - 3s - loss: 0.0108 - val_loss: 0.0085
 - val_f1: 0.9934
Epoch 23/200
 - 3s - loss: 0.0104 - val_loss: 0.0081
 - val_f1: 0.9943
Epoch 24/200
 - 3s - loss: 0.0100 - val_loss: 0.0086
 - val_f1: 0.9945
Epoch 25/200
 - 3s - loss: 0.0099 - val_loss: 0.0081
 - val_f1: 0.9942
Epoch 26/200
 - 3s - loss: 0.0098 - val_loss: 0.0077
 - val_f1: 0.9943
Epoch 27/200
 - 3s - loss: 0.0097 - val_loss: 0.0074
 - val_f1: 0.9942
Epoch 28/200
 - 3s - loss: 0.0092 - val_loss: 0.0073
 - val_f1: 0.9950
Epoch 29/200
 - 3s - loss: 0.0093 - val_loss: 0.0075
 - val_f1: 0.9949
Epoch 30/200
 - 3s - loss: 0.0094 - val_loss: 0.0071
 - val_f1: 0.9943
Epoch 31/200
 - 3s - loss: 0.0087 - val_loss: 0.0066
 - val_f1: 0.9950
Epoch 32/200
 - 3s - loss: 0.0084 - val_loss: 0.0066
 - val_f1: 0.9951
Epoch 33/200
 - 3s - loss: 0.0087 - val_loss: 0.0074
 - val_f1: 0.9950
Epoch 34/200
 - 3s - loss: 0.0091 - val_loss: 0.0065
 - val_f1: 0.9952
Epoch 35/200
 - 3s - loss: 0.0082 - val_loss: 0.0070
 - val_f1: 0.9947
Epoch 36/200
 - 3s - loss: 0.0080 - val_loss: 0.0070
 - val_f1: 0.9943
Epoch 37/200
 - 3s - loss: 0.0078 - val_loss: 0.0065
 - val_f1: 0.9950
Epoch 38/200
 - 3s - loss: 0.0081 - val_loss: 0.0067
 - val_f1: 0.9948
Epoch 39/200
 - 3s - loss: 0.0077 - val_loss: 0.0066
 - val_f1: 0.9950
Epoch 40/200
 - 3s - loss: 0.0079 - val_loss: 0.0063
 - val_f1: 0.9953
Epoch 41/200
 - 3s - loss: 0.0081 - val_loss: 0.0065
2020-01-08 14:44:16,788 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_8/ann_model_epoch_40.pickle
 - val_f1: 0.9946
Epoch 42/200
 - 3s - loss: 0.0078 - val_loss: 0.0066
 - val_f1: 0.9955
Epoch 43/200
 - 3s - loss: 0.0073 - val_loss: 0.0063
 - val_f1: 0.9955
Epoch 44/200
 - 3s - loss: 0.0074 - val_loss: 0.0060
 - val_f1: 0.9955
Epoch 45/200
 - 3s - loss: 0.0069 - val_loss: 0.0060
 - val_f1: 0.9957
Epoch 46/200
 - 3s - loss: 0.0069 - val_loss: 0.0056
 - val_f1: 0.9960
Epoch 47/200
 - 3s - loss: 0.0069 - val_loss: 0.0062
 - val_f1: 0.9954
Epoch 48/200
 - 3s - loss: 0.0070 - val_loss: 0.0053
 - val_f1: 0.9961
Epoch 49/200
 - 3s - loss: 0.0069 - val_loss: 0.0061
 - val_f1: 0.9956
Epoch 50/200
 - 3s - loss: 0.0067 - val_loss: 0.0060
 - val_f1: 0.9959
Epoch 51/200
 - 3s - loss: 0.0068 - val_loss: 0.0058
 - val_f1: 0.9958
Epoch 52/200
 - 3s - loss: 0.0064 - val_loss: 0.0055
 - val_f1: 0.9956
Epoch 53/200
 - 3s - loss: 0.0064 - val_loss: 0.0056
 - val_f1: 0.9959
Epoch 54/200
 - 3s - loss: 0.0064 - val_loss: 0.0054
 - val_f1: 0.9961
Epoch 55/200
 - 3s - loss: 0.0066 - val_loss: 0.0056
 - val_f1: 0.9959
Epoch 56/200
 - 3s - loss: 0.0066 - val_loss: 0.0061
 - val_f1: 0.9951
Epoch 57/200
 - 3s - loss: 0.0065 - val_loss: 0.0054
 - val_f1: 0.9963
Epoch 58/200
 - 3s - loss: 0.0066 - val_loss: 0.0058
 - val_f1: 0.9962
Epoch 59/200
 - 3s - loss: 0.0063 - val_loss: 0.0054
 - val_f1: 0.9966
Epoch 60/200
 - 3s - loss: 0.0062 - val_loss: 0.0054
 - val_f1: 0.9965
Epoch 61/200
 - 3s - loss: 0.0062 - val_loss: 0.0058
2020-01-08 14:45:30,879 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_8/ann_model_epoch_60.pickle
 - val_f1: 0.9961
Epoch 62/200
 - 3s - loss: 0.0063 - val_loss: 0.0052
 - val_f1: 0.9961
Epoch 63/200
 - 3s - loss: 0.0059 - val_loss: 0.0057
 - val_f1: 0.9961
Epoch 64/200
 - 3s - loss: 0.0062 - val_loss: 0.0054
 - val_f1: 0.9964
Epoch 65/200
 - 3s - loss: 0.0058 - val_loss: 0.0053
 - val_f1: 0.9962
Epoch 66/200
 - 3s - loss: 0.0059 - val_loss: 0.0056
 - val_f1: 0.9960
Epoch 67/200
 - 3s - loss: 0.0059 - val_loss: 0.0053
 - val_f1: 0.9960
Epoch 68/200
 - 3s - loss: 0.0059 - val_loss: 0.0051
 - val_f1: 0.9965
Epoch 69/200
 - 3s - loss: 0.0059 - val_loss: 0.0049
 - val_f1: 0.9967
Epoch 70/200
 - 3s - loss: 0.0056 - val_loss: 0.0052
 - val_f1: 0.9965
Epoch 71/200
 - 3s - loss: 0.0057 - val_loss: 0.0054
 - val_f1: 0.9964
Epoch 72/200
 - 3s - loss: 0.0058 - val_loss: 0.0050
 - val_f1: 0.9964
Epoch 73/200
 - 3s - loss: 0.0057 - val_loss: 0.0050
 - val_f1: 0.9961
Epoch 74/200
 - 3s - loss: 0.0058 - val_loss: 0.0047
 - val_f1: 0.9966
Epoch 75/200
 - 3s - loss: 0.0056 - val_loss: 0.0056
 - val_f1: 0.9961
Epoch 76/200
 - 3s - loss: 0.0057 - val_loss: 0.0054
 - val_f1: 0.9962
Epoch 77/200
 - 3s - loss: 0.0054 - val_loss: 0.0050
 - val_f1: 0.9962
Epoch 78/200
 - 3s - loss: 0.0056 - val_loss: 0.0049
 - val_f1: 0.9963
Epoch 79/200
 - 3s - loss: 0.0056 - val_loss: 0.0051
 - val_f1: 0.9964
Epoch 80/200
 - 3s - loss: 0.0052 - val_loss: 0.0050
 - val_f1: 0.9963
Epoch 81/200
 - 3s - loss: 0.0054 - val_loss: 0.0049
2020-01-08 14:46:44,880 [INFO] epoch = 80. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_8/ann_model_epoch_80.pickle
 - val_f1: 0.9962
Epoch 82/200
 - 3s - loss: 0.0054 - val_loss: 0.0050
 - val_f1: 0.9963
Epoch 83/200
 - 3s - loss: 0.0058 - val_loss: 0.0049
 - val_f1: 0.9962
Epoch 84/200
 - 3s - loss: 0.0052 - val_loss: 0.0052
 - val_f1: 0.9965
Epoch 85/200
 - 3s - loss: 0.0052 - val_loss: 0.0051
 - val_f1: 0.9961
Epoch 86/200
 - 3s - loss: 0.0052 - val_loss: 0.0049
 - val_f1: 0.9962
Epoch 87/200
 - 3s - loss: 0.0052 - val_loss: 0.0051
 - val_f1: 0.9960
Epoch 88/200
 - 3s - loss: 0.0053 - val_loss: 0.0051
 - val_f1: 0.9958
Epoch 89/200
 - 3s - loss: 0.0056 - val_loss: 0.0048
 - val_f1: 0.9966
Epoch 90/200
 - 3s - loss: 0.0052 - val_loss: 0.0048
 - val_f1: 0.9966
Epoch 91/200
 - 3s - loss: 0.0049 - val_loss: 0.0050
 - val_f1: 0.9964
Epoch 92/200
 - 3s - loss: 0.0049 - val_loss: 0.0047
 - val_f1: 0.9963
Epoch 93/200
 - 3s - loss: 0.0051 - val_loss: 0.0045
 - val_f1: 0.9962
Epoch 94/200
 - 3s - loss: 0.0052 - val_loss: 0.0046
 - val_f1: 0.9967
Epoch 95/200
 - 3s - loss: 0.0051 - val_loss: 0.0046
 - val_f1: 0.9965
Epoch 96/200
 - 3s - loss: 0.0052 - val_loss: 0.0046
 - val_f1: 0.9965
Epoch 97/200
 - 3s - loss: 0.0052 - val_loss: 0.0048
 - val_f1: 0.9963
Epoch 98/200
 - 3s - loss: 0.0050 - val_loss: 0.0048
 - val_f1: 0.9963
Epoch 99/200
 - 3s - loss: 0.0047 - val_loss: 0.0048
 - val_f1: 0.9966
Epoch 100/200
 - 3s - loss: 0.0050 - val_loss: 0.0048
 - val_f1: 0.9966
Epoch 101/200
 - 3s - loss: 0.0049 - val_loss: 0.0049
2020-01-08 14:47:58,856 [INFO] epoch = 100. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_8/ann_model_epoch_100.pickle
 - val_f1: 0.9966
Epoch 102/200
 - 3s - loss: 0.0049 - val_loss: 0.0047
 - val_f1: 0.9968
Epoch 103/200
 - 3s - loss: 0.0050 - val_loss: 0.0046
 - val_f1: 0.9962
Epoch 104/200
 - 3s - loss: 0.0048 - val_loss: 0.0047
 - val_f1: 0.9964
Epoch 105/200
 - 3s - loss: 0.0050 - val_loss: 0.0048
 - val_f1: 0.9965
Epoch 106/200
 - 3s - loss: 0.0048 - val_loss: 0.0049
 - val_f1: 0.9966
Epoch 107/200
 - 3s - loss: 0.0048 - val_loss: 0.0046
 - val_f1: 0.9967
Epoch 108/200
 - 3s - loss: 0.0047 - val_loss: 0.0048
 - val_f1: 0.9967
Epoch 109/200
 - 3s - loss: 0.0048 - val_loss: 0.0047
 - val_f1: 0.9965
Epoch 110/200
 - 3s - loss: 0.0047 - val_loss: 0.0047
 - val_f1: 0.9965
Epoch 111/200
 - 3s - loss: 0.0048 - val_loss: 0.0048
 - val_f1: 0.9964
Epoch 112/200
 - 3s - loss: 0.0048 - val_loss: 0.0047
 - val_f1: 0.9963
Epoch 113/200
 - 3s - loss: 0.0045 - val_loss: 0.0046
 - val_f1: 0.9966
Epoch 114/200
 - 3s - loss: 0.0044 - val_loss: 0.0045
 - val_f1: 0.9966
Epoch 115/200
 - 3s - loss: 0.0047 - val_loss: 0.0048
 - val_f1: 0.9966
Epoch 116/200
 - 3s - loss: 0.0042 - val_loss: 0.0044
 - val_f1: 0.9968
Epoch 117/200
 - 3s - loss: 0.0045 - val_loss: 0.0050
 - val_f1: 0.9963
Epoch 118/200
 - 3s - loss: 0.0050 - val_loss: 0.0048
 - val_f1: 0.9966
Epoch 119/200
 - 3s - loss: 0.0046 - val_loss: 0.0051
 - val_f1: 0.9959
Epoch 120/200
 - 3s - loss: 0.0048 - val_loss: 0.0052
 - val_f1: 0.9962
Epoch 121/200
 - 3s - loss: 0.0048 - val_loss: 0.0045
2020-01-08 14:49:12,669 [INFO] epoch = 120. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_8/ann_model_epoch_120.pickle
 - val_f1: 0.9969
Epoch 122/200
 - 3s - loss: 0.0043 - val_loss: 0.0045
 - val_f1: 0.9962
Epoch 123/200
 - 3s - loss: 0.0046 - val_loss: 0.0044
 - val_f1: 0.9968
Epoch 124/200
 - 3s - loss: 0.0044 - val_loss: 0.0045
 - val_f1: 0.9965
Epoch 125/200
 - 3s - loss: 0.0045 - val_loss: 0.0044
 - val_f1: 0.9967
Epoch 126/200
 - 3s - loss: 0.0046 - val_loss: 0.0046
 - val_f1: 0.9967
Epoch 127/200
 - 3s - loss: 0.0046 - val_loss: 0.0045
 - val_f1: 0.9964
Epoch 128/200
 - 3s - loss: 0.0045 - val_loss: 0.0048
 - val_f1: 0.9965
Epoch 129/200
 - 3s - loss: 0.0047 - val_loss: 0.0046
 - val_f1: 0.9965
Epoch 130/200
 - 3s - loss: 0.0044 - val_loss: 0.0045
 - val_f1: 0.9965
Epoch 131/200
 - 3s - loss: 0.0045 - val_loss: 0.0047
 - val_f1: 0.9966
Epoch 132/200
 - 3s - loss: 0.0044 - val_loss: 0.0045
 - val_f1: 0.9964
Epoch 133/200
 - 3s - loss: 0.0045 - val_loss: 0.0047
 - val_f1: 0.9967
Epoch 134/200
 - 3s - loss: 0.0046 - val_loss: 0.0047
 - val_f1: 0.9965
Epoch 135/200
 - 3s - loss: 0.0047 - val_loss: 0.0050
 - val_f1: 0.9961
Epoch 136/200
 - 3s - loss: 0.0049 - val_loss: 0.0046
 - val_f1: 0.9961
Epoch 137/200
 - 3s - loss: 0.0047 - val_loss: 0.0044
 - val_f1: 0.9963
Epoch 138/200
 - 3s - loss: 0.0045 - val_loss: 0.0046
 - val_f1: 0.9966
Epoch 139/200
 - 3s - loss: 0.0042 - val_loss: 0.0047
 - val_f1: 0.9965
Epoch 140/200
 - 3s - loss: 0.0046 - val_loss: 0.0045
 - val_f1: 0.9965
Epoch 141/200
 - 3s - loss: 0.0041 - val_loss: 0.0044
2020-01-08 14:50:26,545 [INFO] epoch = 140. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_8/ann_model_epoch_140.pickle
 - val_f1: 0.9968
Epoch 142/200
 - 3s - loss: 0.0042 - val_loss: 0.0046
 - val_f1: 0.9969
Epoch 143/200
 - 3s - loss: 0.0043 - val_loss: 0.0045
 - val_f1: 0.9968
Epoch 144/200
 - 3s - loss: 0.0044 - val_loss: 0.0048
 - val_f1: 0.9964
Epoch 145/200
 - 3s - loss: 0.0044 - val_loss: 0.0044
 - val_f1: 0.9968
Epoch 146/200
 - 3s - loss: 0.0042 - val_loss: 0.0046
 - val_f1: 0.9965
Epoch 147/200
 - 3s - loss: 0.0043 - val_loss: 0.0046
 - val_f1: 0.9970
Epoch 148/200
 - 3s - loss: 0.0043 - val_loss: 0.0044
 - val_f1: 0.9966
Epoch 149/200
 - 3s - loss: 0.0043 - val_loss: 0.0046
 - val_f1: 0.9967
Epoch 150/200
 - 3s - loss: 0.0044 - val_loss: 0.0044
 - val_f1: 0.9968
Epoch 151/200
 - 3s - loss: 0.0041 - val_loss: 0.0046
 - val_f1: 0.9965
Epoch 152/200
 - 3s - loss: 0.0044 - val_loss: 0.0045
 - val_f1: 0.9964
Epoch 153/200
 - 3s - loss: 0.0043 - val_loss: 0.0045
 - val_f1: 0.9967
Epoch 154/200
 - 3s - loss: 0.0040 - val_loss: 0.0043
 - val_f1: 0.9969
Epoch 155/200
 - 3s - loss: 0.0043 - val_loss: 0.0042
 - val_f1: 0.9969
Epoch 156/200
 - 3s - loss: 0.0043 - val_loss: 0.0044
 - val_f1: 0.9967
Epoch 157/200
 - 3s - loss: 0.0043 - val_loss: 0.0042
 - val_f1: 0.9969
Epoch 158/200
 - 3s - loss: 0.0043 - val_loss: 0.0044
 - val_f1: 0.9970
Epoch 159/200
 - 3s - loss: 0.0040 - val_loss: 0.0046
 - val_f1: 0.9968
Epoch 160/200
 - 3s - loss: 0.0042 - val_loss: 0.0044
 - val_f1: 0.9965
Epoch 161/200
 - 3s - loss: 0.0045 - val_loss: 0.0043
2020-01-08 14:51:40,490 [INFO] epoch = 160. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_8/ann_model_epoch_160.pickle
 - val_f1: 0.9969
Epoch 162/200
 - 3s - loss: 0.0039 - val_loss: 0.0043
 - val_f1: 0.9970
Epoch 163/200
 - 3s - loss: 0.0040 - val_loss: 0.0041
 - val_f1: 0.9970
Epoch 164/200
 - 3s - loss: 0.0041 - val_loss: 0.0047
 - val_f1: 0.9964
Epoch 165/200
 - 3s - loss: 0.0040 - val_loss: 0.0045
 - val_f1: 0.9965
Epoch 166/200
 - 3s - loss: 0.0044 - val_loss: 0.0043
 - val_f1: 0.9967
Epoch 167/200
 - 3s - loss: 0.0041 - val_loss: 0.0043
 - val_f1: 0.9970
Epoch 168/200
 - 3s - loss: 0.0045 - val_loss: 0.0043
 - val_f1: 0.9969
Epoch 169/200
 - 3s - loss: 0.0041 - val_loss: 0.0044
 - val_f1: 0.9969
Epoch 170/200
 - 3s - loss: 0.0043 - val_loss: 0.0044
 - val_f1: 0.9970
Epoch 171/200
 - 3s - loss: 0.0041 - val_loss: 0.0050
 - val_f1: 0.9966
Epoch 172/200
 - 3s - loss: 0.0044 - val_loss: 0.0041
 - val_f1: 0.9972
Epoch 173/200
 - 3s - loss: 0.0038 - val_loss: 0.0043
 - val_f1: 0.9969
Epoch 174/200
 - 3s - loss: 0.0040 - val_loss: 0.0046
 - val_f1: 0.9971
Epoch 175/200
 - 3s - loss: 0.0043 - val_loss: 0.0044
 - val_f1: 0.9972
Epoch 176/200
 - 3s - loss: 0.0040 - val_loss: 0.0043
 - val_f1: 0.9969
Epoch 177/200
 - 3s - loss: 0.0041 - val_loss: 0.0046
 - val_f1: 0.9971
Epoch 178/200
 - 3s - loss: 0.0043 - val_loss: 0.0043
 - val_f1: 0.9968
Epoch 179/200
 - 3s - loss: 0.0041 - val_loss: 0.0042
 - val_f1: 0.9970
Epoch 180/200
 - 3s - loss: 0.0039 - val_loss: 0.0040
 - val_f1: 0.9971
Epoch 181/200
 - 3s - loss: 0.0038 - val_loss: 0.0042
2020-01-08 14:52:54,638 [INFO] epoch = 180. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_8/ann_model_epoch_180.pickle
 - val_f1: 0.9970
Epoch 182/200
 - 3s - loss: 0.0040 - val_loss: 0.0041
 - val_f1: 0.9971
Epoch 183/200
 - 3s - loss: 0.0044 - val_loss: 0.0044
 - val_f1: 0.9969
Epoch 184/200
 - 3s - loss: 0.0041 - val_loss: 0.0046
 - val_f1: 0.9970
Epoch 185/200
 - 3s - loss: 0.0040 - val_loss: 0.0047
 - val_f1: 0.9970
Epoch 186/200
 - 3s - loss: 0.0039 - val_loss: 0.0045
 - val_f1: 0.9968
Epoch 187/200
 - 3s - loss: 0.0039 - val_loss: 0.0043
 - val_f1: 0.9971
Epoch 188/200
 - 3s - loss: 0.0038 - val_loss: 0.0042
 - val_f1: 0.9972
Epoch 189/200
 - 3s - loss: 0.0037 - val_loss: 0.0047
 - val_f1: 0.9969
Epoch 190/200
 - 3s - loss: 0.0039 - val_loss: 0.0045
 - val_f1: 0.9970
Epoch 191/200
 - 3s - loss: 0.0043 - val_loss: 0.0044
 - val_f1: 0.9969
Epoch 192/200
 - 3s - loss: 0.0041 - val_loss: 0.0043
 - val_f1: 0.9969
Epoch 193/200
 - 3s - loss: 0.0038 - val_loss: 0.0048
 - val_f1: 0.9968
Epoch 194/200
 - 3s - loss: 0.0040 - val_loss: 0.0041
 - val_f1: 0.9971
Epoch 195/200
 - 3s - loss: 0.0042 - val_loss: 0.0044
 - val_f1: 0.9965
Epoch 196/200
 - 3s - loss: 0.0039 - val_loss: 0.0045
 - val_f1: 0.9970
Epoch 197/200
 - 3s - loss: 0.0040 - val_loss: 0.0041
 - val_f1: 0.9970
Epoch 198/200
 - 3s - loss: 0.0039 - val_loss: 0.0043
 - val_f1: 0.9970
Epoch 199/200
 - 3s - loss: 0.0039 - val_loss: 0.0042
 - val_f1: 0.9970
Epoch 200/200
 - 3s - loss: 0.0039 - val_loss: 0.0042
2020-01-08 14:54:05,651 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-08 14:54:09,902 [INFO] Last epoch loss evaluation: train_loss = 0.002285, val_loss = 0.003985
2020-01-08 14:54:09,902 [INFO] Training complete. time_to_train = 756.05 sec, 12.60 min
2020-01-08 14:54:09,917 [INFO] Model saved to results_additional_exps/ann_depth_nsl_layers_8/best_model.pickle
2020-01-08 14:54:09,919 [INFO] Training history saved to: results_additional_exps/ann_depth_nsl_layers_8/training_error_history.csv
2020-01-08 14:54:10,109 [INFO] Plot saved to: results_additional_exps/ann_depth_nsl_layers_8/training_error_history.png
2020-01-08 14:54:10,281 [INFO] Plot saved to: results_additional_exps/ann_depth_nsl_layers_8/training_f1_history.png
2020-01-08 14:54:10,281 [INFO] Making predictions on training, validation, testing data
2020-01-08 14:54:14,087 [INFO] Evaluating predictions (results)
2020-01-08 14:54:14,350 [INFO] Dataset: Testing. Classification report below
2020-01-08 14:54:14,351 [INFO] 
              precision    recall  f1-score   support

         dos       0.96      0.83      0.89      7458
      normal       0.68      0.97      0.80      9711
       probe       0.84      0.66      0.74      2421
         r2l       0.96      0.10      0.18      2421
         u2r       0.84      0.04      0.08       533

   micro avg       0.77      0.77      0.77     22544
   macro avg       0.86      0.52      0.54     22544
weighted avg       0.82      0.77      0.74     22544

2020-01-08 14:54:14,351 [INFO] Overall accuracy (micro avg): 0.774041873669269
2020-01-08 14:54:14,646 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.7740         0.7740                       0.7740                0.0565                   0.2260  0.7740
1     Macro avg        0.9096         0.8550                       0.5199                0.0770                   0.4801  0.5367
2  Weighted avg        0.8688         0.8214                       0.7740                0.1591                   0.2260  0.7378
2020-01-08 14:54:14,979 [INFO] Dataset: Validation. Classification report below
2020-01-08 14:54:14,979 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00      9186
      normal       1.00      1.00      1.00     13469
       probe       1.00      0.99      0.99      2331
         r2l       0.96      0.91      0.94       199
         u2r       0.86      0.60      0.71        10

   micro avg       1.00      1.00      1.00     25195
   macro avg       0.96      0.90      0.93     25195
weighted avg       1.00      1.00      1.00     25195

2020-01-08 14:54:14,979 [INFO] Overall accuracy (micro avg): 0.9971422901369319
2020-01-08 14:54:15,335 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9971         0.9971                       0.9971                0.0007                   0.0029  0.9971
1     Macro avg        0.9989         0.9622                       0.8997                0.0010                   0.1003  0.9263
2  Weighted avg        0.9982         0.9971                       0.9971                0.0022                   0.0029  0.9971
2020-01-08 14:54:16,780 [INFO] Dataset: Training. Classification report below
2020-01-08 14:54:16,780 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00     36741
      normal       1.00      1.00      1.00     53874
       probe       1.00      0.99      1.00      9325
         r2l       0.98      0.92      0.95       796
         u2r       0.91      0.71      0.80        42

   micro avg       1.00      1.00      1.00    100778
   macro avg       0.98      0.92      0.95    100778
weighted avg       1.00      1.00      1.00    100778

2020-01-08 14:54:16,780 [INFO] Overall accuracy (micro avg): 0.9978269066661375
2020-01-08 14:54:18,403 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9978         0.9978                       0.9978                0.0005                   0.0022  0.9978
1     Macro avg        0.9991         0.9765                       0.9241                0.0008                   0.0759  0.9478
2  Weighted avg        0.9986         0.9978                       0.9978                0.0021                   0.0022  0.9978
2020-01-08 14:54:18,442 [INFO] Results saved to: results_additional_exps/ann_depth_nsl_layers_8/ann_depth_nsl_layers_8_results.xlsx
2020-01-08 14:54:18,442 [INFO] ================= Finished running experiment no. 8 ================= 

2020-01-08 14:54:18,445 [INFO] Created directory: results_additional_exps/ann_depth_nsl_layers_9
2020-01-08 14:54:18,445 [INFO] Initialized logging. log_filename = results_additional_exps/ann_depth_nsl_layers_9/run_log.log
2020-01-08 14:54:18,445 [INFO] ================= Running experiment no. 9  ================= 

2020-01-08 14:54:18,445 [INFO] Experiment parameters given below
2020-01-08 14:54:18,445 [INFO] 
{'experiment_num': 9, 'results_dir': 'results_additional_exps/ann_depth_nsl_layers_9', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [64, 64, 64, 64, 64, 64, 64, 64, 64], 'ann_layer_activations': ['relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu'], 'ann_layer_dropout_rates': [0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2], 'epochs': 200, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/nsl_kdd_five_classes', 'description': 'ann_depth_nsl_layers_9'}
2020-01-08 14:54:18,446 [INFO] Created tensorboard log directory: results_additional_exps/ann_depth_nsl_layers_9/tf_logs_run_2020_01_08-14_54_18
2020-01-08 14:54:18,446 [INFO] Loading datsets from: ../Datasets/small_datasets/nsl_kdd_five_classes
2020-01-08 14:54:18,446 [INFO] Reading X, y files
2020-01-08 14:54:18,446 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_train.h5
2020-01-08 14:54:18,700 [INFO] Reading complete. time_to_read=0.25 seconds
2020-01-08 14:54:18,700 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_val.h5
2020-01-08 14:54:18,764 [INFO] Reading complete. time_to_read=0.06 seconds
2020-01-08 14:54:18,765 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_test.h5
2020-01-08 14:54:18,825 [INFO] Reading complete. time_to_read=0.06 seconds
2020-01-08 14:54:18,825 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_train.h5
2020-01-08 14:54:18,833 [INFO] Reading complete. time_to_read=0.01 seconds
2020-01-08 14:54:18,833 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_val.h5
2020-01-08 14:54:18,837 [INFO] Reading complete. time_to_read=0.00 seconds
2020-01-08 14:54:18,837 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_test.h5
2020-01-08 14:54:18,840 [INFO] Reading complete. time_to_read=0.00 seconds
2020-01-08 14:54:19,029 [INFO] Initializing model
2020-01-08 14:54:19,810 [INFO] _________________________________________________________________
2020-01-08 14:54:19,810 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-08 14:54:19,810 [INFO] =================================================================
2020-01-08 14:54:19,810 [INFO] dense_45 (Dense)             (None, 64)                7872      
2020-01-08 14:54:19,810 [INFO] _________________________________________________________________
2020-01-08 14:54:19,810 [INFO] batch_normalization_37 (Batc (None, 64)                256       
2020-01-08 14:54:19,810 [INFO] _________________________________________________________________
2020-01-08 14:54:19,810 [INFO] dropout_37 (Dropout)         (None, 64)                0         
2020-01-08 14:54:19,810 [INFO] _________________________________________________________________
2020-01-08 14:54:19,810 [INFO] dense_46 (Dense)             (None, 64)                4160      
2020-01-08 14:54:19,811 [INFO] _________________________________________________________________
2020-01-08 14:54:19,811 [INFO] batch_normalization_38 (Batc (None, 64)                256       
2020-01-08 14:54:19,811 [INFO] _________________________________________________________________
2020-01-08 14:54:19,811 [INFO] dropout_38 (Dropout)         (None, 64)                0         
2020-01-08 14:54:19,811 [INFO] _________________________________________________________________
2020-01-08 14:54:19,811 [INFO] dense_47 (Dense)             (None, 64)                4160      
2020-01-08 14:54:19,811 [INFO] _________________________________________________________________
2020-01-08 14:54:19,811 [INFO] batch_normalization_39 (Batc (None, 64)                256       
2020-01-08 14:54:19,811 [INFO] _________________________________________________________________
2020-01-08 14:54:19,811 [INFO] dropout_39 (Dropout)         (None, 64)                0         
2020-01-08 14:54:19,811 [INFO] _________________________________________________________________
2020-01-08 14:54:19,811 [INFO] dense_48 (Dense)             (None, 64)                4160      
2020-01-08 14:54:19,811 [INFO] _________________________________________________________________
2020-01-08 14:54:19,811 [INFO] batch_normalization_40 (Batc (None, 64)                256       
2020-01-08 14:54:19,811 [INFO] _________________________________________________________________
2020-01-08 14:54:19,811 [INFO] dropout_40 (Dropout)         (None, 64)                0         
2020-01-08 14:54:19,811 [INFO] _________________________________________________________________
2020-01-08 14:54:19,811 [INFO] dense_49 (Dense)             (None, 64)                4160      
2020-01-08 14:54:19,812 [INFO] _________________________________________________________________
2020-01-08 14:54:19,812 [INFO] batch_normalization_41 (Batc (None, 64)                256       
2020-01-08 14:54:19,812 [INFO] _________________________________________________________________
2020-01-08 14:54:19,812 [INFO] dropout_41 (Dropout)         (None, 64)                0         
2020-01-08 14:54:19,812 [INFO] _________________________________________________________________
2020-01-08 14:54:19,812 [INFO] dense_50 (Dense)             (None, 64)                4160      
2020-01-08 14:54:19,812 [INFO] _________________________________________________________________
2020-01-08 14:54:19,812 [INFO] batch_normalization_42 (Batc (None, 64)                256       
2020-01-08 14:54:19,812 [INFO] _________________________________________________________________
2020-01-08 14:54:19,812 [INFO] dropout_42 (Dropout)         (None, 64)                0         
2020-01-08 14:54:19,812 [INFO] _________________________________________________________________
2020-01-08 14:54:19,812 [INFO] dense_51 (Dense)             (None, 64)                4160      
2020-01-08 14:54:19,812 [INFO] _________________________________________________________________
2020-01-08 14:54:19,812 [INFO] batch_normalization_43 (Batc (None, 64)                256       
2020-01-08 14:54:19,812 [INFO] _________________________________________________________________
2020-01-08 14:54:19,812 [INFO] dropout_43 (Dropout)         (None, 64)                0         
2020-01-08 14:54:19,812 [INFO] _________________________________________________________________
2020-01-08 14:54:19,812 [INFO] dense_52 (Dense)             (None, 64)                4160      
2020-01-08 14:54:19,813 [INFO] _________________________________________________________________
2020-01-08 14:54:19,813 [INFO] batch_normalization_44 (Batc (None, 64)                256       
2020-01-08 14:54:19,813 [INFO] _________________________________________________________________
2020-01-08 14:54:19,813 [INFO] dropout_44 (Dropout)         (None, 64)                0         
2020-01-08 14:54:19,813 [INFO] _________________________________________________________________
2020-01-08 14:54:19,813 [INFO] dense_53 (Dense)             (None, 64)                4160      
2020-01-08 14:54:19,813 [INFO] _________________________________________________________________
2020-01-08 14:54:19,813 [INFO] batch_normalization_45 (Batc (None, 64)                256       
2020-01-08 14:54:19,813 [INFO] _________________________________________________________________
2020-01-08 14:54:19,813 [INFO] dropout_45 (Dropout)         (None, 64)                0         
2020-01-08 14:54:19,813 [INFO] _________________________________________________________________
2020-01-08 14:54:19,813 [INFO] dense_54 (Dense)             (None, 5)                 325       
2020-01-08 14:54:19,813 [INFO] =================================================================
2020-01-08 14:54:19,814 [INFO] Total params: 43,781
2020-01-08 14:54:19,814 [INFO] Trainable params: 42,629
2020-01-08 14:54:19,814 [INFO] Non-trainable params: 1,152
2020-01-08 14:54:19,814 [INFO] _________________________________________________________________
2020-01-08 14:54:19,814 [INFO] Training model
 - val_f1: 0.9968
Train on 100778 samples, validate on 25195 samples
Epoch 1/200
 - 5s - loss: 0.1605 - val_loss: 0.0477
 - val_f1: 0.9666
Epoch 2/200
 - 3s - loss: 0.0517 - val_loss: 0.0206
 - val_f1: 0.9796
Epoch 3/200
 - 3s - loss: 0.0347 - val_loss: 0.0177
 - val_f1: 0.9812
Epoch 4/200
 - 3s - loss: 0.0287 - val_loss: 0.0161
 - val_f1: 0.9829
Epoch 5/200
 - 3s - loss: 0.0244 - val_loss: 0.0153
 - val_f1: 0.9824
Epoch 6/200
 - 3s - loss: 0.0229 - val_loss: 0.0136
 - val_f1: 0.9894
Epoch 7/200
 - 3s - loss: 0.0205 - val_loss: 0.0126
 - val_f1: 0.9902
Epoch 8/200
 - 3s - loss: 0.0188 - val_loss: 0.0125
 - val_f1: 0.9893
Epoch 9/200
 - 3s - loss: 0.0178 - val_loss: 0.0123
 - val_f1: 0.9922
Epoch 10/200
 - 3s - loss: 0.0167 - val_loss: 0.0115
 - val_f1: 0.9921
Epoch 11/200
 - 3s - loss: 0.0155 - val_loss: 0.0111
 - val_f1: 0.9925
Epoch 12/200
 - 3s - loss: 0.0152 - val_loss: 0.0103
 - val_f1: 0.9914
Epoch 13/200
 - 3s - loss: 0.0144 - val_loss: 0.0109
 - val_f1: 0.9929
Epoch 14/200
 - 3s - loss: 0.0137 - val_loss: 0.0105
 - val_f1: 0.9928
Epoch 15/200
 - 3s - loss: 0.0134 - val_loss: 0.0091
 - val_f1: 0.9933
Epoch 16/200
 - 3s - loss: 0.0126 - val_loss: 0.0091
 - val_f1: 0.9935
Epoch 17/200
 - 3s - loss: 0.0122 - val_loss: 0.0091
 - val_f1: 0.9934
Epoch 18/200
 - 3s - loss: 0.0116 - val_loss: 0.0085
 - val_f1: 0.9934
Epoch 19/200
 - 3s - loss: 0.0116 - val_loss: 0.0093
 - val_f1: 0.9919
Epoch 20/200
 - 3s - loss: 0.0116 - val_loss: 0.0093
 - val_f1: 0.9923
Epoch 21/200
 - 3s - loss: 0.0113 - val_loss: 0.0084
2020-01-08 14:56:00,899 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_9/ann_model_epoch_20.pickle
 - val_f1: 0.9931
Epoch 22/200
 - 3s - loss: 0.0109 - val_loss: 0.0089
 - val_f1: 0.9938
Epoch 23/200
 - 3s - loss: 0.0108 - val_loss: 0.0084
 - val_f1: 0.9928
Epoch 24/200
 - 3s - loss: 0.0105 - val_loss: 0.0081
 - val_f1: 0.9938
Epoch 25/200
 - 3s - loss: 0.0102 - val_loss: 0.0083
 - val_f1: 0.9940
Epoch 26/200
 - 3s - loss: 0.0106 - val_loss: 0.0078
 - val_f1: 0.9939
Epoch 27/200
 - 3s - loss: 0.0101 - val_loss: 0.0078
 - val_f1: 0.9940
Epoch 28/200
 - 3s - loss: 0.0096 - val_loss: 0.0081
 - val_f1: 0.9934
Epoch 29/200
 - 3s - loss: 0.0098 - val_loss: 0.0075
 - val_f1: 0.9942
Epoch 30/200
 - 3s - loss: 0.0097 - val_loss: 0.0074
 - val_f1: 0.9942
Epoch 31/200
 - 3s - loss: 0.0091 - val_loss: 0.0077
 - val_f1: 0.9936
Epoch 32/200
 - 3s - loss: 0.0090 - val_loss: 0.0072
 - val_f1: 0.9942
Epoch 33/200
 - 3s - loss: 0.0092 - val_loss: 0.0074
 - val_f1: 0.9941
Epoch 34/200
 - 3s - loss: 0.0091 - val_loss: 0.0072
 - val_f1: 0.9935
Epoch 35/200
 - 3s - loss: 0.0086 - val_loss: 0.0067
 - val_f1: 0.9942
Epoch 36/200
 - 3s - loss: 0.0087 - val_loss: 0.0067
 - val_f1: 0.9946
Epoch 37/200
 - 3s - loss: 0.0084 - val_loss: 0.0063
 - val_f1: 0.9952
Epoch 38/200
 - 3s - loss: 0.0084 - val_loss: 0.0071
 - val_f1: 0.9941
Epoch 39/200
 - 3s - loss: 0.0083 - val_loss: 0.0062
 - val_f1: 0.9948
Epoch 40/200
 - 3s - loss: 0.0084 - val_loss: 0.0062
 - val_f1: 0.9952
Epoch 41/200
 - 3s - loss: 0.0083 - val_loss: 0.0062
2020-01-08 14:57:23,684 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_9/ann_model_epoch_40.pickle
 - val_f1: 0.9950
Epoch 42/200
 - 3s - loss: 0.0078 - val_loss: 0.0058
 - val_f1: 0.9950
Epoch 43/200
 - 3s - loss: 0.0075 - val_loss: 0.0059
 - val_f1: 0.9956
Epoch 44/200
 - 3s - loss: 0.0080 - val_loss: 0.0059
 - val_f1: 0.9951
Epoch 45/200
 - 3s - loss: 0.0077 - val_loss: 0.0058
 - val_f1: 0.9956
Epoch 46/200
 - 3s - loss: 0.0074 - val_loss: 0.0060
 - val_f1: 0.9958
Epoch 47/200
 - 3s - loss: 0.0073 - val_loss: 0.0057
 - val_f1: 0.9957
Epoch 48/200
 - 3s - loss: 0.0072 - val_loss: 0.0059
 - val_f1: 0.9958
Epoch 49/200
 - 3s - loss: 0.0073 - val_loss: 0.0060
 - val_f1: 0.9961
Epoch 50/200
 - 3s - loss: 0.0071 - val_loss: 0.0058
 - val_f1: 0.9959
Epoch 51/200
 - 3s - loss: 0.0069 - val_loss: 0.0059
 - val_f1: 0.9961
Epoch 52/200
 - 3s - loss: 0.0066 - val_loss: 0.0053
 - val_f1: 0.9964
Epoch 53/200
 - 3s - loss: 0.0071 - val_loss: 0.0057
 - val_f1: 0.9961
Epoch 54/200
 - 3s - loss: 0.0070 - val_loss: 0.0054
 - val_f1: 0.9962
Epoch 55/200
 - 3s - loss: 0.0066 - val_loss: 0.0058
 - val_f1: 0.9959
Epoch 56/200
 - 3s - loss: 0.0066 - val_loss: 0.0052
 - val_f1: 0.9966
Epoch 57/200
 - 3s - loss: 0.0068 - val_loss: 0.0061
 - val_f1: 0.9954
Epoch 58/200
 - 3s - loss: 0.0067 - val_loss: 0.0051
 - val_f1: 0.9962
Epoch 59/200
 - 3s - loss: 0.0066 - val_loss: 0.0058
 - val_f1: 0.9960
Epoch 60/200
 - 3s - loss: 0.0061 - val_loss: 0.0049
 - val_f1: 0.9965
Epoch 61/200
 - 3s - loss: 0.0063 - val_loss: 0.0059
2020-01-08 14:58:46,276 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_9/ann_model_epoch_60.pickle
 - val_f1: 0.9958
Epoch 62/200
 - 3s - loss: 0.0064 - val_loss: 0.0051
 - val_f1: 0.9961
Epoch 63/200
 - 3s - loss: 0.0064 - val_loss: 0.0052
 - val_f1: 0.9961
Epoch 64/200
 - 3s - loss: 0.0063 - val_loss: 0.0050
 - val_f1: 0.9963
Epoch 65/200
 - 3s - loss: 0.0060 - val_loss: 0.0052
 - val_f1: 0.9961
Epoch 66/200
 - 3s - loss: 0.0062 - val_loss: 0.0052
 - val_f1: 0.9960
Epoch 67/200
 - 3s - loss: 0.0059 - val_loss: 0.0049
 - val_f1: 0.9962
Epoch 68/200
 - 3s - loss: 0.0061 - val_loss: 0.0052
 - val_f1: 0.9962
Epoch 69/200
 - 3s - loss: 0.0059 - val_loss: 0.0055
 - val_f1: 0.9964
Epoch 70/200
 - 3s - loss: 0.0060 - val_loss: 0.0055
 - val_f1: 0.9958
Epoch 71/200
 - 3s - loss: 0.0059 - val_loss: 0.0054
 - val_f1: 0.9961
Epoch 72/200
 - 3s - loss: 0.0056 - val_loss: 0.0054
 - val_f1: 0.9960
Epoch 73/200
 - 3s - loss: 0.0059 - val_loss: 0.0052
 - val_f1: 0.9964
Epoch 74/200
 - 3s - loss: 0.0058 - val_loss: 0.0052
 - val_f1: 0.9962
Epoch 75/200
 - 3s - loss: 0.0057 - val_loss: 0.0054
 - val_f1: 0.9960
Epoch 76/200
 - 3s - loss: 0.0062 - val_loss: 0.0054
 - val_f1: 0.9962
Epoch 77/200
 - 3s - loss: 0.0059 - val_loss: 0.0049
 - val_f1: 0.9961
Epoch 78/200
 - 3s - loss: 0.0057 - val_loss: 0.0051
 - val_f1: 0.9965
Epoch 79/200
 - 3s - loss: 0.0060 - val_loss: 0.0051
 - val_f1: 0.9961
Epoch 80/200
 - 3s - loss: 0.0058 - val_loss: 0.0051
 - val_f1: 0.9962
Epoch 81/200
 - 3s - loss: 0.0058 - val_loss: 0.0047
2020-01-08 15:00:08,944 [INFO] epoch = 80. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_9/ann_model_epoch_80.pickle
 - val_f1: 0.9963
Epoch 82/200
 - 3s - loss: 0.0057 - val_loss: 0.0046
 - val_f1: 0.9965
Epoch 83/200
 - 3s - loss: 0.0055 - val_loss: 0.0073
 - val_f1: 0.9934
Epoch 84/200
 - 3s - loss: 0.0060 - val_loss: 0.0050
 - val_f1: 0.9961
Epoch 85/200
 - 3s - loss: 0.0054 - val_loss: 0.0047
 - val_f1: 0.9962
Epoch 86/200
 - 3s - loss: 0.0054 - val_loss: 0.0051
 - val_f1: 0.9959
Epoch 87/200
 - 3s - loss: 0.0053 - val_loss: 0.0050
 - val_f1: 0.9961
Epoch 88/200
 - 3s - loss: 0.0055 - val_loss: 0.0048
 - val_f1: 0.9964
Epoch 89/200
 - 3s - loss: 0.0054 - val_loss: 0.0048
 - val_f1: 0.9963
Epoch 90/200
 - 3s - loss: 0.0055 - val_loss: 0.0050
 - val_f1: 0.9963
Epoch 91/200
 - 3s - loss: 0.0054 - val_loss: 0.0048
 - val_f1: 0.9964
Epoch 92/200
 - 3s - loss: 0.0055 - val_loss: 0.0050
 - val_f1: 0.9964
Epoch 93/200
 - 3s - loss: 0.0055 - val_loss: 0.0047
 - val_f1: 0.9960
Epoch 94/200
 - 3s - loss: 0.0054 - val_loss: 0.0050
 - val_f1: 0.9964
Epoch 95/200
 - 3s - loss: 0.0052 - val_loss: 0.0046
 - val_f1: 0.9961
Epoch 96/200
 - 3s - loss: 0.0053 - val_loss: 0.0046
 - val_f1: 0.9967
Epoch 97/200
 - 3s - loss: 0.0054 - val_loss: 0.0045
 - val_f1: 0.9966
Epoch 98/200
 - 3s - loss: 0.0053 - val_loss: 0.0050
 - val_f1: 0.9962
Epoch 99/200
 - 3s - loss: 0.0052 - val_loss: 0.0050
 - val_f1: 0.9963
Epoch 100/200
 - 3s - loss: 0.0050 - val_loss: 0.0047
 - val_f1: 0.9965
Epoch 101/200
 - 3s - loss: 0.0049 - val_loss: 0.0051
2020-01-08 15:01:31,621 [INFO] epoch = 100. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_9/ann_model_epoch_100.pickle
 - val_f1: 0.9961
Epoch 102/200
 - 3s - loss: 0.0053 - val_loss: 0.0048
 - val_f1: 0.9965
Epoch 103/200
 - 3s - loss: 0.0051 - val_loss: 0.0048
 - val_f1: 0.9961
Epoch 104/200
 - 3s - loss: 0.0050 - val_loss: 0.0046
 - val_f1: 0.9966
Epoch 105/200
 - 3s - loss: 0.0052 - val_loss: 0.0045
 - val_f1: 0.9964
Epoch 106/200
 - 3s - loss: 0.0055 - val_loss: 0.0045
 - val_f1: 0.9966
Epoch 107/200
 - 3s - loss: 0.0050 - val_loss: 0.0044
 - val_f1: 0.9966
Epoch 108/200
 - 3s - loss: 0.0049 - val_loss: 0.0049
 - val_f1: 0.9961
Epoch 109/200
 - 3s - loss: 0.0047 - val_loss: 0.0050
 - val_f1: 0.9964
Epoch 110/200
 - 3s - loss: 0.0051 - val_loss: 0.0050
 - val_f1: 0.9965
Epoch 111/200
 - 3s - loss: 0.0049 - val_loss: 0.0049
 - val_f1: 0.9965
Epoch 112/200
 - 3s - loss: 0.0047 - val_loss: 0.0047
 - val_f1: 0.9964
Epoch 113/200
 - 3s - loss: 0.0048 - val_loss: 0.0051
 - val_f1: 0.9960
Epoch 114/200
 - 3s - loss: 0.0047 - val_loss: 0.0053
 - val_f1: 0.9960
Epoch 115/200
 - 3s - loss: 0.0048 - val_loss: 0.0048
 - val_f1: 0.9965
Epoch 116/200
 - 3s - loss: 0.0048 - val_loss: 0.0043
 - val_f1: 0.9969
Epoch 117/200
 - 3s - loss: 0.0046 - val_loss: 0.0045
 - val_f1: 0.9967
Epoch 118/200
 - 3s - loss: 0.0046 - val_loss: 0.0045
 - val_f1: 0.9963
Epoch 119/200
 - 3s - loss: 0.0050 - val_loss: 0.0047
 - val_f1: 0.9965
Epoch 120/200
 - 3s - loss: 0.0047 - val_loss: 0.0050
 - val_f1: 0.9963
Epoch 121/200
 - 3s - loss: 0.0046 - val_loss: 0.0078
2020-01-08 15:02:54,289 [INFO] epoch = 120. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_9/ann_model_epoch_120.pickle
 - val_f1: 0.9941
Epoch 122/200
 - 3s - loss: 0.0048 - val_loss: 0.0051
 - val_f1: 0.9963
Epoch 123/200
 - 3s - loss: 0.0050 - val_loss: 0.0047
 - val_f1: 0.9964
Epoch 124/200
 - 3s - loss: 0.0050 - val_loss: 0.0049
 - val_f1: 0.9966
Epoch 125/200
 - 3s - loss: 0.0048 - val_loss: 0.0051
 - val_f1: 0.9967
Epoch 126/200
 - 3s - loss: 0.0045 - val_loss: 0.0046
 - val_f1: 0.9966
Epoch 127/200
 - 3s - loss: 0.0048 - val_loss: 0.0048
 - val_f1: 0.9963
Epoch 128/200
 - 3s - loss: 0.0045 - val_loss: 0.0051
 - val_f1: 0.9960
Epoch 129/200
 - 3s - loss: 0.0044 - val_loss: 0.0049
 - val_f1: 0.9965
Epoch 130/200
 - 3s - loss: 0.0047 - val_loss: 0.0044
 - val_f1: 0.9966
Epoch 131/200
 - 3s - loss: 0.0046 - val_loss: 0.0049
 - val_f1: 0.9967
Epoch 132/200
 - 3s - loss: 0.0045 - val_loss: 0.0048
 - val_f1: 0.9965
Epoch 133/200
 - 3s - loss: 0.0047 - val_loss: 0.0047
 - val_f1: 0.9966
Epoch 134/200
 - 3s - loss: 0.0045 - val_loss: 0.0053
 - val_f1: 0.9964
Epoch 135/200
 - 3s - loss: 0.0044 - val_loss: 0.0050
 - val_f1: 0.9966
Epoch 136/200
 - 3s - loss: 0.0048 - val_loss: 0.0048
 - val_f1: 0.9967
Epoch 137/200
 - 3s - loss: 0.0042 - val_loss: 0.0054
 - val_f1: 0.9964
Epoch 138/200
 - 3s - loss: 0.0045 - val_loss: 0.0051
 - val_f1: 0.9966
Epoch 139/200
 - 3s - loss: 0.0046 - val_loss: 0.0050
 - val_f1: 0.9964
Epoch 140/200
 - 3s - loss: 0.0045 - val_loss: 0.0050
 - val_f1: 0.9967
Epoch 141/200
 - 3s - loss: 0.0046 - val_loss: 0.0047
2020-01-08 15:04:17,012 [INFO] epoch = 140. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_9/ann_model_epoch_140.pickle
 - val_f1: 0.9966
Epoch 142/200
 - 3s - loss: 0.0045 - val_loss: 0.0050
 - val_f1: 0.9965
Epoch 143/200
 - 3s - loss: 0.0045 - val_loss: 0.0048
 - val_f1: 0.9964
Epoch 144/200
 - 3s - loss: 0.0043 - val_loss: 0.0047
 - val_f1: 0.9967
Epoch 145/200
 - 3s - loss: 0.0044 - val_loss: 0.0047
 - val_f1: 0.9964
Epoch 146/200
 - 3s - loss: 0.0045 - val_loss: 0.0050
 - val_f1: 0.9964
Epoch 147/200
 - 3s - loss: 0.0044 - val_loss: 0.0049
 - val_f1: 0.9966
Epoch 148/200
 - 3s - loss: 0.0045 - val_loss: 0.0049
 - val_f1: 0.9964
Epoch 149/200
 - 3s - loss: 0.0042 - val_loss: 0.0048
 - val_f1: 0.9964
Epoch 150/200
 - 3s - loss: 0.0046 - val_loss: 0.0049
 - val_f1: 0.9964
Epoch 151/200
 - 3s - loss: 0.0043 - val_loss: 0.0050
 - val_f1: 0.9966
Epoch 152/200
 - 3s - loss: 0.0044 - val_loss: 0.0047
 - val_f1: 0.9964
Epoch 153/200
 - 3s - loss: 0.0042 - val_loss: 0.0050
 - val_f1: 0.9965
Epoch 154/200
 - 3s - loss: 0.0045 - val_loss: 0.0049
 - val_f1: 0.9964
Epoch 155/200
 - 3s - loss: 0.0043 - val_loss: 0.0047
 - val_f1: 0.9964
Epoch 156/200
 - 3s - loss: 0.0044 - val_loss: 0.0049
 - val_f1: 0.9964
Epoch 157/200
 - 3s - loss: 0.0041 - val_loss: 0.0050
 - val_f1: 0.9964
Epoch 158/200
 - 3s - loss: 0.0044 - val_loss: 0.0047
 - val_f1: 0.9968
Epoch 159/200
 - 3s - loss: 0.0042 - val_loss: 0.0052
 - val_f1: 0.9964
Epoch 160/200
 - 3s - loss: 0.0042 - val_loss: 0.0046
 - val_f1: 0.9966
Epoch 161/200
 - 3s - loss: 0.0043 - val_loss: 0.0047
2020-01-08 15:05:39,572 [INFO] epoch = 160. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_9/ann_model_epoch_160.pickle
 - val_f1: 0.9966
Epoch 162/200
 - 3s - loss: 0.0043 - val_loss: 0.0047
 - val_f1: 0.9962
Epoch 163/200
 - 3s - loss: 0.0044 - val_loss: 0.0049
 - val_f1: 0.9964
Epoch 164/200
 - 3s - loss: 0.0043 - val_loss: 0.0048
 - val_f1: 0.9968
Epoch 165/200
 - 3s - loss: 0.0041 - val_loss: 0.0048
 - val_f1: 0.9964
Epoch 166/200
 - 3s - loss: 0.0040 - val_loss: 0.0046
2020-01-08 15:06:00,972 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-08 15:06:05,854 [INFO] Last epoch loss evaluation: train_loss = 0.002885, val_loss = 0.004295
2020-01-08 15:06:05,854 [INFO] Training complete. time_to_train = 706.04 sec, 11.77 min
2020-01-08 15:06:05,870 [INFO] Model saved to results_additional_exps/ann_depth_nsl_layers_9/best_model.pickle
2020-01-08 15:06:05,872 [INFO] Training history saved to: results_additional_exps/ann_depth_nsl_layers_9/training_error_history.csv
2020-01-08 15:06:06,054 [INFO] Plot saved to: results_additional_exps/ann_depth_nsl_layers_9/training_error_history.png
2020-01-08 15:06:06,221 [INFO] Plot saved to: results_additional_exps/ann_depth_nsl_layers_9/training_f1_history.png
2020-01-08 15:06:06,221 [INFO] Making predictions on training, validation, testing data
2020-01-08 15:06:10,589 [INFO] Evaluating predictions (results)
2020-01-08 15:06:10,851 [INFO] Dataset: Testing. Classification report below
2020-01-08 15:06:10,851 [INFO] 
              precision    recall  f1-score   support

         dos       0.96      0.84      0.89      7458
      normal       0.68      0.96      0.80      9711
       probe       0.83      0.71      0.76      2421
         r2l       0.91      0.11      0.19      2421
         u2r       0.75      0.05      0.08       533

   micro avg       0.78      0.78      0.78     22544
   macro avg       0.83      0.53      0.55     22544
weighted avg       0.82      0.78      0.74     22544

2020-01-08 15:06:10,851 [INFO] Overall accuracy (micro avg): 0.7784332860184529
2020-01-08 15:06:11,147 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.7784         0.7784                       0.7784                0.0554                   0.2216  0.7784
1     Macro avg        0.9114         0.8257                       0.5307                0.0750                   0.4693  0.5456
2  Weighted avg        0.8717         0.8158                       0.7784                0.1537                   0.2216  0.7435
2020-01-08 15:06:11,482 [INFO] Dataset: Validation. Classification report below
2020-01-08 15:06:11,482 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00      9186
      normal       1.00      1.00      1.00     13469
       probe       0.99      0.99      0.99      2331
         r2l       0.96      0.90      0.93       199
         u2r       0.67      0.40      0.50        10

   micro avg       1.00      1.00      1.00     25195
   macro avg       0.92      0.86      0.88     25195
weighted avg       1.00      1.00      1.00     25195

2020-01-08 15:06:11,482 [INFO] Overall accuracy (micro avg): 0.9969438380631077
2020-01-08 15:06:11,840 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9969         0.9969                       0.9969                0.0008                   0.0031  0.9969
1     Macro avg        0.9988         0.9237                       0.8588                0.0011                   0.1412  0.8844
2  Weighted avg        0.9981         0.9969                       0.9969                0.0023                   0.0031  0.9969
2020-01-08 15:06:13,287 [INFO] Dataset: Training. Classification report below
2020-01-08 15:06:13,287 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00     36741
      normal       1.00      1.00      1.00     53874
       probe       1.00      0.99      0.99      9325
         r2l       0.98      0.91      0.94       796
         u2r       0.88      0.67      0.76        42

   micro avg       1.00      1.00      1.00    100778
   macro avg       0.97      0.91      0.94    100778
weighted avg       1.00      1.00      1.00    100778

2020-01-08 15:06:13,287 [INFO] Overall accuracy (micro avg): 0.9975292226478001
2020-01-08 15:06:14,914 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9975         0.9975                       0.9975                0.0006                   0.0025  0.9975
1     Macro avg        0.9990         0.9690                       0.9130                0.0009                   0.0870  0.9380
2  Weighted avg        0.9984         0.9975                       0.9975                0.0022                   0.0025  0.9975
2020-01-08 15:06:14,952 [INFO] Results saved to: results_additional_exps/ann_depth_nsl_layers_9/ann_depth_nsl_layers_9_results.xlsx
2020-01-08 15:06:14,952 [INFO] ================= Finished running experiment no. 9 ================= 

2020-01-08 15:06:14,956 [INFO] Created directory: results_additional_exps/ann_depth_nsl_layers_10
2020-01-08 15:06:14,956 [INFO] Initialized logging. log_filename = results_additional_exps/ann_depth_nsl_layers_10/run_log.log
2020-01-08 15:06:14,956 [INFO] ================= Running experiment no. 10  ================= 

2020-01-08 15:06:14,956 [INFO] Experiment parameters given below
2020-01-08 15:06:14,956 [INFO] 
{'experiment_num': 10, 'results_dir': 'results_additional_exps/ann_depth_nsl_layers_10', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [64, 64, 64, 64, 64, 64, 64, 64, 64, 64], 'ann_layer_activations': ['relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu', 'relu'], 'ann_layer_dropout_rates': [0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2], 'epochs': 200, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/nsl_kdd_five_classes', 'description': 'ann_depth_nsl_layers_10'}
2020-01-08 15:06:14,956 [INFO] Created tensorboard log directory: results_additional_exps/ann_depth_nsl_layers_10/tf_logs_run_2020_01_08-15_06_14
2020-01-08 15:06:14,956 [INFO] Loading datsets from: ../Datasets/small_datasets/nsl_kdd_five_classes
2020-01-08 15:06:14,956 [INFO] Reading X, y files
2020-01-08 15:06:14,956 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_train.h5
2020-01-08 15:06:15,211 [INFO] Reading complete. time_to_read=0.25 seconds
2020-01-08 15:06:15,211 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_val.h5
2020-01-08 15:06:15,275 [INFO] Reading complete. time_to_read=0.06 seconds
2020-01-08 15:06:15,276 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_test.h5
2020-01-08 15:06:15,336 [INFO] Reading complete. time_to_read=0.06 seconds
2020-01-08 15:06:15,336 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_train.h5
2020-01-08 15:06:15,343 [INFO] Reading complete. time_to_read=0.01 seconds
2020-01-08 15:06:15,344 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_val.h5
2020-01-08 15:06:15,347 [INFO] Reading complete. time_to_read=0.00 seconds
2020-01-08 15:06:15,348 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_test.h5
2020-01-08 15:06:15,351 [INFO] Reading complete. time_to_read=0.00 seconds
2020-01-08 15:06:15,539 [INFO] Initializing model
2020-01-08 15:06:16,427 [INFO] _________________________________________________________________
2020-01-08 15:06:16,427 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-08 15:06:16,427 [INFO] =================================================================
2020-01-08 15:06:16,427 [INFO] dense_55 (Dense)             (None, 64)                7872      
2020-01-08 15:06:16,427 [INFO] _________________________________________________________________
2020-01-08 15:06:16,428 [INFO] batch_normalization_46 (Batc (None, 64)                256       
2020-01-08 15:06:16,428 [INFO] _________________________________________________________________
2020-01-08 15:06:16,428 [INFO] dropout_46 (Dropout)         (None, 64)                0         
2020-01-08 15:06:16,428 [INFO] _________________________________________________________________
2020-01-08 15:06:16,428 [INFO] dense_56 (Dense)             (None, 64)                4160      
2020-01-08 15:06:16,428 [INFO] _________________________________________________________________
2020-01-08 15:06:16,428 [INFO] batch_normalization_47 (Batc (None, 64)                256       
2020-01-08 15:06:16,428 [INFO] _________________________________________________________________
2020-01-08 15:06:16,428 [INFO] dropout_47 (Dropout)         (None, 64)                0         
2020-01-08 15:06:16,428 [INFO] _________________________________________________________________
2020-01-08 15:06:16,428 [INFO] dense_57 (Dense)             (None, 64)                4160      
2020-01-08 15:06:16,428 [INFO] _________________________________________________________________
2020-01-08 15:06:16,428 [INFO] batch_normalization_48 (Batc (None, 64)                256       
2020-01-08 15:06:16,428 [INFO] _________________________________________________________________
2020-01-08 15:06:16,428 [INFO] dropout_48 (Dropout)         (None, 64)                0         
2020-01-08 15:06:16,428 [INFO] _________________________________________________________________
2020-01-08 15:06:16,428 [INFO] dense_58 (Dense)             (None, 64)                4160      
2020-01-08 15:06:16,428 [INFO] _________________________________________________________________
2020-01-08 15:06:16,429 [INFO] batch_normalization_49 (Batc (None, 64)                256       
2020-01-08 15:06:16,429 [INFO] _________________________________________________________________
2020-01-08 15:06:16,429 [INFO] dropout_49 (Dropout)         (None, 64)                0         
2020-01-08 15:06:16,429 [INFO] _________________________________________________________________
2020-01-08 15:06:16,429 [INFO] dense_59 (Dense)             (None, 64)                4160      
2020-01-08 15:06:16,429 [INFO] _________________________________________________________________
2020-01-08 15:06:16,429 [INFO] batch_normalization_50 (Batc (None, 64)                256       
2020-01-08 15:06:16,429 [INFO] _________________________________________________________________
2020-01-08 15:06:16,429 [INFO] dropout_50 (Dropout)         (None, 64)                0         
2020-01-08 15:06:16,429 [INFO] _________________________________________________________________
2020-01-08 15:06:16,429 [INFO] dense_60 (Dense)             (None, 64)                4160      
2020-01-08 15:06:16,429 [INFO] _________________________________________________________________
2020-01-08 15:06:16,429 [INFO] batch_normalization_51 (Batc (None, 64)                256       
2020-01-08 15:06:16,429 [INFO] _________________________________________________________________
2020-01-08 15:06:16,429 [INFO] dropout_51 (Dropout)         (None, 64)                0         
2020-01-08 15:06:16,429 [INFO] _________________________________________________________________
2020-01-08 15:06:16,429 [INFO] dense_61 (Dense)             (None, 64)                4160      
2020-01-08 15:06:16,429 [INFO] _________________________________________________________________
2020-01-08 15:06:16,430 [INFO] batch_normalization_52 (Batc (None, 64)                256       
2020-01-08 15:06:16,430 [INFO] _________________________________________________________________
2020-01-08 15:06:16,430 [INFO] dropout_52 (Dropout)         (None, 64)                0         
2020-01-08 15:06:16,430 [INFO] _________________________________________________________________
2020-01-08 15:06:16,430 [INFO] dense_62 (Dense)             (None, 64)                4160      
2020-01-08 15:06:16,430 [INFO] _________________________________________________________________
2020-01-08 15:06:16,430 [INFO] batch_normalization_53 (Batc (None, 64)                256       
2020-01-08 15:06:16,430 [INFO] _________________________________________________________________
2020-01-08 15:06:16,430 [INFO] dropout_53 (Dropout)         (None, 64)                0         
2020-01-08 15:06:16,430 [INFO] _________________________________________________________________
2020-01-08 15:06:16,430 [INFO] dense_63 (Dense)             (None, 64)                4160      
2020-01-08 15:06:16,430 [INFO] _________________________________________________________________
2020-01-08 15:06:16,430 [INFO] batch_normalization_54 (Batc (None, 64)                256       
2020-01-08 15:06:16,430 [INFO] _________________________________________________________________
2020-01-08 15:06:16,430 [INFO] dropout_54 (Dropout)         (None, 64)                0         
2020-01-08 15:06:16,430 [INFO] _________________________________________________________________
2020-01-08 15:06:16,430 [INFO] dense_64 (Dense)             (None, 64)                4160      
2020-01-08 15:06:16,430 [INFO] _________________________________________________________________
2020-01-08 15:06:16,431 [INFO] batch_normalization_55 (Batc (None, 64)                256       
2020-01-08 15:06:16,431 [INFO] _________________________________________________________________
2020-01-08 15:06:16,431 [INFO] dropout_55 (Dropout)         (None, 64)                0         
2020-01-08 15:06:16,431 [INFO] _________________________________________________________________
2020-01-08 15:06:16,431 [INFO] dense_65 (Dense)             (None, 5)                 325       
2020-01-08 15:06:16,431 [INFO] =================================================================
2020-01-08 15:06:16,431 [INFO] Total params: 48,197
2020-01-08 15:06:16,431 [INFO] Trainable params: 46,917
2020-01-08 15:06:16,431 [INFO] Non-trainable params: 1,280
2020-01-08 15:06:16,431 [INFO] _________________________________________________________________
2020-01-08 15:06:16,431 [INFO] Training model
 - val_f1: 0.9963
Epoch 00166: early stopping
Train on 100778 samples, validate on 25195 samples
Epoch 1/200
 - 6s - loss: 0.2033 - val_loss: 0.0579
 - val_f1: 0.9663
Epoch 2/200
 - 4s - loss: 0.0653 - val_loss: 0.0296
 - val_f1: 0.9746
Epoch 3/200
 - 4s - loss: 0.0424 - val_loss: 0.0209
 - val_f1: 0.9787
Epoch 4/200
 - 4s - loss: 0.0324 - val_loss: 0.0170
 - val_f1: 0.9807
Epoch 5/200
 - 4s - loss: 0.0277 - val_loss: 0.0142
 - val_f1: 0.9833
Epoch 6/200
 - 4s - loss: 0.0251 - val_loss: 0.0145
 - val_f1: 0.9878
Epoch 7/200
 - 4s - loss: 0.0227 - val_loss: 0.0131
 - val_f1: 0.9904
Epoch 8/200
 - 4s - loss: 0.0208 - val_loss: 0.0130
 - val_f1: 0.9866
Epoch 9/200
 - 4s - loss: 0.0197 - val_loss: 0.0123
 - val_f1: 0.9897
Epoch 10/200
 - 4s - loss: 0.0179 - val_loss: 0.0111
 - val_f1: 0.9907
Epoch 11/200
 - 4s - loss: 0.0171 - val_loss: 0.0115
 - val_f1: 0.9906
Epoch 12/200
 - 4s - loss: 0.0162 - val_loss: 0.0101
 - val_f1: 0.9913
Epoch 13/200
 - 4s - loss: 0.0148 - val_loss: 0.0105
 - val_f1: 0.9923
Epoch 14/200
 - 4s - loss: 0.0141 - val_loss: 0.0105
 - val_f1: 0.9915
Epoch 15/200
 - 4s - loss: 0.0143 - val_loss: 0.0094
 - val_f1: 0.9917
Epoch 16/200
 - 4s - loss: 0.0138 - val_loss: 0.0101
 - val_f1: 0.9919
Epoch 17/200
 - 4s - loss: 0.0130 - val_loss: 0.0087
 - val_f1: 0.9926
Epoch 18/200
 - 4s - loss: 0.0127 - val_loss: 0.0088
 - val_f1: 0.9934
Epoch 19/200
 - 4s - loss: 0.0122 - val_loss: 0.0092
 - val_f1: 0.9922
Epoch 20/200
 - 4s - loss: 0.0115 - val_loss: 0.0095
 - val_f1: 0.9929
Epoch 21/200
 - 4s - loss: 0.0118 - val_loss: 0.0087
2020-01-08 15:08:06,750 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_10/ann_model_epoch_20.pickle
 - val_f1: 0.9938
Epoch 22/200
 - 4s - loss: 0.0114 - val_loss: 0.0089
 - val_f1: 0.9923
Epoch 23/200
 - 4s - loss: 0.0110 - val_loss: 0.0083
 - val_f1: 0.9949
Epoch 24/200
 - 4s - loss: 0.0107 - val_loss: 0.0086
 - val_f1: 0.9925
Epoch 25/200
 - 4s - loss: 0.0110 - val_loss: 0.0081
 - val_f1: 0.9944
Epoch 26/200
 - 4s - loss: 0.0105 - val_loss: 0.0073
 - val_f1: 0.9948
Epoch 27/200
 - 4s - loss: 0.0100 - val_loss: 0.0085
 - val_f1: 0.9924
Epoch 28/200
 - 4s - loss: 0.0102 - val_loss: 0.0078
 - val_f1: 0.9950
Epoch 29/200
 - 4s - loss: 0.0098 - val_loss: 0.0080
 - val_f1: 0.9939
Epoch 30/200
 - 4s - loss: 0.0094 - val_loss: 0.0075
 - val_f1: 0.9945
Epoch 31/200
 - 4s - loss: 0.0093 - val_loss: 0.0073
 - val_f1: 0.9951
Epoch 32/200
 - 4s - loss: 0.0094 - val_loss: 0.0088
 - val_f1: 0.9944
Epoch 33/200
 - 4s - loss: 0.0092 - val_loss: 0.0069
 - val_f1: 0.9947
Epoch 34/200
 - 4s - loss: 0.0090 - val_loss: 0.0078
 - val_f1: 0.9945
Epoch 35/200
 - 4s - loss: 0.0090 - val_loss: 0.0078
 - val_f1: 0.9946
Epoch 36/200
 - 4s - loss: 0.0086 - val_loss: 0.0073
 - val_f1: 0.9952
Epoch 37/200
 - 4s - loss: 0.0088 - val_loss: 0.0074
 - val_f1: 0.9950
Epoch 38/200
 - 4s - loss: 0.0084 - val_loss: 0.0067
 - val_f1: 0.9956
Epoch 39/200
 - 4s - loss: 0.0086 - val_loss: 0.0069
 - val_f1: 0.9950
Epoch 40/200
 - 4s - loss: 0.0082 - val_loss: 0.0068
 - val_f1: 0.9954
Epoch 41/200
 - 4s - loss: 0.0082 - val_loss: 0.0064
2020-01-08 15:09:34,457 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_10/ann_model_epoch_40.pickle
 - val_f1: 0.9950
Epoch 42/200
 - 4s - loss: 0.0083 - val_loss: 0.0068
 - val_f1: 0.9950
Epoch 43/200
 - 4s - loss: 0.0080 - val_loss: 0.0072
 - val_f1: 0.9952
Epoch 44/200
 - 4s - loss: 0.0082 - val_loss: 0.0068
 - val_f1: 0.9951
Epoch 45/200
 - 4s - loss: 0.0075 - val_loss: 0.0064
 - val_f1: 0.9956
Epoch 46/200
 - 4s - loss: 0.0077 - val_loss: 0.0061
 - val_f1: 0.9957
Epoch 47/200
 - 4s - loss: 0.0075 - val_loss: 0.0063
 - val_f1: 0.9958
Epoch 48/200
 - 4s - loss: 0.0075 - val_loss: 0.0062
 - val_f1: 0.9954
Epoch 49/200
 - 4s - loss: 0.0076 - val_loss: 0.0060
 - val_f1: 0.9958
Epoch 50/200
 - 4s - loss: 0.0076 - val_loss: 0.0064
 - val_f1: 0.9958
Epoch 51/200
 - 4s - loss: 0.0074 - val_loss: 0.0067
 - val_f1: 0.9952
Epoch 52/200
 - 4s - loss: 0.0077 - val_loss: 0.0059
 - val_f1: 0.9964
Epoch 53/200
 - 4s - loss: 0.0071 - val_loss: 0.0063
 - val_f1: 0.9957
Epoch 54/200
 - 4s - loss: 0.0074 - val_loss: 0.0060
 - val_f1: 0.9958
Epoch 55/200
 - 4s - loss: 0.0069 - val_loss: 0.0057
 - val_f1: 0.9959
Epoch 56/200
 - 4s - loss: 0.0070 - val_loss: 0.0055
 - val_f1: 0.9962
Epoch 57/200
 - 4s - loss: 0.0068 - val_loss: 0.0057
 - val_f1: 0.9962
Epoch 58/200
 - 4s - loss: 0.0068 - val_loss: 0.0059
 - val_f1: 0.9959
Epoch 59/200
 - 4s - loss: 0.0067 - val_loss: 0.0055
 - val_f1: 0.9960
Epoch 60/200
 - 4s - loss: 0.0067 - val_loss: 0.0063
 - val_f1: 0.9954
Epoch 61/200
 - 4s - loss: 0.0067 - val_loss: 0.0057
2020-01-08 15:11:02,396 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_10/ann_model_epoch_60.pickle
 - val_f1: 0.9961
Epoch 62/200
 - 4s - loss: 0.0067 - val_loss: 0.0060
 - val_f1: 0.9957
Epoch 63/200
 - 4s - loss: 0.0067 - val_loss: 0.0061
 - val_f1: 0.9959
Epoch 64/200
 - 4s - loss: 0.0065 - val_loss: 0.0056
 - val_f1: 0.9961
Epoch 65/200
 - 4s - loss: 0.0063 - val_loss: 0.0061
 - val_f1: 0.9957
Epoch 66/200
 - 4s - loss: 0.0061 - val_loss: 0.0057
 - val_f1: 0.9959
Epoch 67/200
 - 4s - loss: 0.0064 - val_loss: 0.0080
 - val_f1: 0.9934
Epoch 68/200
 - 4s - loss: 0.0062 - val_loss: 0.0056
 - val_f1: 0.9959
Epoch 69/200
 - 4s - loss: 0.0062 - val_loss: 0.0059
 - val_f1: 0.9959
Epoch 70/200
 - 4s - loss: 0.0064 - val_loss: 0.0054
 - val_f1: 0.9962
Epoch 71/200
 - 4s - loss: 0.0060 - val_loss: 0.0053
 - val_f1: 0.9958
Epoch 72/200
 - 4s - loss: 0.0062 - val_loss: 0.0058
 - val_f1: 0.9956
Epoch 73/200
 - 4s - loss: 0.0059 - val_loss: 0.0056
 - val_f1: 0.9961
Epoch 74/200
 - 4s - loss: 0.0061 - val_loss: 0.0054
 - val_f1: 0.9961
Epoch 75/200
 - 4s - loss: 0.0060 - val_loss: 0.0057
 - val_f1: 0.9960
Epoch 76/200
 - 4s - loss: 0.0059 - val_loss: 0.0055
 - val_f1: 0.9963
Epoch 77/200
 - 4s - loss: 0.0057 - val_loss: 0.0056
 - val_f1: 0.9961
Epoch 78/200
 - 4s - loss: 0.0057 - val_loss: 0.0051
 - val_f1: 0.9963
Epoch 79/200
 - 4s - loss: 0.0062 - val_loss: 0.0054
 - val_f1: 0.9965
Epoch 80/200
 - 4s - loss: 0.0059 - val_loss: 0.0051
 - val_f1: 0.9965
Epoch 81/200
 - 4s - loss: 0.0057 - val_loss: 0.0057
2020-01-08 15:12:30,157 [INFO] epoch = 80. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_10/ann_model_epoch_80.pickle
 - val_f1: 0.9958
Epoch 82/200
 - 4s - loss: 0.0059 - val_loss: 0.0053
 - val_f1: 0.9961
Epoch 83/200
 - 4s - loss: 0.0058 - val_loss: 0.0051
 - val_f1: 0.9961
Epoch 84/200
 - 4s - loss: 0.0058 - val_loss: 0.0051
 - val_f1: 0.9965
Epoch 85/200
 - 4s - loss: 0.0055 - val_loss: 0.0051
 - val_f1: 0.9961
Epoch 86/200
 - 4s - loss: 0.0056 - val_loss: 0.0053
 - val_f1: 0.9963
Epoch 87/200
 - 4s - loss: 0.0058 - val_loss: 0.0053
 - val_f1: 0.9964
Epoch 88/200
 - 4s - loss: 0.0055 - val_loss: 0.0054
 - val_f1: 0.9961
Epoch 89/200
 - 4s - loss: 0.0055 - val_loss: 0.0053
 - val_f1: 0.9963
Epoch 90/200
 - 4s - loss: 0.0053 - val_loss: 0.0055
 - val_f1: 0.9965
Epoch 91/200
 - 4s - loss: 0.0055 - val_loss: 0.0057
 - val_f1: 0.9959
Epoch 92/200
 - 4s - loss: 0.0054 - val_loss: 0.0050
 - val_f1: 0.9965
Epoch 93/200
 - 4s - loss: 0.0059 - val_loss: 0.0050
 - val_f1: 0.9965
Epoch 94/200
 - 4s - loss: 0.0054 - val_loss: 0.0050
 - val_f1: 0.9964
Epoch 95/200
 - 4s - loss: 0.0055 - val_loss: 0.0050
 - val_f1: 0.9963
Epoch 96/200
 - 4s - loss: 0.0053 - val_loss: 0.0052
 - val_f1: 0.9962
Epoch 97/200
 - 4s - loss: 0.0052 - val_loss: 0.0053
 - val_f1: 0.9960
Epoch 98/200
 - 4s - loss: 0.0053 - val_loss: 0.0058
 - val_f1: 0.9960
Epoch 99/200
 - 4s - loss: 0.0050 - val_loss: 0.0055
 - val_f1: 0.9966
Epoch 100/200
 - 4s - loss: 0.0053 - val_loss: 0.0051
 - val_f1: 0.9966
Epoch 101/200
 - 4s - loss: 0.0050 - val_loss: 0.0055
2020-01-08 15:13:57,957 [INFO] epoch = 100. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_10/ann_model_epoch_100.pickle
 - val_f1: 0.9962
Epoch 102/200
 - 4s - loss: 0.0057 - val_loss: 0.0054
 - val_f1: 0.9963
Epoch 103/200
 - 4s - loss: 0.0053 - val_loss: 0.0053
 - val_f1: 0.9965
Epoch 104/200
 - 4s - loss: 0.0051 - val_loss: 0.0050
 - val_f1: 0.9963
Epoch 105/200
 - 4s - loss: 0.0051 - val_loss: 0.0048
 - val_f1: 0.9964
Epoch 106/200
 - 4s - loss: 0.0055 - val_loss: 0.0049
 - val_f1: 0.9958
Epoch 107/200
 - 4s - loss: 0.0054 - val_loss: 0.0049
 - val_f1: 0.9962
Epoch 108/200
 - 4s - loss: 0.0052 - val_loss: 0.0052
 - val_f1: 0.9960
Epoch 109/200
 - 4s - loss: 0.0051 - val_loss: 0.0054
 - val_f1: 0.9963
Epoch 110/200
 - 4s - loss: 0.0053 - val_loss: 0.0048
 - val_f1: 0.9967
Epoch 111/200
 - 4s - loss: 0.0050 - val_loss: 0.0052
 - val_f1: 0.9962
Epoch 112/200
 - 4s - loss: 0.0050 - val_loss: 0.0048
 - val_f1: 0.9965
Epoch 113/200
 - 4s - loss: 0.0051 - val_loss: 0.0049
 - val_f1: 0.9966
Epoch 114/200
 - 4s - loss: 0.0050 - val_loss: 0.0049
 - val_f1: 0.9967
Epoch 115/200
 - 4s - loss: 0.0052 - val_loss: 0.0050
 - val_f1: 0.9965
Epoch 116/200
 - 4s - loss: 0.0051 - val_loss: 0.0048
 - val_f1: 0.9967
Epoch 117/200
 - 4s - loss: 0.0052 - val_loss: 0.0049
 - val_f1: 0.9967
Epoch 118/200
 - 4s - loss: 0.0047 - val_loss: 0.0050
 - val_f1: 0.9965
Epoch 119/200
 - 4s - loss: 0.0053 - val_loss: 0.0051
 - val_f1: 0.9963
Epoch 120/200
 - 4s - loss: 0.0052 - val_loss: 0.0048
 - val_f1: 0.9968
Epoch 121/200
 - 4s - loss: 0.0046 - val_loss: 0.0049
2020-01-08 15:15:25,688 [INFO] epoch = 120. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_10/ann_model_epoch_120.pickle
 - val_f1: 0.9964
Epoch 122/200
 - 4s - loss: 0.0047 - val_loss: 0.0049
 - val_f1: 0.9966
Epoch 123/200
 - 4s - loss: 0.0047 - val_loss: 0.0051
 - val_f1: 0.9965
Epoch 124/200
 - 4s - loss: 0.0047 - val_loss: 0.0050
 - val_f1: 0.9963
Epoch 125/200
 - 4s - loss: 0.0049 - val_loss: 0.0053
 - val_f1: 0.9963
Epoch 126/200
 - 4s - loss: 0.0051 - val_loss: 0.0048
 - val_f1: 0.9966
Epoch 127/200
 - 4s - loss: 0.0048 - val_loss: 0.0051
 - val_f1: 0.9964
Epoch 128/200
 - 4s - loss: 0.0050 - val_loss: 0.0049
 - val_f1: 0.9962
Epoch 129/200
 - 4s - loss: 0.0046 - val_loss: 0.0048
 - val_f1: 0.9963
Epoch 130/200
 - 4s - loss: 0.0046 - val_loss: 0.0051
 - val_f1: 0.9965
Epoch 131/200
 - 4s - loss: 0.0046 - val_loss: 0.0066
 - val_f1: 0.9948
Epoch 132/200
 - 4s - loss: 0.0049 - val_loss: 0.0049
 - val_f1: 0.9963
Epoch 133/200
 - 4s - loss: 0.0051 - val_loss: 0.0049
 - val_f1: 0.9964
Epoch 134/200
 - 4s - loss: 0.0045 - val_loss: 0.0050
 - val_f1: 0.9962
Epoch 135/200
 - 4s - loss: 0.0045 - val_loss: 0.0050
 - val_f1: 0.9962
Epoch 136/200
 - 4s - loss: 0.0045 - val_loss: 0.0052
 - val_f1: 0.9963
Epoch 137/200
 - 4s - loss: 0.0047 - val_loss: 0.0051
 - val_f1: 0.9963
Epoch 138/200
 - 4s - loss: 0.0046 - val_loss: 0.0049
 - val_f1: 0.9964
Epoch 139/200
 - 4s - loss: 0.0045 - val_loss: 0.0055
 - val_f1: 0.9961
Epoch 140/200
 - 4s - loss: 0.0048 - val_loss: 0.0053
 - val_f1: 0.9962
Epoch 141/200
 - 4s - loss: 0.0051 - val_loss: 0.0053
2020-01-08 15:16:53,482 [INFO] epoch = 140. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_10/ann_model_epoch_140.pickle
 - val_f1: 0.9963
Epoch 142/200
 - 4s - loss: 0.0047 - val_loss: 0.0050
 - val_f1: 0.9964
Epoch 143/200
 - 4s - loss: 0.0048 - val_loss: 0.0050
 - val_f1: 0.9963
Epoch 144/200
 - 4s - loss: 0.0044 - val_loss: 0.0049
 - val_f1: 0.9967
Epoch 145/200
 - 4s - loss: 0.0046 - val_loss: 0.0051
 - val_f1: 0.9965
Epoch 146/200
 - 4s - loss: 0.0047 - val_loss: 0.0046
 - val_f1: 0.9965
Epoch 147/200
 - 4s - loss: 0.0047 - val_loss: 0.0051
 - val_f1: 0.9964
Epoch 148/200
 - 4s - loss: 0.0045 - val_loss: 0.0048
 - val_f1: 0.9964
Epoch 149/200
 - 4s - loss: 0.0044 - val_loss: 0.0051
 - val_f1: 0.9962
Epoch 150/200
 - 4s - loss: 0.0044 - val_loss: 0.0049
 - val_f1: 0.9965
Epoch 151/200
 - 4s - loss: 0.0044 - val_loss: 0.0047
 - val_f1: 0.9964
Epoch 152/200
 - 4s - loss: 0.0043 - val_loss: 0.0046
 - val_f1: 0.9964
Epoch 153/200
 - 4s - loss: 0.0045 - val_loss: 0.0052
 - val_f1: 0.9965
Epoch 154/200
 - 4s - loss: 0.0043 - val_loss: 0.0050
 - val_f1: 0.9966
Epoch 155/200
 - 4s - loss: 0.0042 - val_loss: 0.0050
 - val_f1: 0.9965
Epoch 156/200
 - 4s - loss: 0.0044 - val_loss: 0.0056
 - val_f1: 0.9961
Epoch 157/200
 - 4s - loss: 0.0044 - val_loss: 0.0051
 - val_f1: 0.9965
Epoch 158/200
 - 4s - loss: 0.0047 - val_loss: 0.0052
 - val_f1: 0.9964
Epoch 159/200
 - 4s - loss: 0.0045 - val_loss: 0.0053
 - val_f1: 0.9963
Epoch 160/200
 - 4s - loss: 0.0041 - val_loss: 0.0050
 - val_f1: 0.9965
Epoch 161/200
 - 4s - loss: 0.0045 - val_loss: 0.0050
2020-01-08 15:18:21,339 [INFO] epoch = 160. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_10/ann_model_epoch_160.pickle
 - val_f1: 0.9965
Epoch 162/200
 - 4s - loss: 0.0046 - val_loss: 0.0049
 - val_f1: 0.9964
Epoch 163/200
 - 4s - loss: 0.0043 - val_loss: 0.0054
 - val_f1: 0.9960
Epoch 164/200
 - 4s - loss: 0.0043 - val_loss: 0.0053
 - val_f1: 0.9963
Epoch 165/200
 - 4s - loss: 0.0040 - val_loss: 0.0051
 - val_f1: 0.9964
Epoch 166/200
 - 4s - loss: 0.0045 - val_loss: 0.0046
 - val_f1: 0.9965
Epoch 167/200
 - 4s - loss: 0.0044 - val_loss: 0.0048
 - val_f1: 0.9965
Epoch 168/200
 - 4s - loss: 0.0041 - val_loss: 0.0050
 - val_f1: 0.9966
Epoch 169/200
 - 4s - loss: 0.0043 - val_loss: 0.0049
 - val_f1: 0.9967
Epoch 170/200
 - 4s - loss: 0.0044 - val_loss: 0.0054
 - val_f1: 0.9962
Epoch 171/200
 - 4s - loss: 0.0043 - val_loss: 0.0048
 - val_f1: 0.9965
Epoch 172/200
 - 4s - loss: 0.0046 - val_loss: 0.0049
 - val_f1: 0.9965
Epoch 173/200
 - 4s - loss: 0.0042 - val_loss: 0.0052
 - val_f1: 0.9964
Epoch 174/200
 - 4s - loss: 0.0041 - val_loss: 0.0053
 - val_f1: 0.9966
Epoch 175/200
 - 4s - loss: 0.0046 - val_loss: 0.0052
 - val_f1: 0.9967
Epoch 176/200
 - 4s - loss: 0.0042 - val_loss: 0.0053
 - val_f1: 0.9963
Epoch 177/200
 - 4s - loss: 0.0043 - val_loss: 0.0071
 - val_f1: 0.9958
Epoch 178/200
 - 4s - loss: 0.0043 - val_loss: 0.0053
 - val_f1: 0.9962
Epoch 179/200
 - 4s - loss: 0.0041 - val_loss: 0.0049
 - val_f1: 0.9963
Epoch 180/200
 - 4s - loss: 0.0041 - val_loss: 0.0050
 - val_f1: 0.9965
Epoch 181/200
 - 4s - loss: 0.0041 - val_loss: 0.0054
2020-01-08 15:19:49,389 [INFO] epoch = 180. Intermediate model saved to results_additional_exps/ann_depth_nsl_layers_10/ann_model_epoch_180.pickle
 - val_f1: 0.9962
Epoch 182/200
 - 4s - loss: 0.0042 - val_loss: 0.0054
 - val_f1: 0.9966
Epoch 183/200
 - 4s - loss: 0.0039 - val_loss: 0.0050
 - val_f1: 0.9968
Epoch 184/200
 - 4s - loss: 0.0041 - val_loss: 0.0051
 - val_f1: 0.9967
Epoch 185/200
 - 4s - loss: 0.0042 - val_loss: 0.0055
 - val_f1: 0.9961
Epoch 186/200
 - 4s - loss: 0.0040 - val_loss: 0.0051
 - val_f1: 0.9965
Epoch 187/200
 - 4s - loss: 0.0043 - val_loss: 0.0047
 - val_f1: 0.9966
Epoch 188/200
 - 4s - loss: 0.0040 - val_loss: 0.0051
 - val_f1: 0.9962
Epoch 189/200
 - 4s - loss: 0.0043 - val_loss: 0.0051
 - val_f1: 0.9964
Epoch 190/200
 - 4s - loss: 0.0040 - val_loss: 0.0049
 - val_f1: 0.9968
Epoch 191/200
 - 4s - loss: 0.0039 - val_loss: 0.0047
 - val_f1: 0.9968
Epoch 192/200
 - 4s - loss: 0.0042 - val_loss: 0.0049
 - val_f1: 0.9965
Epoch 193/200
 - 4s - loss: 0.0039 - val_loss: 0.0048
 - val_f1: 0.9966
Epoch 194/200
 - 4s - loss: 0.0041 - val_loss: 0.0051
 - val_f1: 0.9967
Epoch 195/200
 - 4s - loss: 0.0043 - val_loss: 0.0047
 - val_f1: 0.9967
Epoch 196/200
 - 4s - loss: 0.0043 - val_loss: 0.0046
 - val_f1: 0.9966
Epoch 197/200
 - 4s - loss: 0.0040 - val_loss: 0.0049
 - val_f1: 0.9966
Epoch 198/200
 - 4s - loss: 0.0040 - val_loss: 0.0052
 - val_f1: 0.9965
Epoch 199/200
 - 4s - loss: 0.0048 - val_loss: 0.0046
 - val_f1: 0.9967
Epoch 200/200
 - 4s - loss: 0.0040 - val_loss: 0.0047
2020-01-08 15:21:13,627 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-08 15:21:19,126 [INFO] Last epoch loss evaluation: train_loss = 0.002571, val_loss = 0.004564
2020-01-08 15:21:19,126 [INFO] Training complete. time_to_train = 902.70 sec, 15.04 min
2020-01-08 15:21:19,149 [INFO] Model saved to results_additional_exps/ann_depth_nsl_layers_10/best_model.pickle
2020-01-08 15:21:19,153 [INFO] Training history saved to: results_additional_exps/ann_depth_nsl_layers_10/training_error_history.csv
2020-01-08 15:21:19,349 [INFO] Plot saved to: results_additional_exps/ann_depth_nsl_layers_10/training_error_history.png
2020-01-08 15:21:19,527 [INFO] Plot saved to: results_additional_exps/ann_depth_nsl_layers_10/training_f1_history.png
2020-01-08 15:21:19,527 [INFO] Making predictions on training, validation, testing data
2020-01-08 15:21:24,469 [INFO] Evaluating predictions (results)
2020-01-08 15:21:24,736 [INFO] Dataset: Testing. Classification report below
2020-01-08 15:21:24,736 [INFO] 
              precision    recall  f1-score   support

         dos       0.96      0.82      0.89      7458
      normal       0.68      0.94      0.79      9711
       probe       0.73      0.72      0.72      2421
         r2l       0.94      0.11      0.20      2421
         u2r       0.84      0.04      0.08       533

   micro avg       0.77      0.77      0.77     22544
   macro avg       0.83      0.53      0.54     22544
weighted avg       0.81      0.77      0.73     22544

2020-01-08 15:21:24,736 [INFO] Overall accuracy (micro avg): 0.7684084457061746
2020-01-08 15:21:25,033 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.7684         0.7684                       0.7684                0.0579                   0.2316  0.7684
1     Macro avg        0.9074         0.8295                       0.5269                0.0770                   0.4731  0.5352
2  Weighted avg        0.8669         0.8097                       0.7684                0.1534                   0.2316  0.7348
2020-01-08 15:21:25,367 [INFO] Dataset: Validation. Classification report below
2020-01-08 15:21:25,367 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00      9186
      normal       1.00      1.00      1.00     13469
       probe       1.00      0.99      0.99      2331
         r2l       0.97      0.88      0.92       199
         u2r       0.80      0.40      0.53        10

   micro avg       1.00      1.00      1.00     25195
   macro avg       0.95      0.85      0.89     25195
weighted avg       1.00      1.00      1.00     25195

2020-01-08 15:21:25,367 [INFO] Overall accuracy (micro avg): 0.9967056955745187
2020-01-08 15:21:25,725 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9967         0.9967                       0.9967                0.0008                   0.0033  0.9967
1     Macro avg        0.9987         0.9514                       0.8534                0.0012                   0.1466  0.8887
2  Weighted avg        0.9980         0.9966                       0.9967                0.0027                   0.0033  0.9966
2020-01-08 15:21:27,172 [INFO] Dataset: Training. Classification report below
2020-01-08 15:21:27,172 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00     36741
      normal       1.00      1.00      1.00     53874
       probe       1.00      0.99      0.99      9325
         r2l       0.98      0.91      0.94       796
         u2r       0.90      0.64      0.75        42

   micro avg       1.00      1.00      1.00    100778
   macro avg       0.97      0.91      0.94    100778
weighted avg       1.00      1.00      1.00    100778

2020-01-08 15:21:27,174 [INFO] Overall accuracy (micro avg): 0.9977177558594138
2020-01-08 15:21:28,801 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9977         0.9977                       0.9977                0.0006                   0.0023  0.9977
1     Macro avg        0.9991         0.9748                       0.9079                0.0009                   0.0921  0.9367
2  Weighted avg        0.9986         0.9977                       0.9977                0.0021                   0.0023  0.9977
2020-01-08 15:21:28,840 [INFO] Results saved to: results_additional_exps/ann_depth_nsl_layers_10/ann_depth_nsl_layers_10_results.xlsx
2020-01-08 15:21:28,840 [INFO] ================= Finished running experiment no. 10 ================= 

2020-01-08 15:21:28,843 [INFO] ================= Finished running 10 experiments ================= 

 - val_f1: 0.9969
