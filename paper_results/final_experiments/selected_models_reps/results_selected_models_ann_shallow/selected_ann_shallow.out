Using TensorFlow backend.
/home/sunanda/anaconda3/envs/ml_env_cpu/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:526: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/sunanda/anaconda3/envs/ml_env_cpu/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:527: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/sunanda/anaconda3/envs/ml_env_cpu/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:528: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/sunanda/anaconda3/envs/ml_env_cpu/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:529: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/sunanda/anaconda3/envs/ml_env_cpu/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:530: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/sunanda/anaconda3/envs/ml_env_cpu/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:535: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
2019-12-20 17:16:32,458 [INFO] Read 20 experiments from file: experiment_specs/selected_model_tests/selected_ann.csv
2019-12-20 17:16:32,458 [INFO] ================= Started running experiments ================= 

2019-12-20 17:16:32,459 [INFO] Created directory: results_selected_models/selected_nsl_ann_shallow_rep1
2019-12-20 17:16:32,459 [INFO] Initialized logging. log_filename = results_selected_models/selected_nsl_ann_shallow_rep1/run_log.log
2019-12-20 17:16:32,459 [INFO] ================= Running experiment no. 1  ================= 

2019-12-20 17:16:32,459 [INFO] Experiment parameters given below
2019-12-20 17:16:32,459 [INFO] 
{'experiment_num': 1, 'results_dir': 'results_selected_models/selected_nsl_ann_shallow_rep1', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [256], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 300, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/nsl_kdd_five_classes', 'description': 'selected_nsl_ann_shallow_rep1'}
2019-12-20 17:16:32,459 [INFO] Created tensorboard log directory: results_selected_models/selected_nsl_ann_shallow_rep1/tf_logs_run_2019_12_20-17_16_32
2019-12-20 17:16:32,459 [INFO] Loading datsets from: ../Datasets/small_datasets/nsl_kdd_five_classes
2019-12-20 17:16:32,461 [INFO] Reading X, y files
2019-12-20 17:16:32,461 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_train.h5
2019-12-20 17:16:32,491 [INFO] NumExpr defaulting to 8 threads.
2019-12-20 17:16:32,796 [INFO] Reading complete. time_to_read=0.33 seconds
2019-12-20 17:16:32,796 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_val.h5
2019-12-20 17:16:32,880 [INFO] Reading complete. time_to_read=0.08 seconds
2019-12-20 17:16:32,880 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_test.h5
2019-12-20 17:16:32,959 [INFO] Reading complete. time_to_read=0.08 seconds
2019-12-20 17:16:32,959 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_train.h5
2019-12-20 17:16:32,975 [INFO] Reading complete. time_to_read=0.02 seconds
2019-12-20 17:16:32,975 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_val.h5
2019-12-20 17:16:32,985 [INFO] Reading complete. time_to_read=0.01 seconds
2019-12-20 17:16:32,985 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_test.h5
2019-12-20 17:16:32,997 [INFO] Reading complete. time_to_read=0.01 seconds
2019-12-20 17:16:33,124 [INFO] Initializing model
WARNING:tensorflow:From /home/sunanda/anaconda3/envs/ml_env_cpu/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
2019-12-20 17:16:33,148 [WARNING] From /home/sunanda/anaconda3/envs/ml_env_cpu/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /home/sunanda/anaconda3/envs/ml_env_cpu/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2019-12-20 17:16:33,230 [WARNING] From /home/sunanda/anaconda3/envs/ml_env_cpu/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2019-12-20 17:16:33,275 [INFO] _________________________________________________________________
2019-12-20 17:16:33,276 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-20 17:16:33,276 [INFO] =================================================================
2019-12-20 17:16:33,276 [INFO] dense_1 (Dense)              (None, 256)               31488     
2019-12-20 17:16:33,276 [INFO] _________________________________________________________________
2019-12-20 17:16:33,276 [INFO] batch_normalization_1 (Batch (None, 256)               1024      
2019-12-20 17:16:33,276 [INFO] _________________________________________________________________
2019-12-20 17:16:33,276 [INFO] dropout_1 (Dropout)          (None, 256)               0         
2019-12-20 17:16:33,276 [INFO] _________________________________________________________________
2019-12-20 17:16:33,276 [INFO] dense_2 (Dense)              (None, 5)                 1285      
2019-12-20 17:16:33,276 [INFO] =================================================================
2019-12-20 17:16:33,277 [INFO] Total params: 33,797
2019-12-20 17:16:33,277 [INFO] Trainable params: 33,285
2019-12-20 17:16:33,277 [INFO] Non-trainable params: 512
2019-12-20 17:16:33,277 [INFO] _________________________________________________________________
2019-12-20 17:16:33,277 [INFO] Training model
WARNING:tensorflow:From /home/sunanda/anaconda3/envs/ml_env_cpu/lib/python3.7/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-12-20 17:16:34,217 [WARNING] From /home/sunanda/anaconda3/envs/ml_env_cpu/lib/python3.7/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-12-20 17:16:34.560274: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX
2019-12-20 17:16:34.603662: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3701985000 Hz
2019-12-20 17:16:34.605411: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x560713807fb0 executing computations on platform Host. Devices:
2019-12-20 17:16:34.605445: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
OMP: Info #212: KMP_AFFINITY: decoding x2APIC ids.
OMP: Info #210: KMP_AFFINITY: Affinity capable, using global cpuid leaf 11 info
OMP: Info #154: KMP_AFFINITY: Initial OS proc set respected: 0-7
OMP: Info #156: KMP_AFFINITY: 8 available OS procs
OMP: Info #157: KMP_AFFINITY: Uniform topology
OMP: Info #179: KMP_AFFINITY: 1 packages x 4 cores/pkg x 2 threads/core (4 total cores)
OMP: Info #214: KMP_AFFINITY: OS proc to physical thread map:
OMP: Info #171: KMP_AFFINITY: OS proc 0 maps to package 0 core 0 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 4 maps to package 0 core 0 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 1 maps to package 0 core 1 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 5 maps to package 0 core 1 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 2 maps to package 0 core 2 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 6 maps to package 0 core 2 thread 1 
OMP: Info #171: KMP_AFFINITY: OS proc 3 maps to package 0 core 3 thread 0 
OMP: Info #171: KMP_AFFINITY: OS proc 7 maps to package 0 core 3 thread 1 
OMP: Info #250: KMP_AFFINITY: pid 5091 tid 5091 thread 0 bound to OS proc set 0
2019-12-20 17:16:34.606632: I tensorflow/core/common_runtime/process_util.cc:71] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
OMP: Info #250: KMP_AFFINITY: pid 5091 tid 5123 thread 1 bound to OS proc set 1
OMP: Info #250: KMP_AFFINITY: pid 5091 tid 5142 thread 2 bound to OS proc set 2
OMP: Info #250: KMP_AFFINITY: pid 5091 tid 5143 thread 3 bound to OS proc set 3
OMP: Info #250: KMP_AFFINITY: pid 5091 tid 5144 thread 4 bound to OS proc set 4
OMP: Info #250: KMP_AFFINITY: pid 5091 tid 5145 thread 5 bound to OS proc set 5
OMP: Info #250: KMP_AFFINITY: pid 5091 tid 5147 thread 7 bound to OS proc set 7
OMP: Info #250: KMP_AFFINITY: pid 5091 tid 5146 thread 6 bound to OS proc set 6
OMP: Info #250: KMP_AFFINITY: pid 5091 tid 5148 thread 8 bound to OS proc set 0
OMP: Info #250: KMP_AFFINITY: pid 5091 tid 5124 thread 9 bound to OS proc set 1
OMP: Info #250: KMP_AFFINITY: pid 5091 tid 5150 thread 11 bound to OS proc set 3
OMP: Info #250: KMP_AFFINITY: pid 5091 tid 5149 thread 10 bound to OS proc set 2
OMP: Info #250: KMP_AFFINITY: pid 5091 tid 5151 thread 12 bound to OS proc set 4
OMP: Info #250: KMP_AFFINITY: pid 5091 tid 5152 thread 13 bound to OS proc set 5
OMP: Info #250: KMP_AFFINITY: pid 5091 tid 5153 thread 14 bound to OS proc set 6
OMP: Info #250: KMP_AFFINITY: pid 5091 tid 5155 thread 16 bound to OS proc set 0
OMP: Info #250: KMP_AFFINITY: pid 5091 tid 5154 thread 15 bound to OS proc set 7
Train on 100778 samples, validate on 25195 samples
Epoch 1/300
 - 3s - loss: 0.0549 - val_loss: 0.0169
 - val_f1: 0.9890
Epoch 2/300
 - 2s - loss: 0.0165 - val_loss: 0.0119
 - val_f1: 0.9923
Epoch 3/300
 - 2s - loss: 0.0133 - val_loss: 0.0107
 - val_f1: 0.9927
Epoch 4/300
 - 2s - loss: 0.0114 - val_loss: 0.0098
 - val_f1: 0.9936
Epoch 5/300
 - 2s - loss: 0.0107 - val_loss: 0.0094
 - val_f1: 0.9943
Epoch 6/300
 - 2s - loss: 0.0096 - val_loss: 0.0096
 - val_f1: 0.9934
Epoch 7/300
 - 2s - loss: 0.0090 - val_loss: 0.0088
 - val_f1: 0.9940
Epoch 8/300
 - 2s - loss: 0.0085 - val_loss: 0.0084
 - val_f1: 0.9951
Epoch 9/300
 - 2s - loss: 0.0087 - val_loss: 0.0093
 - val_f1: 0.9940
Epoch 10/300
 - 2s - loss: 0.0084 - val_loss: 0.0079
 - val_f1: 0.9955
Epoch 11/300
 - 2s - loss: 0.0077 - val_loss: 0.0084
 - val_f1: 0.9949
Epoch 12/300
 - 2s - loss: 0.0075 - val_loss: 0.0080
 - val_f1: 0.9947
Epoch 13/300
 - 2s - loss: 0.0074 - val_loss: 0.0075
 - val_f1: 0.9955
Epoch 14/300
 - 2s - loss: 0.0071 - val_loss: 0.0084
 - val_f1: 0.9946
Epoch 15/300
 - 2s - loss: 0.0068 - val_loss: 0.0075
 - val_f1: 0.9952
Epoch 16/300
 - 2s - loss: 0.0067 - val_loss: 0.0071
 - val_f1: 0.9962
Epoch 17/300
 - 2s - loss: 0.0065 - val_loss: 0.0073
 - val_f1: 0.9960
Epoch 18/300
 - 2s - loss: 0.0063 - val_loss: 0.0074
 - val_f1: 0.9954
Epoch 19/300
 - 2s - loss: 0.0061 - val_loss: 0.0083
 - val_f1: 0.9957
Epoch 20/300
 - 2s - loss: 0.0060 - val_loss: 0.0074
 - val_f1: 0.9961
Epoch 21/300
 - 2s - loss: 0.0058 - val_loss: 0.0075
 - val_f1: 0.9956
Epoch 22/300
 - 2s - loss: 0.0057 - val_loss: 0.0080
 - val_f1: 0.9957
Epoch 23/300
 - 2s - loss: 0.0061 - val_loss: 0.0070
 - val_f1: 0.9962
Epoch 24/300
 - 2s - loss: 0.0059 - val_loss: 0.0076
 - val_f1: 0.9960
Epoch 25/300
 - 2s - loss: 0.0058 - val_loss: 0.0068
 - val_f1: 0.9966
Epoch 26/300
 - 2s - loss: 0.0053 - val_loss: 0.0073
 - val_f1: 0.9965
Epoch 27/300
 - 2s - loss: 0.0051 - val_loss: 0.0067
 - val_f1: 0.9965
Epoch 28/300
 - 2s - loss: 0.0053 - val_loss: 0.0070
 - val_f1: 0.9964
Epoch 29/300
 - 2s - loss: 0.0052 - val_loss: 0.0071
 - val_f1: 0.9959
Epoch 30/300
 - 2s - loss: 0.0053 - val_loss: 0.0077
 - val_f1: 0.9952
Epoch 31/300
 - 2s - loss: 0.0052 - val_loss: 0.0066
2019-12-20 17:17:53,111 [INFO] epoch = 30. Intermediate model saved to results_selected_models/selected_nsl_ann_shallow_rep1/ann_model_epoch_30.pickle
 - val_f1: 0.9965
Epoch 32/300
 - 2s - loss: 0.0048 - val_loss: 0.0069
 - val_f1: 0.9963
Epoch 33/300
 - 2s - loss: 0.0051 - val_loss: 0.0065
 - val_f1: 0.9962
Epoch 34/300
 - 2s - loss: 0.0048 - val_loss: 0.0065
 - val_f1: 0.9960
Epoch 35/300
 - 2s - loss: 0.0052 - val_loss: 0.0068
 - val_f1: 0.9963
Epoch 36/300
 - 2s - loss: 0.0048 - val_loss: 0.0064
 - val_f1: 0.9964
Epoch 37/300
 - 2s - loss: 0.0043 - val_loss: 0.0064
 - val_f1: 0.9967
Epoch 38/300
 - 2s - loss: 0.0048 - val_loss: 0.0066
 - val_f1: 0.9962
Epoch 39/300
 - 2s - loss: 0.0046 - val_loss: 0.0067
 - val_f1: 0.9967
Epoch 40/300
 - 2s - loss: 0.0046 - val_loss: 0.0073
 - val_f1: 0.9963
Epoch 41/300
 - 2s - loss: 0.0047 - val_loss: 0.0069
 - val_f1: 0.9968
Epoch 42/300
 - 2s - loss: 0.0045 - val_loss: 0.0070
 - val_f1: 0.9965
Epoch 43/300
 - 2s - loss: 0.0044 - val_loss: 0.0074
 - val_f1: 0.9964
Epoch 44/300
 - 2s - loss: 0.0045 - val_loss: 0.0068
 - val_f1: 0.9968
Epoch 45/300
 - 2s - loss: 0.0047 - val_loss: 0.0068
 - val_f1: 0.9964
Epoch 46/300
 - 2s - loss: 0.0043 - val_loss: 0.0069
 - val_f1: 0.9967
Epoch 47/300
 - 2s - loss: 0.0044 - val_loss: 0.0063
 - val_f1: 0.9966
Epoch 48/300
 - 2s - loss: 0.0046 - val_loss: 0.0066
 - val_f1: 0.9964
Epoch 49/300
 - 2s - loss: 0.0043 - val_loss: 0.0062
 - val_f1: 0.9966
Epoch 50/300
 - 2s - loss: 0.0041 - val_loss: 0.0062
 - val_f1: 0.9965
Epoch 51/300
 - 2s - loss: 0.0044 - val_loss: 0.0064
 - val_f1: 0.9965
Epoch 52/300
 - 2s - loss: 0.0044 - val_loss: 0.0071
 - val_f1: 0.9965
Epoch 53/300
 - 2s - loss: 0.0045 - val_loss: 0.0067
 - val_f1: 0.9965
Epoch 54/300
 - 2s - loss: 0.0042 - val_loss: 0.0068
 - val_f1: 0.9963
Epoch 55/300
 - 2s - loss: 0.0041 - val_loss: 0.0067
 - val_f1: 0.9964
Epoch 56/300
 - 2s - loss: 0.0040 - val_loss: 0.0063
 - val_f1: 0.9966
Epoch 57/300
 - 2s - loss: 0.0040 - val_loss: 0.0071
 - val_f1: 0.9964
Epoch 58/300
 - 2s - loss: 0.0040 - val_loss: 0.0069
 - val_f1: 0.9963
Epoch 59/300
 - 2s - loss: 0.0042 - val_loss: 0.0062
 - val_f1: 0.9968
Epoch 60/300
 - 2s - loss: 0.0042 - val_loss: 0.0071
 - val_f1: 0.9961
Epoch 61/300
 - 2s - loss: 0.0042 - val_loss: 0.0071
2019-12-20 17:19:08,132 [INFO] epoch = 60. Intermediate model saved to results_selected_models/selected_nsl_ann_shallow_rep1/ann_model_epoch_60.pickle
 - val_f1: 0.9965
Epoch 62/300
 - 2s - loss: 0.0042 - val_loss: 0.0062
 - val_f1: 0.9967
Epoch 63/300
 - 2s - loss: 0.0040 - val_loss: 0.0063
 - val_f1: 0.9968
Epoch 64/300
 - 2s - loss: 0.0040 - val_loss: 0.0069
 - val_f1: 0.9966
Epoch 65/300
 - 2s - loss: 0.0039 - val_loss: 0.0058
 - val_f1: 0.9969
Epoch 66/300
 - 2s - loss: 0.0042 - val_loss: 0.0065
 - val_f1: 0.9966
Epoch 67/300
 - 2s - loss: 0.0040 - val_loss: 0.0059
 - val_f1: 0.9970
Epoch 68/300
 - 2s - loss: 0.0038 - val_loss: 0.0068
 - val_f1: 0.9965
Epoch 69/300
 - 2s - loss: 0.0039 - val_loss: 0.0062
 - val_f1: 0.9970
Epoch 70/300
 - 2s - loss: 0.0038 - val_loss: 0.0062
 - val_f1: 0.9965
Epoch 71/300
 - 2s - loss: 0.0039 - val_loss: 0.0072
 - val_f1: 0.9962
Epoch 72/300
 - 2s - loss: 0.0042 - val_loss: 0.0066
 - val_f1: 0.9969
Epoch 73/300
 - 2s - loss: 0.0040 - val_loss: 0.0066
 - val_f1: 0.9965
Epoch 74/300
 - 2s - loss: 0.0039 - val_loss: 0.0077
 - val_f1: 0.9965
Epoch 75/300
 - 2s - loss: 0.0042 - val_loss: 0.0065
 - val_f1: 0.9969
Epoch 76/300
 - 2s - loss: 0.0042 - val_loss: 0.0065
 - val_f1: 0.9969
Epoch 77/300
 - 2s - loss: 0.0038 - val_loss: 0.0064
 - val_f1: 0.9966
Epoch 78/300
 - 2s - loss: 0.0038 - val_loss: 0.0066
 - val_f1: 0.9968
Epoch 79/300
 - 2s - loss: 0.0037 - val_loss: 0.0061
 - val_f1: 0.9971
Epoch 80/300
 - 2s - loss: 0.0039 - val_loss: 0.0059
 - val_f1: 0.9973
Epoch 81/300
 - 2s - loss: 0.0039 - val_loss: 0.0065
 - val_f1: 0.9968
Epoch 82/300
 - 2s - loss: 0.0039 - val_loss: 0.0061
 - val_f1: 0.9969
Epoch 83/300
 - 2s - loss: 0.0037 - val_loss: 0.0061
 - val_f1: 0.9971
Epoch 84/300
 - 2s - loss: 0.0036 - val_loss: 0.0071
 - val_f1: 0.9968
Epoch 85/300
 - 2s - loss: 0.0038 - val_loss: 0.0063
 - val_f1: 0.9970
Epoch 86/300
 - 2s - loss: 0.0037 - val_loss: 0.0063
 - val_f1: 0.9968
Epoch 87/300
 - 2s - loss: 0.0037 - val_loss: 0.0067
 - val_f1: 0.9960
Epoch 88/300
 - 2s - loss: 0.0037 - val_loss: 0.0063
 - val_f1: 0.9969
Epoch 89/300
 - 2s - loss: 0.0039 - val_loss: 0.0062
 - val_f1: 0.9971
Epoch 90/300
 - 2s - loss: 0.0033 - val_loss: 0.0061
 - val_f1: 0.9971
Epoch 91/300
 - 2s - loss: 0.0038 - val_loss: 0.0058
2019-12-20 17:20:23,258 [INFO] epoch = 90. Intermediate model saved to results_selected_models/selected_nsl_ann_shallow_rep1/ann_model_epoch_90.pickle
 - val_f1: 0.9973
Epoch 92/300
 - 2s - loss: 0.0036 - val_loss: 0.0062
 - val_f1: 0.9972
Epoch 93/300
 - 2s - loss: 0.0037 - val_loss: 0.0063
 - val_f1: 0.9969
Epoch 94/300
 - 2s - loss: 0.0034 - val_loss: 0.0066
 - val_f1: 0.9962
Epoch 95/300
 - 2s - loss: 0.0035 - val_loss: 0.0067
 - val_f1: 0.9969
Epoch 96/300
 - 2s - loss: 0.0036 - val_loss: 0.0062
 - val_f1: 0.9970
Epoch 97/300
 - 2s - loss: 0.0035 - val_loss: 0.0066
 - val_f1: 0.9965
Epoch 98/300
 - 2s - loss: 0.0033 - val_loss: 0.0065
 - val_f1: 0.9968
Epoch 99/300
 - 2s - loss: 0.0036 - val_loss: 0.0063
 - val_f1: 0.9970
Epoch 100/300
 - 2s - loss: 0.0037 - val_loss: 0.0065
 - val_f1: 0.9967
Epoch 101/300
 - 2s - loss: 0.0034 - val_loss: 0.0066
 - val_f1: 0.9970
Epoch 102/300
 - 2s - loss: 0.0035 - val_loss: 0.0061
 - val_f1: 0.9967
Epoch 103/300
 - 2s - loss: 0.0034 - val_loss: 0.0063
 - val_f1: 0.9971
Epoch 104/300
 - 2s - loss: 0.0033 - val_loss: 0.0064
 - val_f1: 0.9970
Epoch 105/300
 - 2s - loss: 0.0034 - val_loss: 0.0060
 - val_f1: 0.9970
Epoch 106/300
 - 2s - loss: 0.0036 - val_loss: 0.0074
 - val_f1: 0.9962
Epoch 107/300
 - 2s - loss: 0.0034 - val_loss: 0.0058
 - val_f1: 0.9969
Epoch 108/300
 - 2s - loss: 0.0033 - val_loss: 0.0063
 - val_f1: 0.9966
Epoch 109/300
 - 2s - loss: 0.0033 - val_loss: 0.0063
 - val_f1: 0.9967
Epoch 110/300
 - 2s - loss: 0.0036 - val_loss: 0.0063
 - val_f1: 0.9967
Epoch 111/300
 - 2s - loss: 0.0037 - val_loss: 0.0067
 - val_f1: 0.9970
Epoch 112/300
 - 2s - loss: 0.0033 - val_loss: 0.0060
 - val_f1: 0.9971
Epoch 113/300
 - 2s - loss: 0.0032 - val_loss: 0.0062
 - val_f1: 0.9962
Epoch 114/300
 - 2s - loss: 0.0033 - val_loss: 0.0069
 - val_f1: 0.9967
Epoch 115/300
 - 2s - loss: 0.0033 - val_loss: 0.0062
2019-12-20 17:21:23,670 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-20 17:21:26,331 [INFO] Last epoch loss evaluation: train_loss = 0.002914, val_loss = 0.005796
2019-12-20 17:21:26,333 [INFO] Training complete. time_to_train = 293.06 sec, 4.88 min
2019-12-20 17:21:26,337 [INFO] Model saved to results_selected_models/selected_nsl_ann_shallow_rep1/best_model.pickle
2019-12-20 17:21:26,527 [INFO] Plot saved to: results_selected_models/selected_nsl_ann_shallow_rep1/training_error_history.png
2019-12-20 17:21:26,684 [INFO] Plot saved to: results_selected_models/selected_nsl_ann_shallow_rep1/training_f1_history.png
2019-12-20 17:21:26,685 [INFO] Making predictions on training, validation, testing data
2019-12-20 17:21:29,433 [INFO] Evaluating predictions (results)
2019-12-20 17:21:30,146 [INFO] Dataset: Testing. Classification report below
2019-12-20 17:21:30,146 [INFO] 
              precision    recall  f1-score   support

         dos       0.96      0.84      0.90      7458
      normal       0.69      0.95      0.80      9711
       probe       0.76      0.69      0.72      2421
         r2l       0.97      0.11      0.19      2421
         u2r       0.19      0.06      0.09       533

    accuracy                           0.77     22544
   macro avg       0.71      0.53      0.54     22544
weighted avg       0.80      0.77      0.74     22544

2019-12-20 17:21:30,146 [INFO] Overall accuracy (micro avg): 0.7731990773598296
2019-12-20 17:21:30,760 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.7732         0.7732                       0.7732                0.0567                   0.2268  0.7732
1     Macro avg        0.9093         0.7137                       0.5276                0.0752                   0.4724  0.5387
2  Weighted avg        0.8720         0.8036                       0.7732                0.1493                   0.2268  0.7400
2019-12-20 17:21:31,440 [INFO] Dataset: Validation. Classification report below
2019-12-20 17:21:31,440 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00      9186
      normal       1.00      1.00      1.00     13469
       probe       0.99      0.99      0.99      2331
         r2l       0.96      0.89      0.92       199
         u2r       0.55      0.60      0.57        10

    accuracy                           1.00     25195
   macro avg       0.90      0.90      0.90     25195
weighted avg       1.00      1.00      1.00     25195

2019-12-20 17:21:31,443 [INFO] Overall accuracy (micro avg): 0.9969041476483429
2019-12-20 17:21:32,125 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9969         0.9969                       0.9969                0.0008                   0.0031  0.9969
1     Macro avg        0.9988         0.8985                       0.8970                0.0011                   0.1030  0.8973
2  Weighted avg        0.9981         0.9969                       0.9969                0.0022                   0.0031  0.9969
2019-12-20 17:21:34,997 [INFO] Dataset: Training. Classification report below
2019-12-20 17:21:34,997 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00     36741
      normal       1.00      1.00      1.00     53874
       probe       1.00      0.99      1.00      9325
         r2l       0.97      0.93      0.95       796
         u2r       0.82      0.79      0.80        42

    accuracy                           1.00    100778
   macro avg       0.96      0.94      0.95    100778
weighted avg       1.00      1.00      1.00    100778

2019-12-20 17:21:34,997 [INFO] Overall accuracy (micro avg): 0.9978765206691936
2019-12-20 17:21:38,061 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9979         0.9979                       0.9979                0.0005                   0.0021  0.9979
1     Macro avg        0.9992         0.9577                       0.9408                0.0008                   0.0592  0.9491
2  Weighted avg        0.9987         0.9979                       0.9979                0.0017                   0.0021  0.9979
2019-12-20 17:21:38,184 [INFO] Results saved to: results_selected_models/selected_nsl_ann_shallow_rep1/selected_nsl_ann_shallow_rep1_results.xlsx
2019-12-20 17:21:38,185 [INFO] ================= Finished running experiment no. 1 ================= 

2019-12-20 17:21:38,185 [INFO] Created directory: results_selected_models/selected_nsl_ann_shallow_rep2
2019-12-20 17:21:38,186 [INFO] Initialized logging. log_filename = results_selected_models/selected_nsl_ann_shallow_rep2/run_log.log
2019-12-20 17:21:38,186 [INFO] ================= Running experiment no. 2  ================= 

2019-12-20 17:21:38,186 [INFO] Experiment parameters given below
2019-12-20 17:21:38,186 [INFO] 
{'experiment_num': 2, 'results_dir': 'results_selected_models/selected_nsl_ann_shallow_rep2', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [256], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 300, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/nsl_kdd_five_classes', 'description': 'selected_nsl_ann_shallow_rep2'}
2019-12-20 17:21:38,186 [INFO] Created tensorboard log directory: results_selected_models/selected_nsl_ann_shallow_rep2/tf_logs_run_2019_12_20-17_21_38
2019-12-20 17:21:38,186 [INFO] Loading datsets from: ../Datasets/small_datasets/nsl_kdd_five_classes
2019-12-20 17:21:38,186 [INFO] Reading X, y files
2019-12-20 17:21:38,186 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_train.h5
2019-12-20 17:21:38,416 [INFO] Reading complete. time_to_read=0.23 seconds
2019-12-20 17:21:38,416 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_val.h5
2019-12-20 17:21:38,480 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-20 17:21:38,480 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_test.h5
2019-12-20 17:21:38,537 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-20 17:21:38,537 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_train.h5
2019-12-20 17:21:38,546 [INFO] Reading complete. time_to_read=0.01 seconds
2019-12-20 17:21:38,546 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_val.h5
2019-12-20 17:21:38,551 [INFO] Reading complete. time_to_read=0.00 seconds
2019-12-20 17:21:38,551 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_test.h5
2019-12-20 17:21:38,555 [INFO] Reading complete. time_to_read=0.00 seconds
2019-12-20 17:21:38,671 [INFO] Initializing model
2019-12-20 17:21:38,792 [INFO] _________________________________________________________________
2019-12-20 17:21:38,792 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-20 17:21:38,792 [INFO] =================================================================
2019-12-20 17:21:38,792 [INFO] dense_3 (Dense)              (None, 256)               31488     
2019-12-20 17:21:38,792 [INFO] _________________________________________________________________
2019-12-20 17:21:38,793 [INFO] batch_normalization_2 (Batch (None, 256)               1024      
2019-12-20 17:21:38,793 [INFO] _________________________________________________________________
2019-12-20 17:21:38,793 [INFO] dropout_2 (Dropout)          (None, 256)               0         
2019-12-20 17:21:38,793 [INFO] _________________________________________________________________
2019-12-20 17:21:38,793 [INFO] dense_4 (Dense)              (None, 5)                 1285      
2019-12-20 17:21:38,793 [INFO] =================================================================
2019-12-20 17:21:38,793 [INFO] Total params: 33,797
2019-12-20 17:21:38,793 [INFO] Trainable params: 33,285
2019-12-20 17:21:38,793 [INFO] Non-trainable params: 512
2019-12-20 17:21:38,793 [INFO] _________________________________________________________________
2019-12-20 17:21:38,793 [INFO] Training model
 - val_f1: 0.9966
Epoch 00115: early stopping
Train on 100778 samples, validate on 25195 samples
Epoch 1/300
 - 3s - loss: 0.0545 - val_loss: 0.0165
 - val_f1: 0.9889
Epoch 2/300
 - 2s - loss: 0.0168 - val_loss: 0.0111
 - val_f1: 0.9923
Epoch 3/300
 - 2s - loss: 0.0133 - val_loss: 0.0115
 - val_f1: 0.9920
Epoch 4/300
 - 2s - loss: 0.0114 - val_loss: 0.0101
 - val_f1: 0.9935
Epoch 5/300
 - 2s - loss: 0.0108 - val_loss: 0.0095
 - val_f1: 0.9920
Epoch 6/300
 - 2s - loss: 0.0100 - val_loss: 0.0090
 - val_f1: 0.9941
Epoch 7/300
 - 2s - loss: 0.0094 - val_loss: 0.0096
 - val_f1: 0.9935
Epoch 8/300
 - 2s - loss: 0.0088 - val_loss: 0.0085
 - val_f1: 0.9941
Epoch 9/300
 - 2s - loss: 0.0085 - val_loss: 0.0080
 - val_f1: 0.9947
Epoch 10/300
 - 2s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9949
Epoch 11/300
 - 2s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9948
Epoch 12/300
 - 2s - loss: 0.0080 - val_loss: 0.0084
 - val_f1: 0.9947
Epoch 13/300
 - 2s - loss: 0.0074 - val_loss: 0.0091
 - val_f1: 0.9934
Epoch 14/300
 - 2s - loss: 0.0077 - val_loss: 0.0085
 - val_f1: 0.9945
Epoch 15/300
 - 2s - loss: 0.0071 - val_loss: 0.0084
 - val_f1: 0.9951
Epoch 16/300
 - 2s - loss: 0.0070 - val_loss: 0.0072
 - val_f1: 0.9957
Epoch 17/300
 - 2s - loss: 0.0066 - val_loss: 0.0069
 - val_f1: 0.9958
Epoch 18/300
 - 2s - loss: 0.0069 - val_loss: 0.0078
 - val_f1: 0.9956
Epoch 19/300
 - 2s - loss: 0.0066 - val_loss: 0.0076
 - val_f1: 0.9958
Epoch 20/300
 - 2s - loss: 0.0066 - val_loss: 0.0074
 - val_f1: 0.9959
Epoch 21/300
 - 2s - loss: 0.0060 - val_loss: 0.0079
 - val_f1: 0.9952
Epoch 22/300
 - 2s - loss: 0.0063 - val_loss: 0.0072
 - val_f1: 0.9948
Epoch 23/300
 - 2s - loss: 0.0062 - val_loss: 0.0074
 - val_f1: 0.9950
Epoch 24/300
 - 2s - loss: 0.0058 - val_loss: 0.0069
 - val_f1: 0.9960
Epoch 25/300
 - 2s - loss: 0.0054 - val_loss: 0.0064
 - val_f1: 0.9963
Epoch 26/300
 - 2s - loss: 0.0058 - val_loss: 0.0071
 - val_f1: 0.9963
Epoch 27/300
 - 2s - loss: 0.0055 - val_loss: 0.0071
 - val_f1: 0.9962
Epoch 28/300
 - 2s - loss: 0.0053 - val_loss: 0.0072
 - val_f1: 0.9954
Epoch 29/300
 - 2s - loss: 0.0055 - val_loss: 0.0065
 - val_f1: 0.9968
Epoch 30/300
 - 2s - loss: 0.0052 - val_loss: 0.0065
 - val_f1: 0.9966
Epoch 31/300
 - 2s - loss: 0.0054 - val_loss: 0.0069
2019-12-20 17:22:58,022 [INFO] epoch = 30. Intermediate model saved to results_selected_models/selected_nsl_ann_shallow_rep2/ann_model_epoch_30.pickle
 - val_f1: 0.9957
Epoch 32/300
 - 2s - loss: 0.0055 - val_loss: 0.0073
 - val_f1: 0.9961
Epoch 33/300
 - 2s - loss: 0.0052 - val_loss: 0.0072
 - val_f1: 0.9960
Epoch 34/300
 - 2s - loss: 0.0054 - val_loss: 0.0075
 - val_f1: 0.9954
Epoch 35/300
 - 2s - loss: 0.0053 - val_loss: 0.0069
 - val_f1: 0.9961
Epoch 36/300
 - 2s - loss: 0.0053 - val_loss: 0.0070
 - val_f1: 0.9964
Epoch 37/300
 - 2s - loss: 0.0052 - val_loss: 0.0073
 - val_f1: 0.9965
Epoch 38/300
 - 2s - loss: 0.0052 - val_loss: 0.0070
 - val_f1: 0.9966
Epoch 39/300
 - 2s - loss: 0.0051 - val_loss: 0.0079
 - val_f1: 0.9961
Epoch 40/300
 - 2s - loss: 0.0054 - val_loss: 0.0079
 - val_f1: 0.9963
Epoch 41/300
 - 2s - loss: 0.0050 - val_loss: 0.0079
 - val_f1: 0.9954
Epoch 42/300
 - 2s - loss: 0.0048 - val_loss: 0.0069
 - val_f1: 0.9966
Epoch 43/300
 - 2s - loss: 0.0046 - val_loss: 0.0076
 - val_f1: 0.9967
Epoch 44/300
 - 2s - loss: 0.0047 - val_loss: 0.0075
 - val_f1: 0.9964
Epoch 45/300
 - 2s - loss: 0.0049 - val_loss: 0.0074
 - val_f1: 0.9964
Epoch 46/300
 - 2s - loss: 0.0046 - val_loss: 0.0065
 - val_f1: 0.9966
Epoch 47/300
 - 2s - loss: 0.0047 - val_loss: 0.0066
 - val_f1: 0.9965
Epoch 48/300
 - 2s - loss: 0.0045 - val_loss: 0.0066
 - val_f1: 0.9966
Epoch 49/300
 - 2s - loss: 0.0043 - val_loss: 0.0070
 - val_f1: 0.9965
Epoch 50/300
 - 2s - loss: 0.0043 - val_loss: 0.0065
 - val_f1: 0.9965
Epoch 51/300
 - 2s - loss: 0.0045 - val_loss: 0.0067
 - val_f1: 0.9969
Epoch 52/300
 - 2s - loss: 0.0044 - val_loss: 0.0062
 - val_f1: 0.9967
Epoch 53/300
 - 2s - loss: 0.0043 - val_loss: 0.0068
 - val_f1: 0.9966
Epoch 54/300
 - 2s - loss: 0.0048 - val_loss: 0.0061
 - val_f1: 0.9966
Epoch 55/300
 - 2s - loss: 0.0042 - val_loss: 0.0070
 - val_f1: 0.9956
Epoch 56/300
 - 2s - loss: 0.0045 - val_loss: 0.0066
 - val_f1: 0.9967
Epoch 57/300
 - 2s - loss: 0.0043 - val_loss: 0.0065
 - val_f1: 0.9968
Epoch 58/300
 - 2s - loss: 0.0043 - val_loss: 0.0064
 - val_f1: 0.9968
Epoch 59/300
 - 2s - loss: 0.0044 - val_loss: 0.0067
 - val_f1: 0.9961
Epoch 60/300
 - 2s - loss: 0.0041 - val_loss: 0.0064
 - val_f1: 0.9967
Epoch 61/300
 - 2s - loss: 0.0039 - val_loss: 0.0072
2019-12-20 17:24:13,641 [INFO] epoch = 60. Intermediate model saved to results_selected_models/selected_nsl_ann_shallow_rep2/ann_model_epoch_60.pickle
 - val_f1: 0.9962
Epoch 62/300
 - 2s - loss: 0.0043 - val_loss: 0.0068
 - val_f1: 0.9966
Epoch 63/300
 - 2s - loss: 0.0044 - val_loss: 0.0064
 - val_f1: 0.9966
Epoch 64/300
 - 2s - loss: 0.0041 - val_loss: 0.0064
 - val_f1: 0.9966
Epoch 65/300
 - 2s - loss: 0.0040 - val_loss: 0.0068
 - val_f1: 0.9966
Epoch 66/300
 - 2s - loss: 0.0039 - val_loss: 0.0063
 - val_f1: 0.9967
Epoch 67/300
 - 2s - loss: 0.0042 - val_loss: 0.0062
 - val_f1: 0.9968
Epoch 68/300
 - 2s - loss: 0.0038 - val_loss: 0.0068
 - val_f1: 0.9966
Epoch 69/300
 - 2s - loss: 0.0042 - val_loss: 0.0064
 - val_f1: 0.9967
Epoch 70/300
 - 2s - loss: 0.0041 - val_loss: 0.0058
 - val_f1: 0.9969
Epoch 71/300
 - 2s - loss: 0.0041 - val_loss: 0.0056
 - val_f1: 0.9968
Epoch 72/300
 - 2s - loss: 0.0037 - val_loss: 0.0060
 - val_f1: 0.9969
Epoch 73/300
 - 2s - loss: 0.0040 - val_loss: 0.0066
 - val_f1: 0.9967
Epoch 74/300
 - 2s - loss: 0.0040 - val_loss: 0.0064
 - val_f1: 0.9966
Epoch 75/300
 - 2s - loss: 0.0039 - val_loss: 0.0064
 - val_f1: 0.9969
Epoch 76/300
 - 2s - loss: 0.0038 - val_loss: 0.0063
 - val_f1: 0.9966
Epoch 77/300
 - 2s - loss: 0.0040 - val_loss: 0.0057
 - val_f1: 0.9968
Epoch 78/300
 - 2s - loss: 0.0042 - val_loss: 0.0068
 - val_f1: 0.9968
Epoch 79/300
 - 2s - loss: 0.0038 - val_loss: 0.0064
 - val_f1: 0.9967
Epoch 80/300
 - 2s - loss: 0.0041 - val_loss: 0.0066
 - val_f1: 0.9970
Epoch 81/300
 - 2s - loss: 0.0039 - val_loss: 0.0070
 - val_f1: 0.9967
Epoch 82/300
 - 2s - loss: 0.0038 - val_loss: 0.0062
 - val_f1: 0.9968
Epoch 83/300
 - 2s - loss: 0.0039 - val_loss: 0.0063
 - val_f1: 0.9969
Epoch 84/300
 - 2s - loss: 0.0039 - val_loss: 0.0063
 - val_f1: 0.9969
Epoch 85/300
 - 2s - loss: 0.0037 - val_loss: 0.0062
 - val_f1: 0.9968
Epoch 86/300
 - 2s - loss: 0.0036 - val_loss: 0.0065
 - val_f1: 0.9966
Epoch 87/300
 - 2s - loss: 0.0040 - val_loss: 0.0063
 - val_f1: 0.9967
Epoch 88/300
 - 2s - loss: 0.0039 - val_loss: 0.0063
 - val_f1: 0.9965
Epoch 89/300
 - 2s - loss: 0.0036 - val_loss: 0.0057
 - val_f1: 0.9970
Epoch 90/300
 - 2s - loss: 0.0037 - val_loss: 0.0058
 - val_f1: 0.9968
Epoch 91/300
 - 2s - loss: 0.0038 - val_loss: 0.0076
2019-12-20 17:25:29,191 [INFO] epoch = 90. Intermediate model saved to results_selected_models/selected_nsl_ann_shallow_rep2/ann_model_epoch_90.pickle
 - val_f1: 0.9967
Epoch 92/300
 - 2s - loss: 0.0038 - val_loss: 0.0057
 - val_f1: 0.9967
Epoch 93/300
 - 2s - loss: 0.0041 - val_loss: 0.0060
 - val_f1: 0.9967
Epoch 94/300
 - 2s - loss: 0.0038 - val_loss: 0.0063
 - val_f1: 0.9966
Epoch 95/300
 - 2s - loss: 0.0037 - val_loss: 0.0064
 - val_f1: 0.9965
Epoch 96/300
 - 2s - loss: 0.0035 - val_loss: 0.0058
 - val_f1: 0.9969
Epoch 97/300
 - 2s - loss: 0.0037 - val_loss: 0.0060
 - val_f1: 0.9972
Epoch 98/300
 - 2s - loss: 0.0035 - val_loss: 0.0062
 - val_f1: 0.9969
Epoch 99/300
 - 2s - loss: 0.0035 - val_loss: 0.0063
 - val_f1: 0.9975
Epoch 100/300
 - 2s - loss: 0.0037 - val_loss: 0.0060
 - val_f1: 0.9973
Epoch 101/300
 - 2s - loss: 0.0036 - val_loss: 0.0060
 - val_f1: 0.9971
Epoch 102/300
 - 2s - loss: 0.0037 - val_loss: 0.0062
 - val_f1: 0.9973
Epoch 103/300
 - 2s - loss: 0.0035 - val_loss: 0.0064
 - val_f1: 0.9968
Epoch 104/300
 - 2s - loss: 0.0037 - val_loss: 0.0071
 - val_f1: 0.9968
Epoch 105/300
 - 2s - loss: 0.0036 - val_loss: 0.0068
 - val_f1: 0.9965
Epoch 106/300
 - 2s - loss: 0.0035 - val_loss: 0.0064
 - val_f1: 0.9969
Epoch 107/300
 - 2s - loss: 0.0037 - val_loss: 0.0069
 - val_f1: 0.9966
Epoch 108/300
 - 2s - loss: 0.0037 - val_loss: 0.0067
 - val_f1: 0.9969
Epoch 109/300
 - 2s - loss: 0.0037 - val_loss: 0.0067
 - val_f1: 0.9969
Epoch 110/300
 - 2s - loss: 0.0036 - val_loss: 0.0062
 - val_f1: 0.9971
Epoch 111/300
 - 2s - loss: 0.0037 - val_loss: 0.0065
 - val_f1: 0.9970
Epoch 112/300
 - 2s - loss: 0.0038 - val_loss: 0.0072
 - val_f1: 0.9965
Epoch 113/300
 - 2s - loss: 0.0038 - val_loss: 0.0069
 - val_f1: 0.9963
Epoch 114/300
 - 2s - loss: 0.0038 - val_loss: 0.0065
 - val_f1: 0.9971
Epoch 115/300
 - 2s - loss: 0.0037 - val_loss: 0.0063
 - val_f1: 0.9972
Epoch 116/300
 - 2s - loss: 0.0035 - val_loss: 0.0071
 - val_f1: 0.9967
Epoch 117/300
 - 2s - loss: 0.0036 - val_loss: 0.0073
 - val_f1: 0.9967
Epoch 118/300
 - 2s - loss: 0.0035 - val_loss: 0.0070
 - val_f1: 0.9967
Epoch 119/300
 - 2s - loss: 0.0038 - val_loss: 0.0059
 - val_f1: 0.9972
Epoch 120/300
 - 2s - loss: 0.0037 - val_loss: 0.0066
 - val_f1: 0.9969
Epoch 121/300
 - 2s - loss: 0.0035 - val_loss: 0.0066
2019-12-20 17:26:44,783 [INFO] epoch = 120. Intermediate model saved to results_selected_models/selected_nsl_ann_shallow_rep2/ann_model_epoch_120.pickle
2019-12-20 17:26:45,274 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-20 17:26:48,014 [INFO] Last epoch loss evaluation: train_loss = 0.003054, val_loss = 0.005555
2019-12-20 17:26:48,014 [INFO] Training complete. time_to_train = 309.22 sec, 5.15 min
2019-12-20 17:26:48,018 [INFO] Model saved to results_selected_models/selected_nsl_ann_shallow_rep2/best_model.pickle
2019-12-20 17:26:48,196 [INFO] Plot saved to: results_selected_models/selected_nsl_ann_shallow_rep2/training_error_history.png
2019-12-20 17:26:48,357 [INFO] Plot saved to: results_selected_models/selected_nsl_ann_shallow_rep2/training_f1_history.png
2019-12-20 17:26:48,357 [INFO] Making predictions on training, validation, testing data
2019-12-20 17:26:51,156 [INFO] Evaluating predictions (results)
2019-12-20 17:26:51,718 [INFO] Dataset: Testing. Classification report below
2019-12-20 17:26:51,718 [INFO] 
              precision    recall  f1-score   support

         dos       0.97      0.85      0.90      7458
      normal       0.68      0.97      0.80      9711
       probe       0.83      0.68      0.75      2421
         r2l       0.86      0.11      0.20      2421
         u2r       0.96      0.05      0.09       533

    accuracy                           0.78     22544
   macro avg       0.86      0.53      0.55     22544
weighted avg       0.82      0.78      0.75     22544

2019-12-20 17:26:51,718 [INFO] Overall accuracy (micro avg): 0.7823811213626686
2019-12-20 17:26:52,327 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.7824         0.7824                       0.7824                0.0544                   0.2176  0.7824
1     Macro avg        0.9130         0.8610                       0.5305                0.0738                   0.4695  0.5479
2  Weighted avg        0.8751         0.8196                       0.7824                0.1515                   0.2176  0.7477
2019-12-20 17:26:53,001 [INFO] Dataset: Validation. Classification report below
2019-12-20 17:26:53,001 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00      9186
      normal       1.00      1.00      1.00     13469
       probe       0.99      0.99      0.99      2331
         r2l       0.95      0.91      0.93       199
         u2r       0.80      0.40      0.53        10

    accuracy                           1.00     25195
   macro avg       0.95      0.86      0.89     25195
weighted avg       1.00      1.00      1.00     25195

2019-12-20 17:26:53,001 [INFO] Overall accuracy (micro avg): 0.9968247668188133
2019-12-20 17:26:53,681 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9968         0.9968                       0.9968                0.0008                   0.0032  0.9968
1     Macro avg        0.9987         0.9478                       0.8611                0.0010                   0.1389  0.8911
2  Weighted avg        0.9980         0.9968                       0.9968                0.0020                   0.0032  0.9968
2019-12-20 17:26:56,553 [INFO] Dataset: Training. Classification report below
2019-12-20 17:26:56,553 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00     36741
      normal       1.00      1.00      1.00     53874
       probe       0.99      1.00      1.00      9325
         r2l       0.96      0.93      0.95       796
         u2r       0.89      0.76      0.82        42

    accuracy                           1.00    100778
   macro avg       0.97      0.94      0.95    100778
weighted avg       1.00      1.00      1.00    100778

2019-12-20 17:26:56,553 [INFO] Overall accuracy (micro avg): 0.9979162118716387
2019-12-20 17:26:59,619 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9979         0.9979                       0.9979                0.0005                   0.0021  0.9979
1     Macro avg        0.9992         0.9687                       0.9369                0.0007                   0.0631  0.9517
2  Weighted avg        0.9987         0.9979                       0.9979                0.0014                   0.0021  0.9979
2019-12-20 17:26:59,666 [INFO] Results saved to: results_selected_models/selected_nsl_ann_shallow_rep2/selected_nsl_ann_shallow_rep2_results.xlsx
2019-12-20 17:26:59,666 [INFO] ================= Finished running experiment no. 2 ================= 

2019-12-20 17:26:59,667 [INFO] Created directory: results_selected_models/selected_nsl_ann_shallow_rep3
2019-12-20 17:26:59,667 [INFO] Initialized logging. log_filename = results_selected_models/selected_nsl_ann_shallow_rep3/run_log.log
2019-12-20 17:26:59,667 [INFO] ================= Running experiment no. 3  ================= 

2019-12-20 17:26:59,667 [INFO] Experiment parameters given below
2019-12-20 17:26:59,667 [INFO] 
{'experiment_num': 3, 'results_dir': 'results_selected_models/selected_nsl_ann_shallow_rep3', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [256], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 300, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/nsl_kdd_five_classes', 'description': 'selected_nsl_ann_shallow_rep3'}
2019-12-20 17:26:59,667 [INFO] Created tensorboard log directory: results_selected_models/selected_nsl_ann_shallow_rep3/tf_logs_run_2019_12_20-17_26_59
2019-12-20 17:26:59,668 [INFO] Loading datsets from: ../Datasets/small_datasets/nsl_kdd_five_classes
2019-12-20 17:26:59,668 [INFO] Reading X, y files
2019-12-20 17:26:59,668 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_train.h5
2019-12-20 17:26:59,900 [INFO] Reading complete. time_to_read=0.23 seconds
2019-12-20 17:26:59,900 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_val.h5
2019-12-20 17:26:59,965 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-20 17:26:59,965 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_test.h5
2019-12-20 17:27:00,023 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-20 17:27:00,023 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_train.h5
2019-12-20 17:27:00,032 [INFO] Reading complete. time_to_read=0.01 seconds
2019-12-20 17:27:00,032 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_val.h5
2019-12-20 17:27:00,037 [INFO] Reading complete. time_to_read=0.00 seconds
2019-12-20 17:27:00,037 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_test.h5
2019-12-20 17:27:00,041 [INFO] Reading complete. time_to_read=0.00 seconds
2019-12-20 17:27:00,159 [INFO] Initializing model
2019-12-20 17:27:00,280 [INFO] _________________________________________________________________
2019-12-20 17:27:00,280 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-20 17:27:00,280 [INFO] =================================================================
2019-12-20 17:27:00,280 [INFO] dense_5 (Dense)              (None, 256)               31488     
2019-12-20 17:27:00,280 [INFO] _________________________________________________________________
2019-12-20 17:27:00,280 [INFO] batch_normalization_3 (Batch (None, 256)               1024      
2019-12-20 17:27:00,280 [INFO] _________________________________________________________________
2019-12-20 17:27:00,280 [INFO] dropout_3 (Dropout)          (None, 256)               0         
2019-12-20 17:27:00,280 [INFO] _________________________________________________________________
2019-12-20 17:27:00,280 [INFO] dense_6 (Dense)              (None, 5)                 1285      
2019-12-20 17:27:00,281 [INFO] =================================================================
2019-12-20 17:27:00,281 [INFO] Total params: 33,797
2019-12-20 17:27:00,281 [INFO] Trainable params: 33,285
2019-12-20 17:27:00,281 [INFO] Non-trainable params: 512
2019-12-20 17:27:00,281 [INFO] _________________________________________________________________
2019-12-20 17:27:00,281 [INFO] Training model
 - val_f1: 0.9970
Epoch 00121: early stopping
Train on 100778 samples, validate on 25195 samples
Epoch 1/300
 - 3s - loss: 0.0540 - val_loss: 0.0168
 - val_f1: 0.9878
Epoch 2/300
 - 2s - loss: 0.0167 - val_loss: 0.0125
 - val_f1: 0.9922
Epoch 3/300
 - 2s - loss: 0.0129 - val_loss: 0.0111
 - val_f1: 0.9928
Epoch 4/300
 - 2s - loss: 0.0116 - val_loss: 0.0089
 - val_f1: 0.9935
Epoch 5/300
 - 2s - loss: 0.0107 - val_loss: 0.0098
 - val_f1: 0.9940
Epoch 6/300
 - 2s - loss: 0.0098 - val_loss: 0.0095
 - val_f1: 0.9945
Epoch 7/300
 - 2s - loss: 0.0090 - val_loss: 0.0091
 - val_f1: 0.9936
Epoch 8/300
 - 2s - loss: 0.0084 - val_loss: 0.0084
 - val_f1: 0.9943
Epoch 9/300
 - 2s - loss: 0.0081 - val_loss: 0.0090
 - val_f1: 0.9932
Epoch 10/300
 - 2s - loss: 0.0081 - val_loss: 0.0083
 - val_f1: 0.9945
Epoch 11/300
 - 2s - loss: 0.0076 - val_loss: 0.0082
 - val_f1: 0.9944
Epoch 12/300
 - 2s - loss: 0.0073 - val_loss: 0.0081
 - val_f1: 0.9947
Epoch 13/300
 - 2s - loss: 0.0074 - val_loss: 0.0083
 - val_f1: 0.9951
Epoch 14/300
 - 2s - loss: 0.0071 - val_loss: 0.0084
 - val_f1: 0.9944
Epoch 15/300
 - 2s - loss: 0.0068 - val_loss: 0.0083
 - val_f1: 0.9955
Epoch 16/300
 - 2s - loss: 0.0068 - val_loss: 0.0075
 - val_f1: 0.9957
Epoch 17/300
 - 2s - loss: 0.0065 - val_loss: 0.0075
 - val_f1: 0.9958
Epoch 18/300
 - 2s - loss: 0.0061 - val_loss: 0.0074
 - val_f1: 0.9959
Epoch 19/300
 - 2s - loss: 0.0057 - val_loss: 0.0091
 - val_f1: 0.9949
Epoch 20/300
 - 2s - loss: 0.0063 - val_loss: 0.0081
 - val_f1: 0.9949
Epoch 21/300
 - 2s - loss: 0.0064 - val_loss: 0.0078
 - val_f1: 0.9951
Epoch 22/300
 - 2s - loss: 0.0060 - val_loss: 0.0072
 - val_f1: 0.9958
Epoch 23/300
 - 2s - loss: 0.0061 - val_loss: 0.0070
 - val_f1: 0.9962
Epoch 24/300
 - 2s - loss: 0.0060 - val_loss: 0.0067
 - val_f1: 0.9964
Epoch 25/300
 - 2s - loss: 0.0057 - val_loss: 0.0070
 - val_f1: 0.9961
Epoch 26/300
 - 2s - loss: 0.0057 - val_loss: 0.0069
 - val_f1: 0.9965
Epoch 27/300
 - 2s - loss: 0.0058 - val_loss: 0.0078
 - val_f1: 0.9953
Epoch 28/300
 - 2s - loss: 0.0057 - val_loss: 0.0072
 - val_f1: 0.9958
Epoch 29/300
 - 2s - loss: 0.0051 - val_loss: 0.0072
 - val_f1: 0.9962
Epoch 30/300
 - 2s - loss: 0.0054 - val_loss: 0.0080
 - val_f1: 0.9958
Epoch 31/300
 - 2s - loss: 0.0058 - val_loss: 0.0077
2019-12-20 17:28:20,580 [INFO] epoch = 30. Intermediate model saved to results_selected_models/selected_nsl_ann_shallow_rep3/ann_model_epoch_30.pickle
 - val_f1: 0.9957
Epoch 32/300
 - 2s - loss: 0.0053 - val_loss: 0.0078
 - val_f1: 0.9959
Epoch 33/300
 - 2s - loss: 0.0055 - val_loss: 0.0073
 - val_f1: 0.9962
Epoch 34/300
 - 2s - loss: 0.0053 - val_loss: 0.0073
 - val_f1: 0.9964
Epoch 35/300
 - 2s - loss: 0.0052 - val_loss: 0.0069
 - val_f1: 0.9962
Epoch 36/300
 - 2s - loss: 0.0053 - val_loss: 0.0068
 - val_f1: 0.9965
Epoch 37/300
 - 2s - loss: 0.0048 - val_loss: 0.0073
 - val_f1: 0.9960
Epoch 38/300
 - 2s - loss: 0.0047 - val_loss: 0.0077
 - val_f1: 0.9961
Epoch 39/300
 - 2s - loss: 0.0050 - val_loss: 0.0077
 - val_f1: 0.9959
Epoch 40/300
 - 2s - loss: 0.0048 - val_loss: 0.0071
 - val_f1: 0.9963
Epoch 41/300
 - 2s - loss: 0.0046 - val_loss: 0.0073
 - val_f1: 0.9964
Epoch 42/300
 - 2s - loss: 0.0043 - val_loss: 0.0070
 - val_f1: 0.9961
Epoch 43/300
 - 2s - loss: 0.0047 - val_loss: 0.0077
 - val_f1: 0.9963
Epoch 44/300
 - 2s - loss: 0.0046 - val_loss: 0.0078
 - val_f1: 0.9958
Epoch 45/300
 - 2s - loss: 0.0050 - val_loss: 0.0070
 - val_f1: 0.9964
Epoch 46/300
 - 2s - loss: 0.0046 - val_loss: 0.0070
 - val_f1: 0.9967
Epoch 47/300
 - 2s - loss: 0.0048 - val_loss: 0.0068
 - val_f1: 0.9966
Epoch 48/300
 - 2s - loss: 0.0046 - val_loss: 0.0069
 - val_f1: 0.9962
Epoch 49/300
 - 2s - loss: 0.0045 - val_loss: 0.0066
 - val_f1: 0.9965
Epoch 50/300
 - 2s - loss: 0.0045 - val_loss: 0.0076
 - val_f1: 0.9961
Epoch 51/300
 - 2s - loss: 0.0048 - val_loss: 0.0070
 - val_f1: 0.9966
Epoch 52/300
 - 2s - loss: 0.0044 - val_loss: 0.0066
 - val_f1: 0.9969
Epoch 53/300
 - 2s - loss: 0.0041 - val_loss: 0.0068
 - val_f1: 0.9968
Epoch 54/300
 - 2s - loss: 0.0043 - val_loss: 0.0068
 - val_f1: 0.9967
Epoch 55/300
 - 2s - loss: 0.0044 - val_loss: 0.0068
 - val_f1: 0.9966
Epoch 56/300
 - 2s - loss: 0.0044 - val_loss: 0.0071
 - val_f1: 0.9964
Epoch 57/300
 - 2s - loss: 0.0043 - val_loss: 0.0068
 - val_f1: 0.9964
Epoch 58/300
 - 2s - loss: 0.0043 - val_loss: 0.0067
 - val_f1: 0.9966
Epoch 59/300
 - 2s - loss: 0.0043 - val_loss: 0.0068
 - val_f1: 0.9966
Epoch 60/300
 - 2s - loss: 0.0044 - val_loss: 0.0074
 - val_f1: 0.9967
Epoch 61/300
 - 2s - loss: 0.0045 - val_loss: 0.0073
2019-12-20 17:29:37,085 [INFO] epoch = 60. Intermediate model saved to results_selected_models/selected_nsl_ann_shallow_rep3/ann_model_epoch_60.pickle
 - val_f1: 0.9965
Epoch 62/300
 - 2s - loss: 0.0044 - val_loss: 0.0072
 - val_f1: 0.9966
Epoch 63/300
 - 2s - loss: 0.0041 - val_loss: 0.0069
 - val_f1: 0.9964
Epoch 64/300
 - 2s - loss: 0.0040 - val_loss: 0.0065
 - val_f1: 0.9966
Epoch 65/300
 - 2s - loss: 0.0038 - val_loss: 0.0060
 - val_f1: 0.9970
Epoch 66/300
 - 2s - loss: 0.0041 - val_loss: 0.0072
 - val_f1: 0.9965
Epoch 67/300
 - 2s - loss: 0.0043 - val_loss: 0.0069
 - val_f1: 0.9967
Epoch 68/300
 - 2s - loss: 0.0041 - val_loss: 0.0066
 - val_f1: 0.9967
Epoch 69/300
 - 2s - loss: 0.0039 - val_loss: 0.0064
 - val_f1: 0.9966
Epoch 70/300
 - 2s - loss: 0.0039 - val_loss: 0.0067
 - val_f1: 0.9967
Epoch 71/300
 - 2s - loss: 0.0037 - val_loss: 0.0065
 - val_f1: 0.9968
Epoch 72/300
 - 2s - loss: 0.0040 - val_loss: 0.0068
 - val_f1: 0.9965
Epoch 73/300
 - 2s - loss: 0.0039 - val_loss: 0.0063
 - val_f1: 0.9965
Epoch 74/300
 - 2s - loss: 0.0040 - val_loss: 0.0073
 - val_f1: 0.9957
Epoch 75/300
 - 2s - loss: 0.0042 - val_loss: 0.0061
 - val_f1: 0.9965
Epoch 76/300
 - 2s - loss: 0.0036 - val_loss: 0.0062
 - val_f1: 0.9969
Epoch 77/300
 - 2s - loss: 0.0038 - val_loss: 0.0065
 - val_f1: 0.9966
Epoch 78/300
 - 2s - loss: 0.0038 - val_loss: 0.0063
 - val_f1: 0.9968
Epoch 79/300
 - 2s - loss: 0.0038 - val_loss: 0.0067
 - val_f1: 0.9970
Epoch 80/300
 - 2s - loss: 0.0039 - val_loss: 0.0068
 - val_f1: 0.9958
Epoch 81/300
 - 2s - loss: 0.0039 - val_loss: 0.0072
 - val_f1: 0.9963
Epoch 82/300
 - 2s - loss: 0.0042 - val_loss: 0.0072
 - val_f1: 0.9968
Epoch 83/300
 - 2s - loss: 0.0038 - val_loss: 0.0069
 - val_f1: 0.9964
Epoch 84/300
 - 2s - loss: 0.0038 - val_loss: 0.0068
 - val_f1: 0.9967
Epoch 85/300
 - 2s - loss: 0.0037 - val_loss: 0.0072
 - val_f1: 0.9962
Epoch 86/300
 - 2s - loss: 0.0037 - val_loss: 0.0073
 - val_f1: 0.9962
Epoch 87/300
 - 2s - loss: 0.0037 - val_loss: 0.0072
 - val_f1: 0.9965
Epoch 88/300
 - 2s - loss: 0.0037 - val_loss: 0.0072
 - val_f1: 0.9969
Epoch 89/300
 - 2s - loss: 0.0040 - val_loss: 0.0073
 - val_f1: 0.9967
Epoch 90/300
 - 2s - loss: 0.0039 - val_loss: 0.0068
 - val_f1: 0.9967
Epoch 91/300
 - 2s - loss: 0.0037 - val_loss: 0.0073
2019-12-20 17:30:53,710 [INFO] epoch = 90. Intermediate model saved to results_selected_models/selected_nsl_ann_shallow_rep3/ann_model_epoch_90.pickle
 - val_f1: 0.9967
Epoch 92/300
 - 2s - loss: 0.0035 - val_loss: 0.0063
 - val_f1: 0.9972
Epoch 93/300
 - 2s - loss: 0.0037 - val_loss: 0.0065
 - val_f1: 0.9967
Epoch 94/300
 - 2s - loss: 0.0037 - val_loss: 0.0077
 - val_f1: 0.9967
Epoch 95/300
 - 2s - loss: 0.0038 - val_loss: 0.0078
 - val_f1: 0.9962
Epoch 96/300
 - 2s - loss: 0.0036 - val_loss: 0.0085
 - val_f1: 0.9965
Epoch 97/300
 - 2s - loss: 0.0036 - val_loss: 0.0067
 - val_f1: 0.9971
Epoch 98/300
 - 2s - loss: 0.0038 - val_loss: 0.0091
 - val_f1: 0.9962
Epoch 99/300
 - 2s - loss: 0.0037 - val_loss: 0.0060
 - val_f1: 0.9969
Epoch 100/300
 - 2s - loss: 0.0036 - val_loss: 0.0068
 - val_f1: 0.9966
Epoch 101/300
 - 2s - loss: 0.0036 - val_loss: 0.0061
 - val_f1: 0.9967
Epoch 102/300
 - 2s - loss: 0.0035 - val_loss: 0.0059
 - val_f1: 0.9969
Epoch 103/300
 - 2s - loss: 0.0034 - val_loss: 0.0060
 - val_f1: 0.9969
Epoch 104/300
 - 2s - loss: 0.0037 - val_loss: 0.0067
 - val_f1: 0.9967
Epoch 105/300
 - 2s - loss: 0.0035 - val_loss: 0.0062
 - val_f1: 0.9971
Epoch 106/300
 - 2s - loss: 0.0034 - val_loss: 0.0070
 - val_f1: 0.9960
Epoch 107/300
 - 2s - loss: 0.0033 - val_loss: 0.0073
 - val_f1: 0.9955
Epoch 108/300
 - 2s - loss: 0.0036 - val_loss: 0.0059
 - val_f1: 0.9969
Epoch 109/300
 - 2s - loss: 0.0034 - val_loss: 0.0082
 - val_f1: 0.9965
Epoch 110/300
 - 2s - loss: 0.0039 - val_loss: 0.0073
 - val_f1: 0.9966
Epoch 111/300
 - 2s - loss: 0.0035 - val_loss: 0.0075
 - val_f1: 0.9957
Epoch 112/300
 - 2s - loss: 0.0034 - val_loss: 0.0070
 - val_f1: 0.9962
Epoch 113/300
 - 2s - loss: 0.0033 - val_loss: 0.0068
 - val_f1: 0.9968
Epoch 114/300
 - 2s - loss: 0.0035 - val_loss: 0.0066
 - val_f1: 0.9968
Epoch 115/300
 - 2s - loss: 0.0036 - val_loss: 0.0068
 - val_f1: 0.9969
Epoch 116/300
 - 2s - loss: 0.0033 - val_loss: 0.0071
 - val_f1: 0.9967
Epoch 117/300
 - 2s - loss: 0.0033 - val_loss: 0.0069
 - val_f1: 0.9969
Epoch 118/300
 - 2s - loss: 0.0037 - val_loss: 0.0074
 - val_f1: 0.9966
Epoch 119/300
 - 2s - loss: 0.0035 - val_loss: 0.0066
 - val_f1: 0.9967
Epoch 120/300
 - 2s - loss: 0.0034 - val_loss: 0.0070
 - val_f1: 0.9968
Epoch 121/300
 - 2s - loss: 0.0035 - val_loss: 0.0068
2019-12-20 17:32:10,243 [INFO] epoch = 120. Intermediate model saved to results_selected_models/selected_nsl_ann_shallow_rep3/ann_model_epoch_120.pickle
 - val_f1: 0.9969
Epoch 122/300
 - 2s - loss: 0.0033 - val_loss: 0.0065
 - val_f1: 0.9968
Epoch 123/300
 - 2s - loss: 0.0032 - val_loss: 0.0069
 - val_f1: 0.9967
Epoch 124/300
 - 2s - loss: 0.0033 - val_loss: 0.0060
 - val_f1: 0.9968
Epoch 125/300
 - 2s - loss: 0.0034 - val_loss: 0.0067
 - val_f1: 0.9967
Epoch 126/300
 - 2s - loss: 0.0035 - val_loss: 0.0060
 - val_f1: 0.9970
Epoch 127/300
 - 2s - loss: 0.0036 - val_loss: 0.0061
 - val_f1: 0.9969
Epoch 128/300
 - 2s - loss: 0.0033 - val_loss: 0.0062
 - val_f1: 0.9967
Epoch 129/300
 - 2s - loss: 0.0030 - val_loss: 0.0062
 - val_f1: 0.9967
Epoch 130/300
 - 2s - loss: 0.0032 - val_loss: 0.0066
 - val_f1: 0.9968
Epoch 131/300
 - 2s - loss: 0.0033 - val_loss: 0.0065
 - val_f1: 0.9968
Epoch 132/300
 - 2s - loss: 0.0033 - val_loss: 0.0064
 - val_f1: 0.9971
Epoch 133/300
 - 2s - loss: 0.0030 - val_loss: 0.0071
 - val_f1: 0.9970
Epoch 134/300
 - 2s - loss: 0.0033 - val_loss: 0.0063
 - val_f1: 0.9970
Epoch 135/300
 - 2s - loss: 0.0031 - val_loss: 0.0061
 - val_f1: 0.9970
Epoch 136/300
 - 2s - loss: 0.0029 - val_loss: 0.0058
 - val_f1: 0.9970
Epoch 137/300
 - 2s - loss: 0.0030 - val_loss: 0.0058
 - val_f1: 0.9971
Epoch 138/300
 - 2s - loss: 0.0034 - val_loss: 0.0060
 - val_f1: 0.9971
Epoch 139/300
 - 2s - loss: 0.0031 - val_loss: 0.0059
 - val_f1: 0.9970
Epoch 140/300
 - 2s - loss: 0.0034 - val_loss: 0.0060
 - val_f1: 0.9973
Epoch 141/300
 - 2s - loss: 0.0032 - val_loss: 0.0066
 - val_f1: 0.9972
Epoch 142/300
 - 2s - loss: 0.0030 - val_loss: 0.0069
 - val_f1: 0.9967
Epoch 143/300
 - 2s - loss: 0.0031 - val_loss: 0.0061
 - val_f1: 0.9970
Epoch 144/300
 - 2s - loss: 0.0032 - val_loss: 0.0066
 - val_f1: 0.9967
Epoch 145/300
 - 2s - loss: 0.0032 - val_loss: 0.0059
 - val_f1: 0.9972
Epoch 146/300
 - 2s - loss: 0.0032 - val_loss: 0.0060
 - val_f1: 0.9970
Epoch 147/300
 - 2s - loss: 0.0032 - val_loss: 0.0059
 - val_f1: 0.9971
Epoch 148/300
 - 2s - loss: 0.0031 - val_loss: 0.0059
 - val_f1: 0.9971
Epoch 149/300
 - 2s - loss: 0.0033 - val_loss: 0.0065
 - val_f1: 0.9969
Epoch 150/300
 - 2s - loss: 0.0033 - val_loss: 0.0065
 - val_f1: 0.9969
Epoch 151/300
 - 2s - loss: 0.0030 - val_loss: 0.0061
2019-12-20 17:33:26,860 [INFO] epoch = 150. Intermediate model saved to results_selected_models/selected_nsl_ann_shallow_rep3/ann_model_epoch_150.pickle
 - val_f1: 0.9972
Epoch 152/300
 - 2s - loss: 0.0029 - val_loss: 0.0063
 - val_f1: 0.9972
Epoch 153/300
 - 2s - loss: 0.0030 - val_loss: 0.0067
 - val_f1: 0.9968
Epoch 154/300
 - 2s - loss: 0.0031 - val_loss: 0.0068
 - val_f1: 0.9970
Epoch 155/300
 - 2s - loss: 0.0031 - val_loss: 0.0059
 - val_f1: 0.9973
Epoch 156/300
 - 2s - loss: 0.0031 - val_loss: 0.0065
 - val_f1: 0.9970
Epoch 157/300
 - 2s - loss: 0.0031 - val_loss: 0.0058
 - val_f1: 0.9973
Epoch 158/300
 - 2s - loss: 0.0028 - val_loss: 0.0065
 - val_f1: 0.9967
Epoch 159/300
 - 2s - loss: 0.0030 - val_loss: 0.0055
 - val_f1: 0.9973
Epoch 160/300
 - 2s - loss: 0.0030 - val_loss: 0.0058
 - val_f1: 0.9971
Epoch 161/300
 - 2s - loss: 0.0030 - val_loss: 0.0058
 - val_f1: 0.9971
Epoch 162/300
 - 2s - loss: 0.0031 - val_loss: 0.0060
 - val_f1: 0.9973
Epoch 163/300
 - 2s - loss: 0.0030 - val_loss: 0.0056
 - val_f1: 0.9974
Epoch 164/300
 - 2s - loss: 0.0031 - val_loss: 0.0061
 - val_f1: 0.9972
Epoch 165/300
 - 2s - loss: 0.0030 - val_loss: 0.0064
 - val_f1: 0.9972
Epoch 166/300
 - 2s - loss: 0.0031 - val_loss: 0.0058
 - val_f1: 0.9973
Epoch 167/300
 - 2s - loss: 0.0031 - val_loss: 0.0060
 - val_f1: 0.9971
Epoch 168/300
 - 2s - loss: 0.0031 - val_loss: 0.0054
 - val_f1: 0.9973
Epoch 169/300
 - 2s - loss: 0.0028 - val_loss: 0.0059
 - val_f1: 0.9973
Epoch 170/300
 - 2s - loss: 0.0028 - val_loss: 0.0062
 - val_f1: 0.9971
Epoch 171/300
 - 2s - loss: 0.0031 - val_loss: 0.0056
 - val_f1: 0.9970
Epoch 172/300
 - 2s - loss: 0.0029 - val_loss: 0.0060
 - val_f1: 0.9966
Epoch 173/300
 - 2s - loss: 0.0031 - val_loss: 0.0062
 - val_f1: 0.9969
Epoch 174/300
 - 2s - loss: 0.0030 - val_loss: 0.0052
 - val_f1: 0.9975
Epoch 175/300
 - 2s - loss: 0.0029 - val_loss: 0.0055
 - val_f1: 0.9975
Epoch 176/300
 - 2s - loss: 0.0031 - val_loss: 0.0058
 - val_f1: 0.9971
Epoch 177/300
 - 2s - loss: 0.0030 - val_loss: 0.0059
 - val_f1: 0.9967
Epoch 178/300
 - 2s - loss: 0.0031 - val_loss: 0.0059
 - val_f1: 0.9973
Epoch 179/300
 - 2s - loss: 0.0032 - val_loss: 0.0056
 - val_f1: 0.9975
Epoch 180/300
 - 2s - loss: 0.0029 - val_loss: 0.0068
 - val_f1: 0.9965
Epoch 181/300
 - 2s - loss: 0.0031 - val_loss: 0.0060
2019-12-20 17:34:43,424 [INFO] epoch = 180. Intermediate model saved to results_selected_models/selected_nsl_ann_shallow_rep3/ann_model_epoch_180.pickle
 - val_f1: 0.9974
Epoch 182/300
 - 2s - loss: 0.0032 - val_loss: 0.0060
 - val_f1: 0.9973
Epoch 183/300
 - 2s - loss: 0.0029 - val_loss: 0.0067
 - val_f1: 0.9967
Epoch 184/300
 - 2s - loss: 0.0031 - val_loss: 0.0062
 - val_f1: 0.9970
Epoch 185/300
 - 2s - loss: 0.0028 - val_loss: 0.0062
 - val_f1: 0.9970
Epoch 186/300
 - 2s - loss: 0.0029 - val_loss: 0.0065
 - val_f1: 0.9966
Epoch 187/300
 - 2s - loss: 0.0030 - val_loss: 0.0059
 - val_f1: 0.9971
Epoch 188/300
 - 2s - loss: 0.0029 - val_loss: 0.0057
 - val_f1: 0.9971
Epoch 189/300
 - 2s - loss: 0.0031 - val_loss: 0.0058
 - val_f1: 0.9972
Epoch 190/300
 - 2s - loss: 0.0030 - val_loss: 0.0060
 - val_f1: 0.9972
Epoch 191/300
 - 2s - loss: 0.0030 - val_loss: 0.0059
 - val_f1: 0.9970
Epoch 192/300
 - 2s - loss: 0.0029 - val_loss: 0.0058
 - val_f1: 0.9973
Epoch 193/300
 - 2s - loss: 0.0027 - val_loss: 0.0058
 - val_f1: 0.9972
Epoch 194/300
 - 2s - loss: 0.0029 - val_loss: 0.0059
 - val_f1: 0.9972
Epoch 195/300
 - 2s - loss: 0.0030 - val_loss: 0.0056
 - val_f1: 0.9972
Epoch 196/300
 - 2s - loss: 0.0030 - val_loss: 0.0055
 - val_f1: 0.9974
Epoch 197/300
 - 2s - loss: 0.0030 - val_loss: 0.0058
 - val_f1: 0.9973
Epoch 198/300
 - 2s - loss: 0.0029 - val_loss: 0.0059
 - val_f1: 0.9972
Epoch 199/300
 - 2s - loss: 0.0028 - val_loss: 0.0052
 - val_f1: 0.9974
Epoch 200/300
 - 2s - loss: 0.0030 - val_loss: 0.0054
 - val_f1: 0.9974
Epoch 201/300
 - 2s - loss: 0.0029 - val_loss: 0.0055
 - val_f1: 0.9972
Epoch 202/300
 - 2s - loss: 0.0029 - val_loss: 0.0058
 - val_f1: 0.9972
Epoch 203/300
 - 2s - loss: 0.0031 - val_loss: 0.0057
 - val_f1: 0.9974
Epoch 204/300
 - 2s - loss: 0.0028 - val_loss: 0.0055
 - val_f1: 0.9971
Epoch 205/300
 - 2s - loss: 0.0028 - val_loss: 0.0057
 - val_f1: 0.9973
Epoch 206/300
 - 2s - loss: 0.0027 - val_loss: 0.0059
 - val_f1: 0.9973
Epoch 207/300
 - 2s - loss: 0.0029 - val_loss: 0.0058
 - val_f1: 0.9974
Epoch 208/300
 - 2s - loss: 0.0027 - val_loss: 0.0053
 - val_f1: 0.9973
Epoch 209/300
 - 2s - loss: 0.0027 - val_loss: 0.0055
 - val_f1: 0.9973
Epoch 210/300
 - 2s - loss: 0.0026 - val_loss: 0.0057
 - val_f1: 0.9969
Epoch 211/300
 - 2s - loss: 0.0029 - val_loss: 0.0053
2019-12-20 17:35:59,999 [INFO] epoch = 210. Intermediate model saved to results_selected_models/selected_nsl_ann_shallow_rep3/ann_model_epoch_210.pickle
 - val_f1: 0.9977
Epoch 212/300
 - 2s - loss: 0.0028 - val_loss: 0.0055
 - val_f1: 0.9972
Epoch 213/300
 - 2s - loss: 0.0026 - val_loss: 0.0057
 - val_f1: 0.9975
Epoch 214/300
 - 2s - loss: 0.0028 - val_loss: 0.0058
 - val_f1: 0.9973
Epoch 215/300
 - 2s - loss: 0.0029 - val_loss: 0.0053
 - val_f1: 0.9974
Epoch 216/300
 - 2s - loss: 0.0027 - val_loss: 0.0056
 - val_f1: 0.9972
Epoch 217/300
 - 2s - loss: 0.0027 - val_loss: 0.0053
 - val_f1: 0.9975
Epoch 218/300
 - 2s - loss: 0.0030 - val_loss: 0.0061
 - val_f1: 0.9973
Epoch 219/300
 - 2s - loss: 0.0029 - val_loss: 0.0066
 - val_f1: 0.9972
Epoch 220/300
 - 2s - loss: 0.0027 - val_loss: 0.0064
 - val_f1: 0.9969
Epoch 221/300
 - 2s - loss: 0.0029 - val_loss: 0.0052
 - val_f1: 0.9974
Epoch 222/300
 - 2s - loss: 0.0028 - val_loss: 0.0055
 - val_f1: 0.9974
Epoch 223/300
 - 2s - loss: 0.0027 - val_loss: 0.0060
 - val_f1: 0.9972
Epoch 224/300
 - 2s - loss: 0.0027 - val_loss: 0.0058
 - val_f1: 0.9970
Epoch 225/300
 - 2s - loss: 0.0028 - val_loss: 0.0056
 - val_f1: 0.9972
Epoch 226/300
 - 2s - loss: 0.0028 - val_loss: 0.0053
 - val_f1: 0.9969
Epoch 227/300
 - 2s - loss: 0.0027 - val_loss: 0.0053
 - val_f1: 0.9972
Epoch 228/300
 - 2s - loss: 0.0027 - val_loss: 0.0058
 - val_f1: 0.9970
Epoch 229/300
 - 2s - loss: 0.0025 - val_loss: 0.0054
 - val_f1: 0.9973
Epoch 230/300
 - 2s - loss: 0.0026 - val_loss: 0.0056
 - val_f1: 0.9975
Epoch 231/300
 - 2s - loss: 0.0028 - val_loss: 0.0054
 - val_f1: 0.9974
Epoch 232/300
 - 2s - loss: 0.0029 - val_loss: 0.0062
 - val_f1: 0.9968
Epoch 233/300
 - 2s - loss: 0.0026 - val_loss: 0.0057
 - val_f1: 0.9974
Epoch 234/300
 - 2s - loss: 0.0027 - val_loss: 0.0061
 - val_f1: 0.9969
Epoch 235/300
 - 2s - loss: 0.0029 - val_loss: 0.0061
 - val_f1: 0.9972
Epoch 236/300
 - 2s - loss: 0.0027 - val_loss: 0.0061
 - val_f1: 0.9973
Epoch 237/300
 - 2s - loss: 0.0026 - val_loss: 0.0055
 - val_f1: 0.9975
Epoch 238/300
 - 2s - loss: 0.0026 - val_loss: 0.0057
 - val_f1: 0.9975
Epoch 239/300
 - 2s - loss: 0.0028 - val_loss: 0.0060
 - val_f1: 0.9971
Epoch 240/300
 - 2s - loss: 0.0027 - val_loss: 0.0059
 - val_f1: 0.9972
Epoch 241/300
 - 2s - loss: 0.0028 - val_loss: 0.0059
2019-12-20 17:37:16,706 [INFO] epoch = 240. Intermediate model saved to results_selected_models/selected_nsl_ann_shallow_rep3/ann_model_epoch_240.pickle
 - val_f1: 0.9974
Epoch 242/300
 - 2s - loss: 0.0028 - val_loss: 0.0070
 - val_f1: 0.9971
Epoch 243/300
 - 2s - loss: 0.0028 - val_loss: 0.0062
 - val_f1: 0.9970
Epoch 244/300
 - 2s - loss: 0.0029 - val_loss: 0.0062
 - val_f1: 0.9973
Epoch 245/300
 - 2s - loss: 0.0028 - val_loss: 0.0058
 - val_f1: 0.9973
Epoch 246/300
 - 2s - loss: 0.0032 - val_loss: 0.0061
 - val_f1: 0.9972
Epoch 247/300
 - 2s - loss: 0.0028 - val_loss: 0.0062
 - val_f1: 0.9971
Epoch 248/300
 - 2s - loss: 0.0029 - val_loss: 0.0060
 - val_f1: 0.9971
Epoch 249/300
 - 2s - loss: 0.0027 - val_loss: 0.0055
 - val_f1: 0.9975
Epoch 250/300
 - 2s - loss: 0.0026 - val_loss: 0.0055
 - val_f1: 0.9974
Epoch 251/300
 - 2s - loss: 0.0027 - val_loss: 0.0061
 - val_f1: 0.9973
Epoch 252/300
 - 2s - loss: 0.0026 - val_loss: 0.0062
 - val_f1: 0.9970
Epoch 253/300
 - 2s - loss: 0.0028 - val_loss: 0.0059
 - val_f1: 0.9975
Epoch 254/300
 - 2s - loss: 0.0027 - val_loss: 0.0063
 - val_f1: 0.9968
Epoch 255/300
 - 2s - loss: 0.0028 - val_loss: 0.0055
 - val_f1: 0.9975
Epoch 256/300
 - 2s - loss: 0.0028 - val_loss: 0.0057
 - val_f1: 0.9976
Epoch 257/300
 - 2s - loss: 0.0027 - val_loss: 0.0054
 - val_f1: 0.9977
Epoch 258/300
 - 2s - loss: 0.0026 - val_loss: 0.0056
 - val_f1: 0.9974
Epoch 259/300
 - 2s - loss: 0.0026 - val_loss: 0.0053
 - val_f1: 0.9973
Epoch 260/300
 - 2s - loss: 0.0028 - val_loss: 0.0060
 - val_f1: 0.9972
Epoch 261/300
 - 2s - loss: 0.0030 - val_loss: 0.0057
 - val_f1: 0.9973
Epoch 262/300
 - 2s - loss: 0.0026 - val_loss: 0.0054
 - val_f1: 0.9974
Epoch 263/300
 - 2s - loss: 0.0027 - val_loss: 0.0057
 - val_f1: 0.9973
Epoch 264/300
 - 2s - loss: 0.0029 - val_loss: 0.0065
 - val_f1: 0.9972
Epoch 265/300
 - 2s - loss: 0.0027 - val_loss: 0.0059
 - val_f1: 0.9971
Epoch 266/300
 - 2s - loss: 0.0024 - val_loss: 0.0060
 - val_f1: 0.9973
Epoch 267/300
 - 2s - loss: 0.0026 - val_loss: 0.0063
 - val_f1: 0.9967
Epoch 268/300
 - 2s - loss: 0.0028 - val_loss: 0.0060
 - val_f1: 0.9974
Epoch 269/300
 - 2s - loss: 0.0028 - val_loss: 0.0054
 - val_f1: 0.9976
Epoch 270/300
 - 2s - loss: 0.0028 - val_loss: 0.0060
 - val_f1: 0.9969
Epoch 271/300
 - 2s - loss: 0.0027 - val_loss: 0.0059
2019-12-20 17:38:33,371 [INFO] epoch = 270. Intermediate model saved to results_selected_models/selected_nsl_ann_shallow_rep3/ann_model_epoch_270.pickle
2019-12-20 17:38:33,872 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-20 17:38:36,684 [INFO] Last epoch loss evaluation: train_loss = 0.002038, val_loss = 0.005229
2019-12-20 17:38:36,684 [INFO] Training complete. time_to_train = 696.40 sec, 11.61 min
2019-12-20 17:38:36,688 [INFO] Model saved to results_selected_models/selected_nsl_ann_shallow_rep3/best_model.pickle
2019-12-20 17:38:36,866 [INFO] Plot saved to: results_selected_models/selected_nsl_ann_shallow_rep3/training_error_history.png
2019-12-20 17:38:37,032 [INFO] Plot saved to: results_selected_models/selected_nsl_ann_shallow_rep3/training_f1_history.png
2019-12-20 17:38:37,032 [INFO] Making predictions on training, validation, testing data
2019-12-20 17:38:39,978 [INFO] Evaluating predictions (results)
2019-12-20 17:38:40,539 [INFO] Dataset: Testing. Classification report below
2019-12-20 17:38:40,539 [INFO] 
              precision    recall  f1-score   support

         dos       0.95      0.83      0.89      7458
      normal       0.67      0.95      0.79      9711
       probe       0.77      0.66      0.71      2421
         r2l       0.97      0.07      0.14      2421
         u2r       0.92      0.05      0.09       533

    accuracy                           0.76     22544
   macro avg       0.86      0.51      0.52     22544
weighted avg       0.81      0.76      0.73     22544

2019-12-20 17:38:40,539 [INFO] Overall accuracy (micro avg): 0.7642388218594748
2019-12-20 17:38:41,148 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.7642         0.7642                       0.7642                0.0589                   0.2358  0.7642
1     Macro avg        0.9057         0.8572                       0.5113                0.0794                   0.4887  0.5212
2  Weighted avg        0.8640         0.8126                       0.7642                0.1613                   0.2358  0.7255
2019-12-20 17:38:41,823 [INFO] Dataset: Validation. Classification report below
2019-12-20 17:38:41,823 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00      9186
      normal       1.00      1.00      1.00     13469
       probe       0.99      1.00      0.99      2331
         r2l       0.95      0.92      0.94       199
         u2r       0.75      0.60      0.67        10

    accuracy                           1.00     25195
   macro avg       0.94      0.90      0.92     25195
weighted avg       1.00      1.00      1.00     25195

2019-12-20 17:38:41,826 [INFO] Overall accuracy (micro avg): 0.9973804326255209
2019-12-20 17:38:42,509 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9974         0.9974                       0.9974                0.0007                   0.0026  0.9974
1     Macro avg        0.9990         0.9378                       0.9034                0.0009                   0.0966  0.9189
2  Weighted avg        0.9984         0.9974                       0.9974                0.0017                   0.0026  0.9974
2019-12-20 17:38:45,374 [INFO] Dataset: Training. Classification report below
2019-12-20 17:38:45,374 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00     36741
      normal       1.00      1.00      1.00     53874
       probe       1.00      1.00      1.00      9325
         r2l       0.97      0.95      0.96       796
         u2r       0.91      0.74      0.82        42

    accuracy                           1.00    100778
   macro avg       0.98      0.94      0.95    100778
weighted avg       1.00      1.00      1.00    100778

2019-12-20 17:38:45,374 [INFO] Overall accuracy (micro avg): 0.9984818115064796
2019-12-20 17:38:48,445 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9985         0.9985                       0.9985                0.0004                   0.0015  0.9985
1     Macro avg        0.9994         0.9756                       0.9363                0.0005                   0.0637  0.9541
2  Weighted avg        0.9991         0.9985                       0.9985                0.0011                   0.0015  0.9985
2019-12-20 17:38:48,492 [INFO] Results saved to: results_selected_models/selected_nsl_ann_shallow_rep3/selected_nsl_ann_shallow_rep3_results.xlsx
2019-12-20 17:38:48,492 [INFO] ================= Finished running experiment no. 3 ================= 

2019-12-20 17:38:48,493 [INFO] Created directory: results_selected_models/selected_nsl_ann_shallow_rep4
2019-12-20 17:38:48,493 [INFO] Initialized logging. log_filename = results_selected_models/selected_nsl_ann_shallow_rep4/run_log.log
2019-12-20 17:38:48,493 [INFO] ================= Running experiment no. 4  ================= 

2019-12-20 17:38:48,493 [INFO] Experiment parameters given below
2019-12-20 17:38:48,493 [INFO] 
{'experiment_num': 4, 'results_dir': 'results_selected_models/selected_nsl_ann_shallow_rep4', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [256], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 300, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/nsl_kdd_five_classes', 'description': 'selected_nsl_ann_shallow_rep4'}
2019-12-20 17:38:48,494 [INFO] Created tensorboard log directory: results_selected_models/selected_nsl_ann_shallow_rep4/tf_logs_run_2019_12_20-17_38_48
2019-12-20 17:38:48,494 [INFO] Loading datsets from: ../Datasets/small_datasets/nsl_kdd_five_classes
2019-12-20 17:38:48,494 [INFO] Reading X, y files
2019-12-20 17:38:48,494 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_train.h5
2019-12-20 17:38:48,726 [INFO] Reading complete. time_to_read=0.23 seconds
2019-12-20 17:38:48,727 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_val.h5
2019-12-20 17:38:48,791 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-20 17:38:48,791 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_test.h5
2019-12-20 17:38:48,850 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-20 17:38:48,850 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_train.h5
2019-12-20 17:38:48,858 [INFO] Reading complete. time_to_read=0.01 seconds
2019-12-20 17:38:48,859 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_val.h5
2019-12-20 17:38:48,863 [INFO] Reading complete. time_to_read=0.00 seconds
2019-12-20 17:38:48,863 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_test.h5
2019-12-20 17:38:48,867 [INFO] Reading complete. time_to_read=0.00 seconds
2019-12-20 17:38:48,983 [INFO] Initializing model
2019-12-20 17:38:49,105 [INFO] _________________________________________________________________
2019-12-20 17:38:49,105 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-20 17:38:49,105 [INFO] =================================================================
2019-12-20 17:38:49,105 [INFO] dense_7 (Dense)              (None, 256)               31488     
2019-12-20 17:38:49,105 [INFO] _________________________________________________________________
2019-12-20 17:38:49,105 [INFO] batch_normalization_4 (Batch (None, 256)               1024      
2019-12-20 17:38:49,105 [INFO] _________________________________________________________________
2019-12-20 17:38:49,105 [INFO] dropout_4 (Dropout)          (None, 256)               0         
2019-12-20 17:38:49,105 [INFO] _________________________________________________________________
2019-12-20 17:38:49,106 [INFO] dense_8 (Dense)              (None, 5)                 1285      
2019-12-20 17:38:49,106 [INFO] =================================================================
2019-12-20 17:38:49,106 [INFO] Total params: 33,797
2019-12-20 17:38:49,106 [INFO] Trainable params: 33,285
2019-12-20 17:38:49,106 [INFO] Non-trainable params: 512
2019-12-20 17:38:49,106 [INFO] _________________________________________________________________
2019-12-20 17:38:49,106 [INFO] Training model
 - val_f1: 0.9974
Epoch 00271: early stopping
Train on 100778 samples, validate on 25195 samples
Epoch 1/300
 - 3s - loss: 0.0566 - val_loss: 0.0170
 - val_f1: 0.9852
Epoch 2/300
 - 2s - loss: 0.0164 - val_loss: 0.0124
 - val_f1: 0.9920
Epoch 3/300
 - 2s - loss: 0.0130 - val_loss: 0.0109
 - val_f1: 0.9914
Epoch 4/300
 - 2s - loss: 0.0119 - val_loss: 0.0095
 - val_f1: 0.9935
Epoch 5/300
 - 2s - loss: 0.0103 - val_loss: 0.0098
 - val_f1: 0.9933
Epoch 6/300
 - 2s - loss: 0.0099 - val_loss: 0.0092
 - val_f1: 0.9943
Epoch 7/300
 - 2s - loss: 0.0093 - val_loss: 0.0090
 - val_f1: 0.9943
Epoch 8/300
 - 2s - loss: 0.0090 - val_loss: 0.0091
 - val_f1: 0.9949
Epoch 9/300
 - 2s - loss: 0.0085 - val_loss: 0.0095
 - val_f1: 0.9941
Epoch 10/300
 - 2s - loss: 0.0080 - val_loss: 0.0084
 - val_f1: 0.9947
Epoch 11/300
 - 2s - loss: 0.0075 - val_loss: 0.0081
 - val_f1: 0.9943
Epoch 12/300
 - 2s - loss: 0.0077 - val_loss: 0.0083
 - val_f1: 0.9943
Epoch 13/300
 - 2s - loss: 0.0075 - val_loss: 0.0076
 - val_f1: 0.9951
Epoch 14/300
 - 2s - loss: 0.0072 - val_loss: 0.0083
 - val_f1: 0.9953
Epoch 15/300
 - 2s - loss: 0.0067 - val_loss: 0.0078
 - val_f1: 0.9950
Epoch 16/300
 - 2s - loss: 0.0070 - val_loss: 0.0078
 - val_f1: 0.9956
Epoch 17/300
 - 2s - loss: 0.0064 - val_loss: 0.0082
 - val_f1: 0.9956
Epoch 18/300
 - 2s - loss: 0.0063 - val_loss: 0.0080
 - val_f1: 0.9954
Epoch 19/300
 - 2s - loss: 0.0066 - val_loss: 0.0069
 - val_f1: 0.9959
Epoch 20/300
 - 2s - loss: 0.0061 - val_loss: 0.0074
 - val_f1: 0.9956
Epoch 21/300
 - 2s - loss: 0.0062 - val_loss: 0.0077
 - val_f1: 0.9962
Epoch 22/300
 - 2s - loss: 0.0060 - val_loss: 0.0078
 - val_f1: 0.9957
Epoch 23/300
 - 2s - loss: 0.0061 - val_loss: 0.0074
 - val_f1: 0.9960
Epoch 24/300
 - 2s - loss: 0.0055 - val_loss: 0.0077
 - val_f1: 0.9953
Epoch 25/300
 - 2s - loss: 0.0061 - val_loss: 0.0080
 - val_f1: 0.9964
Epoch 26/300
 - 2s - loss: 0.0057 - val_loss: 0.0079
 - val_f1: 0.9961
Epoch 27/300
 - 2s - loss: 0.0056 - val_loss: 0.0074
 - val_f1: 0.9966
Epoch 28/300
 - 2s - loss: 0.0056 - val_loss: 0.0077
 - val_f1: 0.9966
Epoch 29/300
 - 2s - loss: 0.0054 - val_loss: 0.0072
 - val_f1: 0.9960
Epoch 30/300
 - 2s - loss: 0.0052 - val_loss: 0.0068
 - val_f1: 0.9964
Epoch 31/300
 - 2s - loss: 0.0050 - val_loss: 0.0065
2019-12-20 17:40:10,056 [INFO] epoch = 30. Intermediate model saved to results_selected_models/selected_nsl_ann_shallow_rep4/ann_model_epoch_30.pickle
 - val_f1: 0.9963
Epoch 32/300
 - 2s - loss: 0.0050 - val_loss: 0.0073
 - val_f1: 0.9956
Epoch 33/300
 - 2s - loss: 0.0050 - val_loss: 0.0071
 - val_f1: 0.9959
Epoch 34/300
 - 2s - loss: 0.0048 - val_loss: 0.0068
 - val_f1: 0.9967
Epoch 35/300
 - 2s - loss: 0.0052 - val_loss: 0.0068
 - val_f1: 0.9964
Epoch 36/300
 - 2s - loss: 0.0049 - val_loss: 0.0068
 - val_f1: 0.9966
Epoch 37/300
 - 2s - loss: 0.0048 - val_loss: 0.0071
 - val_f1: 0.9954
Epoch 38/300
 - 2s - loss: 0.0048 - val_loss: 0.0070
 - val_f1: 0.9960
Epoch 39/300
 - 2s - loss: 0.0049 - val_loss: 0.0066
 - val_f1: 0.9964
Epoch 40/300
 - 2s - loss: 0.0044 - val_loss: 0.0066
 - val_f1: 0.9963
Epoch 41/300
 - 2s - loss: 0.0046 - val_loss: 0.0063
 - val_f1: 0.9970
Epoch 42/300
 - 2s - loss: 0.0045 - val_loss: 0.0063
 - val_f1: 0.9965
Epoch 43/300
 - 2s - loss: 0.0045 - val_loss: 0.0080
 - val_f1: 0.9944
Epoch 44/300
 - 2s - loss: 0.0045 - val_loss: 0.0062
 - val_f1: 0.9964
Epoch 45/300
 - 2s - loss: 0.0045 - val_loss: 0.0069
 - val_f1: 0.9966
Epoch 46/300
 - 2s - loss: 0.0043 - val_loss: 0.0062
 - val_f1: 0.9973
Epoch 47/300
 - 2s - loss: 0.0045 - val_loss: 0.0064
 - val_f1: 0.9968
Epoch 48/300
 - 2s - loss: 0.0043 - val_loss: 0.0065
 - val_f1: 0.9969
Epoch 49/300
 - 2s - loss: 0.0045 - val_loss: 0.0073
 - val_f1: 0.9959
Epoch 50/300
 - 2s - loss: 0.0046 - val_loss: 0.0068
 - val_f1: 0.9966
Epoch 51/300
 - 2s - loss: 0.0043 - val_loss: 0.0063
 - val_f1: 0.9964
Epoch 52/300
 - 2s - loss: 0.0044 - val_loss: 0.0067
 - val_f1: 0.9966
Epoch 53/300
 - 2s - loss: 0.0050 - val_loss: 0.0064
 - val_f1: 0.9964
Epoch 54/300
 - 2s - loss: 0.0045 - val_loss: 0.0061
 - val_f1: 0.9967
Epoch 55/300
 - 2s - loss: 0.0043 - val_loss: 0.0068
 - val_f1: 0.9962
Epoch 56/300
 - 2s - loss: 0.0043 - val_loss: 0.0062
 - val_f1: 0.9967
Epoch 57/300
 - 2s - loss: 0.0039 - val_loss: 0.0066
 - val_f1: 0.9962
Epoch 58/300
 - 2s - loss: 0.0044 - val_loss: 0.0064
 - val_f1: 0.9967
Epoch 59/300
 - 2s - loss: 0.0041 - val_loss: 0.0068
 - val_f1: 0.9967
Epoch 60/300
 - 2s - loss: 0.0043 - val_loss: 0.0070
 - val_f1: 0.9964
Epoch 61/300
 - 2s - loss: 0.0044 - val_loss: 0.0067
2019-12-20 17:41:27,087 [INFO] epoch = 60. Intermediate model saved to results_selected_models/selected_nsl_ann_shallow_rep4/ann_model_epoch_60.pickle
 - val_f1: 0.9968
Epoch 62/300
 - 2s - loss: 0.0042 - val_loss: 0.0073
 - val_f1: 0.9965
Epoch 63/300
 - 2s - loss: 0.0043 - val_loss: 0.0071
 - val_f1: 0.9967
Epoch 64/300
 - 2s - loss: 0.0042 - val_loss: 0.0073
 - val_f1: 0.9964
Epoch 65/300
 - 2s - loss: 0.0040 - val_loss: 0.0071
 - val_f1: 0.9962
Epoch 66/300
 - 2s - loss: 0.0038 - val_loss: 0.0065
 - val_f1: 0.9965
Epoch 67/300
 - 2s - loss: 0.0037 - val_loss: 0.0069
 - val_f1: 0.9967
Epoch 68/300
 - 2s - loss: 0.0038 - val_loss: 0.0069
 - val_f1: 0.9968
Epoch 69/300
 - 2s - loss: 0.0039 - val_loss: 0.0069
 - val_f1: 0.9964
Epoch 70/300
 - 2s - loss: 0.0037 - val_loss: 0.0067
 - val_f1: 0.9968
Epoch 71/300
 - 2s - loss: 0.0039 - val_loss: 0.0069
 - val_f1: 0.9968
Epoch 72/300
 - 2s - loss: 0.0039 - val_loss: 0.0067
 - val_f1: 0.9968
Epoch 73/300
 - 2s - loss: 0.0040 - val_loss: 0.0066
 - val_f1: 0.9967
Epoch 74/300
 - 2s - loss: 0.0038 - val_loss: 0.0068
 - val_f1: 0.9968
Epoch 75/300
 - 2s - loss: 0.0039 - val_loss: 0.0068
 - val_f1: 0.9967
Epoch 76/300
 - 2s - loss: 0.0040 - val_loss: 0.0070
 - val_f1: 0.9964
Epoch 77/300
 - 2s - loss: 0.0038 - val_loss: 0.0063
 - val_f1: 0.9970
Epoch 78/300
 - 2s - loss: 0.0038 - val_loss: 0.0067
 - val_f1: 0.9966
Epoch 79/300
 - 2s - loss: 0.0036 - val_loss: 0.0067
 - val_f1: 0.9965
Epoch 80/300
 - 2s - loss: 0.0037 - val_loss: 0.0065
 - val_f1: 0.9969
Epoch 81/300
 - 2s - loss: 0.0038 - val_loss: 0.0063
 - val_f1: 0.9969
Epoch 82/300
 - 2s - loss: 0.0036 - val_loss: 0.0062
 - val_f1: 0.9972
Epoch 83/300
 - 2s - loss: 0.0036 - val_loss: 0.0064
 - val_f1: 0.9968
Epoch 84/300
 - 2s - loss: 0.0041 - val_loss: 0.0067
 - val_f1: 0.9967
Epoch 85/300
 - 2s - loss: 0.0038 - val_loss: 0.0062
 - val_f1: 0.9967
Epoch 86/300
 - 2s - loss: 0.0038 - val_loss: 0.0067
 - val_f1: 0.9969
Epoch 87/300
 - 2s - loss: 0.0038 - val_loss: 0.0069
 - val_f1: 0.9966
Epoch 88/300
 - 2s - loss: 0.0040 - val_loss: 0.0068
 - val_f1: 0.9970
Epoch 89/300
 - 2s - loss: 0.0039 - val_loss: 0.0063
 - val_f1: 0.9970
Epoch 90/300
 - 2s - loss: 0.0039 - val_loss: 0.0069
 - val_f1: 0.9963
Epoch 91/300
 - 2s - loss: 0.0038 - val_loss: 0.0065
2019-12-20 17:42:44,147 [INFO] epoch = 90. Intermediate model saved to results_selected_models/selected_nsl_ann_shallow_rep4/ann_model_epoch_90.pickle
 - val_f1: 0.9970
Epoch 92/300
 - 2s - loss: 0.0037 - val_loss: 0.0074
 - val_f1: 0.9964
Epoch 93/300
 - 2s - loss: 0.0037 - val_loss: 0.0066
 - val_f1: 0.9968
Epoch 94/300
 - 2s - loss: 0.0039 - val_loss: 0.0069
 - val_f1: 0.9970
Epoch 95/300
 - 2s - loss: 0.0036 - val_loss: 0.0062
 - val_f1: 0.9965
Epoch 96/300
 - 2s - loss: 0.0034 - val_loss: 0.0064
 - val_f1: 0.9966
Epoch 97/300
 - 2s - loss: 0.0039 - val_loss: 0.0067
 - val_f1: 0.9968
Epoch 98/300
 - 2s - loss: 0.0038 - val_loss: 0.0062
 - val_f1: 0.9968
Epoch 99/300
 - 2s - loss: 0.0034 - val_loss: 0.0071
 - val_f1: 0.9966
Epoch 100/300
 - 2s - loss: 0.0037 - val_loss: 0.0064
 - val_f1: 0.9968
Epoch 101/300
 - 2s - loss: 0.0035 - val_loss: 0.0059
 - val_f1: 0.9965
Epoch 102/300
 - 2s - loss: 0.0034 - val_loss: 0.0067
 - val_f1: 0.9966
Epoch 103/300
 - 2s - loss: 0.0035 - val_loss: 0.0062
 - val_f1: 0.9970
Epoch 104/300
 - 2s - loss: 0.0032 - val_loss: 0.0067
 - val_f1: 0.9968
Epoch 105/300
 - 2s - loss: 0.0033 - val_loss: 0.0061
 - val_f1: 0.9969
Epoch 106/300
 - 2s - loss: 0.0032 - val_loss: 0.0063
 - val_f1: 0.9970
Epoch 107/300
 - 2s - loss: 0.0032 - val_loss: 0.0062
 - val_f1: 0.9970
Epoch 108/300
 - 2s - loss: 0.0034 - val_loss: 0.0064
 - val_f1: 0.9968
Epoch 109/300
 - 2s - loss: 0.0037 - val_loss: 0.0059
 - val_f1: 0.9970
Epoch 110/300
 - 2s - loss: 0.0033 - val_loss: 0.0062
 - val_f1: 0.9969
Epoch 111/300
 - 2s - loss: 0.0034 - val_loss: 0.0058
 - val_f1: 0.9971
Epoch 112/300
 - 2s - loss: 0.0034 - val_loss: 0.0061
 - val_f1: 0.9967
Epoch 113/300
 - 2s - loss: 0.0034 - val_loss: 0.0062
 - val_f1: 0.9969
Epoch 114/300
 - 2s - loss: 0.0032 - val_loss: 0.0055
 - val_f1: 0.9971
Epoch 115/300
 - 2s - loss: 0.0036 - val_loss: 0.0062
 - val_f1: 0.9969
Epoch 116/300
 - 2s - loss: 0.0034 - val_loss: 0.0059
 - val_f1: 0.9970
Epoch 117/300
 - 2s - loss: 0.0033 - val_loss: 0.0056
 - val_f1: 0.9970
Epoch 118/300
 - 2s - loss: 0.0033 - val_loss: 0.0059
 - val_f1: 0.9971
Epoch 119/300
 - 2s - loss: 0.0033 - val_loss: 0.0055
 - val_f1: 0.9968
Epoch 120/300
 - 2s - loss: 0.0032 - val_loss: 0.0056
 - val_f1: 0.9971
Epoch 121/300
 - 2s - loss: 0.0034 - val_loss: 0.0056
2019-12-20 17:44:01,230 [INFO] epoch = 120. Intermediate model saved to results_selected_models/selected_nsl_ann_shallow_rep4/ann_model_epoch_120.pickle
 - val_f1: 0.9972
Epoch 122/300
 - 2s - loss: 0.0033 - val_loss: 0.0052
 - val_f1: 0.9976
Epoch 123/300
 - 2s - loss: 0.0036 - val_loss: 0.0054
 - val_f1: 0.9972
Epoch 124/300
 - 2s - loss: 0.0033 - val_loss: 0.0063
 - val_f1: 0.9958
Epoch 125/300
 - 2s - loss: 0.0032 - val_loss: 0.0057
 - val_f1: 0.9970
Epoch 126/300
 - 2s - loss: 0.0034 - val_loss: 0.0055
 - val_f1: 0.9969
Epoch 127/300
 - 2s - loss: 0.0033 - val_loss: 0.0057
 - val_f1: 0.9972
Epoch 128/300
 - 2s - loss: 0.0034 - val_loss: 0.0051
 - val_f1: 0.9973
Epoch 129/300
 - 2s - loss: 0.0031 - val_loss: 0.0052
 - val_f1: 0.9972
Epoch 130/300
 - 2s - loss: 0.0033 - val_loss: 0.0056
 - val_f1: 0.9971
Epoch 131/300
 - 2s - loss: 0.0034 - val_loss: 0.0061
 - val_f1: 0.9968
Epoch 132/300
 - 2s - loss: 0.0033 - val_loss: 0.0056
 - val_f1: 0.9972
Epoch 133/300
 - 2s - loss: 0.0032 - val_loss: 0.0059
 - val_f1: 0.9971
Epoch 134/300
 - 2s - loss: 0.0032 - val_loss: 0.0063
 - val_f1: 0.9970
Epoch 135/300
 - 2s - loss: 0.0032 - val_loss: 0.0059
 - val_f1: 0.9967
Epoch 136/300
 - 2s - loss: 0.0032 - val_loss: 0.0060
 - val_f1: 0.9970
Epoch 137/300
 - 2s - loss: 0.0032 - val_loss: 0.0066
 - val_f1: 0.9967
Epoch 138/300
 - 2s - loss: 0.0033 - val_loss: 0.0059
 - val_f1: 0.9972
Epoch 139/300
 - 2s - loss: 0.0034 - val_loss: 0.0059
 - val_f1: 0.9973
Epoch 140/300
 - 2s - loss: 0.0031 - val_loss: 0.0054
 - val_f1: 0.9973
Epoch 141/300
 - 2s - loss: 0.0031 - val_loss: 0.0057
 - val_f1: 0.9971
Epoch 142/300
 - 2s - loss: 0.0033 - val_loss: 0.0061
 - val_f1: 0.9970
Epoch 143/300
 - 2s - loss: 0.0032 - val_loss: 0.0056
 - val_f1: 0.9972
Epoch 144/300
 - 2s - loss: 0.0030 - val_loss: 0.0057
 - val_f1: 0.9972
Epoch 145/300
 - 2s - loss: 0.0029 - val_loss: 0.0061
 - val_f1: 0.9966
Epoch 146/300
 - 2s - loss: 0.0032 - val_loss: 0.0055
 - val_f1: 0.9970
Epoch 147/300
 - 2s - loss: 0.0030 - val_loss: 0.0057
 - val_f1: 0.9970
Epoch 148/300
 - 2s - loss: 0.0029 - val_loss: 0.0053
 - val_f1: 0.9972
Epoch 149/300
 - 2s - loss: 0.0030 - val_loss: 0.0058
 - val_f1: 0.9973
Epoch 150/300
 - 2s - loss: 0.0031 - val_loss: 0.0055
 - val_f1: 0.9971
Epoch 151/300
 - 2s - loss: 0.0031 - val_loss: 0.0060
2019-12-20 17:45:18,265 [INFO] epoch = 150. Intermediate model saved to results_selected_models/selected_nsl_ann_shallow_rep4/ann_model_epoch_150.pickle
 - val_f1: 0.9972
Epoch 152/300
 - 2s - loss: 0.0029 - val_loss: 0.0056
 - val_f1: 0.9968
Epoch 153/300
 - 2s - loss: 0.0030 - val_loss: 0.0050
 - val_f1: 0.9974
Epoch 154/300
 - 2s - loss: 0.0031 - val_loss: 0.0056
 - val_f1: 0.9972
Epoch 155/300
 - 2s - loss: 0.0031 - val_loss: 0.0060
 - val_f1: 0.9973
Epoch 156/300
 - 2s - loss: 0.0032 - val_loss: 0.0062
 - val_f1: 0.9968
Epoch 157/300
 - 2s - loss: 0.0033 - val_loss: 0.0066
 - val_f1: 0.9969
Epoch 158/300
 - 2s - loss: 0.0030 - val_loss: 0.0065
 - val_f1: 0.9968
Epoch 159/300
 - 2s - loss: 0.0033 - val_loss: 0.0065
 - val_f1: 0.9975
Epoch 160/300
 - 2s - loss: 0.0032 - val_loss: 0.0057
 - val_f1: 0.9974
Epoch 161/300
 - 2s - loss: 0.0033 - val_loss: 0.0055
 - val_f1: 0.9970
Epoch 162/300
 - 2s - loss: 0.0032 - val_loss: 0.0054
 - val_f1: 0.9972
Epoch 163/300
 - 2s - loss: 0.0032 - val_loss: 0.0054
 - val_f1: 0.9972
Epoch 164/300
 - 2s - loss: 0.0030 - val_loss: 0.0052
 - val_f1: 0.9973
Epoch 165/300
 - 2s - loss: 0.0029 - val_loss: 0.0063
 - val_f1: 0.9972
Epoch 166/300
 - 2s - loss: 0.0031 - val_loss: 0.0061
 - val_f1: 0.9973
Epoch 167/300
 - 2s - loss: 0.0030 - val_loss: 0.0065
 - val_f1: 0.9974
Epoch 168/300
 - 2s - loss: 0.0029 - val_loss: 0.0057
 - val_f1: 0.9969
Epoch 169/300
 - 2s - loss: 0.0028 - val_loss: 0.0062
 - val_f1: 0.9972
Epoch 170/300
 - 2s - loss: 0.0027 - val_loss: 0.0059
 - val_f1: 0.9972
Epoch 171/300
 - 2s - loss: 0.0030 - val_loss: 0.0055
 - val_f1: 0.9974
Epoch 172/300
 - 2s - loss: 0.0030 - val_loss: 0.0058
 - val_f1: 0.9973
Epoch 173/300
 - 2s - loss: 0.0029 - val_loss: 0.0066
 - val_f1: 0.9971
Epoch 174/300
 - 2s - loss: 0.0030 - val_loss: 0.0062
 - val_f1: 0.9969
Epoch 175/300
 - 2s - loss: 0.0029 - val_loss: 0.0063
 - val_f1: 0.9973
Epoch 176/300
 - 2s - loss: 0.0028 - val_loss: 0.0065
 - val_f1: 0.9969
Epoch 177/300
 - 2s - loss: 0.0029 - val_loss: 0.0059
 - val_f1: 0.9968
Epoch 178/300
 - 2s - loss: 0.0030 - val_loss: 0.0057
 - val_f1: 0.9973
Epoch 179/300
 - 2s - loss: 0.0029 - val_loss: 0.0058
 - val_f1: 0.9971
Epoch 180/300
 - 2s - loss: 0.0033 - val_loss: 0.0060
 - val_f1: 0.9977
Epoch 181/300
 - 2s - loss: 0.0030 - val_loss: 0.0054
2019-12-20 17:46:35,255 [INFO] epoch = 180. Intermediate model saved to results_selected_models/selected_nsl_ann_shallow_rep4/ann_model_epoch_180.pickle
 - val_f1: 0.9973
Epoch 182/300
 - 2s - loss: 0.0029 - val_loss: 0.0058
 - val_f1: 0.9973
Epoch 183/300
 - 2s - loss: 0.0028 - val_loss: 0.0058
 - val_f1: 0.9973
Epoch 184/300
 - 2s - loss: 0.0028 - val_loss: 0.0060
 - val_f1: 0.9973
Epoch 185/300
 - 2s - loss: 0.0030 - val_loss: 0.0059
 - val_f1: 0.9970
Epoch 186/300
 - 2s - loss: 0.0029 - val_loss: 0.0060
 - val_f1: 0.9971
Epoch 187/300
 - 2s - loss: 0.0029 - val_loss: 0.0054
 - val_f1: 0.9973
Epoch 188/300
 - 2s - loss: 0.0029 - val_loss: 0.0060
 - val_f1: 0.9972
Epoch 189/300
 - 2s - loss: 0.0029 - val_loss: 0.0054
 - val_f1: 0.9974
Epoch 190/300
 - 2s - loss: 0.0028 - val_loss: 0.0058
 - val_f1: 0.9973
Epoch 191/300
 - 2s - loss: 0.0030 - val_loss: 0.0055
 - val_f1: 0.9971
Epoch 192/300
 - 2s - loss: 0.0028 - val_loss: 0.0054
 - val_f1: 0.9973
Epoch 193/300
 - 2s - loss: 0.0031 - val_loss: 0.0053
 - val_f1: 0.9974
Epoch 194/300
 - 2s - loss: 0.0029 - val_loss: 0.0062
 - val_f1: 0.9973
Epoch 195/300
 - 2s - loss: 0.0032 - val_loss: 0.0058
 - val_f1: 0.9973
Epoch 196/300
 - 2s - loss: 0.0030 - val_loss: 0.0056
 - val_f1: 0.9975
Epoch 197/300
 - 2s - loss: 0.0029 - val_loss: 0.0062
 - val_f1: 0.9973
Epoch 198/300
 - 2s - loss: 0.0027 - val_loss: 0.0059
 - val_f1: 0.9972
Epoch 199/300
 - 2s - loss: 0.0028 - val_loss: 0.0060
 - val_f1: 0.9974
Epoch 200/300
 - 2s - loss: 0.0028 - val_loss: 0.0062
 - val_f1: 0.9972
Epoch 201/300
 - 2s - loss: 0.0029 - val_loss: 0.0053
 - val_f1: 0.9977
Epoch 202/300
 - 2s - loss: 0.0029 - val_loss: 0.0058
 - val_f1: 0.9972
Epoch 203/300
 - 2s - loss: 0.0032 - val_loss: 0.0061
2019-12-20 17:47:32,370 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-20 17:47:35,245 [INFO] Last epoch loss evaluation: train_loss = 0.002331, val_loss = 0.005039
2019-12-20 17:47:35,245 [INFO] Training complete. time_to_train = 526.14 sec, 8.77 min
2019-12-20 17:47:35,249 [INFO] Model saved to results_selected_models/selected_nsl_ann_shallow_rep4/best_model.pickle
2019-12-20 17:47:35,435 [INFO] Plot saved to: results_selected_models/selected_nsl_ann_shallow_rep4/training_error_history.png
2019-12-20 17:47:35,618 [INFO] Plot saved to: results_selected_models/selected_nsl_ann_shallow_rep4/training_f1_history.png
2019-12-20 17:47:35,618 [INFO] Making predictions on training, validation, testing data
2019-12-20 17:47:38,564 [INFO] Evaluating predictions (results)
2019-12-20 17:47:39,127 [INFO] Dataset: Testing. Classification report below
2019-12-20 17:47:39,127 [INFO] 
              precision    recall  f1-score   support

         dos       0.96      0.83      0.89      7458
      normal       0.67      0.97      0.79      9711
       probe       0.85      0.60      0.70      2421
         r2l       0.95      0.08      0.15      2421
         u2r       0.83      0.05      0.09       533

    accuracy                           0.77     22544
   macro avg       0.85      0.51      0.52     22544
weighted avg       0.82      0.77      0.73     22544

2019-12-20 17:47:39,127 [INFO] Overall accuracy (micro avg): 0.767388218594748
2019-12-20 17:47:39,735 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.7674         0.7674                       0.7674                0.0582                   0.2326  0.7674
1     Macro avg        0.9070         0.8488                       0.5052                0.0795                   0.4948  0.5228
2  Weighted avg        0.8656         0.8164                       0.7674                0.1648                   0.2326  0.7284
2019-12-20 17:47:40,412 [INFO] Dataset: Validation. Classification report below
2019-12-20 17:47:40,412 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00      9186
      normal       1.00      1.00      1.00     13469
       probe       1.00      1.00      1.00      2331
         r2l       0.96      0.91      0.94       199
         u2r       0.71      0.50      0.59        10

    accuracy                           1.00     25195
   macro avg       0.93      0.88      0.90     25195
weighted avg       1.00      1.00      1.00     25195

2019-12-20 17:47:40,414 [INFO] Overall accuracy (micro avg): 0.9974201230402858
2019-12-20 17:47:41,100 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9974         0.9974                       0.9974                0.0006                   0.0026  0.9974
1     Macro avg        0.9990         0.9338                       0.8815                0.0009                   0.1185  0.9037
2  Weighted avg        0.9984         0.9974                       0.9974                0.0019                   0.0026  0.9974
2019-12-20 17:47:43,975 [INFO] Dataset: Training. Classification report below
2019-12-20 17:47:43,975 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00     36741
      normal       1.00      1.00      1.00     53874
       probe       1.00      1.00      1.00      9325
         r2l       0.98      0.93      0.96       796
         u2r       0.92      0.81      0.86        42

    accuracy                           1.00    100778
   macro avg       0.98      0.95      0.96    100778
weighted avg       1.00      1.00      1.00    100778

2019-12-20 17:47:43,975 [INFO] Overall accuracy (micro avg): 0.9983131238960884
2019-12-20 17:47:47,054 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9983         0.9983                       0.9983                0.0004                   0.0017  0.9983
1     Macro avg        0.9993         0.9784                       0.9474                0.0006                   0.0526  0.9621
2  Weighted avg        0.9989         0.9983                       0.9983                0.0014                   0.0017  0.9983
2019-12-20 17:47:47,101 [INFO] Results saved to: results_selected_models/selected_nsl_ann_shallow_rep4/selected_nsl_ann_shallow_rep4_results.xlsx
2019-12-20 17:47:47,101 [INFO] ================= Finished running experiment no. 4 ================= 

2019-12-20 17:47:47,102 [INFO] Created directory: results_selected_models/selected_nsl_ann_shallow_rep5
2019-12-20 17:47:47,102 [INFO] Initialized logging. log_filename = results_selected_models/selected_nsl_ann_shallow_rep5/run_log.log
2019-12-20 17:47:47,102 [INFO] ================= Running experiment no. 5  ================= 

2019-12-20 17:47:47,102 [INFO] Experiment parameters given below
2019-12-20 17:47:47,102 [INFO] 
{'experiment_num': 5, 'results_dir': 'results_selected_models/selected_nsl_ann_shallow_rep5', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [256], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 300, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/nsl_kdd_five_classes', 'description': 'selected_nsl_ann_shallow_rep5'}
2019-12-20 17:47:47,102 [INFO] Created tensorboard log directory: results_selected_models/selected_nsl_ann_shallow_rep5/tf_logs_run_2019_12_20-17_47_47
2019-12-20 17:47:47,102 [INFO] Loading datsets from: ../Datasets/small_datasets/nsl_kdd_five_classes
2019-12-20 17:47:47,103 [INFO] Reading X, y files
2019-12-20 17:47:47,103 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_train.h5
2019-12-20 17:47:47,336 [INFO] Reading complete. time_to_read=0.23 seconds
2019-12-20 17:47:47,336 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_val.h5
2019-12-20 17:47:47,401 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-20 17:47:47,401 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_test.h5
2019-12-20 17:47:47,459 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-20 17:47:47,460 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_train.h5
2019-12-20 17:47:47,469 [INFO] Reading complete. time_to_read=0.01 seconds
2019-12-20 17:47:47,469 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_val.h5
2019-12-20 17:47:47,473 [INFO] Reading complete. time_to_read=0.00 seconds
2019-12-20 17:47:47,474 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_test.h5
2019-12-20 17:47:47,478 [INFO] Reading complete. time_to_read=0.00 seconds
2019-12-20 17:47:47,594 [INFO] Initializing model
2019-12-20 17:47:47,718 [INFO] _________________________________________________________________
2019-12-20 17:47:47,718 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-20 17:47:47,718 [INFO] =================================================================
2019-12-20 17:47:47,718 [INFO] dense_9 (Dense)              (None, 256)               31488     
2019-12-20 17:47:47,718 [INFO] _________________________________________________________________
2019-12-20 17:47:47,719 [INFO] batch_normalization_5 (Batch (None, 256)               1024      
2019-12-20 17:47:47,719 [INFO] _________________________________________________________________
2019-12-20 17:47:47,719 [INFO] dropout_5 (Dropout)          (None, 256)               0         
2019-12-20 17:47:47,719 [INFO] _________________________________________________________________
2019-12-20 17:47:47,719 [INFO] dense_10 (Dense)             (None, 5)                 1285      
2019-12-20 17:47:47,719 [INFO] =================================================================
2019-12-20 17:47:47,719 [INFO] Total params: 33,797
2019-12-20 17:47:47,719 [INFO] Trainable params: 33,285
2019-12-20 17:47:47,719 [INFO] Non-trainable params: 512
2019-12-20 17:47:47,719 [INFO] _________________________________________________________________
2019-12-20 17:47:47,719 [INFO] Training model
 - val_f1: 0.9973
Epoch 00203: early stopping
Train on 100778 samples, validate on 25195 samples
Epoch 1/300
 - 3s - loss: 0.0571 - val_loss: 0.0158
 - val_f1: 0.9888
Epoch 2/300
 - 2s - loss: 0.0168 - val_loss: 0.0122
 - val_f1: 0.9920
Epoch 3/300
 - 2s - loss: 0.0133 - val_loss: 0.0115
 - val_f1: 0.9910
Epoch 4/300
 - 2s - loss: 0.0115 - val_loss: 0.0094
 - val_f1: 0.9924
Epoch 5/300
 - 2s - loss: 0.0108 - val_loss: 0.0099
 - val_f1: 0.9937
Epoch 6/300
 - 2s - loss: 0.0100 - val_loss: 0.0106
 - val_f1: 0.9927
Epoch 7/300
 - 2s - loss: 0.0094 - val_loss: 0.0087
 - val_f1: 0.9946
Epoch 8/300
 - 2s - loss: 0.0088 - val_loss: 0.0095
 - val_f1: 0.9924
Epoch 9/300
 - 2s - loss: 0.0087 - val_loss: 0.0082
 - val_f1: 0.9945
Epoch 10/300
 - 2s - loss: 0.0083 - val_loss: 0.0082
 - val_f1: 0.9948
Epoch 11/300
 - 2s - loss: 0.0077 - val_loss: 0.0076
 - val_f1: 0.9953
Epoch 12/300
 - 2s - loss: 0.0071 - val_loss: 0.0076
 - val_f1: 0.9958
Epoch 13/300
 - 2s - loss: 0.0072 - val_loss: 0.0075
 - val_f1: 0.9958
Epoch 14/300
 - 2s - loss: 0.0072 - val_loss: 0.0074
 - val_f1: 0.9947
Epoch 15/300
 - 2s - loss: 0.0066 - val_loss: 0.0077
 - val_f1: 0.9952
Epoch 16/300
 - 2s - loss: 0.0066 - val_loss: 0.0070
 - val_f1: 0.9958
Epoch 17/300
 - 2s - loss: 0.0063 - val_loss: 0.0087
 - val_f1: 0.9943
Epoch 18/300
 - 2s - loss: 0.0060 - val_loss: 0.0082
 - val_f1: 0.9935
Epoch 19/300
 - 2s - loss: 0.0064 - val_loss: 0.0073
 - val_f1: 0.9961
Epoch 20/300
 - 2s - loss: 0.0065 - val_loss: 0.0069
 - val_f1: 0.9963
Epoch 21/300
 - 2s - loss: 0.0059 - val_loss: 0.0072
 - val_f1: 0.9960
Epoch 22/300
 - 2s - loss: 0.0058 - val_loss: 0.0095
 - val_f1: 0.9930
Epoch 23/300
 - 2s - loss: 0.0058 - val_loss: 0.0074
 - val_f1: 0.9959
Epoch 24/300
 - 2s - loss: 0.0057 - val_loss: 0.0068
 - val_f1: 0.9965
Epoch 25/300
 - 2s - loss: 0.0055 - val_loss: 0.0067
 - val_f1: 0.9961
Epoch 26/300
 - 2s - loss: 0.0053 - val_loss: 0.0071
 - val_f1: 0.9961
Epoch 27/300
 - 2s - loss: 0.0051 - val_loss: 0.0072
 - val_f1: 0.9960
Epoch 28/300
 - 2s - loss: 0.0051 - val_loss: 0.0070
 - val_f1: 0.9962
Epoch 29/300
 - 2s - loss: 0.0052 - val_loss: 0.0074
 - val_f1: 0.9959
Epoch 30/300
 - 2s - loss: 0.0051 - val_loss: 0.0071
 - val_f1: 0.9959
Epoch 31/300
 - 2s - loss: 0.0048 - val_loss: 0.0065
2019-12-20 17:49:09,694 [INFO] epoch = 30. Intermediate model saved to results_selected_models/selected_nsl_ann_shallow_rep5/ann_model_epoch_30.pickle
 - val_f1: 0.9960
Epoch 32/300
 - 2s - loss: 0.0050 - val_loss: 0.0077
 - val_f1: 0.9956
Epoch 33/300
 - 2s - loss: 0.0050 - val_loss: 0.0068
 - val_f1: 0.9963
Epoch 34/300
 - 2s - loss: 0.0048 - val_loss: 0.0069
 - val_f1: 0.9964
Epoch 35/300
 - 2s - loss: 0.0046 - val_loss: 0.0069
 - val_f1: 0.9966
Epoch 36/300
 - 2s - loss: 0.0047 - val_loss: 0.0068
 - val_f1: 0.9968
Epoch 37/300
 - 2s - loss: 0.0047 - val_loss: 0.0067
 - val_f1: 0.9967
Epoch 38/300
 - 2s - loss: 0.0046 - val_loss: 0.0071
 - val_f1: 0.9958
Epoch 39/300
 - 2s - loss: 0.0046 - val_loss: 0.0074
 - val_f1: 0.9958
Epoch 40/300
 - 2s - loss: 0.0047 - val_loss: 0.0078
 - val_f1: 0.9960
Epoch 41/300
 - 2s - loss: 0.0047 - val_loss: 0.0076
 - val_f1: 0.9959
Epoch 42/300
 - 2s - loss: 0.0049 - val_loss: 0.0074
 - val_f1: 0.9963
Epoch 43/300
 - 2s - loss: 0.0045 - val_loss: 0.0072
 - val_f1: 0.9965
Epoch 44/300
 - 2s - loss: 0.0045 - val_loss: 0.0073
 - val_f1: 0.9967
Epoch 45/300
 - 2s - loss: 0.0045 - val_loss: 0.0070
 - val_f1: 0.9963
Epoch 46/300
 - 2s - loss: 0.0043 - val_loss: 0.0061
 - val_f1: 0.9966
Epoch 47/300
 - 2s - loss: 0.0048 - val_loss: 0.0059
 - val_f1: 0.9968
Epoch 48/300
 - 2s - loss: 0.0046 - val_loss: 0.0070
 - val_f1: 0.9964
Epoch 49/300
 - 2s - loss: 0.0048 - val_loss: 0.0070
 - val_f1: 0.9960
Epoch 50/300
 - 2s - loss: 0.0045 - val_loss: 0.0065
 - val_f1: 0.9967
Epoch 51/300
 - 2s - loss: 0.0042 - val_loss: 0.0070
 - val_f1: 0.9962
Epoch 52/300
 - 2s - loss: 0.0044 - val_loss: 0.0064
 - val_f1: 0.9969
Epoch 53/300
 - 2s - loss: 0.0044 - val_loss: 0.0066
 - val_f1: 0.9965
Epoch 54/300
 - 2s - loss: 0.0043 - val_loss: 0.0063
 - val_f1: 0.9963
Epoch 55/300
 - 2s - loss: 0.0045 - val_loss: 0.0074
 - val_f1: 0.9964
Epoch 56/300
 - 2s - loss: 0.0045 - val_loss: 0.0065
 - val_f1: 0.9967
Epoch 57/300
 - 2s - loss: 0.0042 - val_loss: 0.0063
 - val_f1: 0.9966
Epoch 58/300
 - 2s - loss: 0.0044 - val_loss: 0.0064
 - val_f1: 0.9968
Epoch 59/300
 - 2s - loss: 0.0041 - val_loss: 0.0062
 - val_f1: 0.9967
Epoch 60/300
 - 2s - loss: 0.0040 - val_loss: 0.0061
 - val_f1: 0.9967
Epoch 61/300
 - 2s - loss: 0.0041 - val_loss: 0.0063
2019-12-20 17:50:27,455 [INFO] epoch = 60. Intermediate model saved to results_selected_models/selected_nsl_ann_shallow_rep5/ann_model_epoch_60.pickle
 - val_f1: 0.9965
Epoch 62/300
 - 2s - loss: 0.0039 - val_loss: 0.0066
 - val_f1: 0.9967
Epoch 63/300
 - 2s - loss: 0.0042 - val_loss: 0.0059
 - val_f1: 0.9970
Epoch 64/300
 - 2s - loss: 0.0039 - val_loss: 0.0062
 - val_f1: 0.9964
Epoch 65/300
 - 2s - loss: 0.0037 - val_loss: 0.0062
 - val_f1: 0.9966
Epoch 66/300
 - 2s - loss: 0.0038 - val_loss: 0.0064
 - val_f1: 0.9967
Epoch 67/300
 - 2s - loss: 0.0039 - val_loss: 0.0057
 - val_f1: 0.9969
Epoch 68/300
 - 2s - loss: 0.0040 - val_loss: 0.0064
 - val_f1: 0.9969
Epoch 69/300
 - 2s - loss: 0.0038 - val_loss: 0.0066
 - val_f1: 0.9966
Epoch 70/300
 - 2s - loss: 0.0040 - val_loss: 0.0062
 - val_f1: 0.9966
Epoch 71/300
 - 2s - loss: 0.0039 - val_loss: 0.0063
 - val_f1: 0.9967
Epoch 72/300
 - 2s - loss: 0.0039 - val_loss: 0.0062
 - val_f1: 0.9967
Epoch 73/300
 - 2s - loss: 0.0041 - val_loss: 0.0061
 - val_f1: 0.9968
Epoch 74/300
 - 2s - loss: 0.0038 - val_loss: 0.0061
 - val_f1: 0.9971
Epoch 75/300
 - 2s - loss: 0.0038 - val_loss: 0.0066
 - val_f1: 0.9966
Epoch 76/300
 - 2s - loss: 0.0038 - val_loss: 0.0059
 - val_f1: 0.9970
Epoch 77/300
 - 2s - loss: 0.0037 - val_loss: 0.0067
 - val_f1: 0.9968
Epoch 78/300
 - 2s - loss: 0.0038 - val_loss: 0.0056
 - val_f1: 0.9969
Epoch 79/300
 - 2s - loss: 0.0037 - val_loss: 0.0059
 - val_f1: 0.9972
Epoch 80/300
 - 2s - loss: 0.0038 - val_loss: 0.0058
 - val_f1: 0.9972
Epoch 81/300
 - 2s - loss: 0.0040 - val_loss: 0.0059
 - val_f1: 0.9970
Epoch 82/300
 - 2s - loss: 0.0034 - val_loss: 0.0053
 - val_f1: 0.9971
Epoch 83/300
 - 2s - loss: 0.0036 - val_loss: 0.0062
 - val_f1: 0.9970
Epoch 84/300
 - 2s - loss: 0.0036 - val_loss: 0.0059
 - val_f1: 0.9971
Epoch 85/300
 - 2s - loss: 0.0038 - val_loss: 0.0065
 - val_f1: 0.9962
Epoch 86/300
 - 2s - loss: 0.0039 - val_loss: 0.0056
 - val_f1: 0.9972
Epoch 87/300
 - 2s - loss: 0.0035 - val_loss: 0.0059
 - val_f1: 0.9973
Epoch 88/300
 - 2s - loss: 0.0035 - val_loss: 0.0056
 - val_f1: 0.9971
Epoch 89/300
 - 2s - loss: 0.0035 - val_loss: 0.0057
 - val_f1: 0.9971
Epoch 90/300
 - 2s - loss: 0.0038 - val_loss: 0.0059
 - val_f1: 0.9966
Epoch 91/300
 - 2s - loss: 0.0035 - val_loss: 0.0060
2019-12-20 17:51:45,125 [INFO] epoch = 90. Intermediate model saved to results_selected_models/selected_nsl_ann_shallow_rep5/ann_model_epoch_90.pickle
 - val_f1: 0.9970
Epoch 92/300
 - 2s - loss: 0.0036 - val_loss: 0.0062
 - val_f1: 0.9969
Epoch 93/300
 - 2s - loss: 0.0034 - val_loss: 0.0057
 - val_f1: 0.9973
Epoch 94/300
 - 2s - loss: 0.0035 - val_loss: 0.0055
 - val_f1: 0.9971
Epoch 95/300
 - 2s - loss: 0.0039 - val_loss: 0.0058
 - val_f1: 0.9969
Epoch 96/300
 - 2s - loss: 0.0041 - val_loss: 0.0060
 - val_f1: 0.9968
Epoch 97/300
 - 2s - loss: 0.0038 - val_loss: 0.0070
 - val_f1: 0.9968
Epoch 98/300
 - 2s - loss: 0.0038 - val_loss: 0.0058
 - val_f1: 0.9969
Epoch 99/300
 - 2s - loss: 0.0035 - val_loss: 0.0061
 - val_f1: 0.9971
Epoch 100/300
 - 2s - loss: 0.0034 - val_loss: 0.0062
 - val_f1: 0.9971
Epoch 101/300
 - 2s - loss: 0.0037 - val_loss: 0.0060
 - val_f1: 0.9971
Epoch 102/300
 - 2s - loss: 0.0035 - val_loss: 0.0064
 - val_f1: 0.9969
Epoch 103/300
 - 2s - loss: 0.0033 - val_loss: 0.0062
 - val_f1: 0.9969
Epoch 104/300
 - 2s - loss: 0.0033 - val_loss: 0.0062
 - val_f1: 0.9971
Epoch 105/300
 - 2s - loss: 0.0032 - val_loss: 0.0065
 - val_f1: 0.9966
Epoch 106/300
 - 2s - loss: 0.0036 - val_loss: 0.0064
 - val_f1: 0.9972
Epoch 107/300
 - 2s - loss: 0.0034 - val_loss: 0.0068
 - val_f1: 0.9960
Epoch 108/300
 - 2s - loss: 0.0034 - val_loss: 0.0057
 - val_f1: 0.9974
Epoch 109/300
 - 2s - loss: 0.0034 - val_loss: 0.0058
 - val_f1: 0.9970
Epoch 110/300
 - 2s - loss: 0.0035 - val_loss: 0.0065
 - val_f1: 0.9967
Epoch 111/300
 - 2s - loss: 0.0035 - val_loss: 0.0059
 - val_f1: 0.9969
Epoch 112/300
 - 2s - loss: 0.0035 - val_loss: 0.0058
 - val_f1: 0.9971
Epoch 113/300
 - 2s - loss: 0.0032 - val_loss: 0.0062
 - val_f1: 0.9971
Epoch 114/300
 - 2s - loss: 0.0036 - val_loss: 0.0063
 - val_f1: 0.9970
Epoch 115/300
 - 2s - loss: 0.0033 - val_loss: 0.0060
 - val_f1: 0.9973
Epoch 116/300
 - 2s - loss: 0.0033 - val_loss: 0.0057
 - val_f1: 0.9975
Epoch 117/300
 - 2s - loss: 0.0033 - val_loss: 0.0059
 - val_f1: 0.9969
Epoch 118/300
 - 2s - loss: 0.0032 - val_loss: 0.0058
 - val_f1: 0.9964
Epoch 119/300
 - 2s - loss: 0.0034 - val_loss: 0.0065
 - val_f1: 0.9968
Epoch 120/300
 - 2s - loss: 0.0033 - val_loss: 0.0064
 - val_f1: 0.9971
Epoch 121/300
 - 2s - loss: 0.0036 - val_loss: 0.0062
2019-12-20 17:53:02,832 [INFO] epoch = 120. Intermediate model saved to results_selected_models/selected_nsl_ann_shallow_rep5/ann_model_epoch_120.pickle
 - val_f1: 0.9971
Epoch 122/300
 - 2s - loss: 0.0036 - val_loss: 0.0059
 - val_f1: 0.9971
Epoch 123/300
 - 2s - loss: 0.0036 - val_loss: 0.0065
 - val_f1: 0.9973
Epoch 124/300
 - 2s - loss: 0.0036 - val_loss: 0.0067
 - val_f1: 0.9972
Epoch 125/300
 - 2s - loss: 0.0036 - val_loss: 0.0069
 - val_f1: 0.9969
Epoch 126/300
 - 2s - loss: 0.0034 - val_loss: 0.0062
 - val_f1: 0.9971
Epoch 127/300
 - 2s - loss: 0.0035 - val_loss: 0.0066
 - val_f1: 0.9971
Epoch 128/300
 - 2s - loss: 0.0035 - val_loss: 0.0067
 - val_f1: 0.9972
Epoch 129/300
 - 2s - loss: 0.0036 - val_loss: 0.0063
 - val_f1: 0.9972
Epoch 130/300
 - 2s - loss: 0.0035 - val_loss: 0.0067
 - val_f1: 0.9972
Epoch 131/300
 - 2s - loss: 0.0034 - val_loss: 0.0066
 - val_f1: 0.9972
Epoch 132/300
 - 2s - loss: 0.0035 - val_loss: 0.0066
2019-12-20 17:53:31,850 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-20 17:53:34,796 [INFO] Last epoch loss evaluation: train_loss = 0.002792, val_loss = 0.005265
2019-12-20 17:53:34,796 [INFO] Training complete. time_to_train = 347.08 sec, 5.78 min
2019-12-20 17:53:34,800 [INFO] Model saved to results_selected_models/selected_nsl_ann_shallow_rep5/best_model.pickle
2019-12-20 17:53:34,981 [INFO] Plot saved to: results_selected_models/selected_nsl_ann_shallow_rep5/training_error_history.png
2019-12-20 17:53:35,143 [INFO] Plot saved to: results_selected_models/selected_nsl_ann_shallow_rep5/training_f1_history.png
2019-12-20 17:53:35,143 [INFO] Making predictions on training, validation, testing data
2019-12-20 17:53:38,169 [INFO] Evaluating predictions (results)
2019-12-20 17:53:38,731 [INFO] Dataset: Testing. Classification report below
2019-12-20 17:53:38,731 [INFO] 
              precision    recall  f1-score   support

         dos       0.97      0.84      0.90      7458
      normal       0.68      0.97      0.80      9711
       probe       0.83      0.66      0.73      2421
         r2l       0.73      0.09      0.16      2421
         u2r       0.86      0.04      0.07       533

    accuracy                           0.78     22544
   macro avg       0.81      0.52      0.53     22544
weighted avg       0.80      0.78      0.74     22544

2019-12-20 17:53:38,731 [INFO] Overall accuracy (micro avg): 0.7750621007806955
2019-12-20 17:53:39,336 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.7751         0.7751                       0.7751                0.0562                   0.2249  0.7751
1     Macro avg        0.9100         0.8125                       0.5178                0.0762                   0.4822  0.5316
2  Weighted avg        0.8713         0.7998                       0.7751                0.1559                   0.2249  0.7384
2019-12-20 17:53:40,018 [INFO] Dataset: Validation. Classification report below
2019-12-20 17:53:40,019 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00      9186
      normal       1.00      1.00      1.00     13469
       probe       0.99      0.99      0.99      2331
         r2l       0.97      0.91      0.94       199
         u2r       0.83      0.50      0.62        10

    accuracy                           1.00     25195
   macro avg       0.96      0.88      0.91     25195
weighted avg       1.00      1.00      1.00     25195

2019-12-20 17:53:40,019 [INFO] Overall accuracy (micro avg): 0.9970629093074023
2019-12-20 17:53:40,699 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9971         0.9971                       0.9971                0.0007                   0.0029  0.9971
1     Macro avg        0.9988         0.9587                       0.8803                0.0010                   0.1197  0.9110
2  Weighted avg        0.9981         0.9970                       0.9971                0.0020                   0.0029  0.9970
2019-12-20 17:53:43,563 [INFO] Dataset: Training. Classification report below
2019-12-20 17:53:43,565 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00     36741
      normal       1.00      1.00      1.00     53874
       probe       1.00      1.00      1.00      9325
         r2l       0.98      0.91      0.95       796
         u2r       0.94      0.71      0.81        42

    accuracy                           1.00    100778
   macro avg       0.98      0.92      0.95    100778
weighted avg       1.00      1.00      1.00    100778

2019-12-20 17:53:43,565 [INFO] Overall accuracy (micro avg): 0.9980253626783624
2019-12-20 17:53:46,635 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9980         0.9980                       0.9980                0.0005                   0.0020  0.9980
1     Macro avg        0.9992         0.9820                       0.9245                0.0007                   0.0755  0.9500
2  Weighted avg        0.9988         0.9980                       0.9980                0.0015                   0.0020  0.9980
2019-12-20 17:53:46,682 [INFO] Results saved to: results_selected_models/selected_nsl_ann_shallow_rep5/selected_nsl_ann_shallow_rep5_results.xlsx
2019-12-20 17:53:46,682 [INFO] ================= Finished running experiment no. 5 ================= 

2019-12-20 17:53:46,683 [INFO] Created directory: results_selected_models/selected_ids2017_ann_shallow_rep1
2019-12-20 17:53:46,683 [INFO] Initialized logging. log_filename = results_selected_models/selected_ids2017_ann_shallow_rep1/run_log.log
2019-12-20 17:53:46,683 [INFO] ================= Running experiment no. 1  ================= 

2019-12-20 17:53:46,683 [INFO] Experiment parameters given below
2019-12-20 17:53:46,684 [INFO] 
{'experiment_num': 1, 'results_dir': 'results_selected_models/selected_ids2017_ann_shallow_rep1', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 300, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/full_datasets/ids2017', 'description': 'selected_ids2017_ann_shallow_rep1'}
2019-12-20 17:53:46,684 [INFO] Created tensorboard log directory: results_selected_models/selected_ids2017_ann_shallow_rep1/tf_logs_run_2019_12_20-17_53_46
2019-12-20 17:53:46,684 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2017
2019-12-20 17:53:46,684 [INFO] Reading X, y files
2019-12-20 17:53:46,684 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_train.h5
2019-12-20 17:53:51,449 [INFO] Reading complete. time_to_read=4.76 seconds
2019-12-20 17:53:51,449 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_val.h5
2019-12-20 17:53:52,794 [INFO] Reading complete. time_to_read=1.34 seconds
2019-12-20 17:53:52,794 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_test.h5
2019-12-20 17:53:54,144 [INFO] Reading complete. time_to_read=1.35 seconds
2019-12-20 17:53:54,144 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_train.h5
2019-12-20 17:53:54,475 [INFO] Reading complete. time_to_read=0.33 seconds
2019-12-20 17:53:54,475 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_val.h5
2019-12-20 17:53:54,592 [INFO] Reading complete. time_to_read=0.12 seconds
2019-12-20 17:53:54,592 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_test.h5
2019-12-20 17:53:54,711 [INFO] Reading complete. time_to_read=0.12 seconds
OMP: Info #250: KMP_AFFINITY: pid 5091 tid 5471 thread 17 bound to OS proc set 1
OMP: Info #250: KMP_AFFINITY: pid 5091 tid 5472 thread 18 bound to OS proc set 2
OMP: Info #250: KMP_AFFINITY: pid 5091 tid 5473 thread 19 bound to OS proc set 3
2019-12-20 17:53:57,890 [INFO] Initializing model
2019-12-20 17:53:58,013 [INFO] _________________________________________________________________
2019-12-20 17:53:58,013 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-20 17:53:58,013 [INFO] =================================================================
2019-12-20 17:53:58,013 [INFO] dense_11 (Dense)             (None, 64)                5056      
2019-12-20 17:53:58,014 [INFO] _________________________________________________________________
2019-12-20 17:53:58,014 [INFO] batch_normalization_6 (Batch (None, 64)                256       
2019-12-20 17:53:58,014 [INFO] _________________________________________________________________
2019-12-20 17:53:58,014 [INFO] dropout_6 (Dropout)          (None, 64)                0         
2019-12-20 17:53:58,014 [INFO] _________________________________________________________________
2019-12-20 17:53:58,014 [INFO] dense_12 (Dense)             (None, 12)                780       
2019-12-20 17:53:58,014 [INFO] =================================================================
2019-12-20 17:53:58,014 [INFO] Total params: 6,092
2019-12-20 17:53:58,014 [INFO] Trainable params: 5,964
2019-12-20 17:53:58,015 [INFO] Non-trainable params: 128
2019-12-20 17:53:58,015 [INFO] _________________________________________________________________
2019-12-20 17:53:58,015 [INFO] Training model
 - val_f1: 0.9969
Epoch 00132: early stopping
Train on 1696684 samples, validate on 565562 samples
Epoch 1/300
 - 27s - loss: 0.0190 - val_loss: 0.0110
 - val_f1: 0.9713
Epoch 2/300
 - 26s - loss: 0.0091 - val_loss: 0.0091
 - val_f1: 0.9790
Epoch 3/300
 - 26s - loss: 0.0065 - val_loss: 0.0064
 - val_f1: 0.9866
Epoch 4/300
 - 26s - loss: 0.0058 - val_loss: 0.0048
 - val_f1: 0.9911
Epoch 5/300
 - 26s - loss: 0.0054 - val_loss: 0.0046
 - val_f1: 0.9894
Epoch 6/300
 - 26s - loss: 0.0053 - val_loss: 0.0046
 - val_f1: 0.9919
Epoch 7/300
 - 26s - loss: 0.0053 - val_loss: 0.0066
 - val_f1: 0.9847
Epoch 8/300
 - 26s - loss: 0.0049 - val_loss: 0.0068
 - val_f1: 0.9860
Epoch 9/300
 - 26s - loss: 0.0047 - val_loss: 0.0037
 - val_f1: 0.9933
Epoch 10/300
 - 26s - loss: 0.0050 - val_loss: 0.0038
 - val_f1: 0.9939
Epoch 11/300
 - 26s - loss: 0.0049 - val_loss: 0.0046
 - val_f1: 0.9896
Epoch 12/300
 - 26s - loss: 0.0047 - val_loss: 0.0038
 - val_f1: 0.9926
Epoch 13/300
 - 26s - loss: 0.0045 - val_loss: 0.0037
 - val_f1: 0.9929
Epoch 14/300
 - 26s - loss: 0.0044 - val_loss: 0.0072
 - val_f1: 0.9862
Epoch 15/300
 - 26s - loss: 0.0043 - val_loss: 0.0037
 - val_f1: 0.9940
Epoch 16/300
 - 26s - loss: 0.0045 - val_loss: 0.0038
 - val_f1: 0.9926
Epoch 17/300
 - 26s - loss: 0.0043 - val_loss: 0.0038
 - val_f1: 0.9923
Epoch 18/300
 - 26s - loss: 0.0043 - val_loss: 0.0057
 - val_f1: 0.9884
Epoch 19/300
 - 26s - loss: 0.0044 - val_loss: 0.0045
 - val_f1: 0.9902
Epoch 20/300
 - 26s - loss: 0.0047 - val_loss: 0.0049
 - val_f1: 0.9904
Epoch 21/300
 - 26s - loss: 0.0045 - val_loss: 0.0051
 - val_f1: 0.9900
Epoch 22/300
 - 26s - loss: 0.0045 - val_loss: 0.0036
 - val_f1: 0.9935
Epoch 23/300
 - 26s - loss: 0.0042 - val_loss: 0.0042
 - val_f1: 0.9907
Epoch 24/300
 - 26s - loss: 0.0041 - val_loss: 0.0033
 - val_f1: 0.9946
Epoch 25/300
 - 26s - loss: 0.0040 - val_loss: 0.0034
 - val_f1: 0.9944
Epoch 26/300
 - 26s - loss: 0.0040 - val_loss: 0.0037
 - val_f1: 0.9906
Epoch 27/300
 - 26s - loss: 0.0040 - val_loss: 0.0041
 - val_f1: 0.9920
Epoch 28/300
 - 26s - loss: 0.0039 - val_loss: 0.0052
 - val_f1: 0.9893
Epoch 29/300
 - 26s - loss: 0.0040 - val_loss: 0.0030
 - val_f1: 0.9926
Epoch 30/300
 - 26s - loss: 0.0039 - val_loss: 0.0038
 - val_f1: 0.9917
Epoch 31/300
 - 26s - loss: 0.0038 - val_loss: 0.0035
2019-12-20 18:13:05,802 [INFO] epoch = 30. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep1/ann_model_epoch_30.pickle
 - val_f1: 0.9923
Epoch 32/300
 - 26s - loss: 0.0039 - val_loss: 0.0037
 - val_f1: 0.9927
Epoch 33/300
 - 26s - loss: 0.0039 - val_loss: 0.0035
 - val_f1: 0.9938
Epoch 34/300
 - 26s - loss: 0.0038 - val_loss: 0.0038
 - val_f1: 0.9928
Epoch 35/300
 - 26s - loss: 0.0038 - val_loss: 0.0031
 - val_f1: 0.9945
Epoch 36/300
 - 26s - loss: 0.0037 - val_loss: 0.0033
 - val_f1: 0.9924
Epoch 37/300
 - 26s - loss: 0.0037 - val_loss: 0.0033
 - val_f1: 0.9924
Epoch 38/300
 - 26s - loss: 0.0039 - val_loss: 0.0029
 - val_f1: 0.9946
Epoch 39/300
 - 26s - loss: 0.0041 - val_loss: 0.0030
 - val_f1: 0.9947
Epoch 40/300
 - 26s - loss: 0.0038 - val_loss: 0.0067
 - val_f1: 0.9905
Epoch 41/300
 - 26s - loss: 0.0037 - val_loss: 0.0042
 - val_f1: 0.9911
Epoch 42/300
 - 26s - loss: 0.0037 - val_loss: 0.0031
 - val_f1: 0.9951
Epoch 43/300
 - 26s - loss: 0.0036 - val_loss: 0.0033
 - val_f1: 0.9925
Epoch 44/300
 - 26s - loss: 0.0035 - val_loss: 0.0038
 - val_f1: 0.9947
Epoch 45/300
 - 25s - loss: 0.0036 - val_loss: 0.0032
 - val_f1: 0.9936
Epoch 46/300
 - 26s - loss: 0.0036 - val_loss: 0.0033
 - val_f1: 0.9925
Epoch 47/300
 - 26s - loss: 0.0036 - val_loss: 0.0032
 - val_f1: 0.9920
Epoch 48/300
 - 26s - loss: 0.0035 - val_loss: 0.0032
 - val_f1: 0.9934
Epoch 49/300
 - 25s - loss: 0.0035 - val_loss: 0.0028
 - val_f1: 0.9948
Epoch 50/300
 - 26s - loss: 0.0035 - val_loss: 0.0031
 - val_f1: 0.9940
Epoch 51/300
 - 26s - loss: 0.0035 - val_loss: 0.0032
 - val_f1: 0.9926
Epoch 52/300
 - 26s - loss: 0.0035 - val_loss: 0.0031
 - val_f1: 0.9936
Epoch 53/300
 - 26s - loss: 0.0035 - val_loss: 0.0031
 - val_f1: 0.9926
Epoch 54/300
 - 26s - loss: 0.0034 - val_loss: 0.0043
 - val_f1: 0.9922
Epoch 55/300
 - 26s - loss: 0.0034 - val_loss: 0.0033
 - val_f1: 0.9924
Epoch 56/300
 - 26s - loss: 0.0034 - val_loss: 0.0031
 - val_f1: 0.9936
Epoch 57/300
 - 26s - loss: 0.0034 - val_loss: 0.0027
 - val_f1: 0.9953
Epoch 58/300
 - 26s - loss: 0.0034 - val_loss: 0.0041
 - val_f1: 0.9918
Epoch 59/300
 - 26s - loss: 0.0034 - val_loss: 0.0027
 - val_f1: 0.9948
Epoch 60/300
 - 26s - loss: 0.0033 - val_loss: 0.0045
 - val_f1: 0.9918
Epoch 61/300
 - 26s - loss: 0.0035 - val_loss: 0.0028
2019-12-20 18:31:44,585 [INFO] epoch = 60. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep1/ann_model_epoch_60.pickle
 - val_f1: 0.9955
Epoch 62/300
 - 26s - loss: 0.0034 - val_loss: 0.0031
 - val_f1: 0.9941
Epoch 63/300
 - 26s - loss: 0.0034 - val_loss: 0.0045
 - val_f1: 0.9890
Epoch 64/300
 - 26s - loss: 0.0034 - val_loss: 0.0027
 - val_f1: 0.9950
Epoch 65/300
 - 26s - loss: 0.0033 - val_loss: 0.0027
 - val_f1: 0.9953
Epoch 66/300
 - 26s - loss: 0.0033 - val_loss: 0.0032
 - val_f1: 0.9952
Epoch 67/300
 - 26s - loss: 0.0033 - val_loss: 0.0029
 - val_f1: 0.9929
Epoch 68/300
 - 26s - loss: 0.0033 - val_loss: 0.0027
 - val_f1: 0.9947
Epoch 69/300
 - 26s - loss: 0.0033 - val_loss: 0.0029
 - val_f1: 0.9953
Epoch 70/300
 - 26s - loss: 0.0033 - val_loss: 0.0029
 - val_f1: 0.9937
Epoch 71/300
 - 25s - loss: 0.0033 - val_loss: 0.0047
 - val_f1: 0.9914
Epoch 72/300
 - 25s - loss: 0.0032 - val_loss: 0.0036
 - val_f1: 0.9924
Epoch 73/300
 - 26s - loss: 0.0032 - val_loss: 0.0028
 - val_f1: 0.9954
Epoch 74/300
 - 26s - loss: 0.0033 - val_loss: 0.0029
 - val_f1: 0.9946
Epoch 75/300
 - 25s - loss: 0.0032 - val_loss: 0.0033
 - val_f1: 0.9918
Epoch 76/300
 - 25s - loss: 0.0033 - val_loss: 0.0035
 - val_f1: 0.9938
Epoch 77/300
 - 26s - loss: 0.0033 - val_loss: 0.0027
 - val_f1: 0.9953
Epoch 78/300
 - 26s - loss: 0.0032 - val_loss: 0.0026
 - val_f1: 0.9943
Epoch 79/300
 - 26s - loss: 0.0032 - val_loss: 0.0051
 - val_f1: 0.9913
Epoch 80/300
 - 26s - loss: 0.0032 - val_loss: 0.0029
 - val_f1: 0.9926
Epoch 81/300
 - 26s - loss: 0.0032 - val_loss: 0.0031
 - val_f1: 0.9937
Epoch 82/300
 - 25s - loss: 0.0032 - val_loss: 0.0028
 - val_f1: 0.9953
Epoch 83/300
 - 25s - loss: 0.0032 - val_loss: 0.0034
 - val_f1: 0.9921
Epoch 84/300
 - 25s - loss: 0.0033 - val_loss: 0.0027
 - val_f1: 0.9947
Epoch 85/300
 - 26s - loss: 0.0032 - val_loss: 0.0031
 - val_f1: 0.9938
Epoch 86/300
 - 25s - loss: 0.0033 - val_loss: 0.0027
 - val_f1: 0.9946
Epoch 87/300
 - 25s - loss: 0.0033 - val_loss: 0.0036
 - val_f1: 0.9920
Epoch 88/300
 - 26s - loss: 0.0032 - val_loss: 0.0029
 - val_f1: 0.9936
Epoch 89/300
 - 26s - loss: 0.0033 - val_loss: 0.0034
 - val_f1: 0.9927
Epoch 90/300
 - 25s - loss: 0.0033 - val_loss: 0.0037
 - val_f1: 0.9913
Epoch 91/300
 - 26s - loss: 0.0033 - val_loss: 0.0026
2019-12-20 18:50:18,048 [INFO] epoch = 90. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep1/ann_model_epoch_90.pickle
 - val_f1: 0.9948
Epoch 92/300
 - 26s - loss: 0.0033 - val_loss: 0.0030
 - val_f1: 0.9946
Epoch 93/300
 - 26s - loss: 0.0032 - val_loss: 0.0027
 - val_f1: 0.9944
Epoch 94/300
 - 25s - loss: 0.0032 - val_loss: 0.0035
 - val_f1: 0.9936
Epoch 95/300
 - 25s - loss: 0.0032 - val_loss: 0.0027
 - val_f1: 0.9951
Epoch 96/300
 - 25s - loss: 0.0032 - val_loss: 0.0032
 - val_f1: 0.9945
Epoch 97/300
 - 25s - loss: 0.0032 - val_loss: 0.0027
 - val_f1: 0.9949
Epoch 98/300
 - 26s - loss: 0.0032 - val_loss: 0.0055
 - val_f1: 0.9920
Epoch 99/300
 - 25s - loss: 0.0031 - val_loss: 0.0031
 - val_f1: 0.9920
Epoch 100/300
 - 26s - loss: 0.0032 - val_loss: 0.0032
 - val_f1: 0.9938
Epoch 101/300
 - 25s - loss: 0.0031 - val_loss: 0.0040
 - val_f1: 0.9913
Epoch 102/300
 - 25s - loss: 0.0031 - val_loss: 0.0030
 - val_f1: 0.9940
Epoch 103/300
 - 26s - loss: 0.0031 - val_loss: 0.0031
 - val_f1: 0.9925
Epoch 104/300
 - 26s - loss: 0.0031 - val_loss: 0.0028
 - val_f1: 0.9931
Epoch 105/300
 - 25s - loss: 0.0032 - val_loss: 0.0029
 - val_f1: 0.9938
Epoch 106/300
 - 25s - loss: 0.0032 - val_loss: 0.0035
 - val_f1: 0.9907
Epoch 107/300
 - 25s - loss: 0.0032 - val_loss: 0.0036
 - val_f1: 0.9939
Epoch 108/300
 - 26s - loss: 0.0032 - val_loss: 0.0029
 - val_f1: 0.9928
Epoch 109/300
 - 25s - loss: 0.0031 - val_loss: 0.0027
 - val_f1: 0.9951
Epoch 110/300
 - 25s - loss: 0.0032 - val_loss: 0.0034
 - val_f1: 0.9938
Epoch 111/300
 - 26s - loss: 0.0031 - val_loss: 0.0028
 - val_f1: 0.9944
Epoch 112/300
 - 26s - loss: 0.0031 - val_loss: 0.0035
 - val_f1: 0.9926
Epoch 113/300
 - 25s - loss: 0.0032 - val_loss: 0.0035
 - val_f1: 0.9937
Epoch 114/300
 - 25s - loss: 0.0031 - val_loss: 0.0028
 - val_f1: 0.9941
Epoch 115/300
 - 26s - loss: 0.0031 - val_loss: 0.0027
 - val_f1: 0.9933
Epoch 116/300
 - 25s - loss: 0.0031 - val_loss: 0.0026
 - val_f1: 0.9950
Epoch 117/300
 - 25s - loss: 0.0031 - val_loss: 0.0034
 - val_f1: 0.9923
Epoch 118/300
 - 26s - loss: 0.0032 - val_loss: 0.0032
 - val_f1: 0.9938
Epoch 119/300
 - 26s - loss: 0.0031 - val_loss: 0.0029
 - val_f1: 0.9939
Epoch 120/300
 - 25s - loss: 0.0031 - val_loss: 0.0029
 - val_f1: 0.9939
Epoch 121/300
 - 25s - loss: 0.0031 - val_loss: 0.0026
2019-12-20 19:08:48,080 [INFO] epoch = 120. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep1/ann_model_epoch_120.pickle
 - val_f1: 0.9945
Epoch 122/300
 - 26s - loss: 0.0031 - val_loss: 0.0027
 - val_f1: 0.9943
Epoch 123/300
 - 26s - loss: 0.0031 - val_loss: 0.0026
 - val_f1: 0.9950
Epoch 124/300
 - 26s - loss: 0.0031 - val_loss: 0.0027
 - val_f1: 0.9954
Epoch 125/300
 - 25s - loss: 0.0031 - val_loss: 0.0029
 - val_f1: 0.9930
Epoch 126/300
 - 25s - loss: 0.0031 - val_loss: 0.0027
 - val_f1: 0.9954
Epoch 127/300
 - 25s - loss: 0.0032 - val_loss: 0.0031
 - val_f1: 0.9928
Epoch 128/300
 - 26s - loss: 0.0031 - val_loss: 0.0029
 - val_f1: 0.9930
Epoch 129/300
 - 25s - loss: 0.0031 - val_loss: 0.0026
 - val_f1: 0.9951
Epoch 130/300
 - 25s - loss: 0.0031 - val_loss: 0.0027
 - val_f1: 0.9953
Epoch 131/300
 - 25s - loss: 0.0031 - val_loss: 0.0028
 - val_f1: 0.9951
Epoch 132/300
 - 25s - loss: 0.0031 - val_loss: 0.0027
 - val_f1: 0.9946
Epoch 133/300
 - 25s - loss: 0.0031 - val_loss: 0.0027
 - val_f1: 0.9946
Epoch 134/300
 - 25s - loss: 0.0031 - val_loss: 0.0029
 - val_f1: 0.9929
Epoch 135/300
 - 26s - loss: 0.0031 - val_loss: 0.0025
 - val_f1: 0.9955
Epoch 136/300
 - 25s - loss: 0.0031 - val_loss: 0.0033
 - val_f1: 0.9924
Epoch 137/300
 - 26s - loss: 0.0031 - val_loss: 0.0027
 - val_f1: 0.9952
Epoch 138/300
 - 25s - loss: 0.0030 - val_loss: 0.0031
 - val_f1: 0.9948
Epoch 139/300
 - 25s - loss: 0.0030 - val_loss: 0.0027
 - val_f1: 0.9924
Epoch 140/300
 - 26s - loss: 0.0030 - val_loss: 0.0025
 - val_f1: 0.9957
Epoch 141/300
 - 25s - loss: 0.0031 - val_loss: 0.0042
 - val_f1: 0.9938
Epoch 142/300
 - 25s - loss: 0.0031 - val_loss: 0.0026
 - val_f1: 0.9949
Epoch 143/300
 - 25s - loss: 0.0030 - val_loss: 0.0031
 - val_f1: 0.9951
Epoch 144/300
 - 26s - loss: 0.0030 - val_loss: 0.0024
 - val_f1: 0.9958
Epoch 145/300
 - 25s - loss: 0.0030 - val_loss: 0.0030
 - val_f1: 0.9931
Epoch 146/300
 - 26s - loss: 0.0030 - val_loss: 0.0026
 - val_f1: 0.9953
Epoch 147/300
 - 25s - loss: 0.0030 - val_loss: 0.0029
 - val_f1: 0.9948
Epoch 148/300
 - 25s - loss: 0.0030 - val_loss: 0.0025
 - val_f1: 0.9953
Epoch 149/300
 - 26s - loss: 0.0030 - val_loss: 0.0025
 - val_f1: 0.9959
Epoch 150/300
 - 26s - loss: 0.0030 - val_loss: 0.0028
 - val_f1: 0.9959
Epoch 151/300
 - 26s - loss: 0.0030 - val_loss: 0.0027
2019-12-20 19:27:17,558 [INFO] epoch = 150. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep1/ann_model_epoch_150.pickle
 - val_f1: 0.9938
Epoch 152/300
 - 25s - loss: 0.0030 - val_loss: 0.0025
 - val_f1: 0.9952
Epoch 153/300
 - 26s - loss: 0.0030 - val_loss: 0.0034
 - val_f1: 0.9937
Epoch 154/300
 - 26s - loss: 0.0030 - val_loss: 0.0026
 - val_f1: 0.9955
Epoch 155/300
 - 25s - loss: 0.0030 - val_loss: 0.0025
 - val_f1: 0.9953
Epoch 156/300
 - 25s - loss: 0.0030 - val_loss: 0.0024
 - val_f1: 0.9957
Epoch 157/300
 - 25s - loss: 0.0030 - val_loss: 0.0027
 - val_f1: 0.9944
Epoch 158/300
 - 25s - loss: 0.0029 - val_loss: 0.0028
 - val_f1: 0.9948
Epoch 159/300
 - 26s - loss: 0.0030 - val_loss: 0.0027
 - val_f1: 0.9931
Epoch 160/300
 - 26s - loss: 0.0030 - val_loss: 0.0029
 - val_f1: 0.9931
Epoch 161/300
 - 25s - loss: 0.0030 - val_loss: 0.0024
 - val_f1: 0.9956
Epoch 162/300
 - 26s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9934
Epoch 163/300
 - 26s - loss: 0.0029 - val_loss: 0.0028
 - val_f1: 0.9930
Epoch 164/300
 - 25s - loss: 0.0031 - val_loss: 0.0046
 - val_f1: 0.9889
Epoch 165/300
 - 25s - loss: 0.0030 - val_loss: 0.0025
 - val_f1: 0.9958
Epoch 166/300
 - 26s - loss: 0.0030 - val_loss: 0.0024
 - val_f1: 0.9952
Epoch 167/300
 - 26s - loss: 0.0029 - val_loss: 0.0026
 - val_f1: 0.9955
Epoch 168/300
 - 25s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9952
Epoch 169/300
 - 26s - loss: 0.0029 - val_loss: 0.0038
 - val_f1: 0.9921
Epoch 170/300
 - 25s - loss: 0.0030 - val_loss: 0.0034
 - val_f1: 0.9938
Epoch 171/300
 - 25s - loss: 0.0029 - val_loss: 0.0029
 - val_f1: 0.9942
Epoch 172/300
 - 25s - loss: 0.0030 - val_loss: 0.0027
 - val_f1: 0.9933
Epoch 173/300
 - 26s - loss: 0.0030 - val_loss: 0.0029
 - val_f1: 0.9944
Epoch 174/300
 - 26s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9948
Epoch 175/300
 - 26s - loss: 0.0029 - val_loss: 0.0034
 - val_f1: 0.9938
Epoch 176/300
 - 26s - loss: 0.0029 - val_loss: 0.0027
 - val_f1: 0.9927
Epoch 177/300
 - 25s - loss: 0.0029 - val_loss: 0.0028
 - val_f1: 0.9953
Epoch 178/300
 - 26s - loss: 0.0029 - val_loss: 0.0028
 - val_f1: 0.9947
Epoch 179/300
 - 26s - loss: 0.0030 - val_loss: 0.0025
 - val_f1: 0.9951
Epoch 180/300
 - 25s - loss: 0.0030 - val_loss: 0.0029
 - val_f1: 0.9943
Epoch 181/300
 - 25s - loss: 0.0030 - val_loss: 0.0025
2019-12-20 19:45:48,203 [INFO] epoch = 180. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep1/ann_model_epoch_180.pickle
 - val_f1: 0.9952
Epoch 182/300
 - 25s - loss: 0.0030 - val_loss: 0.0034
 - val_f1: 0.9927
Epoch 183/300
 - 26s - loss: 0.0031 - val_loss: 0.0024
 - val_f1: 0.9959
Epoch 184/300
 - 25s - loss: 0.0030 - val_loss: 0.0025
 - val_f1: 0.9954
Epoch 185/300
 - 26s - loss: 0.0030 - val_loss: 0.0048
 - val_f1: 0.9894
Epoch 186/300
 - 25s - loss: 0.0030 - val_loss: 0.0033
 - val_f1: 0.9921
Epoch 187/300
 - 25s - loss: 0.0030 - val_loss: 0.0030
 - val_f1: 0.9953
Epoch 188/300
 - 25s - loss: 0.0030 - val_loss: 0.0035
 - val_f1: 0.9956
Epoch 189/300
 - 25s - loss: 0.0030 - val_loss: 0.0029
 - val_f1: 0.9932
Epoch 190/300
 - 25s - loss: 0.0029 - val_loss: 0.0027
 - val_f1: 0.9948
Epoch 191/300
 - 25s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9946
Epoch 192/300
 - 26s - loss: 0.0029 - val_loss: 0.0053
 - val_f1: 0.9900
Epoch 193/300
 - 26s - loss: 0.0029 - val_loss: 0.0032
 - val_f1: 0.9929
Epoch 194/300
 - 26s - loss: 0.0029 - val_loss: 0.0035
 - val_f1: 0.9925
Epoch 195/300
 - 25s - loss: 0.0030 - val_loss: 0.0025
 - val_f1: 0.9957
Epoch 196/300
 - 26s - loss: 0.0030 - val_loss: 0.0032
 - val_f1: 0.9924
Epoch 197/300
 - 25s - loss: 0.0029 - val_loss: 0.0023
 - val_f1: 0.9953
Epoch 198/300
 - 25s - loss: 0.0029 - val_loss: 0.0028
 - val_f1: 0.9921
Epoch 199/300
 - 25s - loss: 0.0029 - val_loss: 0.0032
 - val_f1: 0.9952
Epoch 200/300
 - 25s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9953
Epoch 201/300
 - 26s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9946
Epoch 202/300
 - 26s - loss: 0.0029 - val_loss: 0.0038
 - val_f1: 0.9921
Epoch 203/300
 - 25s - loss: 0.0029 - val_loss: 0.0026
 - val_f1: 0.9958
Epoch 204/300
 - 25s - loss: 0.0029 - val_loss: 0.0030
 - val_f1: 0.9947
Epoch 205/300
 - 25s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9956
Epoch 206/300
 - 25s - loss: 0.0029 - val_loss: 0.0048
 - val_f1: 0.9908
Epoch 207/300
 - 25s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9954
Epoch 208/300
 - 26s - loss: 0.0029 - val_loss: 0.0026
 - val_f1: 0.9954
Epoch 209/300
 - 25s - loss: 0.0029 - val_loss: 0.0028
 - val_f1: 0.9943
Epoch 210/300
 - 25s - loss: 0.0030 - val_loss: 0.0029
 - val_f1: 0.9931
Epoch 211/300
 - 25s - loss: 0.0029 - val_loss: 0.0025
2019-12-20 20:04:17,467 [INFO] epoch = 210. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep1/ann_model_epoch_210.pickle
 - val_f1: 0.9956
Epoch 212/300
 - 25s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9947
Epoch 213/300
 - 25s - loss: 0.0029 - val_loss: 0.0031
 - val_f1: 0.9929
Epoch 214/300
 - 26s - loss: 0.0029 - val_loss: 0.0030
 - val_f1: 0.9956
Epoch 215/300
 - 25s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9953
Epoch 216/300
 - 25s - loss: 0.0029 - val_loss: 0.0026
 - val_f1: 0.9952
Epoch 217/300
 - 25s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9937
Epoch 218/300
 - 25s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9952
Epoch 219/300
 - 25s - loss: 0.0029 - val_loss: 0.0033
 - val_f1: 0.9939
Epoch 220/300
 - 25s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9948
Epoch 221/300
 - 25s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9952
Epoch 222/300
 - 25s - loss: 0.0029 - val_loss: 0.0022
 - val_f1: 0.9957
Epoch 223/300
 - 25s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9956
Epoch 224/300
 - 25s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9943
Epoch 225/300
 - 25s - loss: 0.0029 - val_loss: 0.0030
 - val_f1: 0.9949
Epoch 226/300
 - 25s - loss: 0.0029 - val_loss: 0.0023
 - val_f1: 0.9955
Epoch 227/300
 - 25s - loss: 0.0030 - val_loss: 0.0023
 - val_f1: 0.9952
Epoch 228/300
 - 25s - loss: 0.0029 - val_loss: 0.0027
 - val_f1: 0.9931
Epoch 229/300
 - 25s - loss: 0.0029 - val_loss: 0.0023
 - val_f1: 0.9956
Epoch 230/300
 - 25s - loss: 0.0028 - val_loss: 0.0023
 - val_f1: 0.9960
Epoch 231/300
 - 25s - loss: 0.0029 - val_loss: 0.0028
 - val_f1: 0.9931
Epoch 232/300
 - 26s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9952
Epoch 233/300
 - 26s - loss: 0.0029 - val_loss: 0.0027
 - val_f1: 0.9942
Epoch 234/300
 - 25s - loss: 0.0029 - val_loss: 0.0026
 - val_f1: 0.9947
Epoch 235/300
 - 25s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9961
Epoch 236/300
 - 25s - loss: 0.0028 - val_loss: 0.0030
 - val_f1: 0.9932
Epoch 237/300
 - 26s - loss: 0.0028 - val_loss: 0.0023
 - val_f1: 0.9959
Epoch 238/300
 - 25s - loss: 0.0029 - val_loss: 0.0026
 - val_f1: 0.9945
Epoch 239/300
 - 26s - loss: 0.0029 - val_loss: 0.0023
 - val_f1: 0.9958
Epoch 240/300
 - 26s - loss: 0.0029 - val_loss: 0.0023
 - val_f1: 0.9958
Epoch 241/300
 - 25s - loss: 0.0029 - val_loss: 0.0024
2019-12-20 20:22:47,036 [INFO] epoch = 240. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep1/ann_model_epoch_240.pickle
 - val_f1: 0.9952
Epoch 242/300
 - 25s - loss: 0.0028 - val_loss: 0.0023
 - val_f1: 0.9952
Epoch 243/300
 - 26s - loss: 0.0028 - val_loss: 0.0023
 - val_f1: 0.9947
Epoch 244/300
 - 25s - loss: 0.0028 - val_loss: 0.0029
 - val_f1: 0.9943
Epoch 245/300
 - 25s - loss: 0.0028 - val_loss: 0.0029
 - val_f1: 0.9946
Epoch 246/300
 - 25s - loss: 0.0028 - val_loss: 0.0025
 - val_f1: 0.9946
Epoch 247/300
 - 26s - loss: 0.0028 - val_loss: 0.0025
 - val_f1: 0.9945
Epoch 248/300
 - 25s - loss: 0.0028 - val_loss: 0.0025
 - val_f1: 0.9944
Epoch 249/300
 - 25s - loss: 0.0028 - val_loss: 0.0024
 - val_f1: 0.9954
Epoch 250/300
 - 25s - loss: 0.0028 - val_loss: 0.0038
 - val_f1: 0.9907
Epoch 251/300
 - 26s - loss: 0.0028 - val_loss: 0.0024
 - val_f1: 0.9956
Epoch 252/300
 - 25s - loss: 0.0028 - val_loss: 0.0024
 - val_f1: 0.9956
Epoch 253/300
 - 26s - loss: 0.0028 - val_loss: 0.0023
 - val_f1: 0.9951
Epoch 254/300
 - 25s - loss: 0.0028 - val_loss: 0.0024
 - val_f1: 0.9960
Epoch 255/300
 - 25s - loss: 0.0028 - val_loss: 0.0028
 - val_f1: 0.9953
Epoch 256/300
 - 25s - loss: 0.0028 - val_loss: 0.0033
 - val_f1: 0.9926
Epoch 257/300
 - 26s - loss: 0.0028 - val_loss: 0.0025
 - val_f1: 0.9948
Epoch 258/300
 - 25s - loss: 0.0028 - val_loss: 0.0027
 - val_f1: 0.9950
Epoch 259/300
 - 25s - loss: 0.0028 - val_loss: 0.0026
 - val_f1: 0.9943
Epoch 260/300
 - 25s - loss: 0.0028 - val_loss: 0.0026
 - val_f1: 0.9954
Epoch 261/300
 - 25s - loss: 0.0028 - val_loss: 0.0026
 - val_f1: 0.9955
Epoch 262/300
 - 25s - loss: 0.0028 - val_loss: 0.0023
 - val_f1: 0.9954
Epoch 263/300
 - 25s - loss: 0.0028 - val_loss: 0.0027
 - val_f1: 0.9953
Epoch 264/300
 - 25s - loss: 0.0028 - val_loss: 0.0023
 - val_f1: 0.9947
Epoch 265/300
 - 25s - loss: 0.0028 - val_loss: 0.0023
 - val_f1: 0.9956
Epoch 266/300
 - 26s - loss: 0.0028 - val_loss: 0.0024
 - val_f1: 0.9956
Epoch 267/300
 - 25s - loss: 0.0028 - val_loss: 0.0023
 - val_f1: 0.9956
Epoch 268/300
 - 26s - loss: 0.0027 - val_loss: 0.0032
 - val_f1: 0.9926
Epoch 269/300
 - 26s - loss: 0.0028 - val_loss: 0.0024
 - val_f1: 0.9951
Epoch 270/300
 - 26s - loss: 0.0028 - val_loss: 0.0024
 - val_f1: 0.9952
Epoch 271/300
 - 25s - loss: 0.0028 - val_loss: 0.0025
2019-12-20 20:41:16,517 [INFO] epoch = 270. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep1/ann_model_epoch_270.pickle
 - val_f1: 0.9952
Epoch 272/300
 - 26s - loss: 0.0028 - val_loss: 0.0029
2019-12-20 20:42:05,099 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-20 20:42:52,448 [INFO] Last epoch loss evaluation: train_loss = 0.002178, val_loss = 0.002188
2019-12-20 20:42:52,448 [INFO] Training complete. time_to_train = 10134.43 sec, 168.91 min
2019-12-20 20:42:52,452 [INFO] Model saved to results_selected_models/selected_ids2017_ann_shallow_rep1/best_model.pickle
2019-12-20 20:42:52,637 [INFO] Plot saved to: results_selected_models/selected_ids2017_ann_shallow_rep1/training_error_history.png
2019-12-20 20:42:52,802 [INFO] Plot saved to: results_selected_models/selected_ids2017_ann_shallow_rep1/training_f1_history.png
2019-12-20 20:42:52,802 [INFO] Making predictions on training, validation, testing data
2019-12-20 20:43:45,421 [INFO] Evaluating predictions (results)
2019-12-20 20:44:05,350 [INFO] Dataset: Testing. Classification report below
2019-12-20 20:44:05,350 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454265
                   Bot       0.94      0.38      0.54       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       0.99      0.98      0.99      2058
              DoS Hulk       0.98      0.99      0.99     46025
      DoS Slowhttptest       0.88      0.99      0.93      1100
         DoS slowloris       0.99      0.97      0.98      1159
           FTP-Patator       1.00      1.00      1.00      1587
              PortScan       0.99      1.00      1.00     31761
           SSH-Patator       0.95      0.98      0.96      1179
Web Attack Brute Force       1.00      0.10      0.19       302
        Web Attack XSS       0.00      0.00      0.00       130

              accuracy                           1.00    565562
             macro avg       0.89      0.78      0.80    565562
          weighted avg       1.00      1.00      1.00    565562

2019-12-20 20:44:05,350 [INFO] Overall accuracy (micro avg): 0.9954063391812038
/home/sunanda/research/ids_experiments/utility.py:313: RuntimeWarning: invalid value encountered in true_divide
  F1 = (2 * PPV * TPR) / (PPV + TPR)  # F1 score
2019-12-20 20:44:26,801 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9954         0.9954                       0.9954                0.0004                   0.0046  0.9954
1     Macro avg        0.9992         0.8937                       0.7824                0.0011                   0.2176  0.7972
2  Weighted avg        0.9962         0.9952                       0.9954                0.0084                   0.0046  0.9950
2019-12-20 20:44:46,899 [INFO] Dataset: Validation. Classification report below
2019-12-20 20:44:46,899 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454264
                   Bot       0.95      0.34      0.50       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       0.99      0.98      0.99      2059
              DoS Hulk       0.98      0.99      0.99     46025
      DoS Slowhttptest       0.89      0.98      0.93      1099
         DoS slowloris       0.99      0.97      0.98      1159
           FTP-Patator       1.00      1.00      1.00      1587
              PortScan       0.99      1.00      1.00     31761
           SSH-Patator       0.95      0.98      0.96      1180
Web Attack Brute Force       0.91      0.07      0.13       301
        Web Attack XSS       1.00      0.03      0.06       131

              accuracy                           1.00    565562
             macro avg       0.97      0.78      0.79    565562
          weighted avg       1.00      1.00      1.00    565562

2019-12-20 20:44:46,899 [INFO] Overall accuracy (micro avg): 0.9955619366223332
2019-12-20 20:45:08,556 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9956         0.9956                       0.9956                0.0004                   0.0044  0.9956
1     Macro avg        0.9993         0.9708                       0.7786                0.0010                   0.2214  0.7944
2  Weighted avg        0.9963         0.9955                       0.9956                0.0080                   0.0044  0.9951
2019-12-20 20:46:15,377 [INFO] Dataset: Training. Classification report below
2019-12-20 20:46:15,377 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00   1362791
                   Bot       0.95      0.36      0.52      1174
                  DDoS       1.00      1.00      1.00     76815
         DoS GoldenEye       0.99      0.98      0.99      6176
              DoS Hulk       0.98      0.99      0.99    138074
      DoS Slowhttptest       0.90      0.99      0.94      3300
         DoS slowloris       0.99      0.98      0.98      3478
           FTP-Patator       1.00      1.00      1.00      4761
              PortScan       0.99      1.00      1.00     95282
           SSH-Patator       0.96      0.98      0.97      3538
Web Attack Brute Force       0.96      0.09      0.16       904
        Web Attack XSS       0.92      0.03      0.06       391

              accuracy                           1.00   1696684
             macro avg       0.97      0.78      0.80   1696684
          weighted avg       1.00      1.00      1.00   1696684

2019-12-20 20:46:15,377 [INFO] Overall accuracy (micro avg): 0.9956020095668964
2019-12-20 20:47:27,532 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9956         0.9956                       0.9956                0.0004                   0.0044  0.9956
1     Macro avg        0.9993         0.9701                       0.7825                0.0011                   0.2175  0.7999
2  Weighted avg        0.9963         0.9956                       0.9956                0.0083                   0.0044  0.9952
2019-12-20 20:47:27,597 [INFO] Results saved to: results_selected_models/selected_ids2017_ann_shallow_rep1/selected_ids2017_ann_shallow_rep1_results.xlsx
2019-12-20 20:47:27,601 [INFO] ================= Finished running experiment no. 1 ================= 

2019-12-20 20:47:27,644 [INFO] Created directory: results_selected_models/selected_ids2017_ann_shallow_rep2
2019-12-20 20:47:27,645 [INFO] Initialized logging. log_filename = results_selected_models/selected_ids2017_ann_shallow_rep2/run_log.log
2019-12-20 20:47:27,645 [INFO] ================= Running experiment no. 2  ================= 

2019-12-20 20:47:27,645 [INFO] Experiment parameters given below
2019-12-20 20:47:27,645 [INFO] 
{'experiment_num': 2, 'results_dir': 'results_selected_models/selected_ids2017_ann_shallow_rep2', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 300, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/full_datasets/ids2017', 'description': 'selected_ids2017_ann_shallow_rep2'}
2019-12-20 20:47:27,645 [INFO] Created tensorboard log directory: results_selected_models/selected_ids2017_ann_shallow_rep2/tf_logs_run_2019_12_20-20_47_27
2019-12-20 20:47:27,645 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2017
2019-12-20 20:47:27,645 [INFO] Reading X, y files
2019-12-20 20:47:27,646 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_train.h5
2019-12-20 20:47:31,443 [INFO] Reading complete. time_to_read=3.80 seconds
2019-12-20 20:47:31,443 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_val.h5
2019-12-20 20:47:32,730 [INFO] Reading complete. time_to_read=1.29 seconds
2019-12-20 20:47:32,733 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_test.h5
2019-12-20 20:47:34,019 [INFO] Reading complete. time_to_read=1.29 seconds
2019-12-20 20:47:34,019 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_train.h5
2019-12-20 20:47:34,295 [INFO] Reading complete. time_to_read=0.28 seconds
2019-12-20 20:47:34,295 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_val.h5
2019-12-20 20:47:34,384 [INFO] Reading complete. time_to_read=0.09 seconds
2019-12-20 20:47:34,384 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_test.h5
2019-12-20 20:47:34,473 [INFO] Reading complete. time_to_read=0.09 seconds
2019-12-20 20:47:37,585 [INFO] Initializing model
2019-12-20 20:47:37,708 [INFO] _________________________________________________________________
2019-12-20 20:47:37,708 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-20 20:47:37,708 [INFO] =================================================================
2019-12-20 20:47:37,709 [INFO] dense_13 (Dense)             (None, 64)                5056      
2019-12-20 20:47:37,709 [INFO] _________________________________________________________________
2019-12-20 20:47:37,709 [INFO] batch_normalization_7 (Batch (None, 64)                256       
2019-12-20 20:47:37,709 [INFO] _________________________________________________________________
2019-12-20 20:47:37,709 [INFO] dropout_7 (Dropout)          (None, 64)                0         
2019-12-20 20:47:37,709 [INFO] _________________________________________________________________
2019-12-20 20:47:37,709 [INFO] dense_14 (Dense)             (None, 12)                780       
2019-12-20 20:47:37,709 [INFO] =================================================================
2019-12-20 20:47:37,709 [INFO] Total params: 6,092
2019-12-20 20:47:37,709 [INFO] Trainable params: 5,964
2019-12-20 20:47:37,709 [INFO] Non-trainable params: 128
2019-12-20 20:47:37,710 [INFO] _________________________________________________________________
2019-12-20 20:47:37,710 [INFO] Training model
 - val_f1: 0.9932
Epoch 00272: early stopping
Train on 1696684 samples, validate on 565562 samples
Epoch 1/300
 - 27s - loss: 0.0193 - val_loss: 0.0107
 - val_f1: 0.9720
Epoch 2/300
 - 26s - loss: 0.0092 - val_loss: 0.0089
 - val_f1: 0.9785
Epoch 3/300
 - 26s - loss: 0.0065 - val_loss: 0.0047
 - val_f1: 0.9915
Epoch 4/300
 - 26s - loss: 0.0061 - val_loss: 0.0047
 - val_f1: 0.9900
Epoch 5/300
 - 26s - loss: 0.0056 - val_loss: 0.0044
 - val_f1: 0.9897
Epoch 6/300
 - 26s - loss: 0.0055 - val_loss: 0.0047
 - val_f1: 0.9884
Epoch 7/300
 - 26s - loss: 0.0052 - val_loss: 0.0073
 - val_f1: 0.9846
Epoch 8/300
 - 26s - loss: 0.0048 - val_loss: 0.0041
 - val_f1: 0.9909
Epoch 9/300
 - 26s - loss: 0.0046 - val_loss: 0.0034
 - val_f1: 0.9943
Epoch 10/300
 - 26s - loss: 0.0045 - val_loss: 0.0055
 - val_f1: 0.9863
Epoch 11/300
 - 26s - loss: 0.0044 - val_loss: 0.0080
 - val_f1: 0.9839
Epoch 12/300
 - 26s - loss: 0.0044 - val_loss: 0.0053
 - val_f1: 0.9886
Epoch 13/300
 - 26s - loss: 0.0043 - val_loss: 0.0037
 - val_f1: 0.9930
Epoch 14/300
 - 26s - loss: 0.0044 - val_loss: 0.0041
 - val_f1: 0.9927
Epoch 15/300
 - 26s - loss: 0.0045 - val_loss: 0.0044
 - val_f1: 0.9899
Epoch 16/300
 - 26s - loss: 0.0045 - val_loss: 0.0041
 - val_f1: 0.9919
Epoch 17/300
 - 26s - loss: 0.0045 - val_loss: 0.0053
 - val_f1: 0.9898
Epoch 18/300
 - 26s - loss: 0.0043 - val_loss: 0.0031
 - val_f1: 0.9946
Epoch 19/300
 - 26s - loss: 0.0041 - val_loss: 0.0045
 - val_f1: 0.9904
Epoch 20/300
 - 26s - loss: 0.0040 - val_loss: 0.0032
 - val_f1: 0.9947
Epoch 21/300
 - 26s - loss: 0.0039 - val_loss: 0.0033
 - val_f1: 0.9932
Epoch 22/300
 - 26s - loss: 0.0039 - val_loss: 0.0034
 - val_f1: 0.9933
Epoch 23/300
 - 26s - loss: 0.0039 - val_loss: 0.0043
 - val_f1: 0.9929
Epoch 24/300
 - 26s - loss: 0.0039 - val_loss: 0.0032
 - val_f1: 0.9925
Epoch 25/300
 - 26s - loss: 0.0038 - val_loss: 0.0029
 - val_f1: 0.9947
Epoch 26/300
 - 26s - loss: 0.0039 - val_loss: 0.0033
 - val_f1: 0.9949
Epoch 27/300
 - 26s - loss: 0.0038 - val_loss: 0.0045
 - val_f1: 0.9900
Epoch 28/300
 - 26s - loss: 0.0038 - val_loss: 0.0029
 - val_f1: 0.9947
Epoch 29/300
 - 26s - loss: 0.0037 - val_loss: 0.0030
 - val_f1: 0.9946
Epoch 30/300
 - 26s - loss: 0.0037 - val_loss: 0.0045
 - val_f1: 0.9920
Epoch 31/300
 - 26s - loss: 0.0037 - val_loss: 0.0032
2019-12-20 21:07:00,394 [INFO] epoch = 30. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep2/ann_model_epoch_30.pickle
 - val_f1: 0.9938
Epoch 32/300
 - 26s - loss: 0.0037 - val_loss: 0.0033
 - val_f1: 0.9949
Epoch 33/300
 - 26s - loss: 0.0037 - val_loss: 0.0031
 - val_f1: 0.9952
Epoch 34/300
 - 26s - loss: 0.0037 - val_loss: 0.0031
 - val_f1: 0.9941
Epoch 35/300
 - 26s - loss: 0.0036 - val_loss: 0.0040
 - val_f1: 0.9918
Epoch 36/300
 - 26s - loss: 0.0036 - val_loss: 0.0032
 - val_f1: 0.9938
Epoch 37/300
 - 26s - loss: 0.0036 - val_loss: 0.0030
 - val_f1: 0.9942
Epoch 38/300
 - 26s - loss: 0.0036 - val_loss: 0.0033
 - val_f1: 0.9935
Epoch 39/300
 - 26s - loss: 0.0036 - val_loss: 0.0028
 - val_f1: 0.9946
Epoch 40/300
 - 26s - loss: 0.0036 - val_loss: 0.0030
 - val_f1: 0.9944
Epoch 41/300
 - 26s - loss: 0.0035 - val_loss: 0.0034
 - val_f1: 0.9915
Epoch 42/300
 - 26s - loss: 0.0035 - val_loss: 0.0033
 - val_f1: 0.9939
Epoch 43/300
 - 26s - loss: 0.0035 - val_loss: 0.0056
 - val_f1: 0.9890
Epoch 44/300
 - 26s - loss: 0.0035 - val_loss: 0.0038
 - val_f1: 0.9937
Epoch 45/300
 - 26s - loss: 0.0035 - val_loss: 0.0031
 - val_f1: 0.9925
Epoch 46/300
 - 26s - loss: 0.0034 - val_loss: 0.0031
 - val_f1: 0.9926
Epoch 47/300
 - 26s - loss: 0.0034 - val_loss: 0.0032
 - val_f1: 0.9937
Epoch 48/300
 - 26s - loss: 0.0034 - val_loss: 0.0036
 - val_f1: 0.9937
Epoch 49/300
 - 26s - loss: 0.0034 - val_loss: 0.0026
 - val_f1: 0.9950
Epoch 50/300
 - 26s - loss: 0.0034 - val_loss: 0.0036
 - val_f1: 0.9919
Epoch 51/300
 - 26s - loss: 0.0034 - val_loss: 0.0028
 - val_f1: 0.9942
Epoch 52/300
 - 26s - loss: 0.0034 - val_loss: 0.0031
 - val_f1: 0.9946
Epoch 53/300
 - 26s - loss: 0.0034 - val_loss: 0.0031
 - val_f1: 0.9929
Epoch 54/300
 - 26s - loss: 0.0033 - val_loss: 0.0027
 - val_f1: 0.9954
Epoch 55/300
 - 26s - loss: 0.0033 - val_loss: 0.0035
 - val_f1: 0.9945
Epoch 56/300
 - 26s - loss: 0.0033 - val_loss: 0.0033
 - val_f1: 0.9936
Epoch 57/300
 - 26s - loss: 0.0033 - val_loss: 0.0027
 - val_f1: 0.9945
Epoch 58/300
 - 26s - loss: 0.0033 - val_loss: 0.0031
 - val_f1: 0.9928
Epoch 59/300
 - 26s - loss: 0.0033 - val_loss: 0.0030
 - val_f1: 0.9952
Epoch 60/300
 - 26s - loss: 0.0033 - val_loss: 0.0028
 - val_f1: 0.9943
Epoch 61/300
 - 26s - loss: 0.0033 - val_loss: 0.0032
2019-12-20 21:25:53,210 [INFO] epoch = 60. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep2/ann_model_epoch_60.pickle
 - val_f1: 0.9928
Epoch 62/300
 - 26s - loss: 0.0033 - val_loss: 0.0025
 - val_f1: 0.9951
Epoch 63/300
 - 26s - loss: 0.0033 - val_loss: 0.0027
 - val_f1: 0.9954
Epoch 64/300
 - 26s - loss: 0.0033 - val_loss: 0.0032
 - val_f1: 0.9949
Epoch 65/300
 - 26s - loss: 0.0033 - val_loss: 0.0036
 - val_f1: 0.9924
Epoch 66/300
 - 26s - loss: 0.0033 - val_loss: 0.0027
 - val_f1: 0.9949
Epoch 67/300
 - 26s - loss: 0.0032 - val_loss: 0.0026
 - val_f1: 0.9950
Epoch 68/300
 - 26s - loss: 0.0032 - val_loss: 0.0029
 - val_f1: 0.9945
Epoch 69/300
 - 26s - loss: 0.0032 - val_loss: 0.0025
 - val_f1: 0.9953
Epoch 70/300
 - 26s - loss: 0.0032 - val_loss: 0.0026
 - val_f1: 0.9953
Epoch 71/300
 - 26s - loss: 0.0032 - val_loss: 0.0031
 - val_f1: 0.9953
Epoch 72/300
 - 26s - loss: 0.0032 - val_loss: 0.0028
 - val_f1: 0.9952
Epoch 73/300
 - 26s - loss: 0.0032 - val_loss: 0.0025
 - val_f1: 0.9950
Epoch 74/300
 - 26s - loss: 0.0032 - val_loss: 0.0028
 - val_f1: 0.9954
Epoch 75/300
 - 26s - loss: 0.0032 - val_loss: 0.0029
 - val_f1: 0.9926
Epoch 76/300
 - 26s - loss: 0.0032 - val_loss: 0.0026
 - val_f1: 0.9952
Epoch 77/300
 - 26s - loss: 0.0032 - val_loss: 0.0028
 - val_f1: 0.9949
Epoch 78/300
 - 26s - loss: 0.0032 - val_loss: 0.0028
 - val_f1: 0.9930
Epoch 79/300
 - 26s - loss: 0.0031 - val_loss: 0.0040
 - val_f1: 0.9926
Epoch 80/300
 - 26s - loss: 0.0032 - val_loss: 0.0028
 - val_f1: 0.9929
Epoch 81/300
 - 26s - loss: 0.0032 - val_loss: 0.0029
 - val_f1: 0.9929
Epoch 82/300
 - 26s - loss: 0.0031 - val_loss: 0.0029
 - val_f1: 0.9939
Epoch 83/300
 - 26s - loss: 0.0032 - val_loss: 0.0025
 - val_f1: 0.9953
Epoch 84/300
 - 26s - loss: 0.0031 - val_loss: 0.0028
 - val_f1: 0.9927
Epoch 85/300
 - 26s - loss: 0.0031 - val_loss: 0.0028
 - val_f1: 0.9930
Epoch 86/300
 - 26s - loss: 0.0031 - val_loss: 0.0024
 - val_f1: 0.9953
Epoch 87/300
 - 26s - loss: 0.0031 - val_loss: 0.0046
 - val_f1: 0.9886
Epoch 88/300
 - 26s - loss: 0.0032 - val_loss: 0.0031
 - val_f1: 0.9926
Epoch 89/300
 - 26s - loss: 0.0031 - val_loss: 0.0025
 - val_f1: 0.9952
Epoch 90/300
 - 26s - loss: 0.0031 - val_loss: 0.0031
 - val_f1: 0.9926
Epoch 91/300
 - 26s - loss: 0.0031 - val_loss: 0.0026
2019-12-20 21:44:47,653 [INFO] epoch = 90. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep2/ann_model_epoch_90.pickle
 - val_f1: 0.9952
Epoch 92/300
 - 26s - loss: 0.0031 - val_loss: 0.0070
 - val_f1: 0.9778
Epoch 93/300
 - 26s - loss: 0.0031 - val_loss: 0.0024
 - val_f1: 0.9953
Epoch 94/300
 - 26s - loss: 0.0031 - val_loss: 0.0029
 - val_f1: 0.9927
Epoch 95/300
 - 26s - loss: 0.0031 - val_loss: 0.0025
 - val_f1: 0.9954
Epoch 96/300
 - 26s - loss: 0.0031 - val_loss: 0.0029
 - val_f1: 0.9951
Epoch 97/300
 - 26s - loss: 0.0031 - val_loss: 0.0024
 - val_f1: 0.9951
Epoch 98/300
 - 26s - loss: 0.0030 - val_loss: 0.0034
 - val_f1: 0.9926
Epoch 99/300
 - 26s - loss: 0.0031 - val_loss: 0.0030
 - val_f1: 0.9941
Epoch 100/300
 - 26s - loss: 0.0030 - val_loss: 0.0025
 - val_f1: 0.9951
Epoch 101/300
 - 26s - loss: 0.0030 - val_loss: 0.0031
 - val_f1: 0.9941
Epoch 102/300
 - 26s - loss: 0.0030 - val_loss: 0.0031
 - val_f1: 0.9931
Epoch 103/300
 - 26s - loss: 0.0030 - val_loss: 0.0030
 - val_f1: 0.9928
Epoch 104/300
 - 26s - loss: 0.0030 - val_loss: 0.0030
 - val_f1: 0.9930
Epoch 105/300
 - 26s - loss: 0.0030 - val_loss: 0.0028
 - val_f1: 0.9947
Epoch 106/300
 - 26s - loss: 0.0030 - val_loss: 0.0035
 - val_f1: 0.9917
Epoch 107/300
 - 26s - loss: 0.0030 - val_loss: 0.0024
 - val_f1: 0.9955
Epoch 108/300
 - 26s - loss: 0.0030 - val_loss: 0.0024
 - val_f1: 0.9951
Epoch 109/300
 - 26s - loss: 0.0030 - val_loss: 0.0028
 - val_f1: 0.9952
Epoch 110/300
 - 26s - loss: 0.0030 - val_loss: 0.0026
 - val_f1: 0.9948
Epoch 111/300
 - 26s - loss: 0.0030 - val_loss: 0.0026
 - val_f1: 0.9951
Epoch 112/300
 - 26s - loss: 0.0030 - val_loss: 0.0029
 - val_f1: 0.9941
Epoch 113/300
 - 26s - loss: 0.0031 - val_loss: 0.0030
 - val_f1: 0.9929
Epoch 114/300
 - 26s - loss: 0.0030 - val_loss: 0.0030
 - val_f1: 0.9930
Epoch 115/300
 - 26s - loss: 0.0030 - val_loss: 0.0031
 - val_f1: 0.9941
Epoch 116/300
 - 26s - loss: 0.0030 - val_loss: 0.0025
 - val_f1: 0.9942
Epoch 117/300
 - 26s - loss: 0.0030 - val_loss: 0.0024
 - val_f1: 0.9952
Epoch 118/300
 - 26s - loss: 0.0030 - val_loss: 0.0027
 - val_f1: 0.9950
Epoch 119/300
 - 26s - loss: 0.0030 - val_loss: 0.0055
 - val_f1: 0.9908
Epoch 120/300
 - 26s - loss: 0.0030 - val_loss: 0.0024
 - val_f1: 0.9954
Epoch 121/300
 - 26s - loss: 0.0029 - val_loss: 0.0025
2019-12-20 22:03:39,250 [INFO] epoch = 120. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep2/ann_model_epoch_120.pickle
 - val_f1: 0.9954
Epoch 122/300
 - 26s - loss: 0.0029 - val_loss: 0.0026
 - val_f1: 0.9931
Epoch 123/300
 - 26s - loss: 0.0030 - val_loss: 0.0027
 - val_f1: 0.9942
Epoch 124/300
 - 26s - loss: 0.0030 - val_loss: 0.0033
 - val_f1: 0.9925
Epoch 125/300
 - 26s - loss: 0.0030 - val_loss: 0.0026
 - val_f1: 0.9942
Epoch 126/300
 - 26s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9947
Epoch 127/300
 - 26s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9930
Epoch 128/300
 - 26s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9956
Epoch 129/300
 - 26s - loss: 0.0029 - val_loss: 0.0032
 - val_f1: 0.9919
Epoch 130/300
 - 26s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9952
Epoch 131/300
 - 26s - loss: 0.0029 - val_loss: 0.0048
 - val_f1: 0.9911
Epoch 132/300
 - 26s - loss: 0.0030 - val_loss: 0.0022
 - val_f1: 0.9955
Epoch 133/300
 - 26s - loss: 0.0030 - val_loss: 0.0023
 - val_f1: 0.9956
Epoch 134/300
 - 26s - loss: 0.0029 - val_loss: 0.0034
 - val_f1: 0.9929
Epoch 135/300
 - 26s - loss: 0.0029 - val_loss: 0.0048
 - val_f1: 0.9900
Epoch 136/300
 - 26s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9954
Epoch 137/300
 - 26s - loss: 0.0029 - val_loss: 0.0030
 - val_f1: 0.9932
Epoch 138/300
 - 26s - loss: 0.0029 - val_loss: 0.0028
 - val_f1: 0.9935
Epoch 139/300
 - 26s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9945
Epoch 140/300
 - 26s - loss: 0.0029 - val_loss: 0.0026
 - val_f1: 0.9945
Epoch 141/300
 - 26s - loss: 0.0029 - val_loss: 0.0029
 - val_f1: 0.9929
Epoch 142/300
 - 26s - loss: 0.0029 - val_loss: 0.0033
 - val_f1: 0.9940
Epoch 143/300
 - 26s - loss: 0.0029 - val_loss: 0.0036
 - val_f1: 0.9922
Epoch 144/300
 - 26s - loss: 0.0029 - val_loss: 0.0029
 - val_f1: 0.9951
Epoch 145/300
 - 26s - loss: 0.0029 - val_loss: 0.0027
 - val_f1: 0.9952
Epoch 146/300
 - 26s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9944
Epoch 147/300
 - 26s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9951
Epoch 148/300
 - 26s - loss: 0.0029 - val_loss: 0.0027
 - val_f1: 0.9944
Epoch 149/300
 - 26s - loss: 0.0029 - val_loss: 0.0040
 - val_f1: 0.9922
Epoch 150/300
 - 26s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9960
Epoch 151/300
 - 26s - loss: 0.0029 - val_loss: 0.0033
2019-12-20 22:22:30,059 [INFO] epoch = 150. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep2/ann_model_epoch_150.pickle
 - val_f1: 0.9928
Epoch 152/300
 - 26s - loss: 0.0030 - val_loss: 0.0029
 - val_f1: 0.9942
Epoch 153/300
 - 26s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9953
Epoch 154/300
 - 26s - loss: 0.0029 - val_loss: 0.0023
 - val_f1: 0.9959
Epoch 155/300
 - 26s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9954
Epoch 156/300
 - 26s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9944
Epoch 157/300
 - 26s - loss: 0.0028 - val_loss: 0.0025
 - val_f1: 0.9947
Epoch 158/300
 - 26s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9951
Epoch 159/300
 - 26s - loss: 0.0029 - val_loss: 0.0027
 - val_f1: 0.9943
Epoch 160/300
 - 26s - loss: 0.0029 - val_loss: 0.0029
 - val_f1: 0.9935
Epoch 161/300
 - 26s - loss: 0.0029 - val_loss: 0.0032
 - val_f1: 0.9940
Epoch 162/300
 - 26s - loss: 0.0029 - val_loss: 0.0023
 - val_f1: 0.9953
Epoch 163/300
 - 26s - loss: 0.0028 - val_loss: 0.0027
 - val_f1: 0.9946
Epoch 164/300
 - 26s - loss: 0.0029 - val_loss: 0.0028
 - val_f1: 0.9931
Epoch 165/300
 - 26s - loss: 0.0028 - val_loss: 0.0025
 - val_f1: 0.9955
Epoch 166/300
 - 26s - loss: 0.0028 - val_loss: 0.0023
 - val_f1: 0.9954
Epoch 167/300
 - 26s - loss: 0.0028 - val_loss: 0.0032
 - val_f1: 0.9927
Epoch 168/300
 - 26s - loss: 0.0028 - val_loss: 0.0026
 - val_f1: 0.9945
Epoch 169/300
 - 26s - loss: 0.0028 - val_loss: 0.0026
 - val_f1: 0.9946
Epoch 170/300
 - 26s - loss: 0.0028 - val_loss: 0.0023
 - val_f1: 0.9955
Epoch 171/300
 - 26s - loss: 0.0028 - val_loss: 0.0026
 - val_f1: 0.9947
Epoch 172/300
 - 26s - loss: 0.0028 - val_loss: 0.0025
 - val_f1: 0.9946
Epoch 173/300
 - 26s - loss: 0.0028 - val_loss: 0.0033
 - val_f1: 0.9931
Epoch 174/300
 - 26s - loss: 0.0028 - val_loss: 0.0023
 - val_f1: 0.9954
Epoch 175/300
 - 26s - loss: 0.0028 - val_loss: 0.0026
 - val_f1: 0.9945
Epoch 176/300
 - 26s - loss: 0.0028 - val_loss: 0.0024
 - val_f1: 0.9957
Epoch 177/300
 - 26s - loss: 0.0028 - val_loss: 0.0023
 - val_f1: 0.9955
Epoch 178/300
 - 26s - loss: 0.0029 - val_loss: 0.0027
 - val_f1: 0.9939
Epoch 179/300
 - 26s - loss: 0.0029 - val_loss: 0.0023
 - val_f1: 0.9947
Epoch 180/300
 - 26s - loss: 0.0028 - val_loss: 0.0025
 - val_f1: 0.9930
Epoch 181/300
 - 26s - loss: 0.0028 - val_loss: 0.0024
2019-12-20 22:41:19,945 [INFO] epoch = 180. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep2/ann_model_epoch_180.pickle
 - val_f1: 0.9952
Epoch 182/300
 - 26s - loss: 0.0028 - val_loss: 0.0024
2019-12-20 22:42:09,245 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-20 22:42:57,604 [INFO] Last epoch loss evaluation: train_loss = 0.002223, val_loss = 0.002237
2019-12-20 22:42:57,604 [INFO] Training complete. time_to_train = 6919.89 sec, 115.33 min
2019-12-20 22:42:57,608 [INFO] Model saved to results_selected_models/selected_ids2017_ann_shallow_rep2/best_model.pickle
2019-12-20 22:42:57,806 [INFO] Plot saved to: results_selected_models/selected_ids2017_ann_shallow_rep2/training_error_history.png
2019-12-20 22:42:57,978 [INFO] Plot saved to: results_selected_models/selected_ids2017_ann_shallow_rep2/training_f1_history.png
2019-12-20 22:42:57,978 [INFO] Making predictions on training, validation, testing data
2019-12-20 22:43:51,873 [INFO] Evaluating predictions (results)
/home/sunanda/anaconda3/envs/ml_env_cpu/lib/python3.7/site-packages/sklearn/metrics/classification.py:1437: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples.
  'precision', 'predicted', average, warn_for)
2019-12-20 22:44:11,805 [INFO] Dataset: Testing. Classification report below
2019-12-20 22:44:11,805 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454265
                   Bot       0.97      0.39      0.55       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       0.99      0.98      0.99      2058
              DoS Hulk       0.98      0.99      0.99     46025
      DoS Slowhttptest       0.89      0.97      0.93      1100
         DoS slowloris       0.98      0.98      0.98      1159
           FTP-Patator       1.00      1.00      1.00      1587
              PortScan       0.99      1.00      1.00     31761
           SSH-Patator       0.94      0.98      0.96      1179
Web Attack Brute Force       0.92      0.11      0.20       302
        Web Attack XSS       0.00      0.00      0.00       130

              accuracy                           1.00    565562
             macro avg       0.89      0.78      0.80    565562
          weighted avg       1.00      1.00      1.00    565562

2019-12-20 22:44:11,805 [INFO] Overall accuracy (micro avg): 0.9953886576538028
/home/sunanda/research/ids_experiments/utility.py:307: RuntimeWarning: invalid value encountered in true_divide
  PPV = TP / (TP + FP)    # Precision or positive predictive value
/home/sunanda/research/ids_experiments/utility.py:311: RuntimeWarning: invalid value encountered in true_divide
  FDR = FP / (TP + FP)    # False discovery rate
2019-12-20 22:44:33,200 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9954         0.9954                       0.9954                0.0004                   0.0046  0.9954
1     Macro avg        0.9992         0.8886                       0.7834                0.0010                   0.2166  0.7990
2  Weighted avg        0.9962         0.9952                       0.9954                0.0080                   0.0046  0.9950
2019-12-20 22:44:53,270 [INFO] Dataset: Validation. Classification report below
2019-12-20 22:44:53,270 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454264
                   Bot       0.99      0.36      0.52       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       0.99      0.98      0.99      2059
              DoS Hulk       0.98      0.99      0.99     46025
      DoS Slowhttptest       0.89      0.98      0.93      1099
         DoS slowloris       0.99      0.98      0.98      1159
           FTP-Patator       1.00      1.00      1.00      1587
              PortScan       0.99      1.00      1.00     31761
           SSH-Patator       0.95      0.98      0.96      1180
Web Attack Brute Force       0.88      0.08      0.14       301
        Web Attack XSS       1.00      0.01      0.02       131

              accuracy                           1.00    565562
             macro avg       0.97      0.78      0.79    565562
          weighted avg       1.00      1.00      1.00    565562

2019-12-20 22:44:53,270 [INFO] Overall accuracy (micro avg): 0.9955177328038305
2019-12-20 22:45:14,888 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9955         0.9955                       0.9955                0.0004                   0.0045  0.9955
1     Macro avg        0.9993         0.9716                       0.7782                0.0010                   0.2218  0.7933
2  Weighted avg        0.9963         0.9955                       0.9955                0.0077                   0.0045  0.9951
2019-12-20 22:46:21,918 [INFO] Dataset: Training. Classification report below
2019-12-20 22:46:21,918 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00   1362791
                   Bot       0.99      0.37      0.54      1174
                  DDoS       1.00      1.00      1.00     76815
         DoS GoldenEye       0.99      0.98      0.99      6176
              DoS Hulk       0.98      0.99      0.99    138074
      DoS Slowhttptest       0.91      0.98      0.94      3300
         DoS slowloris       0.98      0.99      0.99      3478
           FTP-Patator       1.00      1.00      1.00      4761
              PortScan       0.99      1.00      1.00     95282
           SSH-Patator       0.96      0.98      0.97      3538
Web Attack Brute Force       0.93      0.09      0.17       904
        Web Attack XSS       1.00      0.03      0.05       391

              accuracy                           1.00   1696684
             macro avg       0.98      0.78      0.80   1696684
          weighted avg       1.00      1.00      1.00   1696684

2019-12-20 22:46:21,918 [INFO] Overall accuracy (micro avg): 0.9955955263325404
2019-12-20 22:47:34,274 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9956         0.9956                       0.9956                0.0004                   0.0044  0.9956
1     Macro avg        0.9993         0.9773                       0.7838                0.0010                   0.2162  0.8018
2  Weighted avg        0.9963         0.9956                       0.9956                0.0078                   0.0044  0.9952
2019-12-20 22:47:34,338 [INFO] Results saved to: results_selected_models/selected_ids2017_ann_shallow_rep2/selected_ids2017_ann_shallow_rep2_results.xlsx
2019-12-20 22:47:34,342 [INFO] ================= Finished running experiment no. 2 ================= 

2019-12-20 22:47:34,385 [INFO] Created directory: results_selected_models/selected_ids2017_ann_shallow_rep3
2019-12-20 22:47:34,386 [INFO] Initialized logging. log_filename = results_selected_models/selected_ids2017_ann_shallow_rep3/run_log.log
2019-12-20 22:47:34,386 [INFO] ================= Running experiment no. 3  ================= 

2019-12-20 22:47:34,386 [INFO] Experiment parameters given below
2019-12-20 22:47:34,386 [INFO] 
{'experiment_num': 3, 'results_dir': 'results_selected_models/selected_ids2017_ann_shallow_rep3', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 300, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/full_datasets/ids2017', 'description': 'selected_ids2017_ann_shallow_rep3'}
2019-12-20 22:47:34,386 [INFO] Created tensorboard log directory: results_selected_models/selected_ids2017_ann_shallow_rep3/tf_logs_run_2019_12_20-22_47_34
2019-12-20 22:47:34,386 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2017
2019-12-20 22:47:34,386 [INFO] Reading X, y files
2019-12-20 22:47:34,386 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_train.h5
2019-12-20 22:47:38,246 [INFO] Reading complete. time_to_read=3.86 seconds
2019-12-20 22:47:38,246 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_val.h5
2019-12-20 22:47:39,549 [INFO] Reading complete. time_to_read=1.30 seconds
2019-12-20 22:47:39,550 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_test.h5
2019-12-20 22:47:40,840 [INFO] Reading complete. time_to_read=1.29 seconds
2019-12-20 22:47:40,840 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_train.h5
2019-12-20 22:47:41,103 [INFO] Reading complete. time_to_read=0.26 seconds
2019-12-20 22:47:41,103 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_val.h5
2019-12-20 22:47:41,191 [INFO] Reading complete. time_to_read=0.09 seconds
2019-12-20 22:47:41,191 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_test.h5
2019-12-20 22:47:41,280 [INFO] Reading complete. time_to_read=0.09 seconds
2019-12-20 22:47:44,405 [INFO] Initializing model
2019-12-20 22:47:44,530 [INFO] _________________________________________________________________
2019-12-20 22:47:44,530 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-20 22:47:44,530 [INFO] =================================================================
2019-12-20 22:47:44,530 [INFO] dense_15 (Dense)             (None, 64)                5056      
2019-12-20 22:47:44,530 [INFO] _________________________________________________________________
2019-12-20 22:47:44,530 [INFO] batch_normalization_8 (Batch (None, 64)                256       
2019-12-20 22:47:44,531 [INFO] _________________________________________________________________
2019-12-20 22:47:44,531 [INFO] dropout_8 (Dropout)          (None, 64)                0         
2019-12-20 22:47:44,531 [INFO] _________________________________________________________________
2019-12-20 22:47:44,531 [INFO] dense_16 (Dense)             (None, 12)                780       
2019-12-20 22:47:44,531 [INFO] =================================================================
2019-12-20 22:47:44,531 [INFO] Total params: 6,092
2019-12-20 22:47:44,531 [INFO] Trainable params: 5,964
2019-12-20 22:47:44,531 [INFO] Non-trainable params: 128
2019-12-20 22:47:44,531 [INFO] _________________________________________________________________
2019-12-20 22:47:44,531 [INFO] Training model
 - val_f1: 0.9952
Epoch 00182: early stopping
Train on 1696684 samples, validate on 565562 samples
Epoch 1/300
 - 27s - loss: 0.0188 - val_loss: 0.0195
 - val_f1: 0.9444
Epoch 2/300
 - 26s - loss: 0.0096 - val_loss: 0.0078
 - val_f1: 0.9805
Epoch 3/300
 - 26s - loss: 0.0071 - val_loss: 0.0079
 - val_f1: 0.9803
Epoch 4/300
 - 26s - loss: 0.0065 - val_loss: 0.0054
 - val_f1: 0.9873
Epoch 5/300
 - 26s - loss: 0.0060 - val_loss: 0.0049
 - val_f1: 0.9907
Epoch 6/300
 - 26s - loss: 0.0057 - val_loss: 0.0062
 - val_f1: 0.9836
Epoch 7/300
 - 26s - loss: 0.0053 - val_loss: 0.0055
 - val_f1: 0.9880
Epoch 8/300
 - 26s - loss: 0.0054 - val_loss: 0.0043
 - val_f1: 0.9900
Epoch 9/300
 - 26s - loss: 0.0051 - val_loss: 0.0051
 - val_f1: 0.9887
Epoch 10/300
 - 26s - loss: 0.0053 - val_loss: 0.0060
 - val_f1: 0.9847
Epoch 11/300
 - 26s - loss: 0.0050 - val_loss: 0.0050
 - val_f1: 0.9869
Epoch 12/300
 - 26s - loss: 0.0049 - val_loss: 0.0053
 - val_f1: 0.9889
Epoch 13/300
 - 26s - loss: 0.0048 - val_loss: 0.0044
 - val_f1: 0.9922
Epoch 14/300
 - 26s - loss: 0.0046 - val_loss: 0.0062
 - val_f1: 0.9843
Epoch 15/300
 - 26s - loss: 0.0044 - val_loss: 0.0047
 - val_f1: 0.9879
Epoch 16/300
 - 26s - loss: 0.0044 - val_loss: 0.0036
 - val_f1: 0.9939
Epoch 17/300
 - 26s - loss: 0.0044 - val_loss: 0.0041
 - val_f1: 0.9910
Epoch 18/300
 - 26s - loss: 0.0043 - val_loss: 0.0057
 - val_f1: 0.9872
Epoch 19/300
 - 26s - loss: 0.0041 - val_loss: 0.0061
 - val_f1: 0.9877
Epoch 20/300
 - 26s - loss: 0.0041 - val_loss: 0.0032
 - val_f1: 0.9933
Epoch 21/300
 - 26s - loss: 0.0041 - val_loss: 0.0037
 - val_f1: 0.9921
Epoch 22/300
 - 26s - loss: 0.0040 - val_loss: 0.0048
 - val_f1: 0.9891
Epoch 23/300
 - 26s - loss: 0.0040 - val_loss: 0.0032
 - val_f1: 0.9944
Epoch 24/300
 - 26s - loss: 0.0040 - val_loss: 0.0031
 - val_f1: 0.9943
Epoch 25/300
 - 27s - loss: 0.0039 - val_loss: 0.0029
 - val_f1: 0.9940
Epoch 26/300
 - 26s - loss: 0.0039 - val_loss: 0.0032
 - val_f1: 0.9937
Epoch 27/300
 - 26s - loss: 0.0039 - val_loss: 0.0037
 - val_f1: 0.9912
Epoch 28/300
 - 26s - loss: 0.0038 - val_loss: 0.0034
 - val_f1: 0.9930
Epoch 29/300
 - 26s - loss: 0.0038 - val_loss: 0.0033
 - val_f1: 0.9935
Epoch 30/300
 - 26s - loss: 0.0037 - val_loss: 0.0039
 - val_f1: 0.9917
Epoch 31/300
 - 26s - loss: 0.0037 - val_loss: 0.0036
2019-12-20 23:07:16,804 [INFO] epoch = 30. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep3/ann_model_epoch_30.pickle
 - val_f1: 0.9933
Epoch 32/300
 - 26s - loss: 0.0038 - val_loss: 0.0034
 - val_f1: 0.9923
Epoch 33/300
 - 26s - loss: 0.0037 - val_loss: 0.0030
 - val_f1: 0.9945
Epoch 34/300
 - 26s - loss: 0.0037 - val_loss: 0.0030
 - val_f1: 0.9948
Epoch 35/300
 - 26s - loss: 0.0037 - val_loss: 0.0054
 - val_f1: 0.9897
Epoch 36/300
 - 26s - loss: 0.0037 - val_loss: 0.0034
 - val_f1: 0.9924
Epoch 37/300
 - 26s - loss: 0.0037 - val_loss: 0.0033
 - val_f1: 0.9924
Epoch 38/300
 - 26s - loss: 0.0036 - val_loss: 0.0036
 - val_f1: 0.9935
Epoch 39/300
 - 26s - loss: 0.0036 - val_loss: 0.0027
 - val_f1: 0.9951
Epoch 40/300
 - 26s - loss: 0.0036 - val_loss: 0.0028
 - val_f1: 0.9948
Epoch 41/300
 - 26s - loss: 0.0036 - val_loss: 0.0032
 - val_f1: 0.9926
Epoch 42/300
 - 26s - loss: 0.0036 - val_loss: 0.0030
 - val_f1: 0.9928
Epoch 43/300
 - 26s - loss: 0.0035 - val_loss: 0.0043
 - val_f1: 0.9915
Epoch 44/300
 - 26s - loss: 0.0035 - val_loss: 0.0026
 - val_f1: 0.9948
Epoch 45/300
 - 26s - loss: 0.0035 - val_loss: 0.0038
 - val_f1: 0.9931
Epoch 46/300
 - 26s - loss: 0.0035 - val_loss: 0.0027
 - val_f1: 0.9947
Epoch 47/300
 - 26s - loss: 0.0035 - val_loss: 0.0030
 - val_f1: 0.9921
Epoch 48/300
 - 26s - loss: 0.0035 - val_loss: 0.0029
 - val_f1: 0.9925
Epoch 49/300
 - 26s - loss: 0.0034 - val_loss: 0.0029
 - val_f1: 0.9939
Epoch 50/300
 - 26s - loss: 0.0034 - val_loss: 0.0051
 - val_f1: 0.9887
Epoch 51/300
 - 26s - loss: 0.0035 - val_loss: 0.0037
 - val_f1: 0.9920
Epoch 52/300
 - 26s - loss: 0.0035 - val_loss: 0.0048
 - val_f1: 0.9898
Epoch 53/300
 - 26s - loss: 0.0035 - val_loss: 0.0027
 - val_f1: 0.9950
Epoch 54/300
 - 26s - loss: 0.0034 - val_loss: 0.0030
 - val_f1: 0.9951
Epoch 55/300
 - 26s - loss: 0.0034 - val_loss: 0.0031
 - val_f1: 0.9925
Epoch 56/300
 - 26s - loss: 0.0035 - val_loss: 0.0095
 - val_f1: 0.9842
Epoch 57/300
 - 26s - loss: 0.0034 - val_loss: 0.0039
 - val_f1: 0.9927
Epoch 58/300
 - 26s - loss: 0.0034 - val_loss: 0.0042
 - val_f1: 0.9909
Epoch 59/300
 - 26s - loss: 0.0034 - val_loss: 0.0038
 - val_f1: 0.9912
Epoch 60/300
 - 26s - loss: 0.0034 - val_loss: 0.0031
 - val_f1: 0.9938
Epoch 61/300
 - 26s - loss: 0.0033 - val_loss: 0.0042
2019-12-20 23:26:19,268 [INFO] epoch = 60. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep3/ann_model_epoch_60.pickle
 - val_f1: 0.9909
Epoch 62/300
 - 26s - loss: 0.0034 - val_loss: 0.0031
 - val_f1: 0.9922
Epoch 63/300
 - 26s - loss: 0.0033 - val_loss: 0.0037
 - val_f1: 0.9934
Epoch 64/300
 - 26s - loss: 0.0033 - val_loss: 0.0025
 - val_f1: 0.9952
Epoch 65/300
 - 26s - loss: 0.0033 - val_loss: 0.0048
 - val_f1: 0.9901
Epoch 66/300
 - 26s - loss: 0.0033 - val_loss: 0.0026
 - val_f1: 0.9954
Epoch 67/300
 - 26s - loss: 0.0032 - val_loss: 0.0026
 - val_f1: 0.9952
Epoch 68/300
 - 26s - loss: 0.0033 - val_loss: 0.0029
 - val_f1: 0.9939
Epoch 69/300
 - 26s - loss: 0.0035 - val_loss: 0.0026
 - val_f1: 0.9951
Epoch 70/300
 - 26s - loss: 0.0034 - val_loss: 0.0029
 - val_f1: 0.9926
Epoch 71/300
 - 26s - loss: 0.0034 - val_loss: 0.0029
 - val_f1: 0.9928
Epoch 72/300
 - 26s - loss: 0.0034 - val_loss: 0.0026
 - val_f1: 0.9950
Epoch 73/300
 - 26s - loss: 0.0034 - val_loss: 0.0027
 - val_f1: 0.9948
Epoch 74/300
 - 26s - loss: 0.0034 - val_loss: 0.0026
 - val_f1: 0.9951
Epoch 75/300
 - 26s - loss: 0.0034 - val_loss: 0.0029
 - val_f1: 0.9928
Epoch 76/300
 - 26s - loss: 0.0036 - val_loss: 0.0034
 - val_f1: 0.9918
Epoch 77/300
 - 26s - loss: 0.0035 - val_loss: 0.0026
 - val_f1: 0.9955
Epoch 78/300
 - 26s - loss: 0.0035 - val_loss: 0.0025
 - val_f1: 0.9953
Epoch 79/300
 - 26s - loss: 0.0034 - val_loss: 0.0028
 - val_f1: 0.9929
Epoch 80/300
 - 26s - loss: 0.0034 - val_loss: 0.0028
 - val_f1: 0.9945
Epoch 81/300
 - 26s - loss: 0.0033 - val_loss: 0.0028
 - val_f1: 0.9950
Epoch 82/300
 - 26s - loss: 0.0033 - val_loss: 0.0026
 - val_f1: 0.9954
Epoch 83/300
 - 26s - loss: 0.0033 - val_loss: 0.0026
 - val_f1: 0.9947
Epoch 84/300
 - 26s - loss: 0.0033 - val_loss: 0.0029
 - val_f1: 0.9929
Epoch 85/300
 - 26s - loss: 0.0033 - val_loss: 0.0044
 - val_f1: 0.9908
Epoch 86/300
 - 26s - loss: 0.0033 - val_loss: 0.0027
 - val_f1: 0.9950
Epoch 87/300
 - 26s - loss: 0.0033 - val_loss: 0.0034
 - val_f1: 0.9918
Epoch 88/300
 - 26s - loss: 0.0032 - val_loss: 0.0031
 - val_f1: 0.9917
Epoch 89/300
 - 26s - loss: 0.0032 - val_loss: 0.0025
 - val_f1: 0.9958
Epoch 90/300
 - 26s - loss: 0.0032 - val_loss: 0.0025
 - val_f1: 0.9954
Epoch 91/300
 - 26s - loss: 0.0032 - val_loss: 0.0030
2019-12-20 23:45:21,640 [INFO] epoch = 90. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep3/ann_model_epoch_90.pickle
 - val_f1: 0.9927
Epoch 92/300
 - 26s - loss: 0.0032 - val_loss: 0.0025
 - val_f1: 0.9949
Epoch 93/300
 - 26s - loss: 0.0032 - val_loss: 0.0056
 - val_f1: 0.9892
Epoch 94/300
 - 26s - loss: 0.0032 - val_loss: 0.0030
 - val_f1: 0.9929
Epoch 95/300
 - 26s - loss: 0.0032 - val_loss: 0.0025
 - val_f1: 0.9942
Epoch 96/300
 - 26s - loss: 0.0032 - val_loss: 0.0040
 - val_f1: 0.9887
Epoch 97/300
 - 26s - loss: 0.0032 - val_loss: 0.0027
 - val_f1: 0.9942
Epoch 98/300
 - 26s - loss: 0.0032 - val_loss: 0.0029
 - val_f1: 0.9927
Epoch 99/300
 - 26s - loss: 0.0032 - val_loss: 0.0034
 - val_f1: 0.9937
Epoch 100/300
 - 26s - loss: 0.0031 - val_loss: 0.0038
 - val_f1: 0.9927
Epoch 101/300
 - 26s - loss: 0.0031 - val_loss: 0.0024
 - val_f1: 0.9954
Epoch 102/300
 - 26s - loss: 0.0031 - val_loss: 0.0029
 - val_f1: 0.9944
Epoch 103/300
 - 26s - loss: 0.0031 - val_loss: 0.0028
 - val_f1: 0.9930
Epoch 104/300
 - 26s - loss: 0.0031 - val_loss: 0.0024
 - val_f1: 0.9952
Epoch 105/300
 - 26s - loss: 0.0031 - val_loss: 0.0027
 - val_f1: 0.9930
Epoch 106/300
 - 26s - loss: 0.0031 - val_loss: 0.0044
 - val_f1: 0.9927
Epoch 107/300
 - 26s - loss: 0.0031 - val_loss: 0.0027
 - val_f1: 0.9945
Epoch 108/300
 - 26s - loss: 0.0031 - val_loss: 0.0026
 - val_f1: 0.9942
Epoch 109/300
 - 26s - loss: 0.0031 - val_loss: 0.0029
 - val_f1: 0.9951
Epoch 110/300
 - 26s - loss: 0.0031 - val_loss: 0.0026
 - val_f1: 0.9942
Epoch 111/300
 - 26s - loss: 0.0030 - val_loss: 0.0031
 - val_f1: 0.9929
Epoch 112/300
 - 26s - loss: 0.0031 - val_loss: 0.0024
 - val_f1: 0.9955
Epoch 113/300
 - 26s - loss: 0.0030 - val_loss: 0.0024
 - val_f1: 0.9956
Epoch 114/300
 - 26s - loss: 0.0030 - val_loss: 0.0024
 - val_f1: 0.9951
Epoch 115/300
 - 26s - loss: 0.0030 - val_loss: 0.0025
 - val_f1: 0.9956
Epoch 116/300
 - 26s - loss: 0.0031 - val_loss: 0.0028
 - val_f1: 0.9939
Epoch 117/300
 - 26s - loss: 0.0031 - val_loss: 0.0033
 - val_f1: 0.9927
Epoch 118/300
 - 26s - loss: 0.0030 - val_loss: 0.0028
 - val_f1: 0.9942
Epoch 119/300
 - 26s - loss: 0.0030 - val_loss: 0.0024
 - val_f1: 0.9954
Epoch 120/300
 - 26s - loss: 0.0031 - val_loss: 0.0025
 - val_f1: 0.9956
Epoch 121/300
 - 26s - loss: 0.0030 - val_loss: 0.0031
2019-12-21 00:04:24,377 [INFO] epoch = 120. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep3/ann_model_epoch_120.pickle
 - val_f1: 0.9942
Epoch 122/300
 - 26s - loss: 0.0031 - val_loss: 0.0038
 - val_f1: 0.9938
Epoch 123/300
 - 26s - loss: 0.0031 - val_loss: 0.0024
 - val_f1: 0.9952
Epoch 124/300
 - 26s - loss: 0.0030 - val_loss: 0.0024
 - val_f1: 0.9952
Epoch 125/300
 - 26s - loss: 0.0030 - val_loss: 0.0023
 - val_f1: 0.9949
Epoch 126/300
 - 26s - loss: 0.0030 - val_loss: 0.0027
 - val_f1: 0.9942
Epoch 127/300
 - 26s - loss: 0.0030 - val_loss: 0.0034
 - val_f1: 0.9931
Epoch 128/300
 - 26s - loss: 0.0030 - val_loss: 0.0031
 - val_f1: 0.9929
Epoch 129/300
 - 26s - loss: 0.0030 - val_loss: 0.0023
 - val_f1: 0.9953
Epoch 130/300
 - 26s - loss: 0.0030 - val_loss: 0.0028
 - val_f1: 0.9931
Epoch 131/300
 - 26s - loss: 0.0030 - val_loss: 0.0024
 - val_f1: 0.9952
Epoch 132/300
 - 26s - loss: 0.0030 - val_loss: 0.0035
 - val_f1: 0.9918
Epoch 133/300
 - 26s - loss: 0.0030 - val_loss: 0.0023
 - val_f1: 0.9956
Epoch 134/300
 - 26s - loss: 0.0030 - val_loss: 0.0029
 - val_f1: 0.9929
Epoch 135/300
 - 26s - loss: 0.0030 - val_loss: 0.0027
 - val_f1: 0.9951
Epoch 136/300
 - 26s - loss: 0.0030 - val_loss: 0.0025
 - val_f1: 0.9945
Epoch 137/300
 - 26s - loss: 0.0029 - val_loss: 0.0031
 - val_f1: 0.9930
Epoch 138/300
 - 26s - loss: 0.0030 - val_loss: 0.0027
 - val_f1: 0.9941
Epoch 139/300
 - 26s - loss: 0.0029 - val_loss: 0.0026
 - val_f1: 0.9952
Epoch 140/300
 - 26s - loss: 0.0030 - val_loss: 0.0023
 - val_f1: 0.9951
Epoch 141/300
 - 26s - loss: 0.0029 - val_loss: 0.0031
 - val_f1: 0.9954
Epoch 142/300
 - 26s - loss: 0.0030 - val_loss: 0.0025
 - val_f1: 0.9947
Epoch 143/300
 - 26s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9949
Epoch 144/300
 - 26s - loss: 0.0029 - val_loss: 0.0028
 - val_f1: 0.9940
Epoch 145/300
 - 26s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9948
Epoch 146/300
 - 26s - loss: 0.0029 - val_loss: 0.0027
 - val_f1: 0.9944
Epoch 147/300
 - 26s - loss: 0.0029 - val_loss: 0.0023
 - val_f1: 0.9958
Epoch 148/300
 - 26s - loss: 0.0029 - val_loss: 0.0027
 - val_f1: 0.9935
Epoch 149/300
 - 26s - loss: 0.0029 - val_loss: 0.0031
 - val_f1: 0.9938
Epoch 150/300
 - 26s - loss: 0.0029 - val_loss: 0.0029
 - val_f1: 0.9932
Epoch 151/300
 - 26s - loss: 0.0029 - val_loss: 0.0029
2019-12-21 00:23:24,635 [INFO] epoch = 150. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep3/ann_model_epoch_150.pickle
 - val_f1: 0.9944
Epoch 152/300
 - 26s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9955
Epoch 153/300
 - 26s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9931
Epoch 154/300
 - 26s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9932
Epoch 155/300
 - 26s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9954
Epoch 156/300
 - 26s - loss: 0.0029 - val_loss: 0.0026
 - val_f1: 0.9942
Epoch 157/300
 - 26s - loss: 0.0029 - val_loss: 0.0026
 - val_f1: 0.9953
Epoch 158/300
 - 26s - loss: 0.0029 - val_loss: 0.0036
 - val_f1: 0.9924
Epoch 159/300
 - 26s - loss: 0.0030 - val_loss: 0.0028
 - val_f1: 0.9943
Epoch 160/300
 - 26s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9960
Epoch 161/300
 - 26s - loss: 0.0028 - val_loss: 0.0027
 - val_f1: 0.9923
Epoch 162/300
 - 26s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9943
Epoch 163/300
 - 26s - loss: 0.0028 - val_loss: 0.0026
 - val_f1: 0.9945
Epoch 164/300
 - 26s - loss: 0.0028 - val_loss: 0.0030
 - val_f1: 0.9930
Epoch 165/300
 - 26s - loss: 0.0029 - val_loss: 0.0029
 - val_f1: 0.9923
Epoch 166/300
 - 26s - loss: 0.0028 - val_loss: 0.0024
 - val_f1: 0.9954
Epoch 167/300
 - 26s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9953
Epoch 168/300
 - 26s - loss: 0.0029 - val_loss: 0.0033
 - val_f1: 0.9956
Epoch 169/300
 - 26s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9945
Epoch 170/300
 - 26s - loss: 0.0030 - val_loss: 0.0030
 - val_f1: 0.9930
Epoch 171/300
 - 26s - loss: 0.0030 - val_loss: 0.0034
 - val_f1: 0.9932
Epoch 172/300
 - 26s - loss: 0.0030 - val_loss: 0.0024
 - val_f1: 0.9953
Epoch 173/300
 - 26s - loss: 0.0030 - val_loss: 0.0028
 - val_f1: 0.9931
Epoch 174/300
 - 26s - loss: 0.0030 - val_loss: 0.0023
 - val_f1: 0.9957
Epoch 175/300
 - 26s - loss: 0.0030 - val_loss: 0.0033
 - val_f1: 0.9944
Epoch 176/300
 - 26s - loss: 0.0030 - val_loss: 0.0028
 - val_f1: 0.9952
Epoch 177/300
 - 26s - loss: 0.0029 - val_loss: 0.0022
 - val_f1: 0.9957
Epoch 178/300
 - 26s - loss: 0.0029 - val_loss: 0.0023
 - val_f1: 0.9956
Epoch 179/300
 - 26s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9957
Epoch 180/300
 - 26s - loss: 0.0030 - val_loss: 0.0039
 - val_f1: 0.9913
Epoch 181/300
 - 26s - loss: 0.0030 - val_loss: 0.0028
2019-12-21 00:42:26,508 [INFO] epoch = 180. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep3/ann_model_epoch_180.pickle
 - val_f1: 0.9950
Epoch 182/300
 - 26s - loss: 0.0029 - val_loss: 0.0023
 - val_f1: 0.9955
Epoch 183/300
 - 26s - loss: 0.0029 - val_loss: 0.0022
 - val_f1: 0.9957
Epoch 184/300
 - 26s - loss: 0.0029 - val_loss: 0.0033
 - val_f1: 0.9923
Epoch 185/300
 - 26s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9957
Epoch 186/300
 - 26s - loss: 0.0030 - val_loss: 0.0023
 - val_f1: 0.9960
Epoch 187/300
 - 26s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9957
Epoch 188/300
 - 26s - loss: 0.0029 - val_loss: 0.0026
 - val_f1: 0.9930
Epoch 189/300
 - 26s - loss: 0.0029 - val_loss: 0.0023
 - val_f1: 0.9960
Epoch 190/300
 - 26s - loss: 0.0029 - val_loss: 0.0031
 - val_f1: 0.9927
Epoch 191/300
 - 26s - loss: 0.0029 - val_loss: 0.0030
 - val_f1: 0.9929
Epoch 192/300
 - 26s - loss: 0.0029 - val_loss: 0.0022
 - val_f1: 0.9953
Epoch 193/300
 - 26s - loss: 0.0029 - val_loss: 0.0023
 - val_f1: 0.9952
Epoch 194/300
 - 26s - loss: 0.0029 - val_loss: 0.0023
 - val_f1: 0.9959
Epoch 195/300
 - 26s - loss: 0.0029 - val_loss: 0.0023
 - val_f1: 0.9953
Epoch 196/300
 - 26s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9937
Epoch 197/300
 - 26s - loss: 0.0028 - val_loss: 0.0034
 - val_f1: 0.9933
Epoch 198/300
 - 26s - loss: 0.0029 - val_loss: 0.0038
 - val_f1: 0.9928
Epoch 199/300
 - 26s - loss: 0.0029 - val_loss: 0.0026
 - val_f1: 0.9953
Epoch 200/300
 - 26s - loss: 0.0029 - val_loss: 0.0023
 - val_f1: 0.9953
Epoch 201/300
 - 26s - loss: 0.0029 - val_loss: 0.0022
 - val_f1: 0.9953
Epoch 202/300
 - 26s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9958
Epoch 203/300
 - 26s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9949
Epoch 204/300
 - 26s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9937
Epoch 205/300
 - 26s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9935
Epoch 206/300
 - 26s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9957
Epoch 207/300
 - 26s - loss: 0.0029 - val_loss: 0.0033
 - val_f1: 0.9930
Epoch 208/300
 - 26s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9956
Epoch 209/300
 - 26s - loss: 0.0029 - val_loss: 0.0033
 - val_f1: 0.9929
Epoch 210/300
 - 26s - loss: 0.0029 - val_loss: 0.0027
 - val_f1: 0.9930
Epoch 211/300
 - 26s - loss: 0.0028 - val_loss: 0.0022
2019-12-21 01:01:27,020 [INFO] epoch = 210. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep3/ann_model_epoch_210.pickle
 - val_f1: 0.9957
Epoch 212/300
 - 26s - loss: 0.0028 - val_loss: 0.0026
 - val_f1: 0.9933
Epoch 213/300
 - 26s - loss: 0.0029 - val_loss: 0.0054
 - val_f1: 0.9878
Epoch 214/300
 - 26s - loss: 0.0029 - val_loss: 0.0026
 - val_f1: 0.9946
Epoch 215/300
 - 26s - loss: 0.0029 - val_loss: 0.0027
 - val_f1: 0.9944
Epoch 216/300
 - 26s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9931
Epoch 217/300
 - 26s - loss: 0.0028 - val_loss: 0.0023
 - val_f1: 0.9950
Epoch 218/300
 - 26s - loss: 0.0029 - val_loss: 0.0026
 - val_f1: 0.9955
Epoch 219/300
 - 26s - loss: 0.0029 - val_loss: 0.0023
 - val_f1: 0.9957
Epoch 220/300
 - 26s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9949
Epoch 221/300
 - 26s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9944
Epoch 222/300
 - 26s - loss: 0.0029 - val_loss: 0.0026
 - val_f1: 0.9931
Epoch 223/300
 - 26s - loss: 0.0028 - val_loss: 0.0023
 - val_f1: 0.9958
Epoch 224/300
 - 26s - loss: 0.0028 - val_loss: 0.0032
 - val_f1: 0.9927
Epoch 225/300
 - 26s - loss: 0.0028 - val_loss: 0.0024
 - val_f1: 0.9934
Epoch 226/300
 - 26s - loss: 0.0028 - val_loss: 0.0025
 - val_f1: 0.9958
Epoch 227/300
 - 26s - loss: 0.0028 - val_loss: 0.0024
2019-12-21 01:11:47,229 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-21 01:12:36,625 [INFO] Last epoch loss evaluation: train_loss = 0.002151, val_loss = 0.002185
2019-12-21 01:12:36,625 [INFO] Training complete. time_to_train = 8692.09 sec, 144.87 min
2019-12-21 01:12:36,629 [INFO] Model saved to results_selected_models/selected_ids2017_ann_shallow_rep3/best_model.pickle
2019-12-21 01:12:36,813 [INFO] Plot saved to: results_selected_models/selected_ids2017_ann_shallow_rep3/training_error_history.png
2019-12-21 01:12:36,972 [INFO] Plot saved to: results_selected_models/selected_ids2017_ann_shallow_rep3/training_f1_history.png
2019-12-21 01:12:36,972 [INFO] Making predictions on training, validation, testing data
2019-12-21 01:13:31,994 [INFO] Evaluating predictions (results)
2019-12-21 01:13:51,932 [INFO] Dataset: Testing. Classification report below
2019-12-21 01:13:51,933 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454265
                   Bot       0.97      0.38      0.55       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       1.00      0.97      0.99      2058
              DoS Hulk       0.98      0.99      0.99     46025
      DoS Slowhttptest       0.89      0.99      0.94      1100
         DoS slowloris       0.99      0.98      0.99      1159
           FTP-Patator       1.00      1.00      1.00      1587
              PortScan       0.99      1.00      1.00     31761
           SSH-Patator       0.96      0.98      0.97      1179
Web Attack Brute Force       1.00      0.10      0.19       302
        Web Attack XSS       0.00      0.00      0.00       130

              accuracy                           1.00    565562
             macro avg       0.90      0.78      0.80    565562
          weighted avg       1.00      1.00      1.00    565562

2019-12-21 01:13:51,933 [INFO] Overall accuracy (micro avg): 0.995591995218915
2019-12-21 01:14:13,345 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9956         0.9956                       0.9956                0.0004                   0.0044  0.9956
1     Macro avg        0.9993         0.8984                       0.7827                0.0011                   0.2173  0.7991
2  Weighted avg        0.9963         0.9954                       0.9956                0.0090                   0.0044  0.9952
2019-12-21 01:14:33,423 [INFO] Dataset: Validation. Classification report below
2019-12-21 01:14:33,423 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454264
                   Bot       0.97      0.36      0.53       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       1.00      0.97      0.98      2059
              DoS Hulk       0.98      0.99      0.99     46025
      DoS Slowhttptest       0.89      0.99      0.94      1099
         DoS slowloris       1.00      0.98      0.99      1159
           FTP-Patator       1.00      1.00      1.00      1587
              PortScan       0.99      1.00      1.00     31761
           SSH-Patator       0.96      0.98      0.97      1180
Web Attack Brute Force       0.91      0.07      0.13       301
        Web Attack XSS       0.80      0.03      0.06       131

              accuracy                           1.00    565562
             macro avg       0.96      0.78      0.80    565562
          weighted avg       1.00      1.00      1.00    565562

2019-12-21 01:14:33,423 [INFO] Overall accuracy (micro avg): 0.9957405200490839
2019-12-21 01:14:55,051 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9957         0.9957                       0.9957                0.0004                   0.0043  0.9957
1     Macro avg        0.9993         0.9583                       0.7794                0.0011                   0.2206  0.7973
2  Weighted avg        0.9965         0.9957                       0.9957                0.0088                   0.0043  0.9953
2019-12-21 01:16:02,041 [INFO] Dataset: Training. Classification report below
2019-12-21 01:16:02,041 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00   1362791
                   Bot       0.98      0.37      0.54      1174
                  DDoS       1.00      1.00      1.00     76815
         DoS GoldenEye       1.00      0.98      0.99      6176
              DoS Hulk       0.98      0.99      0.99    138074
      DoS Slowhttptest       0.91      0.99      0.94      3300
         DoS slowloris       0.99      0.99      0.99      3478
           FTP-Patator       1.00      1.00      1.00      4761
              PortScan       0.99      1.00      1.00     95282
           SSH-Patator       0.97      0.98      0.97      3538
Web Attack Brute Force       0.98      0.09      0.16       904
        Web Attack XSS       0.92      0.03      0.06       391

              accuracy                           1.00   1696684
             macro avg       0.98      0.78      0.80   1696684
          weighted avg       1.00      1.00      1.00   1696684

2019-12-21 01:16:02,041 [INFO] Overall accuracy (micro avg): 0.9958035792168725
2019-12-21 01:17:14,228 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9958         0.9958                       0.9958                0.0004                   0.0042  0.9958
1     Macro avg        0.9993         0.9763                       0.7834                0.0011                   0.2166  0.8024
2  Weighted avg        0.9965         0.9958                       0.9958                0.0088                   0.0042  0.9954
2019-12-21 01:17:14,293 [INFO] Results saved to: results_selected_models/selected_ids2017_ann_shallow_rep3/selected_ids2017_ann_shallow_rep3_results.xlsx
2019-12-21 01:17:14,297 [INFO] ================= Finished running experiment no. 3 ================= 

2019-12-21 01:17:14,341 [INFO] Created directory: results_selected_models/selected_ids2017_ann_shallow_rep4
2019-12-21 01:17:14,341 [INFO] Initialized logging. log_filename = results_selected_models/selected_ids2017_ann_shallow_rep4/run_log.log
2019-12-21 01:17:14,341 [INFO] ================= Running experiment no. 4  ================= 

2019-12-21 01:17:14,342 [INFO] Experiment parameters given below
2019-12-21 01:17:14,342 [INFO] 
{'experiment_num': 4, 'results_dir': 'results_selected_models/selected_ids2017_ann_shallow_rep4', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 300, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/full_datasets/ids2017', 'description': 'selected_ids2017_ann_shallow_rep4'}
2019-12-21 01:17:14,342 [INFO] Created tensorboard log directory: results_selected_models/selected_ids2017_ann_shallow_rep4/tf_logs_run_2019_12_21-01_17_14
2019-12-21 01:17:14,342 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2017
2019-12-21 01:17:14,342 [INFO] Reading X, y files
2019-12-21 01:17:14,342 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_train.h5
2019-12-21 01:17:18,108 [INFO] Reading complete. time_to_read=3.77 seconds
2019-12-21 01:17:18,108 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_val.h5
2019-12-21 01:17:19,398 [INFO] Reading complete. time_to_read=1.29 seconds
2019-12-21 01:17:19,398 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_test.h5
2019-12-21 01:17:20,694 [INFO] Reading complete. time_to_read=1.30 seconds
2019-12-21 01:17:20,694 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_train.h5
2019-12-21 01:17:20,965 [INFO] Reading complete. time_to_read=0.27 seconds
2019-12-21 01:17:20,965 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_val.h5
2019-12-21 01:17:21,055 [INFO] Reading complete. time_to_read=0.09 seconds
2019-12-21 01:17:21,055 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_test.h5
2019-12-21 01:17:21,156 [INFO] Reading complete. time_to_read=0.10 seconds
2019-12-21 01:17:24,188 [INFO] Initializing model
2019-12-21 01:17:24,314 [INFO] _________________________________________________________________
2019-12-21 01:17:24,314 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-21 01:17:24,314 [INFO] =================================================================
2019-12-21 01:17:24,314 [INFO] dense_17 (Dense)             (None, 64)                5056      
2019-12-21 01:17:24,314 [INFO] _________________________________________________________________
2019-12-21 01:17:24,314 [INFO] batch_normalization_9 (Batch (None, 64)                256       
2019-12-21 01:17:24,314 [INFO] _________________________________________________________________
2019-12-21 01:17:24,314 [INFO] dropout_9 (Dropout)          (None, 64)                0         
2019-12-21 01:17:24,314 [INFO] _________________________________________________________________
2019-12-21 01:17:24,314 [INFO] dense_18 (Dense)             (None, 12)                780       
2019-12-21 01:17:24,314 [INFO] =================================================================
2019-12-21 01:17:24,315 [INFO] Total params: 6,092
2019-12-21 01:17:24,315 [INFO] Trainable params: 5,964
2019-12-21 01:17:24,315 [INFO] Non-trainable params: 128
2019-12-21 01:17:24,315 [INFO] _________________________________________________________________
2019-12-21 01:17:24,315 [INFO] Training model
 - val_f1: 0.9952
Epoch 00227: early stopping
Train on 1696684 samples, validate on 565562 samples
Epoch 1/300
 - 27s - loss: 0.0188 - val_loss: 0.0101
 - val_f1: 0.9758
Epoch 2/300
 - 27s - loss: 0.0095 - val_loss: 0.0081
 - val_f1: 0.9788
Epoch 3/300
 - 27s - loss: 0.0071 - val_loss: 0.0081
 - val_f1: 0.9852
Epoch 4/300
 - 26s - loss: 0.0061 - val_loss: 0.0075
 - val_f1: 0.9811
Epoch 5/300
 - 27s - loss: 0.0058 - val_loss: 0.0052
 - val_f1: 0.9902
Epoch 6/300
 - 27s - loss: 0.0055 - val_loss: 0.0080
 - val_f1: 0.9811
Epoch 7/300
 - 26s - loss: 0.0052 - val_loss: 0.0041
 - val_f1: 0.9900
Epoch 8/300
 - 27s - loss: 0.0051 - val_loss: 0.0047
 - val_f1: 0.9903
Epoch 9/300
 - 27s - loss: 0.0049 - val_loss: 0.0041
 - val_f1: 0.9932
Epoch 10/300
 - 26s - loss: 0.0048 - val_loss: 0.0069
 - val_f1: 0.9796
Epoch 11/300
 - 26s - loss: 0.0046 - val_loss: 0.0049
 - val_f1: 0.9908
Epoch 12/300
 - 26s - loss: 0.0046 - val_loss: 0.0038
 - val_f1: 0.9917
Epoch 13/300
 - 27s - loss: 0.0045 - val_loss: 0.0036
 - val_f1: 0.9937
Epoch 14/300
 - 27s - loss: 0.0043 - val_loss: 0.0062
 - val_f1: 0.9833
Epoch 15/300
 - 26s - loss: 0.0043 - val_loss: 0.0042
 - val_f1: 0.9907
Epoch 16/300
 - 26s - loss: 0.0042 - val_loss: 0.0033
 - val_f1: 0.9944
Epoch 17/300
 - 26s - loss: 0.0042 - val_loss: 0.0055
 - val_f1: 0.9890
Epoch 18/300
 - 27s - loss: 0.0042 - val_loss: 0.0044
 - val_f1: 0.9912
Epoch 19/300
 - 26s - loss: 0.0042 - val_loss: 0.0031
 - val_f1: 0.9933
Epoch 20/300
 - 27s - loss: 0.0042 - val_loss: 0.0031
 - val_f1: 0.9938
Epoch 21/300
 - 26s - loss: 0.0042 - val_loss: 0.0036
 - val_f1: 0.9942
Epoch 22/300
 - 27s - loss: 0.0040 - val_loss: 0.0051
 - val_f1: 0.9892
Epoch 23/300
 - 26s - loss: 0.0040 - val_loss: 0.0038
 - val_f1: 0.9928
Epoch 24/300
 - 27s - loss: 0.0040 - val_loss: 0.0032
 - val_f1: 0.9941
Epoch 25/300
 - 26s - loss: 0.0040 - val_loss: 0.0035
 - val_f1: 0.9931
Epoch 26/300
 - 26s - loss: 0.0039 - val_loss: 0.0072
 - val_f1: 0.9804
Epoch 27/300
 - 26s - loss: 0.0039 - val_loss: 0.0040
 - val_f1: 0.9922
Epoch 28/300
 - 26s - loss: 0.0039 - val_loss: 0.0040
 - val_f1: 0.9921
Epoch 29/300
 - 26s - loss: 0.0039 - val_loss: 0.0033
 - val_f1: 0.9924
Epoch 30/300
 - 26s - loss: 0.0038 - val_loss: 0.0040
 - val_f1: 0.9920
Epoch 31/300
 - 27s - loss: 0.0038 - val_loss: 0.0091
2019-12-21 01:37:15,425 [INFO] epoch = 30. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep4/ann_model_epoch_30.pickle
 - val_f1: 0.9657
Epoch 32/300
 - 26s - loss: 0.0038 - val_loss: 0.0033
 - val_f1: 0.9934
Epoch 33/300
 - 26s - loss: 0.0038 - val_loss: 0.0037
 - val_f1: 0.9918
Epoch 34/300
 - 27s - loss: 0.0037 - val_loss: 0.0045
 - val_f1: 0.9912
Epoch 35/300
 - 26s - loss: 0.0037 - val_loss: 0.0040
 - val_f1: 0.9918
Epoch 36/300
 - 26s - loss: 0.0037 - val_loss: 0.0033
 - val_f1: 0.9923
Epoch 37/300
 - 27s - loss: 0.0037 - val_loss: 0.0027
 - val_f1: 0.9949
Epoch 38/300
 - 26s - loss: 0.0037 - val_loss: 0.0029
 - val_f1: 0.9928
Epoch 39/300
 - 27s - loss: 0.0036 - val_loss: 0.0068
 - val_f1: 0.9770
Epoch 40/300
 - 26s - loss: 0.0036 - val_loss: 0.0039
 - val_f1: 0.9917
Epoch 41/300
 - 26s - loss: 0.0036 - val_loss: 0.0029
 - val_f1: 0.9947
Epoch 42/300
 - 26s - loss: 0.0037 - val_loss: 0.0029
 - val_f1: 0.9945
Epoch 43/300
 - 26s - loss: 0.0036 - val_loss: 0.0030
 - val_f1: 0.9949
Epoch 44/300
 - 26s - loss: 0.0036 - val_loss: 0.0030
 - val_f1: 0.9928
Epoch 45/300
 - 26s - loss: 0.0036 - val_loss: 0.0026
 - val_f1: 0.9948
Epoch 46/300
 - 26s - loss: 0.0036 - val_loss: 0.0030
 - val_f1: 0.9937
Epoch 47/300
 - 26s - loss: 0.0036 - val_loss: 0.0028
 - val_f1: 0.9929
Epoch 48/300
 - 27s - loss: 0.0036 - val_loss: 0.0026
 - val_f1: 0.9949
Epoch 49/300
 - 26s - loss: 0.0036 - val_loss: 0.0038
 - val_f1: 0.9916
Epoch 50/300
 - 27s - loss: 0.0035 - val_loss: 0.0029
 - val_f1: 0.9927
Epoch 51/300
 - 27s - loss: 0.0035 - val_loss: 0.0026
 - val_f1: 0.9950
Epoch 52/300
 - 26s - loss: 0.0035 - val_loss: 0.0032
 - val_f1: 0.9925
Epoch 53/300
 - 27s - loss: 0.0036 - val_loss: 0.0027
 - val_f1: 0.9951
Epoch 54/300
 - 27s - loss: 0.0035 - val_loss: 0.0045
 - val_f1: 0.9914
Epoch 55/300
 - 26s - loss: 0.0035 - val_loss: 0.0071
 - val_f1: 0.9891
Epoch 56/300
 - 27s - loss: 0.0035 - val_loss: 0.0026
 - val_f1: 0.9952
Epoch 57/300
 - 27s - loss: 0.0035 - val_loss: 0.0033
 - val_f1: 0.9927
Epoch 58/300
 - 27s - loss: 0.0035 - val_loss: 0.0027
 - val_f1: 0.9949
Epoch 59/300
 - 27s - loss: 0.0035 - val_loss: 0.0034
 - val_f1: 0.9925
Epoch 60/300
 - 26s - loss: 0.0035 - val_loss: 0.0050
 - val_f1: 0.9919
Epoch 61/300
 - 26s - loss: 0.0035 - val_loss: 0.0032
2019-12-21 01:56:36,591 [INFO] epoch = 60. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep4/ann_model_epoch_60.pickle
 - val_f1: 0.9944
Epoch 62/300
 - 27s - loss: 0.0034 - val_loss: 0.0031
 - val_f1: 0.9925
Epoch 63/300
 - 26s - loss: 0.0035 - val_loss: 0.0028
 - val_f1: 0.9943
Epoch 64/300
 - 26s - loss: 0.0034 - val_loss: 0.0042
 - val_f1: 0.9932
Epoch 65/300
 - 26s - loss: 0.0034 - val_loss: 0.0031
 - val_f1: 0.9937
Epoch 66/300
 - 27s - loss: 0.0034 - val_loss: 0.0027
 - val_f1: 0.9945
Epoch 67/300
 - 27s - loss: 0.0034 - val_loss: 0.0026
 - val_f1: 0.9942
Epoch 68/300
 - 26s - loss: 0.0034 - val_loss: 0.0032
 - val_f1: 0.9946
Epoch 69/300
 - 26s - loss: 0.0033 - val_loss: 0.0031
 - val_f1: 0.9926
Epoch 70/300
 - 26s - loss: 0.0033 - val_loss: 0.0027
 - val_f1: 0.9948
Epoch 71/300
 - 27s - loss: 0.0033 - val_loss: 0.0034
 - val_f1: 0.9926
Epoch 72/300
 - 27s - loss: 0.0033 - val_loss: 0.0027
 - val_f1: 0.9929
Epoch 73/300
 - 27s - loss: 0.0033 - val_loss: 0.0038
 - val_f1: 0.9925
Epoch 74/300
 - 27s - loss: 0.0033 - val_loss: 0.0025
 - val_f1: 0.9948
Epoch 75/300
 - 27s - loss: 0.0033 - val_loss: 0.0041
 - val_f1: 0.9922
Epoch 76/300
 - 27s - loss: 0.0033 - val_loss: 0.0026
 - val_f1: 0.9952
Epoch 77/300
 - 27s - loss: 0.0033 - val_loss: 0.0028
 - val_f1: 0.9951
Epoch 78/300
 - 27s - loss: 0.0033 - val_loss: 0.0055
 - val_f1: 0.9903
Epoch 79/300
 - 27s - loss: 0.0032 - val_loss: 0.0034
 - val_f1: 0.9925
Epoch 80/300
 - 26s - loss: 0.0033 - val_loss: 0.0033
 - val_f1: 0.9923
Epoch 81/300
 - 27s - loss: 0.0032 - val_loss: 0.0026
 - val_f1: 0.9942
Epoch 82/300
 - 26s - loss: 0.0032 - val_loss: 0.0029
 - val_f1: 0.9930
Epoch 83/300
 - 26s - loss: 0.0032 - val_loss: 0.0027
 - val_f1: 0.9929
Epoch 84/300
 - 27s - loss: 0.0032 - val_loss: 0.0026
 - val_f1: 0.9948
Epoch 85/300
 - 27s - loss: 0.0032 - val_loss: 0.0026
 - val_f1: 0.9953
Epoch 86/300
 - 26s - loss: 0.0032 - val_loss: 0.0030
 - val_f1: 0.9938
Epoch 87/300
 - 27s - loss: 0.0032 - val_loss: 0.0029
 - val_f1: 0.9951
Epoch 88/300
 - 26s - loss: 0.0032 - val_loss: 0.0026
 - val_f1: 0.9951
Epoch 89/300
 - 26s - loss: 0.0032 - val_loss: 0.0029
 - val_f1: 0.9929
Epoch 90/300
 - 26s - loss: 0.0032 - val_loss: 0.0033
 - val_f1: 0.9937
Epoch 91/300
 - 26s - loss: 0.0032 - val_loss: 0.0032
2019-12-21 02:15:59,119 [INFO] epoch = 90. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep4/ann_model_epoch_90.pickle
 - val_f1: 0.9928
Epoch 92/300
 - 26s - loss: 0.0032 - val_loss: 0.0033
 - val_f1: 0.9924
Epoch 93/300
 - 27s - loss: 0.0032 - val_loss: 0.0029
 - val_f1: 0.9941
Epoch 94/300
 - 26s - loss: 0.0032 - val_loss: 0.0031
 - val_f1: 0.9929
Epoch 95/300
 - 27s - loss: 0.0032 - val_loss: 0.0027
 - val_f1: 0.9956
Epoch 96/300
 - 27s - loss: 0.0032 - val_loss: 0.0033
 - val_f1: 0.9929
Epoch 97/300
 - 27s - loss: 0.0031 - val_loss: 0.0032
 - val_f1: 0.9938
Epoch 98/300
 - 26s - loss: 0.0032 - val_loss: 0.0028
 - val_f1: 0.9931
Epoch 99/300
 - 27s - loss: 0.0032 - val_loss: 0.0028
 - val_f1: 0.9949
Epoch 100/300
 - 26s - loss: 0.0032 - val_loss: 0.0028
 - val_f1: 0.9940
Epoch 101/300
 - 27s - loss: 0.0032 - val_loss: 0.0036
 - val_f1: 0.9926
Epoch 102/300
 - 26s - loss: 0.0032 - val_loss: 0.0028
 - val_f1: 0.9951
Epoch 103/300
 - 26s - loss: 0.0031 - val_loss: 0.0038
 - val_f1: 0.9917
Epoch 104/300
 - 26s - loss: 0.0032 - val_loss: 0.0025
 - val_f1: 0.9955
Epoch 105/300
 - 26s - loss: 0.0032 - val_loss: 0.0027
 - val_f1: 0.9942
Epoch 106/300
 - 26s - loss: 0.0032 - val_loss: 0.0025
 - val_f1: 0.9932
Epoch 107/300
 - 27s - loss: 0.0031 - val_loss: 0.0033
 - val_f1: 0.9922
Epoch 108/300
 - 27s - loss: 0.0031 - val_loss: 0.0034
 - val_f1: 0.9937
Epoch 109/300
 - 26s - loss: 0.0031 - val_loss: 0.0024
 - val_f1: 0.9954
Epoch 110/300
 - 26s - loss: 0.0031 - val_loss: 0.0049
 - val_f1: 0.9896
Epoch 111/300
 - 26s - loss: 0.0031 - val_loss: 0.0026
 - val_f1: 0.9954
Epoch 112/300
 - 27s - loss: 0.0031 - val_loss: 0.0031
 - val_f1: 0.9927
Epoch 113/300
 - 26s - loss: 0.0032 - val_loss: 0.0027
 - val_f1: 0.9941
Epoch 114/300
 - 27s - loss: 0.0031 - val_loss: 0.0025
 - val_f1: 0.9955
Epoch 115/300
 - 27s - loss: 0.0031 - val_loss: 0.0025
 - val_f1: 0.9947
Epoch 116/300
 - 26s - loss: 0.0031 - val_loss: 0.0032
 - val_f1: 0.9929
Epoch 117/300
 - 26s - loss: 0.0031 - val_loss: 0.0030
 - val_f1: 0.9949
Epoch 118/300
 - 27s - loss: 0.0031 - val_loss: 0.0029
 - val_f1: 0.9943
Epoch 119/300
 - 26s - loss: 0.0031 - val_loss: 0.0032
 - val_f1: 0.9927
Epoch 120/300
 - 27s - loss: 0.0031 - val_loss: 0.0030
 - val_f1: 0.9930
Epoch 121/300
 - 27s - loss: 0.0031 - val_loss: 0.0032
2019-12-21 02:35:19,693 [INFO] epoch = 120. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep4/ann_model_epoch_120.pickle
 - val_f1: 0.9928
Epoch 122/300
 - 27s - loss: 0.0031 - val_loss: 0.0026
 - val_f1: 0.9949
Epoch 123/300
 - 27s - loss: 0.0033 - val_loss: 0.0024
 - val_f1: 0.9954
Epoch 124/300
 - 26s - loss: 0.0032 - val_loss: 0.0032
 - val_f1: 0.9939
Epoch 125/300
 - 26s - loss: 0.0032 - val_loss: 0.0027
 - val_f1: 0.9952
Epoch 126/300
 - 26s - loss: 0.0032 - val_loss: 0.0025
 - val_f1: 0.9954
Epoch 127/300
 - 27s - loss: 0.0031 - val_loss: 0.0066
 - val_f1: 0.9780
Epoch 128/300
 - 26s - loss: 0.0032 - val_loss: 0.0028
 - val_f1: 0.9939
Epoch 129/300
 - 27s - loss: 0.0032 - val_loss: 0.0032
 - val_f1: 0.9942
Epoch 130/300
 - 27s - loss: 0.0032 - val_loss: 0.0026
 - val_f1: 0.9954
Epoch 131/300
 - 26s - loss: 0.0032 - val_loss: 0.0027
 - val_f1: 0.9945
Epoch 132/300
 - 26s - loss: 0.0032 - val_loss: 0.0032
 - val_f1: 0.9955
Epoch 133/300
 - 26s - loss: 0.0031 - val_loss: 0.0025
 - val_f1: 0.9947
Epoch 134/300
 - 26s - loss: 0.0032 - val_loss: 0.0030
 - val_f1: 0.9925
Epoch 135/300
 - 26s - loss: 0.0032 - val_loss: 0.0045
 - val_f1: 0.9934
Epoch 136/300
 - 26s - loss: 0.0031 - val_loss: 0.0024
 - val_f1: 0.9956
Epoch 137/300
 - 27s - loss: 0.0031 - val_loss: 0.0032
 - val_f1: 0.9928
Epoch 138/300
 - 27s - loss: 0.0033 - val_loss: 0.0028
 - val_f1: 0.9954
Epoch 139/300
 - 26s - loss: 0.0033 - val_loss: 0.0030
 - val_f1: 0.9952
Epoch 140/300
 - 27s - loss: 0.0033 - val_loss: 0.0025
 - val_f1: 0.9955
Epoch 141/300
 - 26s - loss: 0.0033 - val_loss: 0.0031
 - val_f1: 0.9929
Epoch 142/300
 - 26s - loss: 0.0032 - val_loss: 0.0023
 - val_f1: 0.9951
Epoch 143/300
 - 27s - loss: 0.0031 - val_loss: 0.0063
 - val_f1: 0.9760
Epoch 144/300
 - 26s - loss: 0.0031 - val_loss: 0.0026
 - val_f1: 0.9953
Epoch 145/300
 - 26s - loss: 0.0032 - val_loss: 0.0026
 - val_f1: 0.9957
Epoch 146/300
 - 27s - loss: 0.0031 - val_loss: 0.0023
 - val_f1: 0.9953
Epoch 147/300
 - 27s - loss: 0.0031 - val_loss: 0.0044
 - val_f1: 0.9918
Epoch 148/300
 - 26s - loss: 0.0031 - val_loss: 0.0041
 - val_f1: 0.9942
Epoch 149/300
 - 26s - loss: 0.0031 - val_loss: 0.0025
 - val_f1: 0.9942
Epoch 150/300
 - 26s - loss: 0.0031 - val_loss: 0.0029
 - val_f1: 0.9927
Epoch 151/300
 - 26s - loss: 0.0031 - val_loss: 0.0025
2019-12-21 02:54:40,691 [INFO] epoch = 150. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep4/ann_model_epoch_150.pickle
 - val_f1: 0.9954
Epoch 152/300
 - 27s - loss: 0.0031 - val_loss: 0.0025
 - val_f1: 0.9952
Epoch 153/300
 - 27s - loss: 0.0031 - val_loss: 0.0029
 - val_f1: 0.9931
Epoch 154/300
 - 27s - loss: 0.0030 - val_loss: 0.0029
 - val_f1: 0.9953
Epoch 155/300
 - 27s - loss: 0.0030 - val_loss: 0.0027
 - val_f1: 0.9953
Epoch 156/300
 - 26s - loss: 0.0030 - val_loss: 0.0026
 - val_f1: 0.9931
Epoch 157/300
 - 27s - loss: 0.0031 - val_loss: 0.0025
 - val_f1: 0.9959
Epoch 158/300
 - 26s - loss: 0.0030 - val_loss: 0.0023
 - val_f1: 0.9954
Epoch 159/300
 - 26s - loss: 0.0030 - val_loss: 0.0027
 - val_f1: 0.9944
Epoch 160/300
 - 26s - loss: 0.0030 - val_loss: 0.0024
 - val_f1: 0.9953
Epoch 161/300
 - 26s - loss: 0.0031 - val_loss: 0.0025
 - val_f1: 0.9944
Epoch 162/300
 - 26s - loss: 0.0030 - val_loss: 0.0026
 - val_f1: 0.9943
Epoch 163/300
 - 27s - loss: 0.0030 - val_loss: 0.0029
 - val_f1: 0.9928
Epoch 164/300
 - 27s - loss: 0.0030 - val_loss: 0.0034
 - val_f1: 0.9937
Epoch 165/300
 - 27s - loss: 0.0030 - val_loss: 0.0024
 - val_f1: 0.9957
Epoch 166/300
 - 27s - loss: 0.0030 - val_loss: 0.0025
 - val_f1: 0.9927
Epoch 167/300
 - 26s - loss: 0.0031 - val_loss: 0.0031
 - val_f1: 0.9941
Epoch 168/300
 - 27s - loss: 0.0031 - val_loss: 0.0033
 - val_f1: 0.9913
Epoch 169/300
 - 26s - loss: 0.0030 - val_loss: 0.0026
 - val_f1: 0.9953
Epoch 170/300
 - 27s - loss: 0.0030 - val_loss: 0.0024
 - val_f1: 0.9953
Epoch 171/300
 - 26s - loss: 0.0029 - val_loss: 0.0027
 - val_f1: 0.9934
Epoch 172/300
 - 27s - loss: 0.0030 - val_loss: 0.0023
 - val_f1: 0.9956
Epoch 173/300
 - 27s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9949
Epoch 174/300
 - 26s - loss: 0.0029 - val_loss: 0.0034
 - val_f1: 0.9921
Epoch 175/300
 - 27s - loss: 0.0030 - val_loss: 0.0026
 - val_f1: 0.9942
Epoch 176/300
 - 26s - loss: 0.0030 - val_loss: 0.0033
 - val_f1: 0.9929
Epoch 177/300
 - 27s - loss: 0.0031 - val_loss: 0.0045
 - val_f1: 0.9938
Epoch 178/300
 - 27s - loss: 0.0030 - val_loss: 0.0029
 - val_f1: 0.9944
Epoch 179/300
 - 27s - loss: 0.0031 - val_loss: 0.0032
 - val_f1: 0.9926
Epoch 180/300
 - 27s - loss: 0.0031 - val_loss: 0.0027
 - val_f1: 0.9932
Epoch 181/300
 - 26s - loss: 0.0031 - val_loss: 0.0024
2019-12-21 03:14:03,008 [INFO] epoch = 180. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep4/ann_model_epoch_180.pickle
 - val_f1: 0.9953
Epoch 182/300
 - 26s - loss: 0.0031 - val_loss: 0.0026
 - val_f1: 0.9943
Epoch 183/300
 - 26s - loss: 0.0030 - val_loss: 0.0025
 - val_f1: 0.9945
Epoch 184/300
 - 27s - loss: 0.0031 - val_loss: 0.0023
 - val_f1: 0.9956
Epoch 185/300
 - 26s - loss: 0.0030 - val_loss: 0.0027
 - val_f1: 0.9928
Epoch 186/300
 - 27s - loss: 0.0031 - val_loss: 0.0026
 - val_f1: 0.9955
Epoch 187/300
 - 26s - loss: 0.0031 - val_loss: 0.0043
 - val_f1: 0.9905
Epoch 188/300
 - 26s - loss: 0.0030 - val_loss: 0.0029
 - val_f1: 0.9930
Epoch 189/300
 - 26s - loss: 0.0030 - val_loss: 0.0025
 - val_f1: 0.9933
Epoch 190/300
 - 27s - loss: 0.0030 - val_loss: 0.0029
 - val_f1: 0.9944
Epoch 191/300
 - 27s - loss: 0.0030 - val_loss: 0.0031
 - val_f1: 0.9929
Epoch 192/300
 - 26s - loss: 0.0030 - val_loss: 0.0027
 - val_f1: 0.9930
Epoch 193/300
 - 27s - loss: 0.0030 - val_loss: 0.0063
 - val_f1: 0.9918
Epoch 194/300
 - 26s - loss: 0.0029 - val_loss: 0.0045
 - val_f1: 0.9931
Epoch 195/300
 - 27s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9948
Epoch 196/300
 - 27s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9953
Epoch 197/300
 - 26s - loss: 0.0029 - val_loss: 0.0033
 - val_f1: 0.9929
Epoch 198/300
 - 26s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9932
Epoch 199/300
 - 26s - loss: 0.0029 - val_loss: 0.0023
 - val_f1: 0.9954
Epoch 200/300
 - 27s - loss: 0.0029 - val_loss: 0.0023
 - val_f1: 0.9956
Epoch 201/300
 - 27s - loss: 0.0029 - val_loss: 0.0023
 - val_f1: 0.9948
Epoch 202/300
 - 26s - loss: 0.0029 - val_loss: 0.0023
 - val_f1: 0.9955
Epoch 203/300
 - 27s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9944
Epoch 204/300
 - 26s - loss: 0.0031 - val_loss: 0.0026
 - val_f1: 0.9958
Epoch 205/300
 - 26s - loss: 0.0030 - val_loss: 0.0035
 - val_f1: 0.9926
Epoch 206/300
 - 27s - loss: 0.0030 - val_loss: 0.0025
 - val_f1: 0.9956
Epoch 207/300
 - 26s - loss: 0.0031 - val_loss: 0.0023
 - val_f1: 0.9960
Epoch 208/300
 - 27s - loss: 0.0030 - val_loss: 0.0026
 - val_f1: 0.9955
Epoch 209/300
 - 26s - loss: 0.0030 - val_loss: 0.0025
 - val_f1: 0.9946
Epoch 210/300
 - 27s - loss: 0.0029 - val_loss: 0.0029
 - val_f1: 0.9929
Epoch 211/300
 - 27s - loss: 0.0030 - val_loss: 0.0024
2019-12-21 03:33:24,370 [INFO] epoch = 210. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep4/ann_model_epoch_210.pickle
 - val_f1: 0.9956
Epoch 212/300
 - 26s - loss: 0.0030 - val_loss: 0.0026
 - val_f1: 0.9936
Epoch 213/300
 - 26s - loss: 0.0029 - val_loss: 0.0032
 - val_f1: 0.9944
Epoch 214/300
 - 27s - loss: 0.0029 - val_loss: 0.0023
 - val_f1: 0.9957
Epoch 215/300
 - 27s - loss: 0.0030 - val_loss: 0.0024
 - val_f1: 0.9955
Epoch 216/300
 - 27s - loss: 0.0030 - val_loss: 0.0025
 - val_f1: 0.9956
Epoch 217/300
 - 27s - loss: 0.0029 - val_loss: 0.0028
 - val_f1: 0.9929
Epoch 218/300
 - 26s - loss: 0.0029 - val_loss: 0.0026
 - val_f1: 0.9931
Epoch 219/300
 - 27s - loss: 0.0030 - val_loss: 0.0034
 - val_f1: 0.9944
Epoch 220/300
 - 27s - loss: 0.0030 - val_loss: 0.0024
 - val_f1: 0.9951
Epoch 221/300
 - 26s - loss: 0.0030 - val_loss: 0.0023
 - val_f1: 0.9955
Epoch 222/300
 - 26s - loss: 0.0029 - val_loss: 0.0027
 - val_f1: 0.9930
Epoch 223/300
 - 26s - loss: 0.0031 - val_loss: 0.0024
 - val_f1: 0.9950
Epoch 224/300
 - 27s - loss: 0.0031 - val_loss: 0.0035
 - val_f1: 0.9932
Epoch 225/300
 - 27s - loss: 0.0030 - val_loss: 0.0027
 - val_f1: 0.9934
Epoch 226/300
 - 26s - loss: 0.0030 - val_loss: 0.0031
 - val_f1: 0.9921
Epoch 227/300
 - 26s - loss: 0.0030 - val_loss: 0.0025
 - val_f1: 0.9946
Epoch 228/300
 - 27s - loss: 0.0030 - val_loss: 0.0028
 - val_f1: 0.9945
Epoch 229/300
 - 27s - loss: 0.0029 - val_loss: 0.0028
 - val_f1: 0.9943
Epoch 230/300
 - 26s - loss: 0.0030 - val_loss: 0.0025
 - val_f1: 0.9956
Epoch 231/300
 - 27s - loss: 0.0030 - val_loss: 0.0023
 - val_f1: 0.9958
Epoch 232/300
 - 26s - loss: 0.0030 - val_loss: 0.0024
 - val_f1: 0.9945
Epoch 233/300
 - 27s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9952
Epoch 234/300
 - 27s - loss: 0.0030 - val_loss: 0.0037
 - val_f1: 0.9949
Epoch 235/300
 - 27s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9957
Epoch 236/300
 - 26s - loss: 0.0029 - val_loss: 0.0026
 - val_f1: 0.9933
Epoch 237/300
 - 27s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9959
Epoch 238/300
 - 26s - loss: 0.0029 - val_loss: 0.0023
 - val_f1: 0.9949
Epoch 239/300
 - 26s - loss: 0.0031 - val_loss: 0.0026
 - val_f1: 0.9947
Epoch 240/300
 - 26s - loss: 0.0030 - val_loss: 0.0023
 - val_f1: 0.9955
Epoch 241/300
 - 27s - loss: 0.0030 - val_loss: 0.0041
2019-12-21 03:52:46,193 [INFO] epoch = 240. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep4/ann_model_epoch_240.pickle
 - val_f1: 0.9925
Epoch 242/300
 - 27s - loss: 0.0030 - val_loss: 0.0025
 - val_f1: 0.9933
Epoch 243/300
 - 26s - loss: 0.0030 - val_loss: 0.0025
 - val_f1: 0.9947
Epoch 244/300
 - 26s - loss: 0.0029 - val_loss: 0.0022
 - val_f1: 0.9957
Epoch 245/300
 - 27s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9954
Epoch 246/300
 - 26s - loss: 0.0029 - val_loss: 0.0035
 - val_f1: 0.9928
Epoch 247/300
 - 26s - loss: 0.0029 - val_loss: 0.0027
 - val_f1: 0.9936
Epoch 248/300
 - 26s - loss: 0.0029 - val_loss: 0.0023
 - val_f1: 0.9945
Epoch 249/300
 - 26s - loss: 0.0030 - val_loss: 0.0025
 - val_f1: 0.9931
Epoch 250/300
 - 27s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9945
Epoch 251/300
 - 26s - loss: 0.0029 - val_loss: 0.0023
 - val_f1: 0.9957
Epoch 252/300
 - 27s - loss: 0.0029 - val_loss: 0.0022
 - val_f1: 0.9957
Epoch 253/300
 - 26s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9955
Epoch 254/300
 - 27s - loss: 0.0030 - val_loss: 0.0028
 - val_f1: 0.9953
Epoch 255/300
 - 26s - loss: 0.0030 - val_loss: 0.0030
 - val_f1: 0.9944
Epoch 256/300
 - 27s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9948
Epoch 257/300
 - 27s - loss: 0.0029 - val_loss: 0.0039
 - val_f1: 0.9916
Epoch 258/300
 - 27s - loss: 0.0029 - val_loss: 0.0027
 - val_f1: 0.9932
Epoch 259/300
 - 27s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9937
Epoch 260/300
 - 26s - loss: 0.0030 - val_loss: 0.0027
 - val_f1: 0.9943
Epoch 261/300
 - 26s - loss: 0.0029 - val_loss: 0.0023
 - val_f1: 0.9954
Epoch 262/300
 - 27s - loss: 0.0030 - val_loss: 0.0039
 - val_f1: 0.9927
Epoch 263/300
 - 27s - loss: 0.0029 - val_loss: 0.0039
 - val_f1: 0.9943
Epoch 264/300
 - 26s - loss: 0.0029 - val_loss: 0.0026
 - val_f1: 0.9945
Epoch 265/300
 - 26s - loss: 0.0029 - val_loss: 0.0028
 - val_f1: 0.9944
Epoch 266/300
 - 26s - loss: 0.0029 - val_loss: 0.0029
 - val_f1: 0.9945
Epoch 267/300
 - 26s - loss: 0.0029 - val_loss: 0.0059
 - val_f1: 0.9806
Epoch 268/300
 - 26s - loss: 0.0029 - val_loss: 0.0023
 - val_f1: 0.9958
Epoch 269/300
 - 26s - loss: 0.0028 - val_loss: 0.0027
 - val_f1: 0.9935
Epoch 270/300
 - 27s - loss: 0.0028 - val_loss: 0.0026
 - val_f1: 0.9933
Epoch 271/300
 - 26s - loss: 0.0029 - val_loss: 0.0030
2019-12-21 04:12:07,198 [INFO] epoch = 270. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep4/ann_model_epoch_270.pickle
 - val_f1: 0.9930
Epoch 272/300
 - 26s - loss: 0.0029 - val_loss: 0.0028
 - val_f1: 0.9944
Epoch 273/300
 - 26s - loss: 0.0029 - val_loss: 0.0026
 - val_f1: 0.9933
Epoch 274/300
 - 26s - loss: 0.0029 - val_loss: 0.0027
 - val_f1: 0.9931
Epoch 275/300
 - 27s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9951
Epoch 276/300
 - 27s - loss: 0.0029 - val_loss: 0.0026
 - val_f1: 0.9957
Epoch 277/300
 - 26s - loss: 0.0028 - val_loss: 0.0028
 - val_f1: 0.9945
Epoch 278/300
 - 26s - loss: 0.0028 - val_loss: 0.0027
 - val_f1: 0.9956
Epoch 279/300
 - 26s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9952
Epoch 280/300
 - 26s - loss: 0.0028 - val_loss: 0.0027
 - val_f1: 0.9932
Epoch 281/300
 - 27s - loss: 0.0029 - val_loss: 0.0032
 - val_f1: 0.9928
Epoch 282/300
 - 26s - loss: 0.0028 - val_loss: 0.0026
 - val_f1: 0.9947
Epoch 283/300
 - 26s - loss: 0.0028 - val_loss: 0.0024
 - val_f1: 0.9954
Epoch 284/300
 - 27s - loss: 0.0028 - val_loss: 0.0023
 - val_f1: 0.9957
Epoch 285/300
 - 26s - loss: 0.0028 - val_loss: 0.0027
 - val_f1: 0.9942
Epoch 286/300
 - 26s - loss: 0.0029 - val_loss: 0.0024
 - val_f1: 0.9954
Epoch 287/300
 - 26s - loss: 0.0029 - val_loss: 0.0025
 - val_f1: 0.9955
Epoch 288/300
 - 27s - loss: 0.0028 - val_loss: 0.0024
 - val_f1: 0.9955
Epoch 289/300
 - 27s - loss: 0.0028 - val_loss: 0.0033
 - val_f1: 0.9929
Epoch 290/300
 - 27s - loss: 0.0028 - val_loss: 0.0036
 - val_f1: 0.9931
Epoch 291/300
 - 26s - loss: 0.0028 - val_loss: 0.0024
 - val_f1: 0.9951
Epoch 292/300
 - 27s - loss: 0.0029 - val_loss: 0.0026
 - val_f1: 0.9948
Epoch 293/300
 - 26s - loss: 0.0028 - val_loss: 0.0025
 - val_f1: 0.9952
Epoch 294/300
 - 27s - loss: 0.0028 - val_loss: 0.0028
2019-12-21 04:27:08,421 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-21 04:27:59,033 [INFO] Last epoch loss evaluation: train_loss = 0.002160, val_loss = 0.002206
2019-12-21 04:27:59,033 [INFO] Training complete. time_to_train = 11434.72 sec, 190.58 min
2019-12-21 04:27:59,037 [INFO] Model saved to results_selected_models/selected_ids2017_ann_shallow_rep4/best_model.pickle
2019-12-21 04:27:59,229 [INFO] Plot saved to: results_selected_models/selected_ids2017_ann_shallow_rep4/training_error_history.png
2019-12-21 04:27:59,407 [INFO] Plot saved to: results_selected_models/selected_ids2017_ann_shallow_rep4/training_f1_history.png
2019-12-21 04:27:59,407 [INFO] Making predictions on training, validation, testing data
2019-12-21 04:28:55,715 [INFO] Evaluating predictions (results)
2019-12-21 04:29:15,792 [INFO] Dataset: Testing. Classification report below
2019-12-21 04:29:15,792 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454265
                   Bot       0.97      0.38      0.55       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       1.00      0.97      0.98      2058
              DoS Hulk       0.98      0.99      0.99     46025
      DoS Slowhttptest       0.87      0.99      0.93      1100
         DoS slowloris       0.99      0.96      0.98      1159
           FTP-Patator       1.00      1.00      1.00      1587
              PortScan       0.99      1.00      1.00     31761
           SSH-Patator       0.94      0.98      0.96      1179
Web Attack Brute Force       1.00      0.09      0.17       302
        Web Attack XSS       0.00      0.00      0.00       130

              accuracy                           1.00    565562
             macro avg       0.90      0.78      0.80    565562
          weighted avg       1.00      1.00      1.00    565562

2019-12-21 04:29:15,792 [INFO] Overall accuracy (micro avg): 0.9955407187894519
2019-12-21 04:29:37,373 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9955         0.9955                       0.9955                0.0004                   0.0045  0.9955
1     Macro avg        0.9993         0.8958                       0.7800                0.0011                   0.2200  0.7952
2  Weighted avg        0.9963         0.9954                       0.9955                0.0090                   0.0045  0.9951
2019-12-21 04:29:57,509 [INFO] Dataset: Validation. Classification report below
2019-12-21 04:29:57,509 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454264
                   Bot       0.98      0.35      0.52       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       0.99      0.97      0.98      2059
              DoS Hulk       0.98      0.99      0.99     46025
      DoS Slowhttptest       0.88      0.98      0.93      1099
         DoS slowloris       0.99      0.97      0.98      1159
           FTP-Patator       1.00      1.00      1.00      1587
              PortScan       0.99      1.00      1.00     31761
           SSH-Patator       0.95      0.98      0.96      1180
Web Attack Brute Force       1.00      0.07      0.12       301
        Web Attack XSS       0.75      0.02      0.04       131

              accuracy                           1.00    565562
             macro avg       0.96      0.78      0.79    565562
          weighted avg       1.00      1.00      1.00    565562

2019-12-21 04:29:57,509 [INFO] Overall accuracy (micro avg): 0.9957405200490839
2019-12-21 04:30:19,212 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9957         0.9957                       0.9957                0.0004                   0.0043  0.9957
1     Macro avg        0.9993         0.9599                       0.7768                0.0011                   0.2232  0.7932
2  Weighted avg        0.9965         0.9957                       0.9957                0.0087                   0.0043  0.9953
2019-12-21 04:31:26,161 [INFO] Dataset: Training. Classification report below
2019-12-21 04:31:26,162 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00   1362791
                   Bot       0.99      0.37      0.53      1174
                  DDoS       1.00      1.00      1.00     76815
         DoS GoldenEye       1.00      0.98      0.99      6176
              DoS Hulk       0.98      0.99      0.99    138074
      DoS Slowhttptest       0.89      0.99      0.94      3300
         DoS slowloris       0.99      0.97      0.98      3478
           FTP-Patator       1.00      1.00      1.00      4761
              PortScan       0.99      1.00      1.00     95282
           SSH-Patator       0.96      0.98      0.97      3538
Web Attack Brute Force       1.00      0.08      0.15       904
        Web Attack XSS       0.82      0.04      0.07       391

              accuracy                           1.00   1696684
             macro avg       0.97      0.78      0.80   1696684
          weighted avg       1.00      1.00      1.00   1696684

2019-12-21 04:31:26,162 [INFO] Overall accuracy (micro avg): 0.9957800038192144
2019-12-21 04:32:38,254 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9958         0.9958                       0.9958                0.0004                   0.0042  0.9958
1     Macro avg        0.9993         0.9686                       0.7819                0.0011                   0.2181  0.8005
2  Weighted avg        0.9965         0.9958                       0.9958                0.0088                   0.0042  0.9954
2019-12-21 04:32:38,319 [INFO] Results saved to: results_selected_models/selected_ids2017_ann_shallow_rep4/selected_ids2017_ann_shallow_rep4_results.xlsx
2019-12-21 04:32:38,323 [INFO] ================= Finished running experiment no. 4 ================= 

2019-12-21 04:32:38,371 [INFO] Created directory: results_selected_models/selected_ids2017_ann_shallow_rep5
2019-12-21 04:32:38,372 [INFO] Initialized logging. log_filename = results_selected_models/selected_ids2017_ann_shallow_rep5/run_log.log
2019-12-21 04:32:38,372 [INFO] ================= Running experiment no. 5  ================= 

2019-12-21 04:32:38,372 [INFO] Experiment parameters given below
2019-12-21 04:32:38,372 [INFO] 
{'experiment_num': 5, 'results_dir': 'results_selected_models/selected_ids2017_ann_shallow_rep5', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 300, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/full_datasets/ids2017', 'description': 'selected_ids2017_ann_shallow_rep5'}
2019-12-21 04:32:38,372 [INFO] Created tensorboard log directory: results_selected_models/selected_ids2017_ann_shallow_rep5/tf_logs_run_2019_12_21-04_32_38
2019-12-21 04:32:38,372 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2017
2019-12-21 04:32:38,373 [INFO] Reading X, y files
2019-12-21 04:32:38,373 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_train.h5
2019-12-21 04:32:42,192 [INFO] Reading complete. time_to_read=3.82 seconds
2019-12-21 04:32:42,192 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_val.h5
2019-12-21 04:32:43,483 [INFO] Reading complete. time_to_read=1.29 seconds
2019-12-21 04:32:43,483 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_test.h5
2019-12-21 04:32:44,772 [INFO] Reading complete. time_to_read=1.29 seconds
2019-12-21 04:32:44,773 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_train.h5
2019-12-21 04:32:45,054 [INFO] Reading complete. time_to_read=0.28 seconds
2019-12-21 04:32:45,054 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_val.h5
2019-12-21 04:32:45,142 [INFO] Reading complete. time_to_read=0.09 seconds
2019-12-21 04:32:45,142 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_test.h5
2019-12-21 04:32:45,233 [INFO] Reading complete. time_to_read=0.09 seconds
2019-12-21 04:32:48,313 [INFO] Initializing model
2019-12-21 04:32:48,438 [INFO] _________________________________________________________________
2019-12-21 04:32:48,438 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-21 04:32:48,438 [INFO] =================================================================
2019-12-21 04:32:48,438 [INFO] dense_19 (Dense)             (None, 64)                5056      
2019-12-21 04:32:48,438 [INFO] _________________________________________________________________
2019-12-21 04:32:48,439 [INFO] batch_normalization_10 (Batc (None, 64)                256       
2019-12-21 04:32:48,439 [INFO] _________________________________________________________________
2019-12-21 04:32:48,439 [INFO] dropout_10 (Dropout)         (None, 64)                0         
2019-12-21 04:32:48,439 [INFO] _________________________________________________________________
2019-12-21 04:32:48,439 [INFO] dense_20 (Dense)             (None, 12)                780       
2019-12-21 04:32:48,439 [INFO] =================================================================
2019-12-21 04:32:48,439 [INFO] Total params: 6,092
2019-12-21 04:32:48,439 [INFO] Trainable params: 5,964
2019-12-21 04:32:48,439 [INFO] Non-trainable params: 128
2019-12-21 04:32:48,439 [INFO] _________________________________________________________________
2019-12-21 04:32:48,439 [INFO] Training model
 - val_f1: 0.9945
Epoch 00294: early stopping
Train on 1696684 samples, validate on 565562 samples
Epoch 1/300
 - 28s - loss: 0.0192 - val_loss: 0.0110
 - val_f1: 0.9708
Epoch 2/300
 - 27s - loss: 0.0096 - val_loss: 0.0071
 - val_f1: 0.9865
Epoch 3/300
 - 27s - loss: 0.0073 - val_loss: 0.0079
 - val_f1: 0.9863
Epoch 4/300
 - 27s - loss: 0.0069 - val_loss: 0.0095
 - val_f1: 0.9776
Epoch 5/300
 - 27s - loss: 0.0063 - val_loss: 0.0172
 - val_f1: 0.9538
Epoch 6/300
 - 27s - loss: 0.0057 - val_loss: 0.0114
 - val_f1: 0.9712
Epoch 7/300
 - 27s - loss: 0.0056 - val_loss: 0.0146
 - val_f1: 0.9633
Epoch 8/300
 - 27s - loss: 0.0055 - val_loss: 0.0064
 - val_f1: 0.9854
Epoch 9/300
 - 26s - loss: 0.0053 - val_loss: 0.0155
 - val_f1: 0.9535
Epoch 10/300
 - 27s - loss: 0.0052 - val_loss: 0.0058
 - val_f1: 0.9887
Epoch 11/300
 - 27s - loss: 0.0049 - val_loss: 0.0055
 - val_f1: 0.9867
Epoch 12/300
 - 27s - loss: 0.0048 - val_loss: 0.0056
 - val_f1: 0.9876
Epoch 13/300
 - 27s - loss: 0.0047 - val_loss: 0.0050
 - val_f1: 0.9902
Epoch 14/300
 - 27s - loss: 0.0046 - val_loss: 0.0097
 - val_f1: 0.9805
Epoch 15/300
 - 27s - loss: 0.0045 - val_loss: 0.0072
 - val_f1: 0.9874
Epoch 16/300
 - 27s - loss: 0.0044 - val_loss: 0.0046
 - val_f1: 0.9896
Epoch 17/300
 - 27s - loss: 0.0043 - val_loss: 0.0044
 - val_f1: 0.9911
Epoch 18/300
 - 27s - loss: 0.0043 - val_loss: 0.0041
 - val_f1: 0.9928
Epoch 19/300
 - 26s - loss: 0.0042 - val_loss: 0.0045
 - val_f1: 0.9884
Epoch 20/300
 - 27s - loss: 0.0041 - val_loss: 0.0041
 - val_f1: 0.9905
Epoch 21/300
 - 27s - loss: 0.0042 - val_loss: 0.0031
 - val_f1: 0.9946
Epoch 22/300
 - 27s - loss: 0.0045 - val_loss: 0.0060
 - val_f1: 0.9867
Epoch 23/300
 - 27s - loss: 0.0044 - val_loss: 0.0038
 - val_f1: 0.9921
Epoch 24/300
 - 27s - loss: 0.0044 - val_loss: 0.0054
 - val_f1: 0.9878
Epoch 25/300
 - 27s - loss: 0.0044 - val_loss: 0.0044
 - val_f1: 0.9902
Epoch 26/300
 - 27s - loss: 0.0041 - val_loss: 0.0045
 - val_f1: 0.9913
Epoch 27/300
 - 29s - loss: 0.0040 - val_loss: 0.0047
 - val_f1: 0.9901
Epoch 28/300
 - 27s - loss: 0.0039 - val_loss: 0.0075
 - val_f1: 0.9864
Epoch 29/300
 - 27s - loss: 0.0038 - val_loss: 0.0054
 - val_f1: 0.9881
Epoch 30/300
 - 27s - loss: 0.0039 - val_loss: 0.0039
 - val_f1: 0.9917
Epoch 31/300
 - 27s - loss: 0.0038 - val_loss: 0.0059
2019-12-21 04:53:00,450 [INFO] epoch = 30. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep5/ann_model_epoch_30.pickle
 - val_f1: 0.9882
Epoch 32/300
 - 27s - loss: 0.0038 - val_loss: 0.0049
 - val_f1: 0.9893
Epoch 33/300
 - 27s - loss: 0.0037 - val_loss: 0.0043
 - val_f1: 0.9941
Epoch 34/300
 - 27s - loss: 0.0037 - val_loss: 0.0080
 - val_f1: 0.9852
Epoch 35/300
 - 27s - loss: 0.0037 - val_loss: 0.0039
 - val_f1: 0.9927
Epoch 36/300
 - 27s - loss: 0.0037 - val_loss: 0.0030
 - val_f1: 0.9946
Epoch 37/300
 - 27s - loss: 0.0037 - val_loss: 0.0031
 - val_f1: 0.9946
Epoch 38/300
 - 27s - loss: 0.0037 - val_loss: 0.0085
 - val_f1: 0.9822
Epoch 39/300
 - 27s - loss: 0.0036 - val_loss: 0.0048
 - val_f1: 0.9880
Epoch 40/300
 - 27s - loss: 0.0036 - val_loss: 0.0031
 - val_f1: 0.9943
Epoch 41/300
 - 27s - loss: 0.0036 - val_loss: 0.0037
 - val_f1: 0.9936
Epoch 42/300
 - 27s - loss: 0.0036 - val_loss: 0.0061
 - val_f1: 0.9863
Epoch 43/300
 - 27s - loss: 0.0036 - val_loss: 0.0057
 - val_f1: 0.9884
Epoch 44/300
 - 27s - loss: 0.0036 - val_loss: 0.0029
 - val_f1: 0.9948
Epoch 45/300
 - 27s - loss: 0.0036 - val_loss: 0.0039
 - val_f1: 0.9918
Epoch 46/300
 - 26s - loss: 0.0035 - val_loss: 0.0037
 - val_f1: 0.9915
Epoch 47/300
 - 27s - loss: 0.0035 - val_loss: 0.0036
 - val_f1: 0.9916
Epoch 48/300
 - 27s - loss: 0.0035 - val_loss: 0.0069
 - val_f1: 0.9871
Epoch 49/300
 - 27s - loss: 0.0035 - val_loss: 0.0029
 - val_f1: 0.9944
Epoch 50/300
 - 27s - loss: 0.0034 - val_loss: 0.0046
 - val_f1: 0.9902
Epoch 51/300
 - 27s - loss: 0.0034 - val_loss: 0.0049
 - val_f1: 0.9904
Epoch 52/300
 - 27s - loss: 0.0034 - val_loss: 0.0046
 - val_f1: 0.9912
Epoch 53/300
 - 27s - loss: 0.0034 - val_loss: 0.0044
 - val_f1: 0.9906
Epoch 54/300
 - 27s - loss: 0.0034 - val_loss: 0.0028
 - val_f1: 0.9950
Epoch 55/300
 - 27s - loss: 0.0034 - val_loss: 0.0055
 - val_f1: 0.9902
Epoch 56/300
 - 27s - loss: 0.0034 - val_loss: 0.0048
 - val_f1: 0.9902
Epoch 57/300
 - 27s - loss: 0.0034 - val_loss: 0.0032
 - val_f1: 0.9952
Epoch 58/300
 - 27s - loss: 0.0033 - val_loss: 0.0053
 - val_f1: 0.9889
Epoch 59/300
 - 27s - loss: 0.0034 - val_loss: 0.0030
 - val_f1: 0.9938
Epoch 60/300
 - 27s - loss: 0.0033 - val_loss: 0.0037
 - val_f1: 0.9925
Epoch 61/300
 - 27s - loss: 0.0033 - val_loss: 0.0045
2019-12-21 05:12:33,412 [INFO] epoch = 60. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep5/ann_model_epoch_60.pickle
 - val_f1: 0.9925
Epoch 62/300
 - 27s - loss: 0.0033 - val_loss: 0.0035
 - val_f1: 0.9930
Epoch 63/300
 - 26s - loss: 0.0033 - val_loss: 0.0049
 - val_f1: 0.9913
Epoch 64/300
 - 27s - loss: 0.0033 - val_loss: 0.0055
 - val_f1: 0.9878
Epoch 65/300
 - 26s - loss: 0.0033 - val_loss: 0.0034
 - val_f1: 0.9926
Epoch 66/300
 - 27s - loss: 0.0033 - val_loss: 0.0040
 - val_f1: 0.9920
Epoch 67/300
 - 27s - loss: 0.0033 - val_loss: 0.0030
 - val_f1: 0.9928
Epoch 68/300
 - 27s - loss: 0.0033 - val_loss: 0.0036
 - val_f1: 0.9922
Epoch 69/300
 - 27s - loss: 0.0033 - val_loss: 0.0053
 - val_f1: 0.9894
Epoch 70/300
 - 26s - loss: 0.0034 - val_loss: 0.0032
 - val_f1: 0.9928
Epoch 71/300
 - 27s - loss: 0.0033 - val_loss: 0.0051
 - val_f1: 0.9912
Epoch 72/300
 - 27s - loss: 0.0033 - val_loss: 0.0030
 - val_f1: 0.9945
Epoch 73/300
 - 27s - loss: 0.0033 - val_loss: 0.0033
 - val_f1: 0.9926
Epoch 74/300
 - 26s - loss: 0.0032 - val_loss: 0.0062
 - val_f1: 0.9904
Epoch 75/300
 - 27s - loss: 0.0033 - val_loss: 0.0036
 - val_f1: 0.9925
Epoch 76/300
 - 27s - loss: 0.0033 - val_loss: 0.0044
 - val_f1: 0.9915
Epoch 77/300
 - 27s - loss: 0.0032 - val_loss: 0.0026
 - val_f1: 0.9953
Epoch 78/300
 - 26s - loss: 0.0032 - val_loss: 0.0031
 - val_f1: 0.9948
Epoch 79/300
 - 27s - loss: 0.0032 - val_loss: 0.0033
 - val_f1: 0.9918
Epoch 80/300
 - 27s - loss: 0.0032 - val_loss: 0.0030
 - val_f1: 0.9947
Epoch 81/300
 - 27s - loss: 0.0032 - val_loss: 0.0029
 - val_f1: 0.9952
Epoch 82/300
 - 27s - loss: 0.0033 - val_loss: 0.0033
 - val_f1: 0.9929
Epoch 83/300
 - 27s - loss: 0.0033 - val_loss: 0.0036
 - val_f1: 0.9920
Epoch 84/300
 - 27s - loss: 0.0033 - val_loss: 0.0034
 - val_f1: 0.9925
Epoch 85/300
 - 27s - loss: 0.0033 - val_loss: 0.0054
 - val_f1: 0.9903
Epoch 86/300
 - 27s - loss: 0.0033 - val_loss: 0.0048
 - val_f1: 0.9895
Epoch 87/300
 - 27s - loss: 0.0032 - val_loss: 0.0046
 - val_f1: 0.9907
Epoch 88/300
 - 27s - loss: 0.0032 - val_loss: 0.0031
 - val_f1: 0.9936
Epoch 89/300
 - 27s - loss: 0.0032 - val_loss: 0.0042
 - val_f1: 0.9920
Epoch 90/300
 - 27s - loss: 0.0032 - val_loss: 0.0043
 - val_f1: 0.9919
Epoch 91/300
 - 26s - loss: 0.0032 - val_loss: 0.0032
2019-12-21 05:32:04,239 [INFO] epoch = 90. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep5/ann_model_epoch_90.pickle
 - val_f1: 0.9950
Epoch 92/300
 - 26s - loss: 0.0032 - val_loss: 0.0031
 - val_f1: 0.9945
Epoch 93/300
 - 27s - loss: 0.0032 - val_loss: 0.0026
 - val_f1: 0.9953
Epoch 94/300
 - 27s - loss: 0.0032 - val_loss: 0.0032
 - val_f1: 0.9926
Epoch 95/300
 - 26s - loss: 0.0032 - val_loss: 0.0035
 - val_f1: 0.9937
Epoch 96/300
 - 27s - loss: 0.0032 - val_loss: 0.0036
 - val_f1: 0.9925
Epoch 97/300
 - 27s - loss: 0.0033 - val_loss: 0.0070
 - val_f1: 0.9873
Epoch 98/300
 - 27s - loss: 0.0032 - val_loss: 0.0042
 - val_f1: 0.9909
Epoch 99/300
 - 27s - loss: 0.0032 - val_loss: 0.0043
 - val_f1: 0.9912
Epoch 100/300
 - 27s - loss: 0.0032 - val_loss: 0.0060
 - val_f1: 0.9886
Epoch 101/300
 - 27s - loss: 0.0032 - val_loss: 0.0065
 - val_f1: 0.9888
Epoch 102/300
 - 27s - loss: 0.0032 - val_loss: 0.0031
 - val_f1: 0.9928
Epoch 103/300
 - 27s - loss: 0.0032 - val_loss: 0.0027
 - val_f1: 0.9952
Epoch 104/300
 - 27s - loss: 0.0031 - val_loss: 0.0051
 - val_f1: 0.9884
Epoch 105/300
 - 27s - loss: 0.0032 - val_loss: 0.0036
 - val_f1: 0.9935
Epoch 106/300
 - 27s - loss: 0.0032 - val_loss: 0.0039
 - val_f1: 0.9921
Epoch 107/300
 - 27s - loss: 0.0032 - val_loss: 0.0027
 - val_f1: 0.9933
Epoch 108/300
 - 27s - loss: 0.0032 - val_loss: 0.0028
 - val_f1: 0.9947
Epoch 109/300
 - 27s - loss: 0.0031 - val_loss: 0.0054
 - val_f1: 0.9903
Epoch 110/300
 - 27s - loss: 0.0031 - val_loss: 0.0028
 - val_f1: 0.9949
Epoch 111/300
 - 26s - loss: 0.0031 - val_loss: 0.0033
 - val_f1: 0.9928
Epoch 112/300
 - 26s - loss: 0.0031 - val_loss: 0.0059
 - val_f1: 0.9816
Epoch 113/300
 - 27s - loss: 0.0031 - val_loss: 0.0029
 - val_f1: 0.9929
Epoch 114/300
 - 27s - loss: 0.0031 - val_loss: 0.0036
 - val_f1: 0.9956
Epoch 115/300
 - 26s - loss: 0.0032 - val_loss: 0.0033
 - val_f1: 0.9938
Epoch 116/300
 - 26s - loss: 0.0031 - val_loss: 0.0032
 - val_f1: 0.9918
Epoch 117/300
 - 27s - loss: 0.0031 - val_loss: 0.0074
 - val_f1: 0.9878
Epoch 118/300
 - 26s - loss: 0.0031 - val_loss: 0.0030
 - val_f1: 0.9929
Epoch 119/300
 - 27s - loss: 0.0031 - val_loss: 0.0038
 - val_f1: 0.9922
Epoch 120/300
 - 26s - loss: 0.0031 - val_loss: 0.0030
 - val_f1: 0.9927
Epoch 121/300
 - 27s - loss: 0.0031 - val_loss: 0.0027
2019-12-21 05:51:34,513 [INFO] epoch = 120. Intermediate model saved to results_selected_models/selected_ids2017_ann_shallow_rep5/ann_model_epoch_120.pickle
 - val_f1: 0.9954
Epoch 122/300
 - 27s - loss: 0.0031 - val_loss: 0.0030
 - val_f1: 0.9948
Epoch 123/300
 - 27s - loss: 0.0031 - val_loss: 0.0032
 - val_f1: 0.9929
Epoch 124/300
 - 27s - loss: 0.0031 - val_loss: 0.0053
 - val_f1: 0.9911
Epoch 125/300
 - 27s - loss: 0.0031 - val_loss: 0.0065
 - val_f1: 0.9872
Epoch 126/300
 - 27s - loss: 0.0031 - val_loss: 0.0032
 - val_f1: 0.9928
Epoch 127/300
 - 27s - loss: 0.0032 - val_loss: 0.0034
2019-12-21 05:55:41,479 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-21 05:56:34,372 [INFO] Last epoch loss evaluation: train_loss = 0.002540, val_loss = 0.002615
2019-12-21 05:56:34,372 [INFO] Training complete. time_to_train = 5025.93 sec, 83.77 min
2019-12-21 05:56:34,376 [INFO] Model saved to results_selected_models/selected_ids2017_ann_shallow_rep5/best_model.pickle
2019-12-21 05:56:34,566 [INFO] Plot saved to: results_selected_models/selected_ids2017_ann_shallow_rep5/training_error_history.png
2019-12-21 05:56:34,730 [INFO] Plot saved to: results_selected_models/selected_ids2017_ann_shallow_rep5/training_f1_history.png
2019-12-21 05:56:34,730 [INFO] Making predictions on training, validation, testing data
2019-12-21 05:57:32,643 [INFO] Evaluating predictions (results)
2019-12-21 05:57:52,574 [INFO] Dataset: Testing. Classification report below
2019-12-21 05:57:52,574 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454265
                   Bot       0.60      0.63      0.61       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       0.99      0.99      0.99      2058
              DoS Hulk       0.98      0.99      0.98     46025
      DoS Slowhttptest       0.89      0.99      0.93      1100
         DoS slowloris       0.99      0.98      0.98      1159
           FTP-Patator       0.99      1.00      0.99      1587
              PortScan       0.99      1.00      1.00     31761
           SSH-Patator       0.96      0.98      0.97      1179
Web Attack Brute Force       1.00      0.06      0.11       302
        Web Attack XSS       0.00      0.00      0.00       130

              accuracy                           1.00    565562
             macro avg       0.87      0.80      0.80    565562
          weighted avg       0.99      1.00      0.99    565562

2019-12-21 05:57:52,574 [INFO] Overall accuracy (micro avg): 0.9951198984373066
2019-12-21 05:58:13,998 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9951         0.9951                       0.9951                0.0004                   0.0049  0.9951
1     Macro avg        0.9992         0.8655                       0.8001                0.0011                   0.1999  0.7978
2  Weighted avg        0.9959         0.9950                       0.9951                0.0084                   0.0049  0.9948
2019-12-21 05:58:34,119 [INFO] Dataset: Validation. Classification report below
2019-12-21 05:58:34,119 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454264
                   Bot       0.59      0.59      0.59       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       0.99      0.98      0.99      2059
              DoS Hulk       0.98      0.99      0.99     46025
      DoS Slowhttptest       0.89      0.98      0.93      1099
         DoS slowloris       0.99      0.98      0.98      1159
           FTP-Patator       0.99      1.00      0.99      1587
              PortScan       0.99      1.00      1.00     31761
           SSH-Patator       0.97      0.97      0.97      1180
Web Attack Brute Force       1.00      0.04      0.08       301
        Web Attack XSS       0.40      0.03      0.06       131

              accuracy                           1.00    565562
             macro avg       0.90      0.80      0.80    565562
          weighted avg       1.00      1.00      0.99    565562

2019-12-21 05:58:34,119 [INFO] Overall accuracy (micro avg): 0.9953108589332381
2019-12-21 05:58:55,817 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9953         0.9953                       0.9953                0.0004                   0.0047  0.9953
1     Macro avg        0.9992         0.8985                       0.7962                0.0011                   0.2038  0.7970
2  Weighted avg        0.9961         0.9952                       0.9953                0.0081                   0.0047  0.9950
2019-12-21 06:00:02,820 [INFO] Dataset: Training. Classification report below
2019-12-21 06:00:02,820 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00   1362791
                   Bot       0.59      0.62      0.61      1174
                  DDoS       1.00      1.00      1.00     76815
         DoS GoldenEye       0.99      0.98      0.99      6176
              DoS Hulk       0.98      0.99      0.99    138074
      DoS Slowhttptest       0.90      0.98      0.94      3300
         DoS slowloris       0.98      0.99      0.98      3478
           FTP-Patator       0.99      1.00      0.99      4761
              PortScan       0.99      1.00      1.00     95282
           SSH-Patator       0.97      0.98      0.97      3538
Web Attack Brute Force       1.00      0.05      0.09       904
        Web Attack XSS       0.46      0.03      0.06       391

              accuracy                           1.00   1696684
             macro avg       0.91      0.80      0.80   1696684
          weighted avg       1.00      1.00      1.00   1696684

2019-12-21 06:00:02,820 [INFO] Overall accuracy (micro avg): 0.995333250033595
2019-12-21 06:01:15,047 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9953         0.9953                       0.9953                0.0004                   0.0047  0.9953
1     Macro avg        0.9992         0.9058                       0.8005                0.0011                   0.1995  0.8011
2  Weighted avg        0.9961         0.9953                       0.9953                0.0082                   0.0047  0.9950
2019-12-21 06:01:15,112 [INFO] Results saved to: results_selected_models/selected_ids2017_ann_shallow_rep5/selected_ids2017_ann_shallow_rep5_results.xlsx
2019-12-21 06:01:15,116 [INFO] ================= Finished running experiment no. 5 ================= 

2019-12-21 06:01:15,160 [INFO] Created directory: results_selected_models/selected_kdd99_ann_shallow_rep1
2019-12-21 06:01:15,161 [INFO] Initialized logging. log_filename = results_selected_models/selected_kdd99_ann_shallow_rep1/run_log.log
2019-12-21 06:01:15,161 [INFO] ================= Running experiment no. 1  ================= 

2019-12-21 06:01:15,161 [INFO] Experiment parameters given below
2019-12-21 06:01:15,161 [INFO] 
{'experiment_num': 1, 'results_dir': 'results_selected_models/selected_kdd99_ann_shallow_rep1', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [256], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 300, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/full_datasets/kdd99_five_classes', 'description': 'selected_kdd99_ann_shallow_rep1'}
2019-12-21 06:01:15,161 [INFO] Created tensorboard log directory: results_selected_models/selected_kdd99_ann_shallow_rep1/tf_logs_run_2019_12_21-06_01_15
2019-12-21 06:01:15,161 [INFO] Loading datsets from: ../Datasets/full_datasets/kdd99_five_classes
2019-12-21 06:01:15,162 [INFO] Reading X, y files
2019-12-21 06:01:15,162 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/X_train.h5
2019-12-21 06:01:21,723 [INFO] Reading complete. time_to_read=6.56 seconds
2019-12-21 06:01:21,723 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/X_val.h5
2019-12-21 06:01:23,428 [INFO] Reading complete. time_to_read=1.70 seconds
2019-12-21 06:01:23,428 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/X_test.h5
2019-12-21 06:01:23,926 [INFO] Reading complete. time_to_read=0.50 seconds
2019-12-21 06:01:23,927 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/y_train.h5
2019-12-21 06:01:24,203 [INFO] Reading complete. time_to_read=0.28 seconds
2019-12-21 06:01:24,203 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/y_val.h5
2019-12-21 06:01:24,281 [INFO] Reading complete. time_to_read=0.08 seconds
2019-12-21 06:01:24,281 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/y_test.h5
2019-12-21 06:01:24,311 [INFO] Reading complete. time_to_read=0.03 seconds
2019-12-21 06:01:31,567 [INFO] Initializing model
2019-12-21 06:01:31,692 [INFO] _________________________________________________________________
2019-12-21 06:01:31,692 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-21 06:01:31,692 [INFO] =================================================================
2019-12-21 06:01:31,692 [INFO] dense_21 (Dense)             (None, 256)               31744     
2019-12-21 06:01:31,692 [INFO] _________________________________________________________________
2019-12-21 06:01:31,692 [INFO] batch_normalization_11 (Batc (None, 256)               1024      
2019-12-21 06:01:31,692 [INFO] _________________________________________________________________
2019-12-21 06:01:31,693 [INFO] dropout_11 (Dropout)         (None, 256)               0         
2019-12-21 06:01:31,693 [INFO] _________________________________________________________________
2019-12-21 06:01:31,693 [INFO] dense_22 (Dense)             (None, 5)                 1285      
2019-12-21 06:01:31,693 [INFO] =================================================================
2019-12-21 06:01:31,693 [INFO] Total params: 34,053
2019-12-21 06:01:31,693 [INFO] Trainable params: 33,541
2019-12-21 06:01:31,693 [INFO] Non-trainable params: 512
2019-12-21 06:01:31,693 [INFO] _________________________________________________________________
2019-12-21 06:01:31,693 [INFO] Training model
 - val_f1: 0.9925
Epoch 00127: early stopping
Train on 3918744 samples, validate on 979687 samples
Epoch 1/300
 - 83s - loss: 0.0030 - val_loss: 9.4759e-04
 - val_f1: 0.9996
Epoch 2/300
 - 82s - loss: 8.5279e-04 - val_loss: 5.3880e-04
 - val_f1: 0.9997
Epoch 3/300
 - 82s - loss: 6.3186e-04 - val_loss: 4.5767e-04
 - val_f1: 0.9997
Epoch 4/300
 - 82s - loss: 5.4668e-04 - val_loss: 7.2948e-04
 - val_f1: 0.9995
Epoch 5/300
 - 82s - loss: 4.7855e-04 - val_loss: 4.3044e-04
 - val_f1: 0.9998
Epoch 6/300
 - 82s - loss: 4.7798e-04 - val_loss: 4.9501e-04
 - val_f1: 0.9998
Epoch 7/300
 - 82s - loss: 4.3036e-04 - val_loss: 4.1731e-04
 - val_f1: 0.9998
Epoch 8/300
 - 82s - loss: 4.0974e-04 - val_loss: 4.1117e-04
 - val_f1: 0.9998
Epoch 9/300
 - 82s - loss: 3.9185e-04 - val_loss: 3.7074e-04
 - val_f1: 0.9998
Epoch 10/300
 - 82s - loss: 3.7434e-04 - val_loss: 3.7158e-04
 - val_f1: 0.9998
Epoch 11/300
 - 82s - loss: 3.6495e-04 - val_loss: 4.1992e-04
 - val_f1: 0.9998
Epoch 12/300
 - 82s - loss: 3.5179e-04 - val_loss: 3.4230e-04
 - val_f1: 0.9998
Epoch 13/300
 - 82s - loss: 3.6179e-04 - val_loss: 3.6347e-04
 - val_f1: 0.9998
Epoch 14/300
 - 82s - loss: 3.2170e-04 - val_loss: 3.4855e-04
 - val_f1: 0.9998
Epoch 15/300
 - 82s - loss: 3.2165e-04 - val_loss: 3.3827e-04
 - val_f1: 0.9999
Epoch 16/300
 - 82s - loss: 3.1885e-04 - val_loss: 3.6197e-04
 - val_f1: 0.9998
Epoch 17/300
 - 82s - loss: 3.1368e-04 - val_loss: 4.0279e-04
 - val_f1: 0.9999
Epoch 18/300
 - 82s - loss: 3.2180e-04 - val_loss: 3.8998e-04
 - val_f1: 0.9998
Epoch 19/300
 - 82s - loss: 3.1318e-04 - val_loss: 3.4675e-04
 - val_f1: 0.9998
Epoch 20/300
 - 82s - loss: 3.1195e-04 - val_loss: 3.3028e-04
 - val_f1: 0.9998
Epoch 21/300
 - 82s - loss: 3.1554e-04 - val_loss: 3.5050e-04
 - val_f1: 0.9998
Epoch 22/300
 - 82s - loss: 2.9545e-04 - val_loss: 3.3201e-04
 - val_f1: 0.9998
Epoch 23/300
 - 82s - loss: 2.8269e-04 - val_loss: 3.5452e-04
 - val_f1: 0.9998
Epoch 24/300
 - 82s - loss: 2.9207e-04 - val_loss: 3.1025e-04
 - val_f1: 0.9998
Epoch 25/300
 - 82s - loss: 2.7935e-04 - val_loss: 3.1681e-04
 - val_f1: 0.9999
Epoch 26/300
 - 82s - loss: 2.9312e-04 - val_loss: 3.3088e-04
 - val_f1: 0.9998
Epoch 27/300
 - 82s - loss: 2.8725e-04 - val_loss: 3.1396e-04
 - val_f1: 0.9999
Epoch 28/300
 - 82s - loss: 2.8604e-04 - val_loss: 3.4940e-04
 - val_f1: 0.9998
Epoch 29/300
 - 82s - loss: 2.9268e-04 - val_loss: 3.0774e-04
 - val_f1: 0.9999
Epoch 30/300
 - 82s - loss: 2.7857e-04 - val_loss: 3.2345e-04
 - val_f1: 0.9998
Epoch 31/300
 - 82s - loss: 2.7271e-04 - val_loss: 3.3361e-04
2019-12-21 06:55:46,572 [INFO] epoch = 30. Intermediate model saved to results_selected_models/selected_kdd99_ann_shallow_rep1/ann_model_epoch_30.pickle
 - val_f1: 0.9998
Epoch 32/300
 - 86s - loss: 2.8715e-04 - val_loss: 3.1036e-04
 - val_f1: 0.9999
Epoch 33/300
 - 82s - loss: 2.7775e-04 - val_loss: 3.8633e-04
 - val_f1: 0.9998
Epoch 34/300
 - 82s - loss: 2.7546e-04 - val_loss: 3.4568e-04
 - val_f1: 0.9999
Epoch 35/300
 - 82s - loss: 2.7183e-04 - val_loss: 3.2060e-04
 - val_f1: 0.9999
Epoch 36/300
 - 82s - loss: 2.7285e-04 - val_loss: 2.9061e-04
 - val_f1: 0.9999
Epoch 37/300
 - 82s - loss: 2.6892e-04 - val_loss: 3.2496e-04
 - val_f1: 0.9999
Epoch 38/300
 - 82s - loss: 2.7375e-04 - val_loss: 3.5241e-04
 - val_f1: 0.9998
Epoch 39/300
 - 82s - loss: 2.7960e-04 - val_loss: 3.5131e-04
 - val_f1: 0.9998
Epoch 40/300
 - 82s - loss: 2.6395e-04 - val_loss: 3.5164e-04
 - val_f1: 0.9998
Epoch 41/300
 - 82s - loss: 2.7448e-04 - val_loss: 3.2382e-04
 - val_f1: 0.9998
Epoch 42/300
 - 82s - loss: 2.7425e-04 - val_loss: 3.1033e-04
 - val_f1: 0.9999
Epoch 43/300
 - 82s - loss: 2.7003e-04 - val_loss: 2.9687e-04
 - val_f1: 0.9999
Epoch 44/300
 - 82s - loss: 2.6219e-04 - val_loss: 3.3059e-04
 - val_f1: 0.9999
Epoch 45/300
 - 82s - loss: 2.5597e-04 - val_loss: 3.1010e-04
 - val_f1: 0.9999
Epoch 46/300
 - 82s - loss: 2.6997e-04 - val_loss: 3.1260e-04
 - val_f1: 0.9999
Epoch 47/300
 - 82s - loss: 2.5429e-04 - val_loss: 2.9779e-04
 - val_f1: 0.9999
Epoch 48/300
 - 82s - loss: 2.6321e-04 - val_loss: 3.0139e-04
 - val_f1: 0.9999
Epoch 49/300
 - 82s - loss: 2.6684e-04 - val_loss: 3.0442e-04
 - val_f1: 0.9999
Epoch 50/300
 - 82s - loss: 2.7239e-04 - val_loss: 2.9719e-04
 - val_f1: 0.9999
Epoch 51/300
 - 82s - loss: 2.4874e-04 - val_loss: 3.1556e-04
 - val_f1: 0.9999
Epoch 52/300
 - 82s - loss: 2.5292e-04 - val_loss: 2.8652e-04
 - val_f1: 0.9999
Epoch 53/300
 - 82s - loss: 2.5855e-04 - val_loss: 2.9736e-04
 - val_f1: 0.9999
Epoch 54/300
 - 82s - loss: 2.5379e-04 - val_loss: 3.0292e-04
 - val_f1: 0.9999
Epoch 55/300
 - 82s - loss: 2.5242e-04 - val_loss: 3.1360e-04
 - val_f1: 0.9999
Epoch 56/300
 - 82s - loss: 2.5301e-04 - val_loss: 3.1275e-04
 - val_f1: 0.9999
Epoch 57/300
 - 82s - loss: 2.5483e-04 - val_loss: 3.6329e-04
 - val_f1: 0.9998
Epoch 58/300
 - 82s - loss: 2.6129e-04 - val_loss: 3.5249e-04
 - val_f1: 0.9998
Epoch 59/300
 - 82s - loss: 2.5240e-04 - val_loss: 2.7150e-04
 - val_f1: 0.9999
Epoch 60/300
 - 82s - loss: 2.5968e-04 - val_loss: 2.9069e-04
 - val_f1: 0.9999
Epoch 61/300
 - 82s - loss: 2.5100e-04 - val_loss: 3.2179e-04
2019-12-21 07:48:40,467 [INFO] epoch = 60. Intermediate model saved to results_selected_models/selected_kdd99_ann_shallow_rep1/ann_model_epoch_60.pickle
 - val_f1: 0.9999
Epoch 62/300
 - 82s - loss: 2.5291e-04 - val_loss: 3.7053e-04
 - val_f1: 0.9998
Epoch 63/300
 - 82s - loss: 2.5904e-04 - val_loss: 4.6811e-04
 - val_f1: 0.9997
Epoch 64/300
 - 82s - loss: 2.5560e-04 - val_loss: 3.3007e-04
 - val_f1: 0.9998
Epoch 65/300
 - 82s - loss: 2.4600e-04 - val_loss: 3.0023e-04
 - val_f1: 0.9999
Epoch 66/300
 - 82s - loss: 2.5113e-04 - val_loss: 3.1102e-04
 - val_f1: 0.9999
Epoch 67/300
 - 82s - loss: 2.4435e-04 - val_loss: 3.6324e-04
 - val_f1: 0.9998
Epoch 68/300
 - 82s - loss: 2.5257e-04 - val_loss: 2.9724e-04
 - val_f1: 0.9999
Epoch 69/300
 - 82s - loss: 2.5142e-04 - val_loss: 3.8055e-04
 - val_f1: 0.9998
Epoch 70/300
 - 82s - loss: 2.4577e-04 - val_loss: 2.9451e-04
 - val_f1: 0.9999
Epoch 71/300
 - 82s - loss: 2.4816e-04 - val_loss: 2.9707e-04
 - val_f1: 0.9999
Epoch 72/300
 - 82s - loss: 2.3938e-04 - val_loss: 3.5621e-04
 - val_f1: 0.9998
Epoch 73/300
 - 82s - loss: 2.5289e-04 - val_loss: 3.0420e-04
 - val_f1: 0.9999
Epoch 74/300
 - 82s - loss: 2.4322e-04 - val_loss: 2.9028e-04
 - val_f1: 0.9999
Epoch 75/300
 - 82s - loss: 2.4624e-04 - val_loss: 3.1429e-04
 - val_f1: 0.9999
Epoch 76/300
 - 82s - loss: 2.4292e-04 - val_loss: 3.2125e-04
 - val_f1: 0.9999
Epoch 77/300
 - 82s - loss: 2.4481e-04 - val_loss: 3.2757e-04
 - val_f1: 0.9998
Epoch 78/300
 - 82s - loss: 2.4468e-04 - val_loss: 2.9749e-04
 - val_f1: 0.9999
Epoch 79/300
 - 82s - loss: 2.4038e-04 - val_loss: 2.8449e-04
 - val_f1: 0.9999
Epoch 80/300
 - 82s - loss: 2.3411e-04 - val_loss: 3.1882e-04
 - val_f1: 0.9999
Epoch 81/300
 - 82s - loss: 2.4073e-04 - val_loss: 3.0363e-04
 - val_f1: 0.9999
Epoch 82/300
 - 82s - loss: 2.4422e-04 - val_loss: 2.8054e-04
 - val_f1: 0.9999
Epoch 83/300
 - 82s - loss: 2.4804e-04 - val_loss: 3.1155e-04
 - val_f1: 0.9999
Epoch 84/300
 - 82s - loss: 2.4804e-04 - val_loss: 3.0750e-04
 - val_f1: 0.9999
Epoch 85/300
 - 82s - loss: 2.5259e-04 - val_loss: 3.1416e-04
 - val_f1: 0.9999
Epoch 86/300
 - 82s - loss: 2.4213e-04 - val_loss: 3.2702e-04
 - val_f1: 0.9999
Epoch 87/300
 - 82s - loss: 2.4885e-04 - val_loss: 3.1622e-04
 - val_f1: 0.9999
Epoch 88/300
 - 82s - loss: 2.4768e-04 - val_loss: 3.0467e-04
 - val_f1: 0.9999
Epoch 89/300
 - 82s - loss: 2.2774e-04 - val_loss: 2.9266e-04
 - val_f1: 0.9999
Epoch 90/300
 - 82s - loss: 2.5062e-04 - val_loss: 3.3842e-04
 - val_f1: 0.9999
Epoch 91/300
 - 82s - loss: 2.4702e-04 - val_loss: 3.0213e-04
2019-12-21 08:41:30,142 [INFO] epoch = 90. Intermediate model saved to results_selected_models/selected_kdd99_ann_shallow_rep1/ann_model_epoch_90.pickle
 - val_f1: 0.9999
Epoch 92/300
 - 82s - loss: 2.3561e-04 - val_loss: 3.0109e-04
 - val_f1: 0.9999
Epoch 93/300
 - 82s - loss: 2.4020e-04 - val_loss: 3.1022e-04
 - val_f1: 0.9999
Epoch 94/300
 - 82s - loss: 2.4497e-04 - val_loss: 3.0292e-04
 - val_f1: 0.9999
Epoch 95/300
 - 82s - loss: 2.4422e-04 - val_loss: 3.2239e-04
 - val_f1: 0.9999
Epoch 96/300
 - 82s - loss: 2.4766e-04 - val_loss: 3.1016e-04
 - val_f1: 0.9999
Epoch 97/300
 - 82s - loss: 2.4064e-04 - val_loss: 3.5777e-04
 - val_f1: 0.9998
Epoch 98/300
 - 82s - loss: 2.4015e-04 - val_loss: 3.2504e-04
 - val_f1: 0.9999
Epoch 99/300
 - 82s - loss: 2.3583e-04 - val_loss: 3.2041e-04
 - val_f1: 0.9999
Epoch 100/300
 - 82s - loss: 2.3459e-04 - val_loss: 2.7326e-04
 - val_f1: 0.9999
Epoch 101/300
 - 82s - loss: 2.3605e-04 - val_loss: 3.1903e-04
 - val_f1: 0.9999
Epoch 102/300
 - 82s - loss: 2.2633e-04 - val_loss: 3.4362e-04
 - val_f1: 0.9999
Epoch 103/300
 - 82s - loss: 2.4725e-04 - val_loss: 3.5659e-04
 - val_f1: 0.9998
Epoch 104/300
 - 82s - loss: 2.3892e-04 - val_loss: 3.2426e-04
 - val_f1: 0.9999
Epoch 105/300
 - 82s - loss: 2.3936e-04 - val_loss: 3.0108e-04
 - val_f1: 0.9999
Epoch 106/300
 - 82s - loss: 2.4556e-04 - val_loss: 3.2025e-04
 - val_f1: 0.9999
Epoch 107/300
 - 82s - loss: 2.4013e-04 - val_loss: 3.2058e-04
 - val_f1: 0.9999
Epoch 108/300
 - 82s - loss: 2.4112e-04 - val_loss: 2.9498e-04
 - val_f1: 0.9999
Epoch 109/300
 - 82s - loss: 2.3694e-04 - val_loss: 3.5387e-04
2019-12-21 09:13:33,356 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-21 09:15:59,369 [INFO] Last epoch loss evaluation: train_loss = 0.000195, val_loss = 0.000271
2019-12-21 09:15:59,369 [INFO] Training complete. time_to_train = 11667.68 sec, 194.46 min
2019-12-21 09:15:59,374 [INFO] Model saved to results_selected_models/selected_kdd99_ann_shallow_rep1/best_model.pickle
/home/sunanda/research/ids_experiments/utility.py:268: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  plt.figure()
2019-12-21 09:15:59,552 [INFO] Plot saved to: results_selected_models/selected_kdd99_ann_shallow_rep1/training_error_history.png
/home/sunanda/research/ids_experiments/utility.py:285: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  plt.figure()
2019-12-21 09:15:59,729 [INFO] Plot saved to: results_selected_models/selected_kdd99_ann_shallow_rep1/training_f1_history.png
2019-12-21 09:15:59,729 [INFO] Making predictions on training, validation, testing data
2019-12-21 09:18:01,982 [INFO] Evaluating predictions (results)
2019-12-21 09:18:10,731 [INFO] Dataset: Testing. Classification report below
2019-12-21 09:18:10,731 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      0.97      0.99    229853
     normal.       0.73      0.99      0.84     60593
       probe       0.87      0.81      0.84      4166
         r2l       0.98      0.02      0.05     13781
         u2r       0.93      0.00      0.01      2636

    accuracy                           0.92    311029
   macro avg       0.90      0.56      0.54    311029
weighted avg       0.94      0.92      0.91    311029

2019-12-21 09:18:10,731 [INFO] Overall accuracy (micro avg): 0.924807654591694
2019-12-21 09:18:20,098 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9248         0.9248                       0.9248                0.0188                   0.0752  0.9248
1     Macro avg        0.9699         0.8997                       0.5603                0.0191                   0.4397  0.5435
2  Weighted avg        0.9686         0.9425                       0.9248                0.0201                   0.0752  0.9056
2019-12-21 09:18:50,541 [INFO] Dataset: Validation. Classification report below
2019-12-21 09:18:50,541 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00    776675
     normal.       1.00      1.00      1.00    194556
       probe       1.00      1.00      1.00      8221
         r2l       0.94      0.90      0.92       225
         u2r       1.00      0.40      0.57        10

    accuracy                           1.00    979687
   macro avg       0.99      0.86      0.90    979687
weighted avg       1.00      1.00      1.00    979687

2019-12-21 09:18:50,541 [INFO] Overall accuracy (micro avg): 0.9998805741017284
2019-12-21 09:19:23,394 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9999         0.9999                       0.9999                0.0000                   0.0001  0.9999
1     Macro avg        1.0000         0.9876                       0.8585                0.0000                   0.1415  0.8972
2  Weighted avg        1.0000         0.9999                       0.9999                0.0001                   0.0001  0.9999
2019-12-21 09:21:36,581 [INFO] Dataset: Training. Classification report below
2019-12-21 09:21:36,582 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00   3106695
     normal.       1.00      1.00      1.00    778225
       probe       1.00      1.00      1.00     32881
         r2l       0.92      0.93      0.92       901
         u2r       1.00      0.64      0.78        42

    accuracy                           1.00   3918744
   macro avg       0.98      0.91      0.94   3918744
weighted avg       1.00      1.00      1.00   3918744

2019-12-21 09:21:36,582 [INFO] Overall accuracy (micro avg): 0.9999022646031483
2019-12-21 09:24:00,433 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9999         0.9999                       0.9999                0.0000                   0.0001  0.9999
1     Macro avg        1.0000         0.9832                       0.9141                0.0000                   0.0859  0.9409
2  Weighted avg        1.0000         0.9999                       0.9999                0.0001                   0.0001  0.9999
2019-12-21 09:24:00,480 [INFO] Results saved to: results_selected_models/selected_kdd99_ann_shallow_rep1/selected_kdd99_ann_shallow_rep1_results.xlsx
2019-12-21 09:24:00,487 [INFO] ================= Finished running experiment no. 1 ================= 

2019-12-21 09:24:00,510 [INFO] Created directory: results_selected_models/selected_kdd99_ann_shallow_rep2
2019-12-21 09:24:00,511 [INFO] Initialized logging. log_filename = results_selected_models/selected_kdd99_ann_shallow_rep2/run_log.log
2019-12-21 09:24:00,511 [INFO] ================= Running experiment no. 2  ================= 

2019-12-21 09:24:00,511 [INFO] Experiment parameters given below
2019-12-21 09:24:00,511 [INFO] 
{'experiment_num': 2, 'results_dir': 'results_selected_models/selected_kdd99_ann_shallow_rep2', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [256], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 300, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/full_datasets/kdd99_five_classes', 'description': 'selected_kdd99_ann_shallow_rep2'}
2019-12-21 09:24:00,511 [INFO] Created tensorboard log directory: results_selected_models/selected_kdd99_ann_shallow_rep2/tf_logs_run_2019_12_21-09_24_00
2019-12-21 09:24:00,511 [INFO] Loading datsets from: ../Datasets/full_datasets/kdd99_five_classes
2019-12-21 09:24:00,511 [INFO] Reading X, y files
2019-12-21 09:24:00,511 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/X_train.h5
2019-12-21 09:24:06,875 [INFO] Reading complete. time_to_read=6.36 seconds
2019-12-21 09:24:06,875 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/X_val.h5
2019-12-21 09:24:08,551 [INFO] Reading complete. time_to_read=1.68 seconds
2019-12-21 09:24:08,551 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/X_test.h5
2019-12-21 09:24:09,023 [INFO] Reading complete. time_to_read=0.47 seconds
2019-12-21 09:24:09,023 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/y_train.h5
2019-12-21 09:24:09,266 [INFO] Reading complete. time_to_read=0.24 seconds
2019-12-21 09:24:09,266 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/y_val.h5
2019-12-21 09:24:09,323 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-21 09:24:09,323 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/y_test.h5
2019-12-21 09:24:09,343 [INFO] Reading complete. time_to_read=0.02 seconds
2019-12-21 09:24:16,371 [INFO] Initializing model
2019-12-21 09:24:16,497 [INFO] _________________________________________________________________
2019-12-21 09:24:16,497 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-21 09:24:16,497 [INFO] =================================================================
2019-12-21 09:24:16,497 [INFO] dense_23 (Dense)             (None, 256)               31744     
2019-12-21 09:24:16,497 [INFO] _________________________________________________________________
2019-12-21 09:24:16,497 [INFO] batch_normalization_12 (Batc (None, 256)               1024      
2019-12-21 09:24:16,497 [INFO] _________________________________________________________________
2019-12-21 09:24:16,497 [INFO] dropout_12 (Dropout)         (None, 256)               0         
2019-12-21 09:24:16,497 [INFO] _________________________________________________________________
2019-12-21 09:24:16,498 [INFO] dense_24 (Dense)             (None, 5)                 1285      
2019-12-21 09:24:16,498 [INFO] =================================================================
2019-12-21 09:24:16,498 [INFO] Total params: 34,053
2019-12-21 09:24:16,498 [INFO] Trainable params: 33,541
2019-12-21 09:24:16,498 [INFO] Non-trainable params: 512
2019-12-21 09:24:16,498 [INFO] _________________________________________________________________
2019-12-21 09:24:16,498 [INFO] Training model
 - val_f1: 0.9998
Epoch 00109: early stopping
Train on 3918744 samples, validate on 979687 samples
Epoch 1/300
 - 84s - loss: 0.0041 - val_loss: 0.0023
 - val_f1: 0.9994
Epoch 2/300
 - 83s - loss: 0.0023 - val_loss: 0.0022
 - val_f1: 0.9994
Epoch 3/300
 - 83s - loss: 0.0021 - val_loss: 0.0022
 - val_f1: 0.9993
Epoch 4/300
 - 83s - loss: 0.0012 - val_loss: 4.5338e-04
 - val_f1: 0.9998
Epoch 5/300
 - 83s - loss: 4.9251e-04 - val_loss: 5.6434e-04
 - val_f1: 0.9997
Epoch 6/300
 - 83s - loss: 4.4383e-04 - val_loss: 4.6391e-04
 - val_f1: 0.9998
Epoch 7/300
 - 83s - loss: 4.0753e-04 - val_loss: 3.9302e-04
 - val_f1: 0.9998
Epoch 8/300
 - 83s - loss: 4.0476e-04 - val_loss: 3.7227e-04
 - val_f1: 0.9998
Epoch 9/300
 - 83s - loss: 3.9007e-04 - val_loss: 4.1988e-04
 - val_f1: 0.9998
Epoch 10/300
 - 83s - loss: 3.8529e-04 - val_loss: 3.5188e-04
 - val_f1: 0.9998
Epoch 11/300
 - 83s - loss: 3.4701e-04 - val_loss: 3.6822e-04
 - val_f1: 0.9998
Epoch 12/300
 - 83s - loss: 3.4807e-04 - val_loss: 4.2148e-04
 - val_f1: 0.9997
Epoch 13/300
 - 83s - loss: 3.4285e-04 - val_loss: 4.2532e-04
 - val_f1: 0.9998
Epoch 14/300
 - 83s - loss: 3.3895e-04 - val_loss: 3.6619e-04
 - val_f1: 0.9998
Epoch 15/300
 - 83s - loss: 3.3090e-04 - val_loss: 3.5490e-04
 - val_f1: 0.9998
Epoch 16/300
 - 83s - loss: 3.2147e-04 - val_loss: 3.9117e-04
 - val_f1: 0.9998
Epoch 17/300
 - 83s - loss: 3.2162e-04 - val_loss: 3.4618e-04
 - val_f1: 0.9999
Epoch 18/300
 - 83s - loss: 3.1884e-04 - val_loss: 3.7789e-04
 - val_f1: 0.9998
Epoch 19/300
 - 83s - loss: 3.1752e-04 - val_loss: 3.6627e-04
 - val_f1: 0.9998
Epoch 20/300
 - 83s - loss: 3.1333e-04 - val_loss: 3.5277e-04
 - val_f1: 0.9998
Epoch 21/300
 - 83s - loss: 2.9960e-04 - val_loss: 3.6839e-04
 - val_f1: 0.9998
Epoch 22/300
 - 83s - loss: 2.8765e-04 - val_loss: 3.5392e-04
 - val_f1: 0.9998
Epoch 23/300
 - 83s - loss: 3.0526e-04 - val_loss: 3.3815e-04
 - val_f1: 0.9998
Epoch 24/300
 - 83s - loss: 2.9879e-04 - val_loss: 3.8938e-04
 - val_f1: 0.9998
Epoch 25/300
 - 83s - loss: 2.9703e-04 - val_loss: 3.4159e-04
 - val_f1: 0.9999
Epoch 26/300
 - 83s - loss: 3.0040e-04 - val_loss: 3.3315e-04
 - val_f1: 0.9999
Epoch 27/300
 - 83s - loss: 2.9053e-04 - val_loss: 3.5957e-04
 - val_f1: 0.9998
Epoch 28/300
 - 83s - loss: 2.7280e-04 - val_loss: 3.0204e-04
 - val_f1: 0.9999
Epoch 29/300
 - 83s - loss: 2.7669e-04 - val_loss: 3.4277e-04
 - val_f1: 0.9998
Epoch 30/300
 - 83s - loss: 2.8538e-04 - val_loss: 3.3806e-04
 - val_f1: 0.9998
Epoch 31/300
 - 83s - loss: 2.9623e-04 - val_loss: 3.4106e-04
2019-12-21 10:19:22,046 [INFO] epoch = 30. Intermediate model saved to results_selected_models/selected_kdd99_ann_shallow_rep2/ann_model_epoch_30.pickle
 - val_f1: 0.9999
Epoch 32/300
 - 83s - loss: 2.8563e-04 - val_loss: 3.5485e-04
 - val_f1: 0.9998
Epoch 33/300
 - 83s - loss: 2.8351e-04 - val_loss: 3.2069e-04
 - val_f1: 0.9999
Epoch 34/300
 - 83s - loss: 2.7033e-04 - val_loss: 3.5170e-04
 - val_f1: 0.9999
Epoch 35/300
 - 83s - loss: 2.7780e-04 - val_loss: 3.5186e-04
 - val_f1: 0.9999
Epoch 36/300
 - 83s - loss: 2.9074e-04 - val_loss: 3.2191e-04
 - val_f1: 0.9998
Epoch 37/300
 - 83s - loss: 2.6612e-04 - val_loss: 3.4551e-04
 - val_f1: 0.9998
Epoch 38/300
 - 83s - loss: 2.8028e-04 - val_loss: 3.5118e-04
 - val_f1: 0.9998
Epoch 39/300
 - 83s - loss: 2.6566e-04 - val_loss: 3.2312e-04
 - val_f1: 0.9999
Epoch 40/300
 - 83s - loss: 2.7017e-04 - val_loss: 3.4017e-04
 - val_f1: 0.9999
Epoch 41/300
 - 84s - loss: 2.7007e-04 - val_loss: 3.3883e-04
 - val_f1: 0.9999
Epoch 42/300
 - 84s - loss: 2.7570e-04 - val_loss: 3.3784e-04
 - val_f1: 0.9998
Epoch 43/300
 - 84s - loss: 2.7668e-04 - val_loss: 3.4388e-04
 - val_f1: 0.9998
Epoch 44/300
 - 84s - loss: 2.7546e-04 - val_loss: 3.4752e-04
 - val_f1: 0.9999
Epoch 45/300
 - 84s - loss: 2.7288e-04 - val_loss: 3.3561e-04
 - val_f1: 0.9998
Epoch 46/300
 - 84s - loss: 2.6745e-04 - val_loss: 3.5840e-04
 - val_f1: 0.9998
Epoch 47/300
 - 84s - loss: 2.6690e-04 - val_loss: 3.8123e-04
 - val_f1: 0.9999
Epoch 48/300
 - 84s - loss: 2.5785e-04 - val_loss: 3.3633e-04
 - val_f1: 0.9999
Epoch 49/300
 - 84s - loss: 2.6323e-04 - val_loss: 3.2966e-04
 - val_f1: 0.9998
Epoch 50/300
 - 84s - loss: 2.7278e-04 - val_loss: 3.6148e-04
 - val_f1: 0.9999
Epoch 51/300
 - 84s - loss: 2.7640e-04 - val_loss: 3.2282e-04
 - val_f1: 0.9998
Epoch 52/300
 - 84s - loss: 2.5734e-04 - val_loss: 3.9107e-04
 - val_f1: 0.9998
Epoch 53/300
 - 84s - loss: 2.6087e-04 - val_loss: 3.3691e-04
 - val_f1: 0.9998
Epoch 54/300
 - 84s - loss: 2.6041e-04 - val_loss: 3.1835e-04
 - val_f1: 0.9999
Epoch 55/300
 - 84s - loss: 2.6674e-04 - val_loss: 3.2632e-04
 - val_f1: 0.9999
Epoch 56/300
 - 84s - loss: 2.6908e-04 - val_loss: 3.2381e-04
 - val_f1: 0.9999
Epoch 57/300
 - 84s - loss: 2.6420e-04 - val_loss: 3.4600e-04
 - val_f1: 0.9999
Epoch 58/300
 - 84s - loss: 2.6616e-04 - val_loss: 2.8343e-04
 - val_f1: 0.9999
Epoch 59/300
 - 84s - loss: 2.6780e-04 - val_loss: 3.3717e-04
 - val_f1: 0.9999
Epoch 60/300
 - 84s - loss: 2.6532e-04 - val_loss: 3.9030e-04
 - val_f1: 0.9998
Epoch 61/300
 - 84s - loss: 2.6329e-04 - val_loss: 3.2479e-04
2019-12-21 11:13:31,059 [INFO] epoch = 60. Intermediate model saved to results_selected_models/selected_kdd99_ann_shallow_rep2/ann_model_epoch_60.pickle
 - val_f1: 0.9999
Epoch 62/300
 - 83s - loss: 2.6443e-04 - val_loss: 3.1628e-04
 - val_f1: 0.9998
Epoch 63/300
 - 83s - loss: 2.5599e-04 - val_loss: 3.3701e-04
 - val_f1: 0.9999
Epoch 64/300
 - 83s - loss: 2.6135e-04 - val_loss: 3.3640e-04
 - val_f1: 0.9999
Epoch 65/300
 - 83s - loss: 2.5869e-04 - val_loss: 3.0863e-04
 - val_f1: 0.9999
Epoch 66/300
 - 83s - loss: 2.5682e-04 - val_loss: 3.6577e-04
 - val_f1: 0.9999
Epoch 67/300
 - 83s - loss: 2.7776e-04 - val_loss: 3.3558e-04
 - val_f1: 0.9999
Epoch 68/300
 - 83s - loss: 2.5223e-04 - val_loss: 3.7502e-04
 - val_f1: 0.9998
Epoch 69/300
 - 83s - loss: 2.4869e-04 - val_loss: 4.7073e-04
 - val_f1: 0.9998
Epoch 70/300
 - 83s - loss: 2.5455e-04 - val_loss: 3.8360e-04
 - val_f1: 0.9998
Epoch 71/300
 - 83s - loss: 2.5521e-04 - val_loss: 3.1534e-04
 - val_f1: 0.9999
Epoch 72/300
 - 83s - loss: 2.4712e-04 - val_loss: 3.2566e-04
 - val_f1: 0.9999
Epoch 73/300
 - 83s - loss: 2.5753e-04 - val_loss: 3.2572e-04
 - val_f1: 0.9999
Epoch 74/300
 - 83s - loss: 2.5201e-04 - val_loss: 3.4737e-04
 - val_f1: 0.9998
Epoch 75/300
 - 83s - loss: 2.4845e-04 - val_loss: 3.1276e-04
 - val_f1: 0.9999
Epoch 76/300
 - 83s - loss: 2.6006e-04 - val_loss: 3.2406e-04
 - val_f1: 0.9999
Epoch 77/300
 - 83s - loss: 2.5296e-04 - val_loss: 3.7357e-04
 - val_f1: 0.9998
Epoch 78/300
 - 83s - loss: 2.5199e-04 - val_loss: 2.8875e-04
 - val_f1: 0.9999
Epoch 79/300
 - 83s - loss: 2.4306e-04 - val_loss: 3.1303e-04
 - val_f1: 0.9999
Epoch 80/300
 - 83s - loss: 2.5102e-04 - val_loss: 4.3370e-04
 - val_f1: 0.9997
Epoch 81/300
 - 83s - loss: 2.5086e-04 - val_loss: 3.4332e-04
 - val_f1: 0.9999
Epoch 82/300
 - 83s - loss: 2.4483e-04 - val_loss: 3.0542e-04
 - val_f1: 0.9999
Epoch 83/300
 - 83s - loss: 2.5344e-04 - val_loss: 3.7958e-04
 - val_f1: 0.9999
Epoch 84/300
 - 83s - loss: 2.5455e-04 - val_loss: 3.5372e-04
 - val_f1: 0.9998
Epoch 85/300
 - 83s - loss: 2.5141e-04 - val_loss: 3.4311e-04
 - val_f1: 0.9999
Epoch 86/300
 - 83s - loss: 2.4619e-04 - val_loss: 3.9697e-04
 - val_f1: 0.9998
Epoch 87/300
 - 83s - loss: 2.4410e-04 - val_loss: 3.1628e-04
 - val_f1: 0.9999
Epoch 88/300
 - 83s - loss: 2.5291e-04 - val_loss: 3.3474e-04
 - val_f1: 0.9999
Epoch 89/300
 - 83s - loss: 2.5081e-04 - val_loss: 2.9647e-04
 - val_f1: 0.9999
Epoch 90/300
 - 83s - loss: 2.6278e-04 - val_loss: 2.7300e-04
 - val_f1: 0.9999
Epoch 91/300
 - 83s - loss: 2.4812e-04 - val_loss: 8.3037e-04
2019-12-21 12:07:18,142 [INFO] epoch = 90. Intermediate model saved to results_selected_models/selected_kdd99_ann_shallow_rep2/ann_model_epoch_90.pickle
 - val_f1: 0.9993
Epoch 92/300
 - 83s - loss: 2.4515e-04 - val_loss: 3.1133e-04
 - val_f1: 0.9998
Epoch 93/300
 - 83s - loss: 2.4534e-04 - val_loss: 3.5373e-04
 - val_f1: 0.9998
Epoch 94/300
 - 83s - loss: 2.5109e-04 - val_loss: 2.9328e-04
 - val_f1: 0.9999
Epoch 95/300
 - 83s - loss: 2.4679e-04 - val_loss: 3.0272e-04
 - val_f1: 0.9999
Epoch 96/300
 - 83s - loss: 2.5922e-04 - val_loss: 3.1161e-04
 - val_f1: 0.9999
Epoch 97/300
 - 83s - loss: 2.4314e-04 - val_loss: 2.9623e-04
 - val_f1: 0.9999
Epoch 98/300
 - 83s - loss: 2.4290e-04 - val_loss: 3.0799e-04
 - val_f1: 0.9999
Epoch 99/300
 - 83s - loss: 2.4896e-04 - val_loss: 3.3842e-04
 - val_f1: 0.9998
Epoch 100/300
 - 83s - loss: 2.5243e-04 - val_loss: 3.1065e-04
 - val_f1: 0.9999
Epoch 101/300
 - 83s - loss: 2.3957e-04 - val_loss: 3.0986e-04
 - val_f1: 0.9999
Epoch 102/300
 - 83s - loss: 2.4611e-04 - val_loss: 3.3784e-04
 - val_f1: 0.9999
Epoch 103/300
 - 83s - loss: 2.3949e-04 - val_loss: 2.9686e-04
 - val_f1: 0.9999
Epoch 104/300
 - 83s - loss: 2.4803e-04 - val_loss: 3.2257e-04
 - val_f1: 0.9999
Epoch 105/300
 - 83s - loss: 2.3402e-04 - val_loss: 3.1848e-04
 - val_f1: 0.9999
Epoch 106/300
 - 83s - loss: 2.4098e-04 - val_loss: 3.1472e-04
 - val_f1: 0.9999
Epoch 107/300
 - 83s - loss: 2.3644e-04 - val_loss: 3.2093e-04
 - val_f1: 0.9999
Epoch 108/300
 - 83s - loss: 2.4301e-04 - val_loss: 3.0510e-04
 - val_f1: 0.9999
Epoch 109/300
 - 84s - loss: 2.4383e-04 - val_loss: 3.0288e-04
 - val_f1: 0.9999
Epoch 110/300
 - 84s - loss: 2.3587e-04 - val_loss: 3.7073e-04
 - val_f1: 0.9999
Epoch 111/300
 - 84s - loss: 2.5291e-04 - val_loss: 3.3578e-04
 - val_f1: 0.9999
Epoch 112/300
 - 84s - loss: 2.4574e-04 - val_loss: 3.7588e-04
 - val_f1: 0.9999
Epoch 113/300
 - 84s - loss: 2.4876e-04 - val_loss: 3.8830e-04
 - val_f1: 0.9999
Epoch 114/300
 - 84s - loss: 2.4739e-04 - val_loss: 3.0571e-04
 - val_f1: 0.9999
Epoch 115/300
 - 84s - loss: 2.4386e-04 - val_loss: 3.8165e-04
 - val_f1: 0.9999
Epoch 116/300
 - 84s - loss: 2.4247e-04 - val_loss: 9.2174e-04
 - val_f1: 0.9993
Epoch 117/300
 - 84s - loss: 2.5748e-04 - val_loss: 3.5252e-04
 - val_f1: 0.9999
Epoch 118/300
 - 84s - loss: 2.4758e-04 - val_loss: 3.4338e-04
 - val_f1: 0.9999
Epoch 119/300
 - 84s - loss: 2.4313e-04 - val_loss: 3.6271e-04
 - val_f1: 0.9998
Epoch 120/300
 - 84s - loss: 2.5084e-04 - val_loss: 3.4724e-04
 - val_f1: 0.9998
Epoch 121/300
 - 84s - loss: 2.3685e-04 - val_loss: 3.0962e-04
2019-12-21 13:01:33,971 [INFO] epoch = 120. Intermediate model saved to results_selected_models/selected_kdd99_ann_shallow_rep2/ann_model_epoch_120.pickle
 - val_f1: 0.9999
Epoch 122/300
 - 84s - loss: 2.5097e-04 - val_loss: 3.4274e-04
 - val_f1: 0.9999
Epoch 123/300
 - 84s - loss: 2.3898e-04 - val_loss: 3.1617e-04
 - val_f1: 0.9999
Epoch 124/300
 - 84s - loss: 2.4242e-04 - val_loss: 3.9177e-04
 - val_f1: 0.9998
Epoch 125/300
 - 84s - loss: 2.4317e-04 - val_loss: 3.0973e-04
 - val_f1: 0.9998
Epoch 126/300
 - 84s - loss: 2.4215e-04 - val_loss: 4.0590e-04
 - val_f1: 0.9998
Epoch 127/300
 - 84s - loss: 2.3859e-04 - val_loss: 3.4662e-04
 - val_f1: 0.9999
Epoch 128/300
 - 84s - loss: 2.4479e-04 - val_loss: 3.6575e-04
 - val_f1: 0.9998
Epoch 129/300
 - 84s - loss: 2.4311e-04 - val_loss: 3.6134e-04
 - val_f1: 0.9999
Epoch 130/300
 - 84s - loss: 2.3881e-04 - val_loss: 3.8757e-04
 - val_f1: 0.9998
Epoch 131/300
 - 84s - loss: 2.4107e-04 - val_loss: 3.0970e-04
 - val_f1: 0.9999
Epoch 132/300
 - 84s - loss: 2.5853e-04 - val_loss: 3.1680e-04
 - val_f1: 0.9999
Epoch 133/300
 - 84s - loss: 2.4512e-04 - val_loss: 4.0288e-04
 - val_f1: 0.9999
Epoch 134/300
 - 84s - loss: 2.5012e-04 - val_loss: 3.6488e-04
 - val_f1: 0.9998
Epoch 135/300
 - 84s - loss: 2.4422e-04 - val_loss: 3.3335e-04
 - val_f1: 0.9999
Epoch 136/300
 - 84s - loss: 2.4088e-04 - val_loss: 3.6809e-04
 - val_f1: 0.9998
Epoch 137/300
 - 84s - loss: 2.3989e-04 - val_loss: 3.1361e-04
 - val_f1: 0.9999
Epoch 138/300
 - 84s - loss: 2.5438e-04 - val_loss: 3.4064e-04
 - val_f1: 0.9999
Epoch 139/300
 - 84s - loss: 2.3635e-04 - val_loss: 3.5419e-04
 - val_f1: 0.9999
Epoch 140/300
 - 84s - loss: 2.4111e-04 - val_loss: 3.9491e-04
2019-12-21 13:36:21,333 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-21 13:39:13,947 [INFO] Last epoch loss evaluation: train_loss = 0.000216, val_loss = 0.000273
2019-12-21 13:39:13,947 [INFO] Training complete. time_to_train = 15297.45 sec, 254.96 min
2019-12-21 13:39:13,952 [INFO] Model saved to results_selected_models/selected_kdd99_ann_shallow_rep2/best_model.pickle
2019-12-21 13:39:14,146 [INFO] Plot saved to: results_selected_models/selected_kdd99_ann_shallow_rep2/training_error_history.png
2019-12-21 13:39:14,326 [INFO] Plot saved to: results_selected_models/selected_kdd99_ann_shallow_rep2/training_f1_history.png
2019-12-21 13:39:14,326 [INFO] Making predictions on training, validation, testing data
2019-12-21 13:41:22,057 [INFO] Evaluating predictions (results)
2019-12-21 13:41:30,830 [INFO] Dataset: Testing. Classification report below
2019-12-21 13:41:30,830 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      0.97      0.99    229853
     normal.       0.72      0.99      0.84     60593
       probe       0.80      0.79      0.80      4166
         r2l       0.82      0.03      0.05     13781
         u2r       1.00      0.00      0.00      2636

    accuracy                           0.92    311029
   macro avg       0.87      0.56      0.53    311029
weighted avg       0.94      0.92      0.90    311029

2019-12-21 13:41:30,830 [INFO] Overall accuracy (micro avg): 0.9232515296001338
2019-12-21 13:41:40,218 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9233         0.9233                       0.9233                0.0192                   0.0767  0.9233
1     Macro avg        0.9693         0.8689                       0.5561                0.0193                   0.4439  0.5346
2  Weighted avg        0.9680         0.9350                       0.9233                0.0196                   0.0767  0.9044
2019-12-21 13:42:10,517 [INFO] Dataset: Validation. Classification report below
2019-12-21 13:42:10,517 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00    776675
     normal.       1.00      1.00      1.00    194556
       probe       1.00      1.00      1.00      8221
         r2l       0.97      0.89      0.93       225
         u2r       1.00      0.20      0.33        10

    accuracy                           1.00    979687
   macro avg       0.99      0.82      0.85    979687
weighted avg       1.00      1.00      1.00    979687

2019-12-21 13:42:10,517 [INFO] Overall accuracy (micro avg): 0.9998877192409412
2019-12-21 13:42:43,216 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9999         0.9999                       0.9999                0.0000                   0.0001  0.9999
1     Macro avg        1.0000         0.9928                       0.8168                0.0000                   0.1832  0.8511
2  Weighted avg        1.0000         0.9999                       0.9999                0.0001                   0.0001  0.9999
2019-12-21 13:44:56,523 [INFO] Dataset: Training. Classification report below
2019-12-21 13:44:56,523 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00   3106695
     normal.       1.00      1.00      1.00    778225
       probe       1.00      1.00      1.00     32881
         r2l       0.95      0.89      0.92       901
         u2r       1.00      0.52      0.69        42

    accuracy                           1.00   3918744
   macro avg       0.99      0.88      0.92   3918744
weighted avg       1.00      1.00      1.00   3918744

2019-12-21 13:44:56,523 [INFO] Overall accuracy (micro avg): 0.9998961401918574
2019-12-21 13:47:20,653 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9999         0.9999                       0.9999                0.0000                   0.0001  0.9999
1     Macro avg        1.0000         0.9891                       0.8828                0.0000                   0.1172  0.9209
2  Weighted avg        1.0000         0.9999                       0.9999                0.0001                   0.0001  0.9999
2019-12-21 13:47:20,700 [INFO] Results saved to: results_selected_models/selected_kdd99_ann_shallow_rep2/selected_kdd99_ann_shallow_rep2_results.xlsx
2019-12-21 13:47:20,707 [INFO] ================= Finished running experiment no. 2 ================= 

2019-12-21 13:47:20,729 [INFO] Created directory: results_selected_models/selected_kdd99_ann_shallow_rep3
2019-12-21 13:47:20,730 [INFO] Initialized logging. log_filename = results_selected_models/selected_kdd99_ann_shallow_rep3/run_log.log
2019-12-21 13:47:20,730 [INFO] ================= Running experiment no. 3  ================= 

2019-12-21 13:47:20,730 [INFO] Experiment parameters given below
2019-12-21 13:47:20,730 [INFO] 
{'experiment_num': 3, 'results_dir': 'results_selected_models/selected_kdd99_ann_shallow_rep3', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [256], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 300, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/full_datasets/kdd99_five_classes', 'description': 'selected_kdd99_ann_shallow_rep3'}
2019-12-21 13:47:20,730 [INFO] Created tensorboard log directory: results_selected_models/selected_kdd99_ann_shallow_rep3/tf_logs_run_2019_12_21-13_47_20
2019-12-21 13:47:20,730 [INFO] Loading datsets from: ../Datasets/full_datasets/kdd99_five_classes
2019-12-21 13:47:20,730 [INFO] Reading X, y files
2019-12-21 13:47:20,730 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/X_train.h5
2019-12-21 13:47:27,226 [INFO] Reading complete. time_to_read=6.50 seconds
2019-12-21 13:47:27,226 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/X_val.h5
2019-12-21 13:47:28,895 [INFO] Reading complete. time_to_read=1.67 seconds
2019-12-21 13:47:28,896 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/X_test.h5
2019-12-21 13:47:29,368 [INFO] Reading complete. time_to_read=0.47 seconds
2019-12-21 13:47:29,368 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/y_train.h5
2019-12-21 13:47:29,597 [INFO] Reading complete. time_to_read=0.23 seconds
2019-12-21 13:47:29,597 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/y_val.h5
2019-12-21 13:47:29,654 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-21 13:47:29,654 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/y_test.h5
2019-12-21 13:47:29,674 [INFO] Reading complete. time_to_read=0.02 seconds
2019-12-21 13:47:36,948 [INFO] Initializing model
2019-12-21 13:47:37,074 [INFO] _________________________________________________________________
2019-12-21 13:47:37,074 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-21 13:47:37,074 [INFO] =================================================================
2019-12-21 13:47:37,074 [INFO] dense_25 (Dense)             (None, 256)               31744     
2019-12-21 13:47:37,074 [INFO] _________________________________________________________________
2019-12-21 13:47:37,075 [INFO] batch_normalization_13 (Batc (None, 256)               1024      
2019-12-21 13:47:37,075 [INFO] _________________________________________________________________
2019-12-21 13:47:37,075 [INFO] dropout_13 (Dropout)         (None, 256)               0         
2019-12-21 13:47:37,075 [INFO] _________________________________________________________________
2019-12-21 13:47:37,075 [INFO] dense_26 (Dense)             (None, 5)                 1285      
2019-12-21 13:47:37,075 [INFO] =================================================================
2019-12-21 13:47:37,075 [INFO] Total params: 34,053
2019-12-21 13:47:37,075 [INFO] Trainable params: 33,541
2019-12-21 13:47:37,075 [INFO] Non-trainable params: 512
2019-12-21 13:47:37,075 [INFO] _________________________________________________________________
2019-12-21 13:47:37,075 [INFO] Training model
 - val_f1: 0.9998
Epoch 00140: early stopping
Train on 3918744 samples, validate on 979687 samples
Epoch 1/300
 - 85s - loss: 0.0029 - val_loss: 9.6497e-04
 - val_f1: 0.9996
Epoch 2/300
 - 84s - loss: 8.4278e-04 - val_loss: 5.9113e-04
 - val_f1: 0.9997
Epoch 3/300
 - 84s - loss: 6.1589e-04 - val_loss: 4.7442e-04
 - val_f1: 0.9998
Epoch 4/300
 - 84s - loss: 5.1639e-04 - val_loss: 4.3633e-04
 - val_f1: 0.9998
Epoch 5/300
 - 84s - loss: 4.8840e-04 - val_loss: 4.2429e-04
 - val_f1: 0.9998
Epoch 6/300
 - 84s - loss: 4.4828e-04 - val_loss: 4.8859e-04
 - val_f1: 0.9998
Epoch 7/300
 - 84s - loss: 4.1085e-04 - val_loss: 4.0378e-04
 - val_f1: 0.9998
Epoch 8/300
 - 84s - loss: 3.9483e-04 - val_loss: 4.0020e-04
 - val_f1: 0.9998
Epoch 9/300
 - 83s - loss: 3.9741e-04 - val_loss: 3.9553e-04
 - val_f1: 0.9998
Epoch 10/300
 - 83s - loss: 3.7699e-04 - val_loss: 3.6445e-04
 - val_f1: 0.9998
Epoch 11/300
 - 84s - loss: 3.5991e-04 - val_loss: 3.7351e-04
 - val_f1: 0.9998
Epoch 12/300
 - 83s - loss: 3.5982e-04 - val_loss: 3.4814e-04
 - val_f1: 0.9998
Epoch 13/300
 - 83s - loss: 3.5426e-04 - val_loss: 3.5473e-04
 - val_f1: 0.9998
Epoch 14/300
 - 83s - loss: 3.5026e-04 - val_loss: 3.5261e-04
 - val_f1: 0.9998
Epoch 15/300
 - 83s - loss: 3.2654e-04 - val_loss: 3.5905e-04
 - val_f1: 0.9998
Epoch 16/300
 - 84s - loss: 3.1707e-04 - val_loss: 3.0869e-04
 - val_f1: 0.9998
Epoch 17/300
 - 84s - loss: 3.0811e-04 - val_loss: 3.8745e-04
 - val_f1: 0.9998
Epoch 18/300
 - 83s - loss: 3.0102e-04 - val_loss: 3.7765e-04
 - val_f1: 0.9998
Epoch 19/300
 - 84s - loss: 3.0978e-04 - val_loss: 3.1227e-04
 - val_f1: 0.9999
Epoch 20/300
 - 83s - loss: 3.0511e-04 - val_loss: 2.9336e-04
 - val_f1: 0.9999
Epoch 21/300
 - 83s - loss: 2.8933e-04 - val_loss: 3.2383e-04
 - val_f1: 0.9998
Epoch 22/300
 - 84s - loss: 2.7676e-04 - val_loss: 3.2015e-04
 - val_f1: 0.9999
Epoch 23/300
 - 84s - loss: 2.9164e-04 - val_loss: 3.0051e-04
 - val_f1: 0.9999
Epoch 24/300
 - 83s - loss: 2.7958e-04 - val_loss: 3.0255e-04
 - val_f1: 0.9998
Epoch 25/300
 - 83s - loss: 2.8715e-04 - val_loss: 2.9710e-04
 - val_f1: 0.9999
Epoch 26/300
 - 83s - loss: 2.7858e-04 - val_loss: 3.1781e-04
 - val_f1: 0.9998
Epoch 27/300
 - 83s - loss: 2.8436e-04 - val_loss: 3.0743e-04
 - val_f1: 0.9999
Epoch 28/300
 - 84s - loss: 2.8458e-04 - val_loss: 3.7509e-04
 - val_f1: 0.9998
Epoch 29/300
 - 83s - loss: 2.9102e-04 - val_loss: 3.0370e-04
 - val_f1: 0.9999
Epoch 30/300
 - 84s - loss: 2.7654e-04 - val_loss: 3.6091e-04
 - val_f1: 0.9998
Epoch 31/300
 - 83s - loss: 2.7882e-04 - val_loss: 3.1124e-04
2019-12-21 14:43:33,866 [INFO] epoch = 30. Intermediate model saved to results_selected_models/selected_kdd99_ann_shallow_rep3/ann_model_epoch_30.pickle
 - val_f1: 0.9998
Epoch 32/300
 - 84s - loss: 2.8783e-04 - val_loss: 3.2409e-04
 - val_f1: 0.9998
Epoch 33/300
 - 84s - loss: 2.8074e-04 - val_loss: 3.0628e-04
 - val_f1: 0.9999
Epoch 34/300
 - 84s - loss: 2.7251e-04 - val_loss: 3.2534e-04
 - val_f1: 0.9999
Epoch 35/300
 - 84s - loss: 2.7175e-04 - val_loss: 3.2924e-04
 - val_f1: 0.9999
Epoch 36/300
 - 84s - loss: 2.6318e-04 - val_loss: 3.2212e-04
 - val_f1: 0.9998
Epoch 37/300
 - 84s - loss: 2.6319e-04 - val_loss: 4.3795e-04
 - val_f1: 0.9998
Epoch 38/300
 - 84s - loss: 2.5685e-04 - val_loss: 3.6086e-04
 - val_f1: 0.9998
Epoch 39/300
 - 84s - loss: 2.6263e-04 - val_loss: 3.9922e-04
 - val_f1: 0.9998
Epoch 40/300
 - 84s - loss: 2.6168e-04 - val_loss: 2.9803e-04
 - val_f1: 0.9999
Epoch 41/300
 - 84s - loss: 2.5788e-04 - val_loss: 3.3833e-04
 - val_f1: 0.9998
Epoch 42/300
 - 84s - loss: 2.6339e-04 - val_loss: 3.3673e-04
 - val_f1: 0.9999
Epoch 43/300
 - 84s - loss: 2.6065e-04 - val_loss: 3.5572e-04
 - val_f1: 0.9998
Epoch 44/300
 - 84s - loss: 2.5873e-04 - val_loss: 3.1496e-04
 - val_f1: 0.9999
Epoch 45/300
 - 84s - loss: 2.6121e-04 - val_loss: 3.1425e-04
 - val_f1: 0.9999
Epoch 46/300
 - 84s - loss: 2.6115e-04 - val_loss: 3.2433e-04
 - val_f1: 0.9999
Epoch 47/300
 - 84s - loss: 2.5316e-04 - val_loss: 2.8453e-04
 - val_f1: 0.9999
Epoch 48/300
 - 84s - loss: 2.5005e-04 - val_loss: 3.1585e-04
 - val_f1: 0.9998
Epoch 49/300
 - 84s - loss: 2.5390e-04 - val_loss: 2.9571e-04
 - val_f1: 0.9999
Epoch 50/300
 - 84s - loss: 2.6041e-04 - val_loss: 3.0160e-04
 - val_f1: 0.9999
Epoch 51/300
 - 84s - loss: 2.4617e-04 - val_loss: 3.0354e-04
 - val_f1: 0.9999
Epoch 52/300
 - 84s - loss: 2.5205e-04 - val_loss: 3.2257e-04
 - val_f1: 0.9999
Epoch 53/300
 - 84s - loss: 2.5037e-04 - val_loss: 3.2300e-04
 - val_f1: 0.9999
Epoch 54/300
 - 84s - loss: 2.4883e-04 - val_loss: 3.1380e-04
 - val_f1: 0.9999
Epoch 55/300
 - 84s - loss: 2.4601e-04 - val_loss: 3.0047e-04
 - val_f1: 0.9999
Epoch 56/300
 - 84s - loss: 2.4346e-04 - val_loss: 3.1259e-04
 - val_f1: 0.9999
Epoch 57/300
 - 84s - loss: 2.5463e-04 - val_loss: 3.1405e-04
 - val_f1: 0.9998
Epoch 58/300
 - 84s - loss: 2.5962e-04 - val_loss: 3.0231e-04
 - val_f1: 0.9999
Epoch 59/300
 - 84s - loss: 2.5267e-04 - val_loss: 3.0337e-04
 - val_f1: 0.9999
Epoch 60/300
 - 84s - loss: 2.5046e-04 - val_loss: 2.7797e-04
 - val_f1: 0.9999
Epoch 61/300
 - 84s - loss: 2.4848e-04 - val_loss: 3.4259e-04
2019-12-21 15:38:18,170 [INFO] epoch = 60. Intermediate model saved to results_selected_models/selected_kdd99_ann_shallow_rep3/ann_model_epoch_60.pickle
 - val_f1: 0.9998
Epoch 62/300
 - 84s - loss: 2.5715e-04 - val_loss: 2.8646e-04
 - val_f1: 0.9999
Epoch 63/300
 - 84s - loss: 2.4268e-04 - val_loss: 2.9840e-04
 - val_f1: 0.9999
Epoch 64/300
 - 84s - loss: 2.5239e-04 - val_loss: 2.9667e-04
 - val_f1: 0.9999
Epoch 65/300
 - 84s - loss: 2.5216e-04 - val_loss: 2.8113e-04
 - val_f1: 0.9999
Epoch 66/300
 - 84s - loss: 2.3840e-04 - val_loss: 3.1937e-04
 - val_f1: 0.9999
Epoch 67/300
 - 84s - loss: 2.4604e-04 - val_loss: 3.2779e-04
 - val_f1: 0.9999
Epoch 68/300
 - 84s - loss: 2.4053e-04 - val_loss: 3.2524e-04
 - val_f1: 0.9999
Epoch 69/300
 - 84s - loss: 2.4951e-04 - val_loss: 3.0673e-04
 - val_f1: 0.9998
Epoch 70/300
 - 84s - loss: 2.4602e-04 - val_loss: 4.2700e-04
 - val_f1: 0.9998
Epoch 71/300
 - 84s - loss: 2.5884e-04 - val_loss: 2.7103e-04
 - val_f1: 0.9999
Epoch 72/300
 - 84s - loss: 2.5116e-04 - val_loss: 3.1519e-04
 - val_f1: 0.9998
Epoch 73/300
 - 84s - loss: 2.4260e-04 - val_loss: 2.8598e-04
 - val_f1: 0.9999
Epoch 74/300
 - 84s - loss: 2.4235e-04 - val_loss: 3.3434e-04
 - val_f1: 0.9998
Epoch 75/300
 - 84s - loss: 2.3509e-04 - val_loss: 2.8972e-04
 - val_f1: 0.9999
Epoch 76/300
 - 84s - loss: 2.4219e-04 - val_loss: 2.8597e-04
 - val_f1: 0.9999
Epoch 77/300
 - 84s - loss: 2.3559e-04 - val_loss: 3.1887e-04
 - val_f1: 0.9999
Epoch 78/300
 - 84s - loss: 2.4635e-04 - val_loss: 3.8809e-04
 - val_f1: 0.9998
Epoch 79/300
 - 84s - loss: 2.4187e-04 - val_loss: 3.2079e-04
 - val_f1: 0.9998
Epoch 80/300
 - 84s - loss: 2.3930e-04 - val_loss: 2.9302e-04
 - val_f1: 0.9999
Epoch 81/300
 - 84s - loss: 2.4688e-04 - val_loss: 2.9827e-04
 - val_f1: 0.9999
Epoch 82/300
 - 84s - loss: 2.3729e-04 - val_loss: 2.9194e-04
 - val_f1: 0.9999
Epoch 83/300
 - 84s - loss: 2.3241e-04 - val_loss: 2.9166e-04
 - val_f1: 0.9999
Epoch 84/300
 - 84s - loss: 2.3925e-04 - val_loss: 3.0831e-04
 - val_f1: 0.9999
Epoch 85/300
 - 84s - loss: 2.3824e-04 - val_loss: 2.9419e-04
 - val_f1: 0.9998
Epoch 86/300
 - 84s - loss: 2.3601e-04 - val_loss: 2.6963e-04
 - val_f1: 0.9999
Epoch 87/300
 - 84s - loss: 2.3462e-04 - val_loss: 2.9972e-04
 - val_f1: 0.9999
Epoch 88/300
 - 84s - loss: 2.3905e-04 - val_loss: 3.2575e-04
 - val_f1: 0.9998
Epoch 89/300
 - 84s - loss: 2.3510e-04 - val_loss: 3.1678e-04
 - val_f1: 0.9999
Epoch 90/300
 - 84s - loss: 2.3741e-04 - val_loss: 3.1047e-04
 - val_f1: 0.9999
Epoch 91/300
 - 84s - loss: 2.3528e-04 - val_loss: 3.0597e-04
2019-12-21 16:33:00,716 [INFO] epoch = 90. Intermediate model saved to results_selected_models/selected_kdd99_ann_shallow_rep3/ann_model_epoch_90.pickle
 - val_f1: 0.9999
Epoch 92/300
 - 84s - loss: 2.3987e-04 - val_loss: 3.3072e-04
 - val_f1: 0.9998
Epoch 93/300
 - 84s - loss: 2.4226e-04 - val_loss: 3.1211e-04
 - val_f1: 0.9999
Epoch 94/300
 - 84s - loss: 2.4343e-04 - val_loss: 3.5044e-04
 - val_f1: 0.9998
Epoch 95/300
 - 84s - loss: 2.3589e-04 - val_loss: 4.0787e-04
 - val_f1: 0.9998
Epoch 96/300
 - 84s - loss: 2.3062e-04 - val_loss: 2.8052e-04
 - val_f1: 0.9999
Epoch 97/300
 - 84s - loss: 2.2949e-04 - val_loss: 2.7821e-04
 - val_f1: 0.9999
Epoch 98/300
 - 84s - loss: 2.2629e-04 - val_loss: 2.9822e-04
 - val_f1: 0.9999
Epoch 99/300
 - 84s - loss: 2.3387e-04 - val_loss: 3.1083e-04
 - val_f1: 0.9999
Epoch 100/300
 - 84s - loss: 2.2762e-04 - val_loss: 2.8671e-04
 - val_f1: 0.9999
Epoch 101/300
 - 84s - loss: 2.3344e-04 - val_loss: 3.2234e-04
 - val_f1: 0.9999
Epoch 102/300
 - 84s - loss: 2.3459e-04 - val_loss: 3.2336e-04
 - val_f1: 0.9998
Epoch 103/300
 - 84s - loss: 2.3446e-04 - val_loss: 2.7310e-04
 - val_f1: 0.9999
Epoch 104/300
 - 84s - loss: 2.3167e-04 - val_loss: 3.2500e-04
 - val_f1: 0.9998
Epoch 105/300
 - 84s - loss: 2.3238e-04 - val_loss: 3.3636e-04
 - val_f1: 0.9998
Epoch 106/300
 - 84s - loss: 2.3335e-04 - val_loss: 2.7421e-04
 - val_f1: 0.9999
Epoch 107/300
 - 84s - loss: 2.3092e-04 - val_loss: 2.9304e-04
 - val_f1: 0.9999
Epoch 108/300
 - 84s - loss: 2.3348e-04 - val_loss: 3.3810e-04
 - val_f1: 0.9999
Epoch 109/300
 - 84s - loss: 2.3657e-04 - val_loss: 2.9715e-04
 - val_f1: 0.9999
Epoch 110/300
 - 84s - loss: 2.2834e-04 - val_loss: 3.0812e-04
 - val_f1: 0.9999
Epoch 111/300
 - 84s - loss: 2.3540e-04 - val_loss: 3.0191e-04
 - val_f1: 0.9998
Epoch 112/300
 - 84s - loss: 2.3170e-04 - val_loss: 2.8021e-04
 - val_f1: 0.9999
Epoch 113/300
 - 84s - loss: 2.2903e-04 - val_loss: 2.8889e-04
 - val_f1: 0.9998
Epoch 114/300
 - 84s - loss: 2.4514e-04 - val_loss: 3.0867e-04
 - val_f1: 0.9998
Epoch 115/300
 - 84s - loss: 2.2736e-04 - val_loss: 2.8620e-04
 - val_f1: 0.9999
Epoch 116/300
 - 84s - loss: 2.3432e-04 - val_loss: 3.1679e-04
 - val_f1: 0.9998
Epoch 117/300
 - 84s - loss: 2.3526e-04 - val_loss: 3.1425e-04
 - val_f1: 0.9999
Epoch 118/300
 - 84s - loss: 2.3308e-04 - val_loss: 2.7500e-04
 - val_f1: 0.9999
Epoch 119/300
 - 84s - loss: 2.2942e-04 - val_loss: 3.1886e-04
 - val_f1: 0.9999
Epoch 120/300
 - 84s - loss: 2.3781e-04 - val_loss: 3.2869e-04
 - val_f1: 0.9998
Epoch 121/300
 - 84s - loss: 2.3792e-04 - val_loss: 3.0624e-04
2019-12-21 17:27:40,741 [INFO] epoch = 120. Intermediate model saved to results_selected_models/selected_kdd99_ann_shallow_rep3/ann_model_epoch_120.pickle
 - val_f1: 0.9999
Epoch 122/300
 - 84s - loss: 2.3334e-04 - val_loss: 3.0001e-04
 - val_f1: 0.9999
Epoch 123/300
 - 84s - loss: 2.3718e-04 - val_loss: 2.9591e-04
 - val_f1: 0.9999
Epoch 124/300
 - 84s - loss: 2.3420e-04 - val_loss: 3.4441e-04
 - val_f1: 0.9998
Epoch 125/300
 - 84s - loss: 2.2404e-04 - val_loss: 2.8590e-04
 - val_f1: 0.9999
Epoch 126/300
 - 84s - loss: 2.3401e-04 - val_loss: 2.8246e-04
 - val_f1: 0.9999
Epoch 127/300
 - 84s - loss: 2.2352e-04 - val_loss: 2.8698e-04
 - val_f1: 0.9998
Epoch 128/300
 - 84s - loss: 2.2995e-04 - val_loss: 2.5478e-04
 - val_f1: 0.9999
Epoch 129/300
 - 84s - loss: 2.2398e-04 - val_loss: 2.5870e-04
 - val_f1: 0.9999
Epoch 130/300
 - 84s - loss: 2.3202e-04 - val_loss: 2.8835e-04
 - val_f1: 0.9999
Epoch 131/300
 - 84s - loss: 2.3383e-04 - val_loss: 2.9259e-04
 - val_f1: 0.9999
Epoch 132/300
 - 84s - loss: 2.2618e-04 - val_loss: 2.8257e-04
 - val_f1: 0.9999
Epoch 133/300
 - 84s - loss: 2.2070e-04 - val_loss: 2.9249e-04
 - val_f1: 0.9999
Epoch 134/300
 - 84s - loss: 2.2968e-04 - val_loss: 3.0603e-04
 - val_f1: 0.9999
Epoch 135/300
 - 84s - loss: 2.3504e-04 - val_loss: 2.9297e-04
 - val_f1: 0.9999
Epoch 136/300
 - 84s - loss: 2.3299e-04 - val_loss: 3.3917e-04
 - val_f1: 0.9998
Epoch 137/300
 - 84s - loss: 2.2947e-04 - val_loss: 2.9960e-04
 - val_f1: 0.9999
Epoch 138/300
 - 84s - loss: 2.2557e-04 - val_loss: 3.1672e-04
 - val_f1: 0.9999
Epoch 139/300
 - 84s - loss: 2.3552e-04 - val_loss: 3.0314e-04
 - val_f1: 0.9999
Epoch 140/300
 - 84s - loss: 2.2831e-04 - val_loss: 2.9521e-04
 - val_f1: 0.9999
Epoch 141/300
 - 84s - loss: 2.2269e-04 - val_loss: 3.0498e-04
 - val_f1: 0.9999
Epoch 142/300
 - 84s - loss: 2.3697e-04 - val_loss: 3.0317e-04
 - val_f1: 0.9999
Epoch 143/300
 - 84s - loss: 2.2715e-04 - val_loss: 3.1820e-04
 - val_f1: 0.9999
Epoch 144/300
 - 84s - loss: 2.2408e-04 - val_loss: 3.4042e-04
 - val_f1: 0.9998
Epoch 145/300
 - 84s - loss: 2.1923e-04 - val_loss: 3.1548e-04
 - val_f1: 0.9999
Epoch 146/300
 - 84s - loss: 2.2876e-04 - val_loss: 2.8079e-04
 - val_f1: 0.9999
Epoch 147/300
 - 84s - loss: 2.3780e-04 - val_loss: 2.7009e-04
 - val_f1: 0.9999
Epoch 148/300
 - 84s - loss: 2.2051e-04 - val_loss: 3.0126e-04
 - val_f1: 0.9999
Epoch 149/300
 - 84s - loss: 2.2486e-04 - val_loss: 3.1076e-04
 - val_f1: 0.9999
Epoch 150/300
 - 84s - loss: 2.1496e-04 - val_loss: 2.8291e-04
 - val_f1: 0.9999
Epoch 151/300
 - 84s - loss: 2.2781e-04 - val_loss: 3.1225e-04
2019-12-21 18:22:25,751 [INFO] epoch = 150. Intermediate model saved to results_selected_models/selected_kdd99_ann_shallow_rep3/ann_model_epoch_150.pickle
 - val_f1: 0.9999
Epoch 152/300
 - 84s - loss: 2.1808e-04 - val_loss: 2.9098e-04
 - val_f1: 0.9999
Epoch 153/300
 - 84s - loss: 2.3149e-04 - val_loss: 3.0020e-04
 - val_f1: 0.9999
Epoch 154/300
 - 84s - loss: 2.2156e-04 - val_loss: 3.1471e-04
 - val_f1: 0.9998
Epoch 155/300
 - 84s - loss: 2.2898e-04 - val_loss: 2.8599e-04
 - val_f1: 0.9999
Epoch 156/300
 - 84s - loss: 2.2364e-04 - val_loss: 2.8762e-04
 - val_f1: 0.9999
Epoch 157/300
 - 84s - loss: 2.3506e-04 - val_loss: 2.7864e-04
 - val_f1: 0.9999
Epoch 158/300
 - 84s - loss: 2.2434e-04 - val_loss: 2.9924e-04
 - val_f1: 0.9999
Epoch 159/300
 - 84s - loss: 2.2772e-04 - val_loss: 2.8130e-04
 - val_f1: 0.9999
Epoch 160/300
 - 84s - loss: 2.2254e-04 - val_loss: 2.8993e-04
 - val_f1: 0.9999
Epoch 161/300
 - 84s - loss: 2.1849e-04 - val_loss: 2.6955e-04
 - val_f1: 0.9999
Epoch 162/300
 - 84s - loss: 2.2677e-04 - val_loss: 2.7705e-04
 - val_f1: 0.9999
Epoch 163/300
 - 84s - loss: 2.3122e-04 - val_loss: 2.6340e-04
 - val_f1: 0.9999
Epoch 164/300
 - 84s - loss: 2.1944e-04 - val_loss: 2.6957e-04
 - val_f1: 0.9999
Epoch 165/300
 - 84s - loss: 2.2018e-04 - val_loss: 2.9022e-04
 - val_f1: 0.9999
Epoch 166/300
 - 84s - loss: 2.2690e-04 - val_loss: 3.3672e-04
 - val_f1: 0.9998
Epoch 167/300
 - 84s - loss: 2.1488e-04 - val_loss: 4.4217e-04
 - val_f1: 0.9998
Epoch 168/300
 - 84s - loss: 2.2277e-04 - val_loss: 2.9254e-04
 - val_f1: 0.9999
Epoch 169/300
 - 84s - loss: 2.2984e-04 - val_loss: 2.7913e-04
 - val_f1: 0.9999
Epoch 170/300
 - 84s - loss: 2.2079e-04 - val_loss: 2.8669e-04
 - val_f1: 0.9999
Epoch 171/300
 - 84s - loss: 2.2797e-04 - val_loss: 2.8146e-04
 - val_f1: 0.9999
Epoch 172/300
 - 84s - loss: 2.2409e-04 - val_loss: 2.9338e-04
 - val_f1: 0.9998
Epoch 173/300
 - 84s - loss: 2.2152e-04 - val_loss: 3.2010e-04
 - val_f1: 0.9999
Epoch 174/300
 - 84s - loss: 2.1692e-04 - val_loss: 3.2335e-04
 - val_f1: 0.9998
Epoch 175/300
 - 84s - loss: 2.2866e-04 - val_loss: 2.7960e-04
 - val_f1: 0.9998
Epoch 176/300
 - 84s - loss: 2.1663e-04 - val_loss: 2.5137e-04
 - val_f1: 0.9999
Epoch 177/300
 - 84s - loss: 2.2499e-04 - val_loss: 2.7726e-04
 - val_f1: 0.9999
Epoch 178/300
 - 84s - loss: 2.1133e-04 - val_loss: 3.0033e-04
 - val_f1: 0.9999
Epoch 179/300
 - 84s - loss: 2.2174e-04 - val_loss: 3.1283e-04
 - val_f1: 0.9999
Epoch 180/300
 - 84s - loss: 2.2156e-04 - val_loss: 4.2412e-04
 - val_f1: 0.9998
Epoch 181/300
 - 84s - loss: 2.2148e-04 - val_loss: 3.0571e-04
2019-12-21 19:17:08,411 [INFO] epoch = 180. Intermediate model saved to results_selected_models/selected_kdd99_ann_shallow_rep3/ann_model_epoch_180.pickle
 - val_f1: 0.9999
Epoch 182/300
 - 84s - loss: 2.3287e-04 - val_loss: 3.3133e-04
 - val_f1: 0.9998
Epoch 183/300
 - 84s - loss: 2.2649e-04 - val_loss: 2.6967e-04
 - val_f1: 0.9999
Epoch 184/300
 - 84s - loss: 2.1383e-04 - val_loss: 2.5488e-04
 - val_f1: 0.9999
Epoch 185/300
 - 84s - loss: 2.1865e-04 - val_loss: 2.6491e-04
 - val_f1: 0.9999
Epoch 186/300
 - 84s - loss: 2.2853e-04 - val_loss: 2.4870e-04
 - val_f1: 0.9999
Epoch 187/300
 - 84s - loss: 2.1209e-04 - val_loss: 2.7651e-04
 - val_f1: 0.9999
Epoch 188/300
 - 84s - loss: 2.2375e-04 - val_loss: 2.8384e-04
 - val_f1: 0.9999
Epoch 189/300
 - 84s - loss: 2.1657e-04 - val_loss: 3.0588e-04
 - val_f1: 0.9999
Epoch 190/300
 - 84s - loss: 2.2225e-04 - val_loss: 2.7895e-04
 - val_f1: 0.9999
Epoch 191/300
 - 84s - loss: 2.1925e-04 - val_loss: 3.0163e-04
 - val_f1: 0.9999
Epoch 192/300
 - 84s - loss: 2.1987e-04 - val_loss: 2.7956e-04
 - val_f1: 0.9999
Epoch 193/300
 - 84s - loss: 2.1203e-04 - val_loss: 2.9398e-04
 - val_f1: 0.9999
Epoch 194/300
 - 84s - loss: 2.0697e-04 - val_loss: 2.6173e-04
 - val_f1: 0.9999
Epoch 195/300
 - 84s - loss: 2.2226e-04 - val_loss: 3.0774e-04
 - val_f1: 0.9999
Epoch 196/300
 - 84s - loss: 2.0822e-04 - val_loss: 3.0303e-04
 - val_f1: 0.9999
Epoch 197/300
 - 84s - loss: 2.2275e-04 - val_loss: 2.7486e-04
 - val_f1: 0.9999
Epoch 198/300
 - 84s - loss: 2.1887e-04 - val_loss: 2.9272e-04
 - val_f1: 0.9999
Epoch 199/300
 - 84s - loss: 2.1695e-04 - val_loss: 3.0354e-04
 - val_f1: 0.9999
Epoch 200/300
 - 84s - loss: 2.2668e-04 - val_loss: 2.8489e-04
 - val_f1: 0.9999
Epoch 201/300
 - 84s - loss: 2.2115e-04 - val_loss: 2.6377e-04
 - val_f1: 0.9999
Epoch 202/300
 - 84s - loss: 2.1065e-04 - val_loss: 3.4464e-04
 - val_f1: 0.9998
Epoch 203/300
 - 84s - loss: 2.2199e-04 - val_loss: 3.8290e-04
 - val_f1: 0.9998
Epoch 204/300
 - 84s - loss: 2.1797e-04 - val_loss: 2.9878e-04
 - val_f1: 0.9999
Epoch 205/300
 - 84s - loss: 2.2264e-04 - val_loss: 2.7722e-04
 - val_f1: 0.9999
Epoch 206/300
 - 84s - loss: 2.2196e-04 - val_loss: 3.1251e-04
 - val_f1: 0.9999
Epoch 207/300
 - 84s - loss: 2.2095e-04 - val_loss: 2.6376e-04
 - val_f1: 0.9999
Epoch 208/300
 - 84s - loss: 2.1202e-04 - val_loss: 2.9211e-04
 - val_f1: 0.9999
Epoch 209/300
 - 84s - loss: 2.2053e-04 - val_loss: 2.6773e-04
 - val_f1: 0.9999
Epoch 210/300
 - 84s - loss: 2.1793e-04 - val_loss: 3.0144e-04
 - val_f1: 0.9999
Epoch 211/300
 - 84s - loss: 2.1778e-04 - val_loss: 2.9601e-04
2019-12-21 20:11:52,047 [INFO] epoch = 210. Intermediate model saved to results_selected_models/selected_kdd99_ann_shallow_rep3/ann_model_epoch_210.pickle
 - val_f1: 0.9999
Epoch 212/300
 - 84s - loss: 2.1371e-04 - val_loss: 3.4047e-04
 - val_f1: 0.9998
Epoch 213/300
 - 84s - loss: 2.2232e-04 - val_loss: 3.3084e-04
 - val_f1: 0.9998
Epoch 214/300
 - 84s - loss: 2.2289e-04 - val_loss: 2.8375e-04
 - val_f1: 0.9999
Epoch 215/300
 - 84s - loss: 2.1472e-04 - val_loss: 3.0404e-04
 - val_f1: 0.9999
Epoch 216/300
 - 84s - loss: 2.1561e-04 - val_loss: 4.1375e-04
 - val_f1: 0.9998
Epoch 217/300
 - 84s - loss: 2.2286e-04 - val_loss: 3.5183e-04
 - val_f1: 0.9998
Epoch 218/300
 - 84s - loss: 2.2453e-04 - val_loss: 2.6531e-04
 - val_f1: 0.9999
Epoch 219/300
 - 84s - loss: 2.1677e-04 - val_loss: 3.1552e-04
 - val_f1: 0.9999
Epoch 220/300
 - 84s - loss: 2.1986e-04 - val_loss: 2.8747e-04
 - val_f1: 0.9999
Epoch 221/300
 - 84s - loss: 2.1892e-04 - val_loss: 3.0105e-04
 - val_f1: 0.9999
Epoch 222/300
 - 84s - loss: 2.1611e-04 - val_loss: 3.1569e-04
 - val_f1: 0.9999
Epoch 223/300
 - 84s - loss: 2.2051e-04 - val_loss: 2.9199e-04
 - val_f1: 0.9999
Epoch 224/300
 - 84s - loss: 2.1302e-04 - val_loss: 2.9830e-04
 - val_f1: 0.9999
Epoch 225/300
 - 84s - loss: 2.0672e-04 - val_loss: 2.9671e-04
 - val_f1: 0.9999
Epoch 226/300
 - 84s - loss: 2.1293e-04 - val_loss: 2.7900e-04
 - val_f1: 0.9999
Epoch 227/300
 - 84s - loss: 2.2419e-04 - val_loss: 3.2047e-04
 - val_f1: 0.9999
Epoch 228/300
 - 84s - loss: 2.2299e-04 - val_loss: 2.9258e-04
 - val_f1: 0.9999
Epoch 229/300
 - 84s - loss: 2.1800e-04 - val_loss: 3.0705e-04
 - val_f1: 0.9999
Epoch 230/300
 - 84s - loss: 2.1552e-04 - val_loss: 3.0594e-04
 - val_f1: 0.9999
Epoch 231/300
 - 84s - loss: 2.1660e-04 - val_loss: 3.3260e-04
 - val_f1: 0.9998
Epoch 232/300
 - 84s - loss: 2.1874e-04 - val_loss: 3.0961e-04
 - val_f1: 0.9999
Epoch 233/300
 - 84s - loss: 2.1490e-04 - val_loss: 4.3433e-04
 - val_f1: 0.9997
Epoch 234/300
 - 84s - loss: 2.1375e-04 - val_loss: 3.0525e-04
 - val_f1: 0.9999
Epoch 235/300
 - 84s - loss: 2.0930e-04 - val_loss: 3.3365e-04
 - val_f1: 0.9998
Epoch 236/300
 - 84s - loss: 2.1483e-04 - val_loss: 7.5865e-04
2019-12-21 20:57:56,523 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-21 21:00:54,392 [INFO] Last epoch loss evaluation: train_loss = 0.000182, val_loss = 0.000249
2019-12-21 21:00:54,392 [INFO] Training complete. time_to_train = 25997.32 sec, 433.29 min
2019-12-21 21:00:54,397 [INFO] Model saved to results_selected_models/selected_kdd99_ann_shallow_rep3/best_model.pickle
2019-12-21 21:00:54,569 [INFO] Plot saved to: results_selected_models/selected_kdd99_ann_shallow_rep3/training_error_history.png
2019-12-21 21:00:54,734 [INFO] Plot saved to: results_selected_models/selected_kdd99_ann_shallow_rep3/training_f1_history.png
2019-12-21 21:00:54,735 [INFO] Making predictions on training, validation, testing data
2019-12-21 21:03:07,642 [INFO] Evaluating predictions (results)
2019-12-21 21:03:16,392 [INFO] Dataset: Testing. Classification report below
2019-12-21 21:03:16,392 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      0.97      0.99    229853
     normal.       0.73      0.98      0.84     60593
       probe       0.77      0.80      0.79      4166
         r2l       0.97      0.03      0.06     13781
         u2r       0.78      0.01      0.01      2636

    accuracy                           0.92    311029
   macro avg       0.85      0.56      0.54    311029
weighted avg       0.94      0.92      0.91    311029

2019-12-21 21:03:16,393 [INFO] Overall accuracy (micro avg): 0.9239845802159927
2019-12-21 21:03:25,784 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9240         0.9240                       0.9240                0.0190                   0.0760  0.9240
1     Macro avg        0.9696         0.8490                       0.5603                0.0192                   0.4397  0.5368
2  Weighted avg        0.9686         0.9398                       0.9240                0.0198                   0.0760  0.9054
2019-12-21 21:03:56,247 [INFO] Dataset: Validation. Classification report below
2019-12-21 21:03:56,248 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00    776675
     normal.       1.00      1.00      1.00    194556
       probe       1.00      0.99      1.00      8221
         r2l       0.94      0.89      0.92       225
         u2r       0.50      0.40      0.44        10

    accuracy                           1.00    979687
   macro avg       0.89      0.86      0.87    979687
weighted avg       1.00      1.00      1.00    979687

2019-12-21 21:03:56,248 [INFO] Overall accuracy (micro avg): 0.9998815948359017
2019-12-21 21:04:29,131 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9999         0.9999                       0.9999                0.0000                   0.0001  0.9999
1     Macro avg        1.0000         0.8884                       0.8576                0.0000                   0.1424  0.8717
2  Weighted avg        1.0000         0.9999                       0.9999                0.0001                   0.0001  0.9999
2019-12-21 21:06:42,394 [INFO] Dataset: Training. Classification report below
2019-12-21 21:06:42,394 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00   3106695
     normal.       1.00      1.00      1.00    778225
       probe       1.00      1.00      1.00     32881
         r2l       0.94      0.93      0.94       901
         u2r       1.00      0.71      0.83        42

    accuracy                           1.00   3918744
   macro avg       0.99      0.93      0.95   3918744
weighted avg       1.00      1.00      1.00   3918744

2019-12-21 21:06:42,394 [INFO] Overall accuracy (micro avg): 0.9999009886841294
2019-12-21 21:09:06,255 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9999         0.9999                       0.9999                0.0000                   0.0001  0.9999
1     Macro avg        1.0000         0.9887                       0.9272                0.0000                   0.0728  0.9531
2  Weighted avg        1.0000         0.9999                       0.9999                0.0001                   0.0001  0.9999
2019-12-21 21:09:06,302 [INFO] Results saved to: results_selected_models/selected_kdd99_ann_shallow_rep3/selected_kdd99_ann_shallow_rep3_results.xlsx
2019-12-21 21:09:06,309 [INFO] ================= Finished running experiment no. 3 ================= 

2019-12-21 21:09:06,331 [INFO] Created directory: results_selected_models/selected_kdd99_ann_shallow_rep4
2019-12-21 21:09:06,332 [INFO] Initialized logging. log_filename = results_selected_models/selected_kdd99_ann_shallow_rep4/run_log.log
2019-12-21 21:09:06,332 [INFO] ================= Running experiment no. 4  ================= 

2019-12-21 21:09:06,332 [INFO] Experiment parameters given below
2019-12-21 21:09:06,332 [INFO] 
{'experiment_num': 4, 'results_dir': 'results_selected_models/selected_kdd99_ann_shallow_rep4', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [256], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 300, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/full_datasets/kdd99_five_classes', 'description': 'selected_kdd99_ann_shallow_rep4'}
2019-12-21 21:09:06,332 [INFO] Created tensorboard log directory: results_selected_models/selected_kdd99_ann_shallow_rep4/tf_logs_run_2019_12_21-21_09_06
2019-12-21 21:09:06,332 [INFO] Loading datsets from: ../Datasets/full_datasets/kdd99_five_classes
2019-12-21 21:09:06,332 [INFO] Reading X, y files
2019-12-21 21:09:06,332 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/X_train.h5
2019-12-21 21:09:12,826 [INFO] Reading complete. time_to_read=6.49 seconds
2019-12-21 21:09:12,826 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/X_val.h5
2019-12-21 21:09:14,510 [INFO] Reading complete. time_to_read=1.68 seconds
2019-12-21 21:09:14,510 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/X_test.h5
2019-12-21 21:09:14,986 [INFO] Reading complete. time_to_read=0.48 seconds
2019-12-21 21:09:14,986 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/y_train.h5
2019-12-21 21:09:15,206 [INFO] Reading complete. time_to_read=0.22 seconds
2019-12-21 21:09:15,206 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/y_val.h5
2019-12-21 21:09:15,262 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-21 21:09:15,262 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/y_test.h5
2019-12-21 21:09:15,282 [INFO] Reading complete. time_to_read=0.02 seconds
2019-12-21 21:09:22,344 [INFO] Initializing model
2019-12-21 21:09:22,471 [INFO] _________________________________________________________________
2019-12-21 21:09:22,471 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-21 21:09:22,471 [INFO] =================================================================
2019-12-21 21:09:22,471 [INFO] dense_27 (Dense)             (None, 256)               31744     
2019-12-21 21:09:22,471 [INFO] _________________________________________________________________
2019-12-21 21:09:22,471 [INFO] batch_normalization_14 (Batc (None, 256)               1024      
2019-12-21 21:09:22,471 [INFO] _________________________________________________________________
2019-12-21 21:09:22,471 [INFO] dropout_14 (Dropout)         (None, 256)               0         
2019-12-21 21:09:22,471 [INFO] _________________________________________________________________
2019-12-21 21:09:22,471 [INFO] dense_28 (Dense)             (None, 5)                 1285      
2019-12-21 21:09:22,471 [INFO] =================================================================
2019-12-21 21:09:22,472 [INFO] Total params: 34,053
2019-12-21 21:09:22,472 [INFO] Trainable params: 33,541
2019-12-21 21:09:22,472 [INFO] Non-trainable params: 512
2019-12-21 21:09:22,472 [INFO] _________________________________________________________________
2019-12-21 21:09:22,472 [INFO] Training model
 - val_f1: 0.9994
Epoch 00236: early stopping
Train on 3918744 samples, validate on 979687 samples
Epoch 1/300
 - 84s - loss: 0.0038 - val_loss: 0.0021
 - val_f1: 0.9994
Epoch 2/300
 - 83s - loss: 0.0022 - val_loss: 0.0021
 - val_f1: 0.9995
Epoch 3/300
 - 83s - loss: 0.0021 - val_loss: 7.1551e-04
 - val_f1: 0.9995
Epoch 4/300
 - 83s - loss: 5.7364e-04 - val_loss: 4.8069e-04
 - val_f1: 0.9998
Epoch 5/300
 - 84s - loss: 5.0480e-04 - val_loss: 4.3860e-04
 - val_f1: 0.9998
Epoch 6/300
 - 84s - loss: 4.6685e-04 - val_loss: 4.2500e-04
 - val_f1: 0.9997
Epoch 7/300
 - 83s - loss: 4.2730e-04 - val_loss: 4.3570e-04
 - val_f1: 0.9998
Epoch 8/300
 - 83s - loss: 4.0128e-04 - val_loss: 4.3850e-04
 - val_f1: 0.9998
Epoch 9/300
 - 83s - loss: 3.9185e-04 - val_loss: 4.3354e-04
 - val_f1: 0.9998
Epoch 10/300
 - 84s - loss: 3.7127e-04 - val_loss: 4.4990e-04
 - val_f1: 0.9997
Epoch 11/300
 - 83s - loss: 3.5543e-04 - val_loss: 3.7597e-04
 - val_f1: 0.9998
Epoch 12/300
 - 84s - loss: 3.4177e-04 - val_loss: 3.6859e-04
 - val_f1: 0.9998
Epoch 13/300
 - 83s - loss: 3.4084e-04 - val_loss: 3.5545e-04
 - val_f1: 0.9998
Epoch 14/300
 - 84s - loss: 3.3961e-04 - val_loss: 3.8010e-04
 - val_f1: 0.9998
Epoch 15/300
 - 84s - loss: 3.4341e-04 - val_loss: 4.6917e-04
 - val_f1: 0.9997
Epoch 16/300
 - 84s - loss: 3.3569e-04 - val_loss: 3.8370e-04
 - val_f1: 0.9998
Epoch 17/300
 - 83s - loss: 3.1889e-04 - val_loss: 3.4664e-04
 - val_f1: 0.9998
Epoch 18/300
 - 83s - loss: 3.3283e-04 - val_loss: 3.6666e-04
 - val_f1: 0.9998
Epoch 19/300
 - 83s - loss: 3.2117e-04 - val_loss: 3.8745e-04
 - val_f1: 0.9998
Epoch 20/300
 - 84s - loss: 3.0492e-04 - val_loss: 3.4212e-04
 - val_f1: 0.9998
Epoch 21/300
 - 84s - loss: 3.0250e-04 - val_loss: 4.5947e-04
 - val_f1: 0.9997
Epoch 22/300
 - 84s - loss: 3.1176e-04 - val_loss: 3.4773e-04
 - val_f1: 0.9998
Epoch 23/300
 - 84s - loss: 2.9960e-04 - val_loss: 3.5913e-04
 - val_f1: 0.9998
Epoch 24/300
 - 83s - loss: 2.8824e-04 - val_loss: 3.5336e-04
 - val_f1: 0.9998
Epoch 25/300
 - 83s - loss: 2.9149e-04 - val_loss: 3.9276e-04
 - val_f1: 0.9998
Epoch 26/300
 - 84s - loss: 2.9808e-04 - val_loss: 3.6855e-04
 - val_f1: 0.9998
Epoch 27/300
 - 83s - loss: 2.7843e-04 - val_loss: 3.4147e-04
 - val_f1: 0.9998
Epoch 28/300
 - 84s - loss: 2.9268e-04 - val_loss: 3.3757e-04
 - val_f1: 0.9998
Epoch 29/300
 - 83s - loss: 2.8337e-04 - val_loss: 3.8540e-04
 - val_f1: 0.9998
Epoch 30/300
 - 83s - loss: 2.8154e-04 - val_loss: 3.2024e-04
 - val_f1: 0.9998
Epoch 31/300
 - 84s - loss: 2.7351e-04 - val_loss: 3.2216e-04
2019-12-21 22:07:00,087 [INFO] epoch = 30. Intermediate model saved to results_selected_models/selected_kdd99_ann_shallow_rep4/ann_model_epoch_30.pickle
 - val_f1: 0.9999
Epoch 32/300
 - 83s - loss: 2.8358e-04 - val_loss: 3.0223e-04
 - val_f1: 0.9999
Epoch 33/300
 - 83s - loss: 2.6343e-04 - val_loss: 3.2688e-04
 - val_f1: 0.9999
Epoch 34/300
 - 83s - loss: 2.7795e-04 - val_loss: 3.5872e-04
 - val_f1: 0.9998
Epoch 35/300
 - 83s - loss: 2.7688e-04 - val_loss: 3.5067e-04
 - val_f1: 0.9998
Epoch 36/300
 - 83s - loss: 2.7384e-04 - val_loss: 4.5075e-04
 - val_f1: 0.9997
Epoch 37/300
 - 83s - loss: 2.7210e-04 - val_loss: 4.2534e-04
 - val_f1: 0.9998
Epoch 38/300
 - 83s - loss: 2.6984e-04 - val_loss: 3.2328e-04
 - val_f1: 0.9999
Epoch 39/300
 - 83s - loss: 2.6577e-04 - val_loss: 3.4232e-04
 - val_f1: 0.9998
Epoch 40/300
 - 83s - loss: 2.5513e-04 - val_loss: 3.4124e-04
 - val_f1: 0.9999
Epoch 41/300
 - 83s - loss: 2.6408e-04 - val_loss: 3.4114e-04
 - val_f1: 0.9998
Epoch 42/300
 - 83s - loss: 2.7275e-04 - val_loss: 3.4048e-04
 - val_f1: 0.9999
Epoch 43/300
 - 83s - loss: 2.7011e-04 - val_loss: 3.4359e-04
 - val_f1: 0.9999
Epoch 44/300
 - 83s - loss: 2.5790e-04 - val_loss: 3.3543e-04
 - val_f1: 0.9999
Epoch 45/300
 - 83s - loss: 2.5958e-04 - val_loss: 3.3023e-04
 - val_f1: 0.9998
Epoch 46/300
 - 83s - loss: 2.5452e-04 - val_loss: 3.1636e-04
 - val_f1: 0.9999
Epoch 47/300
 - 83s - loss: 2.5380e-04 - val_loss: 3.2650e-04
 - val_f1: 0.9999
Epoch 48/300
 - 83s - loss: 2.5385e-04 - val_loss: 2.8485e-04
 - val_f1: 0.9999
Epoch 49/300
 - 83s - loss: 2.6035e-04 - val_loss: 3.3676e-04
 - val_f1: 0.9999
Epoch 50/300
 - 83s - loss: 2.3757e-04 - val_loss: 3.3123e-04
 - val_f1: 0.9998
Epoch 51/300
 - 83s - loss: 2.4731e-04 - val_loss: 3.1359e-04
 - val_f1: 0.9999
Epoch 52/300
 - 83s - loss: 2.5000e-04 - val_loss: 3.5488e-04
 - val_f1: 0.9998
Epoch 53/300
 - 83s - loss: 2.6821e-04 - val_loss: 3.1337e-04
 - val_f1: 0.9999
Epoch 54/300
 - 83s - loss: 2.6433e-04 - val_loss: 3.1589e-04
 - val_f1: 0.9999
Epoch 55/300
 - 83s - loss: 2.5884e-04 - val_loss: 3.6686e-04
 - val_f1: 0.9999
Epoch 56/300
 - 83s - loss: 2.4440e-04 - val_loss: 3.2922e-04
 - val_f1: 0.9998
Epoch 57/300
 - 83s - loss: 2.5229e-04 - val_loss: 3.1577e-04
 - val_f1: 0.9999
Epoch 58/300
 - 84s - loss: 2.4574e-04 - val_loss: 3.1775e-04
 - val_f1: 0.9999
Epoch 59/300
 - 83s - loss: 2.4138e-04 - val_loss: 3.0179e-04
 - val_f1: 0.9999
Epoch 60/300
 - 83s - loss: 2.5519e-04 - val_loss: 3.1956e-04
 - val_f1: 0.9999
Epoch 61/300
 - 83s - loss: 2.5421e-04 - val_loss: 3.0511e-04
2019-12-21 23:03:05,856 [INFO] epoch = 60. Intermediate model saved to results_selected_models/selected_kdd99_ann_shallow_rep4/ann_model_epoch_60.pickle
 - val_f1: 0.9999
Epoch 62/300
 - 83s - loss: 2.5085e-04 - val_loss: 3.0978e-04
 - val_f1: 0.9999
Epoch 63/300
 - 83s - loss: 2.4485e-04 - val_loss: 3.2879e-04
 - val_f1: 0.9999
Epoch 64/300
 - 83s - loss: 2.4154e-04 - val_loss: 2.9104e-04
 - val_f1: 0.9999
Epoch 65/300
 - 83s - loss: 2.4078e-04 - val_loss: 3.3831e-04
 - val_f1: 0.9998
Epoch 66/300
 - 83s - loss: 2.3413e-04 - val_loss: 3.2361e-04
 - val_f1: 0.9998
Epoch 67/300
 - 83s - loss: 2.4391e-04 - val_loss: 3.2358e-04
 - val_f1: 0.9999
Epoch 68/300
 - 83s - loss: 2.5388e-04 - val_loss: 2.9751e-04
 - val_f1: 0.9999
Epoch 69/300
 - 83s - loss: 2.3212e-04 - val_loss: 3.1359e-04
 - val_f1: 0.9999
Epoch 70/300
 - 83s - loss: 2.4289e-04 - val_loss: 3.4490e-04
 - val_f1: 0.9998
Epoch 71/300
 - 83s - loss: 2.3331e-04 - val_loss: 3.0697e-04
 - val_f1: 0.9999
Epoch 72/300
 - 83s - loss: 2.3678e-04 - val_loss: 3.0690e-04
 - val_f1: 0.9999
Epoch 73/300
 - 83s - loss: 2.4412e-04 - val_loss: 3.2731e-04
 - val_f1: 0.9999
Epoch 74/300
 - 83s - loss: 2.4720e-04 - val_loss: 3.3293e-04
 - val_f1: 0.9998
Epoch 75/300
 - 83s - loss: 2.3977e-04 - val_loss: 3.5354e-04
 - val_f1: 0.9999
Epoch 76/300
 - 83s - loss: 2.4856e-04 - val_loss: 3.3486e-04
 - val_f1: 0.9999
Epoch 77/300
 - 83s - loss: 2.3326e-04 - val_loss: 3.3276e-04
 - val_f1: 0.9998
Epoch 78/300
 - 83s - loss: 2.3537e-04 - val_loss: 3.2096e-04
 - val_f1: 0.9999
Epoch 79/300
 - 83s - loss: 2.3986e-04 - val_loss: 3.6322e-04
 - val_f1: 0.9998
Epoch 80/300
 - 83s - loss: 2.5367e-04 - val_loss: 3.0187e-04
 - val_f1: 0.9999
Epoch 81/300
 - 83s - loss: 2.4667e-04 - val_loss: 3.2884e-04
 - val_f1: 0.9999
Epoch 82/300
 - 83s - loss: 2.3744e-04 - val_loss: 3.0728e-04
 - val_f1: 0.9999
Epoch 83/300
 - 83s - loss: 2.4357e-04 - val_loss: 3.3867e-04
 - val_f1: 0.9999
Epoch 84/300
 - 83s - loss: 2.3700e-04 - val_loss: 6.2389e-04
 - val_f1: 0.9996
Epoch 85/300
 - 83s - loss: 2.3059e-04 - val_loss: 2.9059e-04
 - val_f1: 0.9999
Epoch 86/300
 - 83s - loss: 2.2738e-04 - val_loss: 3.0485e-04
 - val_f1: 0.9999
Epoch 87/300
 - 83s - loss: 2.2685e-04 - val_loss: 3.1769e-04
 - val_f1: 0.9999
Epoch 88/300
 - 83s - loss: 2.2741e-04 - val_loss: 3.1533e-04
 - val_f1: 0.9999
Epoch 89/300
 - 83s - loss: 2.3792e-04 - val_loss: 3.1245e-04
 - val_f1: 0.9999
Epoch 90/300
 - 83s - loss: 2.4149e-04 - val_loss: 3.3590e-04
 - val_f1: 0.9999
Epoch 91/300
 - 83s - loss: 2.2873e-04 - val_loss: 2.7982e-04
2019-12-21 23:59:14,228 [INFO] epoch = 90. Intermediate model saved to results_selected_models/selected_kdd99_ann_shallow_rep4/ann_model_epoch_90.pickle
 - val_f1: 0.9999
Epoch 92/300
 - 83s - loss: 2.3285e-04 - val_loss: 3.0233e-04
 - val_f1: 0.9999
Epoch 93/300
 - 83s - loss: 2.2754e-04 - val_loss: 3.4554e-04
 - val_f1: 0.9998
Epoch 94/300
 - 83s - loss: 2.2580e-04 - val_loss: 2.8443e-04
 - val_f1: 0.9999
Epoch 95/300
 - 83s - loss: 2.3185e-04 - val_loss: 2.8320e-04
 - val_f1: 0.9999
Epoch 96/300
 - 84s - loss: 2.2512e-04 - val_loss: 3.1579e-04
 - val_f1: 0.9998
Epoch 97/300
 - 83s - loss: 2.4281e-04 - val_loss: 3.1967e-04
 - val_f1: 0.9999
Epoch 98/300
 - 83s - loss: 2.3222e-04 - val_loss: 3.1209e-04
 - val_f1: 0.9999
Epoch 99/300
 - 83s - loss: 2.2425e-04 - val_loss: 3.0487e-04
 - val_f1: 0.9998
Epoch 100/300
 - 83s - loss: 2.3671e-04 - val_loss: 3.0636e-04
 - val_f1: 0.9999
Epoch 101/300
 - 83s - loss: 2.3497e-04 - val_loss: 3.2296e-04
 - val_f1: 0.9999
Epoch 102/300
 - 83s - loss: 2.2948e-04 - val_loss: 3.0342e-04
 - val_f1: 0.9999
Epoch 103/300
 - 83s - loss: 2.2944e-04 - val_loss: 3.1460e-04
 - val_f1: 0.9999
Epoch 104/300
 - 83s - loss: 2.4329e-04 - val_loss: 3.0334e-04
 - val_f1: 0.9999
Epoch 105/300
 - 83s - loss: 2.3124e-04 - val_loss: 3.3492e-04
 - val_f1: 0.9999
Epoch 106/300
 - 83s - loss: 2.2572e-04 - val_loss: 3.3252e-04
 - val_f1: 0.9999
Epoch 107/300
 - 83s - loss: 2.4273e-04 - val_loss: 3.0553e-04
 - val_f1: 0.9999
Epoch 108/300
 - 83s - loss: 2.3200e-04 - val_loss: 3.1715e-04
 - val_f1: 0.9999
Epoch 109/300
 - 83s - loss: 2.2158e-04 - val_loss: 3.5933e-04
 - val_f1: 0.9999
Epoch 110/300
 - 83s - loss: 2.4478e-04 - val_loss: 3.2328e-04
 - val_f1: 0.9999
Epoch 111/300
 - 83s - loss: 2.2687e-04 - val_loss: 3.3779e-04
 - val_f1: 0.9998
Epoch 112/300
 - 83s - loss: 2.3049e-04 - val_loss: 3.1272e-04
 - val_f1: 0.9999
Epoch 113/300
 - 83s - loss: 2.2770e-04 - val_loss: 4.0855e-04
 - val_f1: 0.9998
Epoch 114/300
 - 83s - loss: 2.3606e-04 - val_loss: 3.0753e-04
 - val_f1: 0.9999
Epoch 115/300
 - 83s - loss: 2.2623e-04 - val_loss: 3.1476e-04
 - val_f1: 0.9999
Epoch 116/300
 - 83s - loss: 2.2995e-04 - val_loss: 2.8930e-04
 - val_f1: 0.9999
Epoch 117/300
 - 83s - loss: 2.2911e-04 - val_loss: 3.5177e-04
 - val_f1: 0.9998
Epoch 118/300
 - 83s - loss: 2.2282e-04 - val_loss: 3.6874e-04
 - val_f1: 0.9998
Epoch 119/300
 - 83s - loss: 2.3512e-04 - val_loss: 2.8437e-04
 - val_f1: 0.9999
Epoch 120/300
 - 83s - loss: 2.2534e-04 - val_loss: 3.1799e-04
 - val_f1: 0.9998
Epoch 121/300
 - 83s - loss: 2.3074e-04 - val_loss: 2.6343e-04
2019-12-22 00:55:24,616 [INFO] epoch = 120. Intermediate model saved to results_selected_models/selected_kdd99_ann_shallow_rep4/ann_model_epoch_120.pickle
 - val_f1: 0.9999
Epoch 122/300
 - 83s - loss: 2.3381e-04 - val_loss: 3.2128e-04
 - val_f1: 0.9998
Epoch 123/300
 - 83s - loss: 2.2870e-04 - val_loss: 3.1863e-04
 - val_f1: 0.9999
Epoch 124/300
 - 83s - loss: 2.3065e-04 - val_loss: 2.6866e-04
 - val_f1: 0.9999
Epoch 125/300
 - 83s - loss: 2.2476e-04 - val_loss: 3.2110e-04
 - val_f1: 0.9999
Epoch 126/300
 - 83s - loss: 2.1774e-04 - val_loss: 3.9830e-04
 - val_f1: 0.9998
Epoch 127/300
 - 92s - loss: 2.2059e-04 - val_loss: 3.4325e-04
 - val_f1: 0.9999
Epoch 128/300
 - 83s - loss: 2.2730e-04 - val_loss: 2.8374e-04
 - val_f1: 0.9999
Epoch 129/300
 - 83s - loss: 2.2162e-04 - val_loss: 2.9432e-04
 - val_f1: 0.9999
Epoch 130/300
 - 83s - loss: 2.1944e-04 - val_loss: 2.9351e-04
 - val_f1: 0.9999
Epoch 131/300
 - 83s - loss: 2.2441e-04 - val_loss: 3.3176e-04
 - val_f1: 0.9998
Epoch 132/300
 - 83s - loss: 2.2369e-04 - val_loss: 3.1150e-04
 - val_f1: 0.9998
Epoch 133/300
 - 83s - loss: 2.2353e-04 - val_loss: 3.1282e-04
 - val_f1: 0.9998
Epoch 134/300
 - 83s - loss: 2.2519e-04 - val_loss: 3.7398e-04
 - val_f1: 0.9998
Epoch 135/300
 - 83s - loss: 2.2969e-04 - val_loss: 2.7960e-04
 - val_f1: 0.9999
Epoch 136/300
 - 83s - loss: 2.3030e-04 - val_loss: 3.0958e-04
 - val_f1: 0.9999
Epoch 137/300
 - 83s - loss: 2.1920e-04 - val_loss: 2.6503e-04
 - val_f1: 0.9999
Epoch 138/300
 - 83s - loss: 2.2310e-04 - val_loss: 3.1384e-04
 - val_f1: 0.9999
Epoch 139/300
 - 83s - loss: 2.2799e-04 - val_loss: 3.1430e-04
 - val_f1: 0.9999
Epoch 140/300
 - 83s - loss: 2.2612e-04 - val_loss: 2.8585e-04
 - val_f1: 0.9999
Epoch 141/300
 - 83s - loss: 2.2324e-04 - val_loss: 2.8479e-04
 - val_f1: 0.9999
Epoch 142/300
 - 83s - loss: 2.1820e-04 - val_loss: 2.7294e-04
 - val_f1: 0.9999
Epoch 143/300
 - 83s - loss: 2.1072e-04 - val_loss: 3.0782e-04
 - val_f1: 0.9999
Epoch 144/300
 - 83s - loss: 2.3300e-04 - val_loss: 3.6768e-04
 - val_f1: 0.9999
Epoch 145/300
 - 83s - loss: 2.2027e-04 - val_loss: 2.9928e-04
 - val_f1: 0.9999
Epoch 146/300
 - 83s - loss: 2.1936e-04 - val_loss: 3.0959e-04
 - val_f1: 0.9998
Epoch 147/300
 - 83s - loss: 2.2862e-04 - val_loss: 2.8294e-04
 - val_f1: 0.9999
Epoch 148/300
 - 83s - loss: 2.2421e-04 - val_loss: 3.4651e-04
 - val_f1: 0.9998
Epoch 149/300
 - 83s - loss: 2.2153e-04 - val_loss: 2.9048e-04
 - val_f1: 0.9999
Epoch 150/300
 - 83s - loss: 2.2176e-04 - val_loss: 2.9764e-04
 - val_f1: 0.9999
Epoch 151/300
 - 83s - loss: 2.0795e-04 - val_loss: 4.1199e-04
2019-12-22 01:51:44,145 [INFO] epoch = 150. Intermediate model saved to results_selected_models/selected_kdd99_ann_shallow_rep4/ann_model_epoch_150.pickle
 - val_f1: 0.9999
Epoch 152/300
 - 83s - loss: 2.1636e-04 - val_loss: 3.6756e-04
 - val_f1: 0.9998
Epoch 153/300
 - 83s - loss: 2.1977e-04 - val_loss: 2.5527e-04
 - val_f1: 0.9999
Epoch 154/300
 - 84s - loss: 2.3281e-04 - val_loss: 2.9453e-04
 - val_f1: 0.9999
Epoch 155/300
 - 83s - loss: 2.2719e-04 - val_loss: 2.8369e-04
 - val_f1: 0.9999
Epoch 156/300
 - 83s - loss: 2.1076e-04 - val_loss: 3.2036e-04
 - val_f1: 0.9998
Epoch 157/300
 - 83s - loss: 2.1500e-04 - val_loss: 3.0818e-04
 - val_f1: 0.9999
Epoch 158/300
 - 83s - loss: 2.3167e-04 - val_loss: 2.9971e-04
 - val_f1: 0.9999
Epoch 159/300
 - 83s - loss: 2.2593e-04 - val_loss: 3.0836e-04
 - val_f1: 0.9999
Epoch 160/300
 - 83s - loss: 2.1175e-04 - val_loss: 2.8131e-04
 - val_f1: 0.9999
Epoch 161/300
 - 83s - loss: 2.1805e-04 - val_loss: 3.2064e-04
 - val_f1: 0.9998
Epoch 162/300
 - 83s - loss: 2.2675e-04 - val_loss: 3.3445e-04
 - val_f1: 0.9999
Epoch 163/300
 - 83s - loss: 2.2322e-04 - val_loss: 2.9512e-04
 - val_f1: 0.9999
Epoch 164/300
 - 83s - loss: 2.0600e-04 - val_loss: 2.8781e-04
 - val_f1: 0.9999
Epoch 165/300
 - 83s - loss: 2.1025e-04 - val_loss: 3.0409e-04
 - val_f1: 0.9999
Epoch 166/300
 - 83s - loss: 2.0898e-04 - val_loss: 3.5634e-04
 - val_f1: 0.9999
Epoch 167/300
 - 83s - loss: 2.2863e-04 - val_loss: 0.0011
 - val_f1: 0.9993
Epoch 168/300
 - 83s - loss: 2.1762e-04 - val_loss: 2.7371e-04
 - val_f1: 0.9999
Epoch 169/300
 - 83s - loss: 2.1385e-04 - val_loss: 3.3351e-04
 - val_f1: 0.9999
Epoch 170/300
 - 83s - loss: 2.1951e-04 - val_loss: 3.6360e-04
 - val_f1: 0.9998
Epoch 171/300
 - 83s - loss: 2.2102e-04 - val_loss: 2.7032e-04
 - val_f1: 0.9999
Epoch 172/300
 - 83s - loss: 2.1411e-04 - val_loss: 3.2577e-04
 - val_f1: 0.9999
Epoch 173/300
 - 83s - loss: 2.3021e-04 - val_loss: 3.7726e-04
 - val_f1: 0.9998
Epoch 174/300
 - 83s - loss: 2.2684e-04 - val_loss: 2.6750e-04
 - val_f1: 0.9999
Epoch 175/300
 - 83s - loss: 2.1756e-04 - val_loss: 2.8725e-04
 - val_f1: 0.9999
Epoch 176/300
 - 83s - loss: 2.1620e-04 - val_loss: 3.3103e-04
 - val_f1: 0.9999
Epoch 177/300
 - 83s - loss: 2.2016e-04 - val_loss: 3.1507e-04
 - val_f1: 0.9999
Epoch 178/300
 - 83s - loss: 2.2036e-04 - val_loss: 3.3042e-04
 - val_f1: 0.9998
Epoch 179/300
 - 83s - loss: 2.2261e-04 - val_loss: 3.0756e-04
 - val_f1: 0.9999
Epoch 180/300
 - 83s - loss: 2.0966e-04 - val_loss: 3.2069e-04
 - val_f1: 0.9999
Epoch 181/300
 - 83s - loss: 2.2264e-04 - val_loss: 2.9760e-04
2019-12-22 02:47:52,247 [INFO] epoch = 180. Intermediate model saved to results_selected_models/selected_kdd99_ann_shallow_rep4/ann_model_epoch_180.pickle
 - val_f1: 0.9999
Epoch 182/300
 - 83s - loss: 2.1189e-04 - val_loss: 3.3679e-04
 - val_f1: 0.9998
Epoch 183/300
 - 83s - loss: 2.1082e-04 - val_loss: 2.7954e-04
 - val_f1: 0.9999
Epoch 184/300
 - 83s - loss: 2.0780e-04 - val_loss: 3.4210e-04
 - val_f1: 0.9999
Epoch 185/300
 - 83s - loss: 2.1586e-04 - val_loss: 3.5162e-04
 - val_f1: 0.9999
Epoch 186/300
 - 84s - loss: 2.1306e-04 - val_loss: 3.8444e-04
 - val_f1: 0.9998
Epoch 187/300
 - 83s - loss: 2.1875e-04 - val_loss: 3.2640e-04
 - val_f1: 0.9999
Epoch 188/300
 - 83s - loss: 2.0781e-04 - val_loss: 3.1901e-04
 - val_f1: 0.9999
Epoch 189/300
 - 83s - loss: 2.1267e-04 - val_loss: 4.5820e-04
 - val_f1: 0.9998
Epoch 190/300
 - 83s - loss: 2.1757e-04 - val_loss: 3.7971e-04
 - val_f1: 0.9998
Epoch 191/300
 - 83s - loss: 2.1317e-04 - val_loss: 3.5865e-04
 - val_f1: 0.9999
Epoch 192/300
 - 83s - loss: 2.1693e-04 - val_loss: 2.7902e-04
 - val_f1: 0.9998
Epoch 193/300
 - 83s - loss: 2.0759e-04 - val_loss: 3.4278e-04
 - val_f1: 0.9999
Epoch 194/300
 - 83s - loss: 2.1375e-04 - val_loss: 3.5126e-04
 - val_f1: 0.9999
Epoch 195/300
 - 83s - loss: 2.0977e-04 - val_loss: 2.8186e-04
 - val_f1: 0.9999
Epoch 196/300
 - 83s - loss: 2.2248e-04 - val_loss: 3.7693e-04
 - val_f1: 0.9998
Epoch 197/300
 - 83s - loss: 2.2452e-04 - val_loss: 2.9319e-04
 - val_f1: 0.9998
Epoch 198/300
 - 83s - loss: 2.1511e-04 - val_loss: 3.0202e-04
 - val_f1: 0.9998
Epoch 199/300
 - 83s - loss: 2.1458e-04 - val_loss: 2.9666e-04
 - val_f1: 0.9999
Epoch 200/300
 - 83s - loss: 2.1394e-04 - val_loss: 3.1771e-04
 - val_f1: 0.9998
Epoch 201/300
 - 83s - loss: 2.1017e-04 - val_loss: 2.9044e-04
 - val_f1: 0.9999
Epoch 202/300
 - 83s - loss: 2.1073e-04 - val_loss: 3.8954e-04
 - val_f1: 0.9998
Epoch 203/300
 - 83s - loss: 2.0489e-04 - val_loss: 4.2651e-04
2019-12-22 03:29:32,175 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-22 03:32:35,824 [INFO] Last epoch loss evaluation: train_loss = 0.000178, val_loss = 0.000255
2019-12-22 03:32:35,825 [INFO] Training complete. time_to_train = 22993.35 sec, 383.22 min
2019-12-22 03:32:35,830 [INFO] Model saved to results_selected_models/selected_kdd99_ann_shallow_rep4/best_model.pickle
2019-12-22 03:32:36,028 [INFO] Plot saved to: results_selected_models/selected_kdd99_ann_shallow_rep4/training_error_history.png
2019-12-22 03:32:36,209 [INFO] Plot saved to: results_selected_models/selected_kdd99_ann_shallow_rep4/training_f1_history.png
2019-12-22 03:32:36,209 [INFO] Making predictions on training, validation, testing data
2019-12-22 03:35:08,172 [INFO] Evaluating predictions (results)
2019-12-22 03:35:16,936 [INFO] Dataset: Testing. Classification report below
2019-12-22 03:35:16,937 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      0.97      0.99    229853
     normal.       0.72      0.98      0.83     60593
       probe       0.74      0.76      0.75      4166
         r2l       0.97      0.02      0.03     13781
         u2r       0.88      0.01      0.01      2636

    accuracy                           0.92    311029
   macro avg       0.86      0.55      0.52    311029
weighted avg       0.94      0.92      0.90    311029

2019-12-22 03:35:16,937 [INFO] Overall accuracy (micro avg): 0.9223030649875092
2019-12-22 03:35:26,316 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9223         0.9223                       0.9223                0.0194                   0.0777  0.9223
1     Macro avg        0.9689         0.8633                       0.5487                0.0196                   0.4513  0.5228
2  Weighted avg        0.9681         0.9396                       0.9223                0.0202                   0.0777  0.9028
2019-12-22 03:35:56,752 [INFO] Dataset: Validation. Classification report below
2019-12-22 03:35:56,752 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00    776675
     normal.       1.00      1.00      1.00    194556
       probe       1.00      1.00      1.00      8221
         r2l       0.94      0.90      0.92       225
         u2r       0.60      0.30      0.40        10

    accuracy                           1.00    979687
   macro avg       0.91      0.84      0.86    979687
weighted avg       1.00      1.00      1.00    979687

2019-12-22 03:35:56,752 [INFO] Overall accuracy (micro avg): 0.9998836363042481
2019-12-22 03:36:29,612 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9999         0.9999                       0.9999                0.0000                   0.0001  0.9999
1     Macro avg        1.0000         0.9066                       0.8387                0.0000                   0.1613  0.8626
2  Weighted avg        1.0000         0.9999                       0.9999                0.0001                   0.0001  0.9999
2019-12-22 03:38:43,099 [INFO] Dataset: Training. Classification report below
2019-12-22 03:38:43,099 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00   3106695
     normal.       1.00      1.00      1.00    778225
       probe       1.00      1.00      1.00     32881
         r2l       0.92      0.91      0.92       901
         u2r       1.00      0.67      0.80        42

    accuracy                           1.00   3918744
   macro avg       0.98      0.92      0.94   3918744
weighted avg       1.00      1.00      1.00   3918744

2019-12-22 03:38:43,099 [INFO] Overall accuracy (micro avg): 0.999901499051737
2019-12-22 03:41:07,371 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9999         0.9999                       0.9999                0.0000                   0.0001  0.9999
1     Macro avg        1.0000         0.9843                       0.9155                0.0000                   0.0845  0.9432
2  Weighted avg        1.0000         0.9999                       0.9999                0.0001                   0.0001  0.9999
2019-12-22 03:41:07,417 [INFO] Results saved to: results_selected_models/selected_kdd99_ann_shallow_rep4/selected_kdd99_ann_shallow_rep4_results.xlsx
2019-12-22 03:41:07,424 [INFO] ================= Finished running experiment no. 4 ================= 

2019-12-22 03:41:07,447 [INFO] Created directory: results_selected_models/selected_kdd99_ann_shallow_rep5
2019-12-22 03:41:07,447 [INFO] Initialized logging. log_filename = results_selected_models/selected_kdd99_ann_shallow_rep5/run_log.log
2019-12-22 03:41:07,448 [INFO] ================= Running experiment no. 5  ================= 

2019-12-22 03:41:07,448 [INFO] Experiment parameters given below
2019-12-22 03:41:07,448 [INFO] 
{'experiment_num': 5, 'results_dir': 'results_selected_models/selected_kdd99_ann_shallow_rep5', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [256], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 300, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/full_datasets/kdd99_five_classes', 'description': 'selected_kdd99_ann_shallow_rep5'}
2019-12-22 03:41:07,448 [INFO] Created tensorboard log directory: results_selected_models/selected_kdd99_ann_shallow_rep5/tf_logs_run_2019_12_22-03_41_07
2019-12-22 03:41:07,448 [INFO] Loading datsets from: ../Datasets/full_datasets/kdd99_five_classes
2019-12-22 03:41:07,448 [INFO] Reading X, y files
2019-12-22 03:41:07,448 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/X_train.h5
2019-12-22 03:41:14,019 [INFO] Reading complete. time_to_read=6.57 seconds
2019-12-22 03:41:14,019 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/X_val.h5
2019-12-22 03:41:15,706 [INFO] Reading complete. time_to_read=1.69 seconds
2019-12-22 03:41:15,706 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/X_test.h5
2019-12-22 03:41:16,178 [INFO] Reading complete. time_to_read=0.47 seconds
2019-12-22 03:41:16,178 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/y_train.h5
2019-12-22 03:41:16,398 [INFO] Reading complete. time_to_read=0.22 seconds
2019-12-22 03:41:16,398 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/y_val.h5
2019-12-22 03:41:16,455 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-22 03:41:16,455 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/y_test.h5
2019-12-22 03:41:16,475 [INFO] Reading complete. time_to_read=0.02 seconds
2019-12-22 03:41:23,717 [INFO] Initializing model
2019-12-22 03:41:23,844 [INFO] _________________________________________________________________
2019-12-22 03:41:23,844 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-22 03:41:23,844 [INFO] =================================================================
2019-12-22 03:41:23,844 [INFO] dense_29 (Dense)             (None, 256)               31744     
2019-12-22 03:41:23,844 [INFO] _________________________________________________________________
2019-12-22 03:41:23,844 [INFO] batch_normalization_15 (Batc (None, 256)               1024      
2019-12-22 03:41:23,845 [INFO] _________________________________________________________________
2019-12-22 03:41:23,845 [INFO] dropout_15 (Dropout)         (None, 256)               0         
2019-12-22 03:41:23,845 [INFO] _________________________________________________________________
2019-12-22 03:41:23,845 [INFO] dense_30 (Dense)             (None, 5)                 1285      
2019-12-22 03:41:23,845 [INFO] =================================================================
2019-12-22 03:41:23,845 [INFO] Total params: 34,053
2019-12-22 03:41:23,845 [INFO] Trainable params: 33,541
2019-12-22 03:41:23,845 [INFO] Non-trainable params: 512
2019-12-22 03:41:23,845 [INFO] _________________________________________________________________
2019-12-22 03:41:23,845 [INFO] Training model
 - val_f1: 0.9998
Epoch 00203: early stopping
Train on 3918744 samples, validate on 979687 samples
Epoch 1/300
 - 84s - loss: 0.0039 - val_loss: 0.0023
 - val_f1: 0.9994
Epoch 2/300
 - 83s - loss: 0.0022 - val_loss: 0.0021
 - val_f1: 0.9995
Epoch 3/300
 - 84s - loss: 0.0013 - val_loss: 4.9283e-04
 - val_f1: 0.9998
Epoch 4/300
 - 83s - loss: 5.3575e-04 - val_loss: 4.7240e-04
 - val_f1: 0.9997
Epoch 5/300
 - 84s - loss: 4.9712e-04 - val_loss: 4.0257e-04
 - val_f1: 0.9998
Epoch 6/300
 - 84s - loss: 4.3120e-04 - val_loss: 3.9603e-04
 - val_f1: 0.9998
Epoch 7/300
 - 84s - loss: 4.0403e-04 - val_loss: 4.0274e-04
 - val_f1: 0.9998
Epoch 8/300
 - 83s - loss: 3.8692e-04 - val_loss: 3.9262e-04
 - val_f1: 0.9998
Epoch 9/300
 - 84s - loss: 3.8189e-04 - val_loss: 3.8246e-04
 - val_f1: 0.9998
Epoch 10/300
 - 83s - loss: 3.6858e-04 - val_loss: 3.9032e-04
 - val_f1: 0.9998
Epoch 11/300
 - 84s - loss: 3.7801e-04 - val_loss: 3.9078e-04
 - val_f1: 0.9998
Epoch 12/300
 - 84s - loss: 3.5085e-04 - val_loss: 3.7416e-04
 - val_f1: 0.9998
Epoch 13/300
 - 84s - loss: 3.4961e-04 - val_loss: 3.7119e-04
 - val_f1: 0.9998
Epoch 14/300
 - 84s - loss: 3.3169e-04 - val_loss: 3.9436e-04
 - val_f1: 0.9998
Epoch 15/300
 - 83s - loss: 3.2579e-04 - val_loss: 3.5637e-04
 - val_f1: 0.9998
Epoch 16/300
 - 83s - loss: 3.3833e-04 - val_loss: 3.5493e-04
 - val_f1: 0.9998
Epoch 17/300
 - 84s - loss: 3.2101e-04 - val_loss: 3.8772e-04
 - val_f1: 0.9998
Epoch 18/300
 - 84s - loss: 3.1632e-04 - val_loss: 3.2437e-04
 - val_f1: 0.9998
Epoch 19/300
 - 84s - loss: 3.0521e-04 - val_loss: 3.9165e-04
 - val_f1: 0.9998
Epoch 20/300
 - 83s - loss: 3.0768e-04 - val_loss: 3.3037e-04
 - val_f1: 0.9998
Epoch 21/300
 - 84s - loss: 3.0376e-04 - val_loss: 3.3459e-04
 - val_f1: 0.9999
Epoch 22/300
 - 83s - loss: 3.1076e-04 - val_loss: 3.4484e-04
 - val_f1: 0.9999
Epoch 23/300
 - 84s - loss: 3.0277e-04 - val_loss: 3.3365e-04
 - val_f1: 0.9999
Epoch 24/300
 - 83s - loss: 3.0118e-04 - val_loss: 3.2353e-04
 - val_f1: 0.9999
Epoch 25/300
 - 84s - loss: 3.0857e-04 - val_loss: 3.3324e-04
 - val_f1: 0.9998
Epoch 26/300
 - 83s - loss: 3.0926e-04 - val_loss: 3.6264e-04
 - val_f1: 0.9998
Epoch 27/300
 - 84s - loss: 2.8385e-04 - val_loss: 3.3837e-04
 - val_f1: 0.9998
Epoch 28/300
 - 83s - loss: 2.8668e-04 - val_loss: 3.5408e-04
 - val_f1: 0.9998
Epoch 29/300
 - 84s - loss: 2.8544e-04 - val_loss: 3.4657e-04
 - val_f1: 0.9999
Epoch 30/300
 - 84s - loss: 2.9897e-04 - val_loss: 3.9162e-04
 - val_f1: 0.9998
Epoch 31/300
 - 84s - loss: 2.9268e-04 - val_loss: 2.9924e-04
2019-12-22 04:40:00,357 [INFO] epoch = 30. Intermediate model saved to results_selected_models/selected_kdd99_ann_shallow_rep5/ann_model_epoch_30.pickle
 - val_f1: 0.9999
Epoch 32/300
 - 83s - loss: 2.7832e-04 - val_loss: 3.9753e-04
 - val_f1: 0.9998
Epoch 33/300
 - 84s - loss: 2.9580e-04 - val_loss: 3.6838e-04
 - val_f1: 0.9998
Epoch 34/300
 - 84s - loss: 2.7975e-04 - val_loss: 3.1121e-04
 - val_f1: 0.9998
Epoch 35/300
 - 84s - loss: 2.8081e-04 - val_loss: 4.2022e-04
 - val_f1: 0.9998
Epoch 36/300
 - 84s - loss: 2.8256e-04 - val_loss: 3.3682e-04
 - val_f1: 0.9998
Epoch 37/300
 - 84s - loss: 2.7655e-04 - val_loss: 3.2608e-04
 - val_f1: 0.9999
Epoch 38/300
 - 84s - loss: 2.7086e-04 - val_loss: 3.2963e-04
 - val_f1: 0.9998
Epoch 39/300
 - 84s - loss: 2.6401e-04 - val_loss: 3.2372e-04
 - val_f1: 0.9998
Epoch 40/300
 - 84s - loss: 2.7737e-04 - val_loss: 3.0159e-04
 - val_f1: 0.9999
Epoch 41/300
 - 84s - loss: 2.8286e-04 - val_loss: 3.0157e-04
 - val_f1: 0.9998
Epoch 42/300
 - 83s - loss: 2.6838e-04 - val_loss: 3.0320e-04
 - val_f1: 0.9999
Epoch 43/300
 - 84s - loss: 2.6127e-04 - val_loss: 4.9763e-04
 - val_f1: 0.9998
Epoch 44/300
 - 84s - loss: 2.7033e-04 - val_loss: 3.1619e-04
 - val_f1: 0.9999
Epoch 45/300
 - 84s - loss: 2.6471e-04 - val_loss: 3.1417e-04
 - val_f1: 0.9998
Epoch 46/300
 - 84s - loss: 2.7397e-04 - val_loss: 3.1502e-04
 - val_f1: 0.9998
Epoch 47/300
 - 84s - loss: 2.6997e-04 - val_loss: 3.7925e-04
 - val_f1: 0.9998
Epoch 48/300
 - 84s - loss: 2.7084e-04 - val_loss: 3.3148e-04
 - val_f1: 0.9999
Epoch 49/300
 - 84s - loss: 2.6615e-04 - val_loss: 3.1479e-04
 - val_f1: 0.9999
Epoch 50/300
 - 83s - loss: 2.7397e-04 - val_loss: 3.3884e-04
 - val_f1: 0.9999
Epoch 51/300
 - 84s - loss: 2.6688e-04 - val_loss: 3.8030e-04
 - val_f1: 0.9998
Epoch 52/300
 - 84s - loss: 2.5736e-04 - val_loss: 3.5355e-04
 - val_f1: 0.9999
Epoch 53/300
 - 84s - loss: 2.7583e-04 - val_loss: 3.4281e-04
 - val_f1: 0.9998
Epoch 54/300
 - 84s - loss: 2.5691e-04 - val_loss: 3.3567e-04
 - val_f1: 0.9999
Epoch 55/300
 - 84s - loss: 2.6211e-04 - val_loss: 2.9755e-04
 - val_f1: 0.9999
Epoch 56/300
 - 84s - loss: 2.7236e-04 - val_loss: 3.1030e-04
 - val_f1: 0.9999
Epoch 57/300
 - 84s - loss: 2.5584e-04 - val_loss: 3.1761e-04
 - val_f1: 0.9999
Epoch 58/300
 - 84s - loss: 2.5710e-04 - val_loss: 3.1621e-04
 - val_f1: 0.9999
Epoch 59/300
 - 83s - loss: 2.6280e-04 - val_loss: 3.2685e-04
 - val_f1: 0.9999
Epoch 60/300
 - 84s - loss: 2.5609e-04 - val_loss: 3.3097e-04
 - val_f1: 0.9998
Epoch 61/300
 - 84s - loss: 2.5715e-04 - val_loss: 3.2066e-04
2019-12-22 05:37:01,749 [INFO] epoch = 60. Intermediate model saved to results_selected_models/selected_kdd99_ann_shallow_rep5/ann_model_epoch_60.pickle
 - val_f1: 0.9999
Epoch 62/300
 - 84s - loss: 2.5218e-04 - val_loss: 3.0769e-04
 - val_f1: 0.9999
Epoch 63/300
 - 84s - loss: 2.5854e-04 - val_loss: 3.4018e-04
 - val_f1: 0.9999
Epoch 64/300
 - 84s - loss: 2.4947e-04 - val_loss: 3.2292e-04
 - val_f1: 0.9999
Epoch 65/300
 - 83s - loss: 2.6121e-04 - val_loss: 2.7473e-04
 - val_f1: 0.9999
Epoch 66/300
 - 84s - loss: 2.5039e-04 - val_loss: 3.2958e-04
 - val_f1: 0.9999
Epoch 67/300
 - 84s - loss: 2.5378e-04 - val_loss: 3.4053e-04
 - val_f1: 0.9998
Epoch 68/300
 - 84s - loss: 2.5701e-04 - val_loss: 3.2893e-04
 - val_f1: 0.9999
Epoch 69/300
 - 84s - loss: 2.5706e-04 - val_loss: 3.2858e-04
 - val_f1: 0.9999
Epoch 70/300
 - 84s - loss: 2.5641e-04 - val_loss: 3.1516e-04
 - val_f1: 0.9999
Epoch 71/300
 - 84s - loss: 2.6113e-04 - val_loss: 2.8607e-04
 - val_f1: 0.9999
Epoch 72/300
 - 84s - loss: 2.5214e-04 - val_loss: 3.0661e-04
 - val_f1: 0.9999
Epoch 73/300
 - 84s - loss: 2.3919e-04 - val_loss: 3.1339e-04
 - val_f1: 0.9999
Epoch 74/300
 - 84s - loss: 2.4996e-04 - val_loss: 2.8679e-04
 - val_f1: 0.9999
Epoch 75/300
 - 84s - loss: 2.4682e-04 - val_loss: 2.9478e-04
 - val_f1: 0.9999
Epoch 76/300
 - 84s - loss: 2.4755e-04 - val_loss: 3.0860e-04
 - val_f1: 0.9999
Epoch 77/300
 - 84s - loss: 2.4711e-04 - val_loss: 6.2463e-04
 - val_f1: 0.9996
Epoch 78/300
 - 84s - loss: 2.5211e-04 - val_loss: 3.1199e-04
 - val_f1: 0.9999
Epoch 79/300
 - 84s - loss: 2.5049e-04 - val_loss: 3.1552e-04
 - val_f1: 0.9999
Epoch 80/300
 - 84s - loss: 2.5376e-04 - val_loss: 2.9205e-04
 - val_f1: 0.9999
Epoch 81/300
 - 84s - loss: 2.4255e-04 - val_loss: 3.4811e-04
 - val_f1: 0.9998
Epoch 82/300
 - 84s - loss: 2.4544e-04 - val_loss: 3.4670e-04
 - val_f1: 0.9998
Epoch 83/300
 - 84s - loss: 2.6001e-04 - val_loss: 3.5222e-04
 - val_f1: 0.9999
Epoch 84/300
 - 84s - loss: 2.5079e-04 - val_loss: 3.4257e-04
 - val_f1: 0.9999
Epoch 85/300
 - 87s - loss: 2.4574e-04 - val_loss: 3.6188e-04
 - val_f1: 0.9998
Epoch 86/300
 - 84s - loss: 2.4643e-04 - val_loss: 3.1719e-04
 - val_f1: 0.9999
Epoch 87/300
 - 84s - loss: 2.3431e-04 - val_loss: 3.1393e-04
 - val_f1: 0.9999
Epoch 88/300
 - 84s - loss: 2.3908e-04 - val_loss: 3.0872e-04
 - val_f1: 0.9999
Epoch 89/300
 - 84s - loss: 2.4928e-04 - val_loss: 3.0115e-04
 - val_f1: 0.9999
Epoch 90/300
 - 84s - loss: 2.4742e-04 - val_loss: 3.0893e-04
 - val_f1: 0.9999
Epoch 91/300
 - 84s - loss: 2.4869e-04 - val_loss: 3.1499e-04
2019-12-22 06:34:09,950 [INFO] epoch = 90. Intermediate model saved to results_selected_models/selected_kdd99_ann_shallow_rep5/ann_model_epoch_90.pickle
 - val_f1: 0.9999
Epoch 92/300
 - 84s - loss: 2.3273e-04 - val_loss: 3.0518e-04
 - val_f1: 0.9999
Epoch 93/300
 - 84s - loss: 2.4359e-04 - val_loss: 3.2940e-04
 - val_f1: 0.9998
Epoch 94/300
 - 84s - loss: 2.4466e-04 - val_loss: 2.6744e-04
 - val_f1: 0.9999
Epoch 95/300
 - 83s - loss: 2.3618e-04 - val_loss: 3.2399e-04
 - val_f1: 0.9999
Epoch 96/300
 - 84s - loss: 2.4454e-04 - val_loss: 3.2047e-04
 - val_f1: 0.9999
Epoch 97/300
 - 84s - loss: 2.4025e-04 - val_loss: 3.4933e-04
 - val_f1: 0.9998
Epoch 98/300
 - 84s - loss: 2.3882e-04 - val_loss: 3.4004e-04
 - val_f1: 0.9999
Epoch 99/300
 - 83s - loss: 2.4823e-04 - val_loss: 3.0057e-04
 - val_f1: 0.9999
Epoch 100/300
 - 84s - loss: 2.3862e-04 - val_loss: 2.8764e-04
 - val_f1: 0.9999
Epoch 101/300
 - 84s - loss: 2.4643e-04 - val_loss: 3.3431e-04
 - val_f1: 0.9999
Epoch 102/300
 - 84s - loss: 2.4773e-04 - val_loss: 3.2272e-04
 - val_f1: 0.9999
Epoch 103/300
 - 84s - loss: 2.3052e-04 - val_loss: 2.9890e-04
 - val_f1: 0.9999
Epoch 104/300
 - 84s - loss: 2.4487e-04 - val_loss: 3.2925e-04
 - val_f1: 0.9999
Epoch 105/300
 - 84s - loss: 2.4418e-04 - val_loss: 2.8331e-04
 - val_f1: 0.9999
Epoch 106/300
 - 84s - loss: 2.4104e-04 - val_loss: 3.9898e-04
 - val_f1: 0.9998
Epoch 107/300
 - 84s - loss: 2.4151e-04 - val_loss: 2.7572e-04
 - val_f1: 0.9999
Epoch 108/300
 - 84s - loss: 2.4079e-04 - val_loss: 2.8734e-04
 - val_f1: 0.9999
Epoch 109/300
 - 83s - loss: 2.3836e-04 - val_loss: 3.6437e-04
 - val_f1: 0.9998
Epoch 110/300
 - 84s - loss: 2.4490e-04 - val_loss: 3.6121e-04
 - val_f1: 0.9998
Epoch 111/300
 - 83s - loss: 2.4164e-04 - val_loss: 3.1852e-04
 - val_f1: 0.9999
Epoch 112/300
 - 84s - loss: 2.3445e-04 - val_loss: 3.3066e-04
 - val_f1: 0.9999
Epoch 113/300
 - 84s - loss: 2.4601e-04 - val_loss: 3.3463e-04
 - val_f1: 0.9999
Epoch 114/300
 - 84s - loss: 2.3811e-04 - val_loss: 2.8908e-04
 - val_f1: 0.9999
Epoch 115/300
 - 83s - loss: 2.3291e-04 - val_loss: 2.8974e-04
 - val_f1: 0.9999
Epoch 116/300
 - 84s - loss: 2.4943e-04 - val_loss: 2.8318e-04
 - val_f1: 0.9999
Epoch 117/300
 - 84s - loss: 2.4226e-04 - val_loss: 2.8928e-04
 - val_f1: 0.9999
Epoch 118/300
 - 84s - loss: 2.3320e-04 - val_loss: 3.0457e-04
 - val_f1: 0.9999
Epoch 119/300
 - 84s - loss: 2.5024e-04 - val_loss: 3.1172e-04
 - val_f1: 0.9999
Epoch 120/300
 - 84s - loss: 2.6095e-04 - val_loss: 2.8594e-04
 - val_f1: 0.9999
Epoch 121/300
 - 84s - loss: 2.4682e-04 - val_loss: 3.7130e-04
2019-12-22 07:31:12,591 [INFO] epoch = 120. Intermediate model saved to results_selected_models/selected_kdd99_ann_shallow_rep5/ann_model_epoch_120.pickle
 - val_f1: 0.9998
Epoch 122/300
 - 84s - loss: 2.3698e-04 - val_loss: 2.9827e-04
 - val_f1: 0.9999
Epoch 123/300
 - 84s - loss: 2.5778e-04 - val_loss: 3.1018e-04
 - val_f1: 0.9999
Epoch 124/300
 - 84s - loss: 2.3455e-04 - val_loss: 3.2426e-04
 - val_f1: 0.9998
Epoch 125/300
 - 84s - loss: 2.3600e-04 - val_loss: 3.6540e-04
 - val_f1: 0.9998
Epoch 126/300
 - 84s - loss: 2.3231e-04 - val_loss: 3.1282e-04
 - val_f1: 0.9999
Epoch 127/300
 - 84s - loss: 2.3082e-04 - val_loss: 3.3506e-04
 - val_f1: 0.9999
Epoch 128/300
 - 84s - loss: 2.3895e-04 - val_loss: 3.2216e-04
 - val_f1: 0.9999
Epoch 129/300
 - 84s - loss: 2.3114e-04 - val_loss: 2.9457e-04
 - val_f1: 0.9999
Epoch 130/300
 - 84s - loss: 2.3194e-04 - val_loss: 2.6956e-04
 - val_f1: 0.9999
Epoch 131/300
 - 83s - loss: 2.3196e-04 - val_loss: 2.6083e-04
 - val_f1: 0.9999
Epoch 132/300
 - 84s - loss: 2.3570e-04 - val_loss: 3.0431e-04
 - val_f1: 0.9999
Epoch 133/300
 - 84s - loss: 2.3464e-04 - val_loss: 3.0807e-04
 - val_f1: 0.9999
Epoch 134/300
 - 84s - loss: 2.3156e-04 - val_loss: 2.9603e-04
 - val_f1: 0.9999
Epoch 135/300
 - 84s - loss: 2.3559e-04 - val_loss: 2.8975e-04
 - val_f1: 0.9999
Epoch 136/300
 - 84s - loss: 2.3859e-04 - val_loss: 3.3020e-04
 - val_f1: 0.9998
Epoch 137/300
 - 84s - loss: 2.3524e-04 - val_loss: 3.0403e-04
 - val_f1: 0.9999
Epoch 138/300
 - 84s - loss: 2.3286e-04 - val_loss: 3.5694e-04
 - val_f1: 0.9999
Epoch 139/300
 - 84s - loss: 2.2514e-04 - val_loss: 2.8807e-04
 - val_f1: 0.9999
Epoch 140/300
 - 84s - loss: 2.2695e-04 - val_loss: 2.9663e-04
 - val_f1: 0.9999
Epoch 141/300
 - 84s - loss: 2.3436e-04 - val_loss: 2.6651e-04
 - val_f1: 0.9999
Epoch 142/300
 - 84s - loss: 2.3580e-04 - val_loss: 2.8229e-04
 - val_f1: 0.9999
Epoch 143/300
 - 84s - loss: 2.3230e-04 - val_loss: 3.1407e-04
 - val_f1: 0.9999
Epoch 144/300
 - 84s - loss: 2.3411e-04 - val_loss: 3.0402e-04
 - val_f1: 0.9999
Epoch 145/300
 - 84s - loss: 2.2974e-04 - val_loss: 2.9152e-04
 - val_f1: 0.9999
Epoch 146/300
 - 84s - loss: 2.3008e-04 - val_loss: 2.7540e-04
 - val_f1: 0.9999
Epoch 147/300
 - 84s - loss: 2.3440e-04 - val_loss: 2.6102e-04
 - val_f1: 0.9999
Epoch 148/300
 - 84s - loss: 2.3295e-04 - val_loss: 2.8338e-04
 - val_f1: 0.9999
Epoch 149/300
 - 84s - loss: 2.3194e-04 - val_loss: 2.7949e-04
 - val_f1: 0.9999
Epoch 150/300
 - 84s - loss: 2.2723e-04 - val_loss: 3.0381e-04
 - val_f1: 0.9999
Epoch 151/300
 - 84s - loss: 2.2198e-04 - val_loss: 3.0163e-04
2019-12-22 08:28:16,215 [INFO] epoch = 150. Intermediate model saved to results_selected_models/selected_kdd99_ann_shallow_rep5/ann_model_epoch_150.pickle
 - val_f1: 0.9999
Epoch 152/300
 - 84s - loss: 2.3112e-04 - val_loss: 2.9556e-04
 - val_f1: 0.9999
Epoch 153/300
 - 84s - loss: 2.3606e-04 - val_loss: 3.0738e-04
 - val_f1: 0.9999
Epoch 154/300
 - 84s - loss: 2.3169e-04 - val_loss: 3.0844e-04
 - val_f1: 0.9999
Epoch 155/300
 - 84s - loss: 2.3708e-04 - val_loss: 4.6815e-04
 - val_f1: 0.9998
Epoch 156/300
 - 84s - loss: 2.4146e-04 - val_loss: 3.3257e-04
 - val_f1: 0.9999
Epoch 157/300
 - 84s - loss: 2.3483e-04 - val_loss: 3.0025e-04
 - val_f1: 0.9999
Epoch 158/300
 - 84s - loss: 2.3854e-04 - val_loss: 3.0317e-04
 - val_f1: 0.9999
Epoch 159/300
 - 84s - loss: 2.3294e-04 - val_loss: 3.0197e-04
 - val_f1: 0.9999
Epoch 160/300
 - 84s - loss: 2.2462e-04 - val_loss: 3.2933e-04
 - val_f1: 0.9999
Epoch 161/300
 - 84s - loss: 2.3607e-04 - val_loss: 3.1296e-04
 - val_f1: 0.9999
Epoch 162/300
 - 84s - loss: 2.4152e-04 - val_loss: 3.7324e-04
 - val_f1: 0.9998
Epoch 163/300
 - 84s - loss: 2.2737e-04 - val_loss: 3.4209e-04
 - val_f1: 0.9998
Epoch 164/300
 - 84s - loss: 2.3180e-04 - val_loss: 3.3282e-04
 - val_f1: 0.9999
Epoch 165/300
 - 84s - loss: 2.2891e-04 - val_loss: 3.1175e-04
 - val_f1: 0.9999
Epoch 166/300
 - 84s - loss: 2.2860e-04 - val_loss: 4.5230e-04
 - val_f1: 0.9998
Epoch 167/300
 - 84s - loss: 2.2610e-04 - val_loss: 3.0980e-04
 - val_f1: 0.9999
Epoch 168/300
 - 84s - loss: 2.2937e-04 - val_loss: 2.8197e-04
 - val_f1: 0.9999
Epoch 169/300
 - 84s - loss: 2.2800e-04 - val_loss: 2.7620e-04
 - val_f1: 0.9999
Epoch 170/300
 - 84s - loss: 2.2828e-04 - val_loss: 3.3482e-04
 - val_f1: 0.9998
Epoch 171/300
 - 84s - loss: 2.3256e-04 - val_loss: 4.1358e-04
 - val_f1: 0.9998
Epoch 172/300
 - 84s - loss: 2.3408e-04 - val_loss: 3.0997e-04
 - val_f1: 0.9999
Epoch 173/300
 - 84s - loss: 2.2125e-04 - val_loss: 3.2952e-04
 - val_f1: 0.9999
Epoch 174/300
 - 84s - loss: 2.2764e-04 - val_loss: 2.8666e-04
 - val_f1: 0.9999
Epoch 175/300
 - 84s - loss: 2.3724e-04 - val_loss: 2.9516e-04
 - val_f1: 0.9999
Epoch 176/300
 - 84s - loss: 2.2571e-04 - val_loss: 3.1182e-04
 - val_f1: 0.9999
Epoch 177/300
 - 84s - loss: 2.2342e-04 - val_loss: 3.1499e-04
 - val_f1: 0.9999
Epoch 178/300
 - 84s - loss: 2.3394e-04 - val_loss: 3.0089e-04
 - val_f1: 0.9999
Epoch 179/300
 - 84s - loss: 2.2079e-04 - val_loss: 2.6276e-04
 - val_f1: 0.9999
Epoch 180/300
 - 84s - loss: 2.3005e-04 - val_loss: 4.1381e-04
 - val_f1: 0.9998
Epoch 181/300
 - 84s - loss: 2.3102e-04 - val_loss: 2.9992e-04
2019-12-22 09:25:19,901 [INFO] epoch = 180. Intermediate model saved to results_selected_models/selected_kdd99_ann_shallow_rep5/ann_model_epoch_180.pickle
2019-12-22 09:25:50,321 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-22 09:28:58,113 [INFO] Last epoch loss evaluation: train_loss = 0.000177, val_loss = 0.000261
2019-12-22 09:28:58,113 [INFO] Training complete. time_to_train = 20854.27 sec, 347.57 min
2019-12-22 09:28:58,119 [INFO] Model saved to results_selected_models/selected_kdd99_ann_shallow_rep5/best_model.pickle
2019-12-22 09:28:58,314 [INFO] Plot saved to: results_selected_models/selected_kdd99_ann_shallow_rep5/training_error_history.png
2019-12-22 09:28:58,486 [INFO] Plot saved to: results_selected_models/selected_kdd99_ann_shallow_rep5/training_f1_history.png
2019-12-22 09:28:58,486 [INFO] Making predictions on training, validation, testing data
2019-12-22 09:31:37,248 [INFO] Evaluating predictions (results)
2019-12-22 09:31:46,007 [INFO] Dataset: Testing. Classification report below
2019-12-22 09:31:46,008 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      0.97      0.99    229853
     normal.       0.73      0.99      0.84     60593
       probe       0.84      0.79      0.81      4166
         r2l       0.84      0.02      0.04     13781
         u2r       0.92      0.00      0.01      2636

    accuracy                           0.92    311029
   macro avg       0.86      0.56      0.54    311029
weighted avg       0.94      0.92      0.90    311029

2019-12-22 09:31:46,008 [INFO] Overall accuracy (micro avg): 0.9243221693154015
2019-12-22 09:31:55,400 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9243         0.9243                       0.9243                0.0189                   0.0757  0.9243
1     Macro avg        0.9697         0.8635                       0.5564                0.0191                   0.4436  0.5376
2  Weighted avg        0.9686         0.9359                       0.9243                0.0198                   0.0757  0.9050
2019-12-22 09:32:25,813 [INFO] Dataset: Validation. Classification report below
2019-12-22 09:32:25,813 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00    776675
     normal.       1.00      1.00      1.00    194556
       probe       1.00      1.00      1.00      8221
         r2l       0.93      0.91      0.92       225
         u2r       0.71      0.50      0.59        10

    accuracy                           1.00    979687
   macro avg       0.93      0.88      0.90    979687
weighted avg       1.00      1.00      1.00    979687

2019-12-22 09:32:25,813 [INFO] Overall accuracy (micro avg): 0.9998744496966888
2019-12-22 09:32:58,681 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9999         0.9999                       0.9999                0.0000                   0.0001  0.9999
1     Macro avg        0.9999         0.9286                       0.8803                0.0000                   0.1197  0.9006
2  Weighted avg        1.0000         0.9999                       0.9999                0.0001                   0.0001  0.9999
2019-12-22 09:35:11,975 [INFO] Dataset: Training. Classification report below
2019-12-22 09:35:11,976 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00   3106695
     normal.       1.00      1.00      1.00    778225
       probe       1.00      1.00      1.00     32881
         r2l       0.91      0.94      0.92       901
         u2r       0.94      0.71      0.81        42

    accuracy                           1.00   3918744
   macro avg       0.97      0.93      0.95   3918744
weighted avg       1.00      1.00      1.00   3918744

2019-12-22 09:35:11,976 [INFO] Overall accuracy (micro avg): 0.9998997127651105
2019-12-22 09:37:35,771 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9999         0.9999                       0.9999                0.0000                   0.0001  0.9999
1     Macro avg        1.0000         0.9684                       0.9305                0.0000                   0.0695  0.9463
2  Weighted avg        1.0000         0.9999                       0.9999                0.0001                   0.0001  0.9999
2019-12-22 09:37:35,819 [INFO] Results saved to: results_selected_models/selected_kdd99_ann_shallow_rep5/selected_kdd99_ann_shallow_rep5_results.xlsx
2019-12-22 09:37:35,826 [INFO] ================= Finished running experiment no. 5 ================= 

2019-12-22 09:37:35,849 [INFO] Created directory: results_selected_models/selected_ids18_subset_ann_shallow_rep1
2019-12-22 09:37:35,849 [INFO] Initialized logging. log_filename = results_selected_models/selected_ids18_subset_ann_shallow_rep1/run_log.log
2019-12-22 09:37:35,849 [INFO] ================= Running experiment no. 1  ================= 

2019-12-22 09:37:35,849 [INFO] Experiment parameters given below
2019-12-22 09:37:35,849 [INFO] 
{'experiment_num': 1, 'results_dir': 'results_selected_models/selected_ids18_subset_ann_shallow_rep1', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [512], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 300, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/ids2018', 'description': 'selected_ids18_subset_ann_shallow_rep1'}
2019-12-22 09:37:35,849 [INFO] Created tensorboard log directory: results_selected_models/selected_ids18_subset_ann_shallow_rep1/tf_logs_run_2019_12_22-09_37_35
2019-12-22 09:37:35,849 [INFO] Loading datsets from: ../Datasets/small_datasets/ids2018
2019-12-22 09:37:35,850 [INFO] Reading X, y files
2019-12-22 09:37:35,850 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_train.h5
2019-12-22 09:37:40,789 [INFO] Reading complete. time_to_read=4.94 seconds
2019-12-22 09:37:40,789 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_val.h5
2019-12-22 09:37:42,224 [INFO] Reading complete. time_to_read=1.43 seconds
2019-12-22 09:37:42,224 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_test.h5
2019-12-22 09:37:43,653 [INFO] Reading complete. time_to_read=1.43 seconds
2019-12-22 09:37:43,654 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_train.h5
2019-12-22 09:37:44,020 [INFO] Reading complete. time_to_read=0.37 seconds
2019-12-22 09:37:44,020 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_val.h5
2019-12-22 09:37:44,155 [INFO] Reading complete. time_to_read=0.13 seconds
2019-12-22 09:37:44,155 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_test.h5
2019-12-22 09:37:44,286 [INFO] Reading complete. time_to_read=0.13 seconds
2019-12-22 09:37:47,607 [INFO] Initializing model
2019-12-22 09:37:47,736 [INFO] _________________________________________________________________
2019-12-22 09:37:47,736 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-22 09:37:47,736 [INFO] =================================================================
2019-12-22 09:37:47,736 [INFO] dense_31 (Dense)             (None, 512)               39936     
2019-12-22 09:37:47,736 [INFO] _________________________________________________________________
2019-12-22 09:37:47,736 [INFO] batch_normalization_16 (Batc (None, 512)               2048      
2019-12-22 09:37:47,736 [INFO] _________________________________________________________________
2019-12-22 09:37:47,736 [INFO] dropout_16 (Dropout)         (None, 512)               0         
2019-12-22 09:37:47,736 [INFO] _________________________________________________________________
2019-12-22 09:37:47,737 [INFO] dense_32 (Dense)             (None, 15)                7695      
2019-12-22 09:37:47,737 [INFO] =================================================================
2019-12-22 09:37:47,737 [INFO] Total params: 49,679
2019-12-22 09:37:47,737 [INFO] Trainable params: 48,655
2019-12-22 09:37:47,737 [INFO] Non-trainable params: 1,024
2019-12-22 09:37:47,737 [INFO] _________________________________________________________________
2019-12-22 09:37:47,737 [INFO] Training model
 - val_f1: 0.9999
Epoch 00181: early stopping
Train on 1936462 samples, validate on 645487 samples
Epoch 1/300
 - 49s - loss: 0.0120 - val_loss: 0.0088
 - val_f1: 0.9829
Epoch 2/300
 - 48s - loss: 0.0087 - val_loss: 0.0089
 - val_f1: 0.9825
Epoch 3/300
 - 48s - loss: 0.0085 - val_loss: 0.0083
 - val_f1: 0.9831
Epoch 4/300
 - 48s - loss: 0.0084 - val_loss: 0.0085
 - val_f1: 0.9830
Epoch 5/300
 - 48s - loss: 0.0083 - val_loss: 0.0085
 - val_f1: 0.9829
Epoch 6/300
 - 48s - loss: 0.0082 - val_loss: 0.0083
 - val_f1: 0.9833
Epoch 7/300
 - 48s - loss: 0.0082 - val_loss: 0.0083
 - val_f1: 0.9830
Epoch 8/300
 - 48s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9830
Epoch 9/300
 - 48s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9832
Epoch 10/300
 - 48s - loss: 0.0081 - val_loss: 0.0141
 - val_f1: 0.9561
Epoch 11/300
 - 48s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9833
Epoch 12/300
 - 48s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9830
Epoch 13/300
 - 48s - loss: 0.0081 - val_loss: 0.0083
 - val_f1: 0.9831
Epoch 14/300
 - 48s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9833
Epoch 15/300
 - 48s - loss: 0.0080 - val_loss: 0.0082
 - val_f1: 0.9830
Epoch 16/300
 - 48s - loss: 0.0080 - val_loss: 0.0082
 - val_f1: 0.9830
Epoch 17/300
 - 48s - loss: 0.0080 - val_loss: 0.0082
 - val_f1: 0.9829
Epoch 18/300
 - 48s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9815
Epoch 19/300
 - 48s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9832
Epoch 20/300
 - 48s - loss: 0.0080 - val_loss: 0.0092
 - val_f1: 0.9803
Epoch 21/300
 - 48s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9832
Epoch 22/300
 - 48s - loss: 0.0079 - val_loss: 0.0088
 - val_f1: 0.9815
Epoch 23/300
 - 48s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9833
Epoch 24/300
 - 48s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 25/300
 - 48s - loss: 0.0079 - val_loss: 0.0081
 - val_f1: 0.9817
Epoch 26/300
 - 48s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9834
Epoch 27/300
 - 48s - loss: 0.0079 - val_loss: 0.0081
 - val_f1: 0.9831
Epoch 28/300
 - 48s - loss: 0.0079 - val_loss: 0.0081
 - val_f1: 0.9829
Epoch 29/300
 - 48s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 30/300
 - 48s - loss: 0.0079 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 31/300
 - 48s - loss: 0.0079 - val_loss: 0.0079
2019-12-22 10:13:37,465 [INFO] epoch = 30. Intermediate model saved to results_selected_models/selected_ids18_subset_ann_shallow_rep1/ann_model_epoch_30.pickle
 - val_f1: 0.9835
Epoch 32/300
 - 48s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9829
Epoch 33/300
 - 48s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9835
Epoch 34/300
 - 48s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 35/300
 - 48s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 36/300
 - 48s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9834
Epoch 37/300
 - 48s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9831
Epoch 38/300
 - 48s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9830
Epoch 39/300
 - 48s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9830
Epoch 40/300
 - 48s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 41/300
 - 48s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9831
Epoch 42/300
 - 48s - loss: 0.0079 - val_loss: 0.0107
 - val_f1: 0.9759
Epoch 43/300
 - 49s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 44/300
 - 48s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9831
Epoch 45/300
 - 48s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 46/300
 - 48s - loss: 0.0079 - val_loss: 0.0078
 - val_f1: 0.9838
Epoch 47/300
 - 48s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 48/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 49/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 50/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 51/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9833
Epoch 52/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 53/300
 - 48s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9831
Epoch 54/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9837
Epoch 55/300
 - 48s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9832
Epoch 56/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 57/300
 - 48s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9834
Epoch 58/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 59/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 60/300
 - 48s - loss: 0.0078 - val_loss: 0.0082
 - val_f1: 0.9827
Epoch 61/300
 - 48s - loss: 0.0078 - val_loss: 0.0085
2019-12-22 10:48:38,594 [INFO] epoch = 60. Intermediate model saved to results_selected_models/selected_ids18_subset_ann_shallow_rep1/ann_model_epoch_60.pickle
 - val_f1: 0.9814
Epoch 62/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 63/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9837
Epoch 64/300
 - 48s - loss: 0.0078 - val_loss: 0.0082
 - val_f1: 0.9833
Epoch 65/300
 - 48s - loss: 0.0078 - val_loss: 0.0114
 - val_f1: 0.9742
Epoch 66/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 67/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 68/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 69/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 70/300
 - 48s - loss: 0.0078 - val_loss: 0.0081
 - val_f1: 0.9816
Epoch 71/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 72/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 73/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 74/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9834
Epoch 75/300
 - 48s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9833
Epoch 76/300
 - 48s - loss: 0.0078 - val_loss: 0.0094
 - val_f1: 0.9804
Epoch 77/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9834
Epoch 78/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 79/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 80/300
 - 48s - loss: 0.0078 - val_loss: 0.0083
 - val_f1: 0.9821
Epoch 81/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9837
Epoch 82/300
 - 48s - loss: 0.0078 - val_loss: 0.0093
 - val_f1: 0.9808
Epoch 83/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 84/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 85/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 86/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 87/300
 - 48s - loss: 0.0078 - val_loss: 0.0121
 - val_f1: 0.9752
Epoch 88/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 89/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9834
Epoch 90/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 91/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
2019-12-22 11:23:37,507 [INFO] epoch = 90. Intermediate model saved to results_selected_models/selected_ids18_subset_ann_shallow_rep1/ann_model_epoch_90.pickle
 - val_f1: 0.9836
Epoch 92/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 93/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 94/300
 - 48s - loss: 0.0078 - val_loss: 0.0082
 - val_f1: 0.9826
Epoch 95/300
 - 48s - loss: 0.0078 - val_loss: 0.0084
 - val_f1: 0.9831
Epoch 96/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 97/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 98/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 99/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 100/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 101/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 102/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 103/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 104/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 105/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9833
Epoch 106/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 107/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 108/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9838
Epoch 109/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 110/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 111/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 112/300
 - 48s - loss: 0.0078 - val_loss: 0.0094
 - val_f1: 0.9785
Epoch 113/300
 - 48s - loss: 0.0078 - val_loss: 0.0082
 - val_f1: 0.9830
Epoch 114/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9819
Epoch 115/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 116/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 117/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 118/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9831
Epoch 119/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 120/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 121/300
 - 48s - loss: 0.0078 - val_loss: 0.0080
2019-12-22 11:58:36,994 [INFO] epoch = 120. Intermediate model saved to results_selected_models/selected_ids18_subset_ann_shallow_rep1/ann_model_epoch_120.pickle
 - val_f1: 0.9836
Epoch 122/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 123/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 124/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 125/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9837
Epoch 126/300
 - 48s - loss: 0.0078 - val_loss: 0.0108
 - val_f1: 0.9776
Epoch 127/300
 - 48s - loss: 0.0078 - val_loss: 0.0101
 - val_f1: 0.9795
Epoch 128/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9817
Epoch 129/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9818
Epoch 130/300
 - 48s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9831
Epoch 131/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 132/300
 - 48s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 133/300
 - 48s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9833
Epoch 134/300
 - 49s - loss: 0.0078 - val_loss: 0.0086
 - val_f1: 0.9822
Epoch 135/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 136/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9834
Epoch 137/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 138/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 139/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 140/300
 - 49s - loss: 0.0078 - val_loss: 0.0083
 - val_f1: 0.9835
Epoch 141/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 142/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 143/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9834
Epoch 144/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 145/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 146/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 147/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 148/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 149/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
2019-12-22 12:31:45,763 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-22 12:33:19,317 [INFO] Last epoch loss evaluation: train_loss = 0.007705, val_loss = 0.007754
2019-12-22 12:33:19,317 [INFO] Training complete. time_to_train = 10531.58 sec, 175.53 min
2019-12-22 12:33:19,323 [INFO] Model saved to results_selected_models/selected_ids18_subset_ann_shallow_rep1/best_model.pickle
2019-12-22 12:33:19,517 [INFO] Plot saved to: results_selected_models/selected_ids18_subset_ann_shallow_rep1/training_error_history.png
2019-12-22 12:33:19,695 [INFO] Plot saved to: results_selected_models/selected_ids18_subset_ann_shallow_rep1/training_f1_history.png
2019-12-22 12:33:19,695 [INFO] Making predictions on training, validation, testing data
2019-12-22 12:35:01,877 [INFO] Evaluating predictions (results)
2019-12-22 12:35:25,009 [INFO] Dataset: Testing. Classification report below
2019-12-22 12:35:25,009 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       0.80      0.33      0.47        24
        Brute Force -XSS       1.00      0.33      0.50         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.69      1.00      0.82        67
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23010
   DoS attacks-GoldenEye       0.99      1.00      1.00      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.75      0.51      0.61      5596
   DoS attacks-Slowloris       0.95      0.98      0.96       440
          FTP-BruteForce       0.71      0.88      0.79      7718
           Infilteration       0.45      0.01      0.01      6404
           SQL Injection       1.00      0.50      0.67         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

                accuracy                           0.98    645488
               macro avg       0.89      0.77      0.79    645488
            weighted avg       0.98      0.98      0.98    645488

2019-12-22 12:35:25,009 [INFO] Overall accuracy (micro avg): 0.9836821133777854
2019-12-22 12:35:49,908 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9837         0.9837                       0.9837                0.0012                   0.0163  0.9837
1     Macro avg        0.9978         0.8886                       0.7687                0.0044                   0.2313  0.7873
2  Weighted avg        0.9910         0.9786                       0.9837                0.0499                   0.0163  0.9787
2019-12-22 12:36:12,952 [INFO] Dataset: Validation. Classification report below
2019-12-22 12:36:12,952 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       0.86      0.48      0.62        25
        Brute Force -XSS       1.00      0.67      0.80         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.75      1.00      0.86        68
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23009
   DoS attacks-GoldenEye       0.99      1.00      1.00      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.76      0.51      0.61      5596
   DoS attacks-Slowloris       0.94      0.98      0.96       439
          FTP-BruteForce       0.71      0.88      0.79      7718
           Infilteration       0.39      0.01      0.01      6403
           SQL Injection       0.00      0.00      0.00         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

                accuracy                           0.98    645487
               macro avg       0.83      0.77      0.78    645487
            weighted avg       0.98      0.98      0.98    645487

2019-12-22 12:36:12,952 [INFO] Overall accuracy (micro avg): 0.9837316630698991
2019-12-22 12:36:37,786 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9837         0.9837                       0.9837                0.0012                   0.0163  0.9837
1     Macro avg        0.9978         0.8258                       0.7680                0.0044                   0.2320  0.7751
2  Weighted avg        0.9910         0.9781                       0.9837                0.0498                   0.0163  0.9787
2019-12-22 12:37:53,508 [INFO] Dataset: Training. Classification report below
2019-12-22 12:37:53,508 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99   1606949
                     Bot       1.00      1.00      1.00     34396
        Brute Force -Web       0.93      0.37      0.53        73
        Brute Force -XSS       1.00      0.50      0.67        26
        DDOS attack-HOIC       1.00      1.00      1.00     82341
    DDOS attack-LOIC-UDP       0.72      1.00      0.84       203
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     69029
   DoS attacks-GoldenEye       1.00      1.00      1.00      4954
        DoS attacks-Hulk       1.00      1.00      1.00     55435
DoS attacks-SlowHTTPTest       0.76      0.51      0.61     16787
   DoS attacks-Slowloris       0.95      0.99      0.97      1318
          FTP-BruteForce       0.71      0.88      0.79     23153
           Infilteration       0.46      0.01      0.01     19210
           SQL Injection       0.75      0.25      0.38        12
          SSH-Bruteforce       1.00      1.00      1.00     22576

                accuracy                           0.98   1936462
               macro avg       0.88      0.77      0.78   1936462
            weighted avg       0.98      0.98      0.98   1936462

2019-12-22 12:37:53,508 [INFO] Overall accuracy (micro avg): 0.9837373519335778
2019-12-22 12:39:15,070 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9837         0.9837                       0.9837                0.0012                   0.0163  0.9837
1     Macro avg        0.9978         0.8838                       0.7666                0.0044                   0.2334  0.7848
2  Weighted avg        0.9910         0.9787                       0.9837                0.0497                   0.0163  0.9787
2019-12-22 12:39:15,146 [INFO] Results saved to: results_selected_models/selected_ids18_subset_ann_shallow_rep1/selected_ids18_subset_ann_shallow_rep1_results.xlsx
2019-12-22 12:39:15,150 [INFO] ================= Finished running experiment no. 1 ================= 

2019-12-22 12:39:15,198 [INFO] Created directory: results_selected_models/selected_ids18_subset_ann_shallow_rep2
2019-12-22 12:39:15,199 [INFO] Initialized logging. log_filename = results_selected_models/selected_ids18_subset_ann_shallow_rep2/run_log.log
2019-12-22 12:39:15,199 [INFO] ================= Running experiment no. 2  ================= 

2019-12-22 12:39:15,199 [INFO] Experiment parameters given below
2019-12-22 12:39:15,199 [INFO] 
{'experiment_num': 2, 'results_dir': 'results_selected_models/selected_ids18_subset_ann_shallow_rep2', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [512], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 300, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/ids2018', 'description': 'selected_ids18_subset_ann_shallow_rep2'}
2019-12-22 12:39:15,199 [INFO] Created tensorboard log directory: results_selected_models/selected_ids18_subset_ann_shallow_rep2/tf_logs_run_2019_12_22-12_39_15
2019-12-22 12:39:15,199 [INFO] Loading datsets from: ../Datasets/small_datasets/ids2018
2019-12-22 12:39:15,199 [INFO] Reading X, y files
2019-12-22 12:39:15,199 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_train.h5
2019-12-22 12:39:19,249 [INFO] Reading complete. time_to_read=4.05 seconds
2019-12-22 12:39:19,249 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_val.h5
2019-12-22 12:39:20,631 [INFO] Reading complete. time_to_read=1.38 seconds
2019-12-22 12:39:20,632 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_test.h5
2019-12-22 12:39:22,015 [INFO] Reading complete. time_to_read=1.38 seconds
2019-12-22 12:39:22,015 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_train.h5
2019-12-22 12:39:22,297 [INFO] Reading complete. time_to_read=0.28 seconds
2019-12-22 12:39:22,297 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_val.h5
2019-12-22 12:39:22,396 [INFO] Reading complete. time_to_read=0.10 seconds
2019-12-22 12:39:22,396 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_test.h5
2019-12-22 12:39:22,493 [INFO] Reading complete. time_to_read=0.10 seconds
2019-12-22 12:39:25,843 [INFO] Initializing model
2019-12-22 12:39:25,975 [INFO] _________________________________________________________________
2019-12-22 12:39:25,975 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-22 12:39:25,975 [INFO] =================================================================
2019-12-22 12:39:25,975 [INFO] dense_33 (Dense)             (None, 512)               39936     
2019-12-22 12:39:25,975 [INFO] _________________________________________________________________
2019-12-22 12:39:25,975 [INFO] batch_normalization_17 (Batc (None, 512)               2048      
2019-12-22 12:39:25,975 [INFO] _________________________________________________________________
2019-12-22 12:39:25,975 [INFO] dropout_17 (Dropout)         (None, 512)               0         
2019-12-22 12:39:25,975 [INFO] _________________________________________________________________
2019-12-22 12:39:25,976 [INFO] dense_34 (Dense)             (None, 15)                7695      
2019-12-22 12:39:25,976 [INFO] =================================================================
2019-12-22 12:39:25,976 [INFO] Total params: 49,679
2019-12-22 12:39:25,976 [INFO] Trainable params: 48,655
2019-12-22 12:39:25,976 [INFO] Non-trainable params: 1,024
2019-12-22 12:39:25,976 [INFO] _________________________________________________________________
2019-12-22 12:39:25,976 [INFO] Training model
 - val_f1: 0.9834
Epoch 00149: early stopping
Train on 1936462 samples, validate on 645487 samples
Epoch 1/300
 - 50s - loss: 0.0119 - val_loss: 0.0090
 - val_f1: 0.9827
Epoch 2/300
 - 49s - loss: 0.0088 - val_loss: 0.0086
 - val_f1: 0.9829
Epoch 3/300
 - 49s - loss: 0.0085 - val_loss: 0.0088
 - val_f1: 0.9816
Epoch 4/300
 - 49s - loss: 0.0084 - val_loss: 0.0083
 - val_f1: 0.9830
Epoch 5/300
 - 49s - loss: 0.0083 - val_loss: 0.0084
 - val_f1: 0.9828
Epoch 6/300
 - 49s - loss: 0.0082 - val_loss: 0.0083
 - val_f1: 0.9816
Epoch 7/300
 - 49s - loss: 0.0082 - val_loss: 0.0083
 - val_f1: 0.9831
Epoch 8/300
 - 49s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9835
Epoch 9/300
 - 49s - loss: 0.0082 - val_loss: 0.0084
 - val_f1: 0.9831
Epoch 10/300
 - 49s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9831
Epoch 11/300
 - 49s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9833
Epoch 12/300
 - 49s - loss: 0.0081 - val_loss: 0.0083
 - val_f1: 0.9830
Epoch 13/300
 - 49s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9830
Epoch 14/300
 - 49s - loss: 0.0081 - val_loss: 0.0082
 - val_f1: 0.9830
Epoch 15/300
 - 49s - loss: 0.0080 - val_loss: 0.0083
 - val_f1: 0.9835
Epoch 16/300
 - 49s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9836
Epoch 17/300
 - 49s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9832
Epoch 18/300
 - 49s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9835
Epoch 19/300
 - 49s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9834
Epoch 20/300
 - 49s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 21/300
 - 49s - loss: 0.0079 - val_loss: 0.0081
 - val_f1: 0.9815
Epoch 22/300
 - 49s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9834
Epoch 23/300
 - 49s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9830
Epoch 24/300
 - 49s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9833
Epoch 25/300
 - 49s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9834
Epoch 26/300
 - 49s - loss: 0.0079 - val_loss: 0.0078
 - val_f1: 0.9834
Epoch 27/300
 - 49s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 28/300
 - 49s - loss: 0.0079 - val_loss: 0.0111
 - val_f1: 0.9751
Epoch 29/300
 - 49s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9814
Epoch 30/300
 - 49s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 31/300
 - 49s - loss: 0.0079 - val_loss: 0.0086
2019-12-22 13:16:02,089 [INFO] epoch = 30. Intermediate model saved to results_selected_models/selected_ids18_subset_ann_shallow_rep2/ann_model_epoch_30.pickle
 - val_f1: 0.9821
Epoch 32/300
 - 49s - loss: 0.0079 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 33/300
 - 49s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 34/300
 - 49s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 35/300
 - 49s - loss: 0.0079 - val_loss: 0.0078
 - val_f1: 0.9832
Epoch 36/300
 - 49s - loss: 0.0079 - val_loss: 0.0084
 - val_f1: 0.9823
Epoch 37/300
 - 49s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 38/300
 - 49s - loss: 0.0079 - val_loss: 0.0134
 - val_f1: 0.9719
Epoch 39/300
 - 49s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9818
Epoch 40/300
 - 49s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 41/300
 - 49s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9831
Epoch 42/300
 - 49s - loss: 0.0079 - val_loss: 0.0119
 - val_f1: 0.9741
Epoch 43/300
 - 49s - loss: 0.0079 - val_loss: 0.0135
 - val_f1: 0.9682
Epoch 44/300
 - 49s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 45/300
 - 49s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 46/300
 - 49s - loss: 0.0079 - val_loss: 0.0084
 - val_f1: 0.9827
Epoch 47/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9819
Epoch 48/300
 - 49s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 49/300
 - 49s - loss: 0.0079 - val_loss: 0.0078
 - val_f1: 0.9832
Epoch 50/300
 - 49s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9835
Epoch 51/300
 - 49s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9835
Epoch 52/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 53/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 54/300
 - 49s - loss: 0.0078 - val_loss: 0.0098
 - val_f1: 0.9805
Epoch 55/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 56/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 57/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 58/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 59/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9837
Epoch 60/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 61/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
2019-12-22 13:51:41,216 [INFO] epoch = 60. Intermediate model saved to results_selected_models/selected_ids18_subset_ann_shallow_rep2/ann_model_epoch_60.pickle
 - val_f1: 0.9832
Epoch 62/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 63/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 64/300
 - 49s - loss: 0.0078 - val_loss: 0.0140
 - val_f1: 0.9677
Epoch 65/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 66/300
 - 49s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9834
Epoch 67/300
 - 49s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9835
Epoch 68/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 69/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 70/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 71/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 72/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 73/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 74/300
 - 49s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9834
Epoch 75/300
 - 49s - loss: 0.0078 - val_loss: 0.0116
 - val_f1: 0.9746
Epoch 76/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 77/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 78/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9819
Epoch 79/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 80/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9833
Epoch 81/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9837
Epoch 82/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 83/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 84/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 85/300
 - 49s - loss: 0.0078 - val_loss: 0.0117
 - val_f1: 0.9746
Epoch 86/300
 - 49s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9835
Epoch 87/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 88/300
 - 49s - loss: 0.0078 - val_loss: 0.0081
 - val_f1: 0.9830
Epoch 89/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 90/300
 - 49s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9837
Epoch 91/300
 - 49s - loss: 0.0078 - val_loss: 0.0080
2019-12-22 14:27:23,215 [INFO] epoch = 90. Intermediate model saved to results_selected_models/selected_ids18_subset_ann_shallow_rep2/ann_model_epoch_90.pickle
 - val_f1: 0.9834
Epoch 92/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 93/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 94/300
 - 49s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9835
Epoch 95/300
 - 49s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9837
Epoch 96/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 97/300
 - 49s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9836
Epoch 98/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 99/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 100/300
 - 49s - loss: 0.0078 - val_loss: 0.0117
 - val_f1: 0.9762
Epoch 101/300
 - 49s - loss: 0.0078 - val_loss: 0.0077
 - val_f1: 0.9837
Epoch 102/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 103/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9816
Epoch 104/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 105/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 106/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 107/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 108/300
 - 49s - loss: 0.0078 - val_loss: 0.0081
 - val_f1: 0.9820
Epoch 109/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9833
Epoch 110/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 111/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 112/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 113/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 114/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 115/300
 - 49s - loss: 0.0078 - val_loss: 0.0077
 - val_f1: 0.9837
Epoch 116/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 117/300
 - 49s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9832
Epoch 118/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9833
Epoch 119/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 120/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9837
Epoch 121/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
2019-12-22 15:03:03,652 [INFO] epoch = 120. Intermediate model saved to results_selected_models/selected_ids18_subset_ann_shallow_rep2/ann_model_epoch_120.pickle
 - val_f1: 0.9836
Epoch 122/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9817
Epoch 123/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 124/300
 - 49s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9834
Epoch 125/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 126/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 127/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 128/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 129/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 130/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 131/300
 - 49s - loss: 0.0078 - val_loss: 0.0083
 - val_f1: 0.9830
Epoch 132/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 133/300
 - 49s - loss: 0.0078 - val_loss: 0.0133
 - val_f1: 0.9625
Epoch 134/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9834
Epoch 135/300
 - 49s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9834
Epoch 136/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 137/300
 - 49s - loss: 0.0078 - val_loss: 0.0097
 - val_f1: 0.9806
Epoch 138/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 139/300
 - 49s - loss: 0.0078 - val_loss: 0.0081
 - val_f1: 0.9828
Epoch 140/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 141/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 142/300
 - 49s - loss: 0.0078 - val_loss: 0.0112
 - val_f1: 0.9776
Epoch 143/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 144/300
 - 49s - loss: 0.0078 - val_loss: 0.0085
 - val_f1: 0.9816
Epoch 145/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 146/300
 - 49s - loss: 0.0078 - val_loss: 0.0107
 - val_f1: 0.9771
Epoch 147/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 148/300
 - 49s - loss: 0.0078 - val_loss: 0.0112
 - val_f1: 0.9746
Epoch 149/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 150/300
 - 49s - loss: 0.0078 - val_loss: 0.0084
 - val_f1: 0.9822
Epoch 151/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
2019-12-22 15:38:43,798 [INFO] epoch = 150. Intermediate model saved to results_selected_models/selected_ids18_subset_ann_shallow_rep2/ann_model_epoch_150.pickle
 - val_f1: 0.9817
Epoch 152/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 153/300
 - 49s - loss: 0.0078 - val_loss: 0.0125
 - val_f1: 0.9727
Epoch 154/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9819
Epoch 155/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 156/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 157/300
 - 49s - loss: 0.0078 - val_loss: 0.0083
 - val_f1: 0.9823
Epoch 158/300
 - 49s - loss: 0.0077 - val_loss: 0.0078
 - val_f1: 0.9838
Epoch 159/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 160/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9838
Epoch 161/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 162/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 163/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 164/300
 - 49s - loss: 0.0077 - val_loss: 0.0088
 - val_f1: 0.9818
Epoch 165/300
 - 49s - loss: 0.0077 - val_loss: 0.0078
2019-12-22 15:55:43,841 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-22 15:57:22,188 [INFO] Last epoch loss evaluation: train_loss = 0.007706, val_loss = 0.007739
2019-12-22 15:57:22,188 [INFO] Training complete. time_to_train = 11876.21 sec, 197.94 min
2019-12-22 15:57:22,194 [INFO] Model saved to results_selected_models/selected_ids18_subset_ann_shallow_rep2/best_model.pickle
2019-12-22 15:57:22,387 [INFO] Plot saved to: results_selected_models/selected_ids18_subset_ann_shallow_rep2/training_error_history.png
2019-12-22 15:57:22,552 [INFO] Plot saved to: results_selected_models/selected_ids18_subset_ann_shallow_rep2/training_f1_history.png
2019-12-22 15:57:22,552 [INFO] Making predictions on training, validation, testing data
2019-12-22 15:59:09,769 [INFO] Evaluating predictions (results)
2019-12-22 15:59:33,014 [INFO] Dataset: Testing. Classification report below
2019-12-22 15:59:33,015 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       0.89      0.33      0.48        24
        Brute Force -XSS       1.00      0.33      0.50         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.68      1.00      0.81        67
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23010
   DoS attacks-GoldenEye       0.99      1.00      1.00      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.74      0.52      0.61      5596
   DoS attacks-Slowloris       0.97      0.97      0.97       440
          FTP-BruteForce       0.71      0.87      0.78      7718
           Infilteration       0.46      0.01      0.03      6404
           SQL Injection       1.00      0.50      0.67         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

                accuracy                           0.98    645488
               macro avg       0.89      0.77      0.79    645488
            weighted avg       0.98      0.98      0.98    645488

2019-12-22 15:59:33,015 [INFO] Overall accuracy (micro avg): 0.9836728180849218
2019-12-22 15:59:57,986 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9837         0.9837                       0.9837                0.0012                   0.0163  0.9837
1     Macro avg        0.9978         0.8950                       0.7688                0.0044                   0.2312  0.7891
2  Weighted avg        0.9911         0.9787                       0.9837                0.0490                   0.0163  0.9788
2019-12-22 16:00:21,142 [INFO] Dataset: Validation. Classification report below
2019-12-22 16:00:21,142 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       1.00      0.48      0.65        25
        Brute Force -XSS       1.00      0.67      0.80         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.75      1.00      0.86        68
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23009
   DoS attacks-GoldenEye       0.99      1.00      1.00      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.74      0.51      0.61      5596
   DoS attacks-Slowloris       0.96      0.98      0.97       439
          FTP-BruteForce       0.71      0.87      0.78      7718
           Infilteration       0.41      0.01      0.03      6403
           SQL Injection       1.00      0.25      0.40         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

                accuracy                           0.98    645487
               macro avg       0.90      0.78      0.80    645487
            weighted avg       0.98      0.98      0.98    645487

2019-12-22 16:00:21,142 [INFO] Overall accuracy (micro avg): 0.9836991294944747
2019-12-22 16:00:46,084 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9837         0.9837                       0.9837                0.0012                   0.0163  0.9837
1     Macro avg        0.9978         0.9033                       0.7846                0.0043                   0.2154  0.8050
2  Weighted avg        0.9910         0.9783                       0.9837                0.0489                   0.0163  0.9788
2019-12-22 16:02:01,923 [INFO] Dataset: Training. Classification report below
2019-12-22 16:02:01,923 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99   1606949
                     Bot       1.00      1.00      1.00     34396
        Brute Force -Web       0.96      0.37      0.53        73
        Brute Force -XSS       1.00      0.50      0.67        26
        DDOS attack-HOIC       1.00      1.00      1.00     82341
    DDOS attack-LOIC-UDP       0.71      1.00      0.83       203
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     69029
   DoS attacks-GoldenEye       0.99      1.00      1.00      4954
        DoS attacks-Hulk       1.00      1.00      1.00     55435
DoS attacks-SlowHTTPTest       0.74      0.51      0.61     16787
   DoS attacks-Slowloris       0.97      0.99      0.98      1318
          FTP-BruteForce       0.71      0.87      0.78     23153
           Infilteration       0.49      0.02      0.03     19210
           SQL Injection       1.00      0.33      0.50        12
          SSH-Bruteforce       1.00      1.00      1.00     22576

                accuracy                           0.98   1936462
               macro avg       0.90      0.77      0.79   1936462
            weighted avg       0.98      0.98      0.98   1936462

2019-12-22 16:02:01,923 [INFO] Overall accuracy (micro avg): 0.983713080866033
2019-12-22 16:03:23,641 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9837         0.9837                       0.9837                0.0012                   0.0163  0.9837
1     Macro avg        0.9978         0.9044                       0.7724                0.0043                   0.2276  0.7946
2  Weighted avg        0.9911         0.9791                       0.9837                0.0489                   0.0163  0.9789
2019-12-22 16:03:23,716 [INFO] Results saved to: results_selected_models/selected_ids18_subset_ann_shallow_rep2/selected_ids18_subset_ann_shallow_rep2_results.xlsx
2019-12-22 16:03:23,720 [INFO] ================= Finished running experiment no. 2 ================= 

2019-12-22 16:03:23,770 [INFO] Created directory: results_selected_models/selected_ids18_subset_ann_shallow_rep3
2019-12-22 16:03:23,771 [INFO] Initialized logging. log_filename = results_selected_models/selected_ids18_subset_ann_shallow_rep3/run_log.log
2019-12-22 16:03:23,771 [INFO] ================= Running experiment no. 3  ================= 

2019-12-22 16:03:23,771 [INFO] Experiment parameters given below
2019-12-22 16:03:23,771 [INFO] 
{'experiment_num': 3, 'results_dir': 'results_selected_models/selected_ids18_subset_ann_shallow_rep3', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [512], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 300, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/ids2018', 'description': 'selected_ids18_subset_ann_shallow_rep3'}
2019-12-22 16:03:23,771 [INFO] Created tensorboard log directory: results_selected_models/selected_ids18_subset_ann_shallow_rep3/tf_logs_run_2019_12_22-16_03_23
2019-12-22 16:03:23,771 [INFO] Loading datsets from: ../Datasets/small_datasets/ids2018
2019-12-22 16:03:23,771 [INFO] Reading X, y files
2019-12-22 16:03:23,772 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_train.h5
2019-12-22 16:03:27,805 [INFO] Reading complete. time_to_read=4.03 seconds
2019-12-22 16:03:27,805 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_val.h5
2019-12-22 16:03:29,187 [INFO] Reading complete. time_to_read=1.38 seconds
2019-12-22 16:03:29,190 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_test.h5
2019-12-22 16:03:30,574 [INFO] Reading complete. time_to_read=1.38 seconds
2019-12-22 16:03:30,574 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_train.h5
2019-12-22 16:03:30,865 [INFO] Reading complete. time_to_read=0.29 seconds
2019-12-22 16:03:30,865 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_val.h5
2019-12-22 16:03:30,966 [INFO] Reading complete. time_to_read=0.10 seconds
2019-12-22 16:03:30,966 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_test.h5
2019-12-22 16:03:31,065 [INFO] Reading complete. time_to_read=0.10 seconds
2019-12-22 16:03:34,381 [INFO] Initializing model
2019-12-22 16:03:34,511 [INFO] _________________________________________________________________
2019-12-22 16:03:34,511 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-22 16:03:34,511 [INFO] =================================================================
2019-12-22 16:03:34,511 [INFO] dense_35 (Dense)             (None, 512)               39936     
2019-12-22 16:03:34,511 [INFO] _________________________________________________________________
2019-12-22 16:03:34,511 [INFO] batch_normalization_18 (Batc (None, 512)               2048      
2019-12-22 16:03:34,511 [INFO] _________________________________________________________________
2019-12-22 16:03:34,512 [INFO] dropout_18 (Dropout)         (None, 512)               0         
2019-12-22 16:03:34,512 [INFO] _________________________________________________________________
2019-12-22 16:03:34,512 [INFO] dense_36 (Dense)             (None, 15)                7695      
2019-12-22 16:03:34,512 [INFO] =================================================================
2019-12-22 16:03:34,512 [INFO] Total params: 49,679
2019-12-22 16:03:34,512 [INFO] Trainable params: 48,655
2019-12-22 16:03:34,512 [INFO] Non-trainable params: 1,024
2019-12-22 16:03:34,512 [INFO] _________________________________________________________________
2019-12-22 16:03:34,512 [INFO] Training model
 - val_f1: 0.9835
Epoch 00165: early stopping
Train on 1936462 samples, validate on 645487 samples
Epoch 1/300
 - 50s - loss: 0.0122 - val_loss: 0.0099
 - val_f1: 0.9796
Epoch 2/300
 - 49s - loss: 0.0088 - val_loss: 0.0084
 - val_f1: 0.9813
Epoch 3/300
 - 49s - loss: 0.0085 - val_loss: 0.0082
 - val_f1: 0.9831
Epoch 4/300
 - 49s - loss: 0.0084 - val_loss: 0.0082
 - val_f1: 0.9814
Epoch 5/300
 - 49s - loss: 0.0083 - val_loss: 0.0082
 - val_f1: 0.9830
Epoch 6/300
 - 49s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9829
Epoch 7/300
 - 49s - loss: 0.0082 - val_loss: 0.0084
 - val_f1: 0.9830
Epoch 8/300
 - 49s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9833
Epoch 9/300
 - 49s - loss: 0.0081 - val_loss: 0.0089
 - val_f1: 0.9809
Epoch 10/300
 - 49s - loss: 0.0081 - val_loss: 0.0082
 - val_f1: 0.9828
Epoch 11/300
 - 49s - loss: 0.0081 - val_loss: 0.0083
 - val_f1: 0.9830
Epoch 12/300
 - 49s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9830
Epoch 13/300
 - 49s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9832
Epoch 14/300
 - 49s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9831
Epoch 15/300
 - 49s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9831
Epoch 16/300
 - 49s - loss: 0.0080 - val_loss: 0.0082
 - val_f1: 0.9833
Epoch 17/300
 - 49s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9832
Epoch 18/300
 - 49s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9819
Epoch 19/300
 - 49s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9830
Epoch 20/300
 - 49s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 21/300
 - 49s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9831
Epoch 22/300
 - 49s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9831
Epoch 23/300
 - 49s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9831
Epoch 24/300
 - 49s - loss: 0.0079 - val_loss: 0.0082
 - val_f1: 0.9812
Epoch 25/300
 - 49s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9833
Epoch 26/300
 - 49s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9833
Epoch 27/300
 - 49s - loss: 0.0079 - val_loss: 0.0090
 - val_f1: 0.9812
Epoch 28/300
 - 49s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9832
Epoch 29/300
 - 49s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 30/300
 - 49s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 31/300
 - 49s - loss: 0.0079 - val_loss: 0.0079
2019-12-22 16:40:54,154 [INFO] epoch = 30. Intermediate model saved to results_selected_models/selected_ids18_subset_ann_shallow_rep3/ann_model_epoch_30.pickle
 - val_f1: 0.9833
Epoch 32/300
 - 49s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 33/300
 - 49s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 34/300
 - 49s - loss: 0.0079 - val_loss: 0.0078
 - val_f1: 0.9834
Epoch 35/300
 - 49s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9830
Epoch 36/300
 - 50s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 37/300
 - 49s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 38/300
 - 49s - loss: 0.0079 - val_loss: 0.0110
 - val_f1: 0.9760
Epoch 39/300
 - 49s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9832
Epoch 40/300
 - 49s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9832
Epoch 41/300
 - 49s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 42/300
 - 50s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9834
Epoch 43/300
 - 49s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 44/300
 - 49s - loss: 0.0079 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 45/300
 - 49s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9832
Epoch 46/300
 - 49s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 47/300
 - 49s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9837
Epoch 48/300
 - 49s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9835
Epoch 49/300
 - 49s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9833
Epoch 50/300
 - 49s - loss: 0.0079 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 51/300
 - 49s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9831
Epoch 52/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 53/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9833
Epoch 54/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 55/300
 - 49s - loss: 0.0078 - val_loss: 0.0095
 - val_f1: 0.9804
Epoch 56/300
 - 49s - loss: 0.0078 - val_loss: 0.0088
 - val_f1: 0.9814
Epoch 57/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 58/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 59/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9816
Epoch 60/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 61/300
 - 50s - loss: 0.0078 - val_loss: 0.0094
2019-12-22 17:17:25,933 [INFO] epoch = 60. Intermediate model saved to results_selected_models/selected_ids18_subset_ann_shallow_rep3/ann_model_epoch_60.pickle
 - val_f1: 0.9808
Epoch 62/300
 - 49s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9834
Epoch 63/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 64/300
 - 49s - loss: 0.0078 - val_loss: 0.0081
 - val_f1: 0.9833
Epoch 65/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 66/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9813
Epoch 67/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 68/300
 - 49s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9833
Epoch 69/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 70/300
 - 49s - loss: 0.0078 - val_loss: 0.0091
 - val_f1: 0.9814
Epoch 71/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 72/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 73/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 74/300
 - 49s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9837
Epoch 75/300
 - 49s - loss: 0.0078 - val_loss: 0.0081
 - val_f1: 0.9834
Epoch 76/300
 - 49s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9835
Epoch 77/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 78/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 79/300
 - 49s - loss: 0.0078 - val_loss: 0.0083
 - val_f1: 0.9823
Epoch 80/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 81/300
 - 49s - loss: 0.0078 - val_loss: 0.0099
 - val_f1: 0.9798
Epoch 82/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 83/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 84/300
 - 49s - loss: 0.0078 - val_loss: 0.0077
 - val_f1: 0.9836
Epoch 85/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 86/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9820
Epoch 87/300
 - 49s - loss: 0.0078 - val_loss: 0.0091
 - val_f1: 0.9813
Epoch 88/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 89/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 90/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9834
Epoch 91/300
 - 49s - loss: 0.0078 - val_loss: 0.0080
2019-12-22 17:53:48,031 [INFO] epoch = 90. Intermediate model saved to results_selected_models/selected_ids18_subset_ann_shallow_rep3/ann_model_epoch_90.pickle
 - val_f1: 0.9834
Epoch 92/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 93/300
 - 49s - loss: 0.0078 - val_loss: 0.0082
 - val_f1: 0.9826
Epoch 94/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9833
Epoch 95/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9838
Epoch 96/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9838
Epoch 97/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9833
Epoch 98/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 99/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 100/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 101/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 102/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9818
Epoch 103/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 104/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9838
Epoch 105/300
 - 49s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9833
Epoch 106/300
 - 49s - loss: 0.0078 - val_loss: 0.0081
 - val_f1: 0.9833
Epoch 107/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 108/300
 - 49s - loss: 0.0078 - val_loss: 0.0081
 - val_f1: 0.9832
Epoch 109/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 110/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 111/300
 - 49s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9834
Epoch 112/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 113/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 114/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 115/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 116/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 117/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 118/300
 - 49s - loss: 0.0078 - val_loss: 0.0081
 - val_f1: 0.9838
Epoch 119/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9838
Epoch 120/300
 - 49s - loss: 0.0078 - val_loss: 0.0099
 - val_f1: 0.9806
Epoch 121/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
2019-12-22 18:30:05,046 [INFO] epoch = 120. Intermediate model saved to results_selected_models/selected_ids18_subset_ann_shallow_rep3/ann_model_epoch_120.pickle
 - val_f1: 0.9833
Epoch 122/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 123/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 124/300
 - 49s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9831
Epoch 125/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 126/300
 - 49s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9835
Epoch 127/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9832
Epoch 128/300
 - 49s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9834
Epoch 129/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 130/300
 - 49s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9836
Epoch 131/300
 - 49s - loss: 0.0078 - val_loss: 0.0100
 - val_f1: 0.9795
Epoch 132/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 133/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 134/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
2019-12-22 18:46:11,293 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-22 18:47:52,589 [INFO] Last epoch loss evaluation: train_loss = 0.007691, val_loss = 0.007726
2019-12-22 18:47:52,590 [INFO] Training complete. time_to_train = 9858.08 sec, 164.30 min
2019-12-22 18:47:52,596 [INFO] Model saved to results_selected_models/selected_ids18_subset_ann_shallow_rep3/best_model.pickle
2019-12-22 18:47:52,775 [INFO] Plot saved to: results_selected_models/selected_ids18_subset_ann_shallow_rep3/training_error_history.png
2019-12-22 18:47:52,961 [INFO] Plot saved to: results_selected_models/selected_ids18_subset_ann_shallow_rep3/training_f1_history.png
2019-12-22 18:47:52,961 [INFO] Making predictions on training, validation, testing data
2019-12-22 18:49:44,786 [INFO] Evaluating predictions (results)
2019-12-22 18:50:07,975 [INFO] Dataset: Testing. Classification report below
2019-12-22 18:50:07,976 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       0.89      0.33      0.48        24
        Brute Force -XSS       1.00      0.33      0.50         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.00      0.00      0.00        67
  DDoS attacks-LOIC-HTTP       0.99      1.00      0.99     23010
   DoS attacks-GoldenEye       0.99      1.00      1.00      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.75      0.49      0.59      5596
   DoS attacks-Slowloris       0.95      0.99      0.97       440
          FTP-BruteForce       0.70      0.88      0.78      7718
           Infilteration       0.42      0.00      0.01      6404
           SQL Injection       1.00      0.50      0.67         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

                accuracy                           0.98    645488
               macro avg       0.85      0.70      0.73    645488
            weighted avg       0.98      0.98      0.98    645488

2019-12-22 18:50:07,976 [INFO] Overall accuracy (micro avg): 0.9835612745705574
2019-12-22 18:50:32,907 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9836         0.9836                       0.9836                0.0012                   0.0164  0.9836
1     Macro avg        0.9978         0.8450                       0.7018                0.0044                   0.2982  0.7325
2  Weighted avg        0.9911         0.9780                       0.9836                0.0492                   0.0164  0.9784
2019-12-22 18:50:55,996 [INFO] Dataset: Validation. Classification report below
2019-12-22 18:50:55,996 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       1.00      0.48      0.65        25
        Brute Force -XSS       1.00      0.67      0.80         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.00      0.00      0.00        68
  DDoS attacks-LOIC-HTTP       0.99      1.00      0.99     23009
   DoS attacks-GoldenEye       0.99      1.00      1.00      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.76      0.48      0.59      5596
   DoS attacks-Slowloris       0.94      0.99      0.96       439
          FTP-BruteForce       0.70      0.89      0.78      7718
           Infilteration       0.58      0.01      0.01      6403
           SQL Injection       0.00      0.00      0.00         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

                accuracy                           0.98    645487
               macro avg       0.80      0.70      0.72    645487
            weighted avg       0.98      0.98      0.98    645487

2019-12-22 18:50:55,996 [INFO] Overall accuracy (micro avg): 0.9836232178184844
2019-12-22 18:51:20,881 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9836         0.9836                       0.9836                0.0012                   0.0164  0.9836
1     Macro avg        0.9978         0.7962                       0.7006                0.0044                   0.2994  0.7186
2  Weighted avg        0.9911         0.9797                       0.9836                0.0490                   0.0164  0.9784
2019-12-22 18:52:36,655 [INFO] Dataset: Training. Classification report below
2019-12-22 18:52:36,656 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99   1606949
                     Bot       1.00      1.00      1.00     34396
        Brute Force -Web       0.93      0.37      0.53        73
        Brute Force -XSS       0.93      0.50      0.65        26
        DDOS attack-HOIC       1.00      1.00      1.00     82341
    DDOS attack-LOIC-UDP       1.00      0.01      0.03       203
  DDoS attacks-LOIC-HTTP       0.99      1.00      0.99     69029
   DoS attacks-GoldenEye       1.00      1.00      1.00      4954
        DoS attacks-Hulk       1.00      1.00      1.00     55435
DoS attacks-SlowHTTPTest       0.75      0.48      0.59     16787
   DoS attacks-Slowloris       0.95      1.00      0.97      1318
          FTP-BruteForce       0.70      0.88      0.78     23153
           Infilteration       0.53      0.01      0.01     19210
           SQL Injection       1.00      0.25      0.40        12
          SSH-Bruteforce       1.00      1.00      1.00     22576

                accuracy                           0.98   1936462
               macro avg       0.92      0.70      0.73   1936462
            weighted avg       0.98      0.98      0.98   1936462

2019-12-22 18:52:36,656 [INFO] Overall accuracy (micro avg): 0.9835757169518431
2019-12-22 18:53:58,226 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9836         0.9836                       0.9836                0.0012                   0.0164  0.9836
1     Macro avg        0.9978         0.9176                       0.6997                0.0044                   0.3003  0.7297
2  Weighted avg        0.9911         0.9792                       0.9836                0.0491                   0.0164  0.9784
2019-12-22 18:53:58,300 [INFO] Results saved to: results_selected_models/selected_ids18_subset_ann_shallow_rep3/selected_ids18_subset_ann_shallow_rep3_results.xlsx
2019-12-22 18:53:58,305 [INFO] ================= Finished running experiment no. 3 ================= 

2019-12-22 18:53:58,353 [INFO] Created directory: results_selected_models/selected_ids18_subset_ann_shallow_rep4
2019-12-22 18:53:58,353 [INFO] Initialized logging. log_filename = results_selected_models/selected_ids18_subset_ann_shallow_rep4/run_log.log
2019-12-22 18:53:58,353 [INFO] ================= Running experiment no. 4  ================= 

2019-12-22 18:53:58,353 [INFO] Experiment parameters given below
2019-12-22 18:53:58,353 [INFO] 
{'experiment_num': 4, 'results_dir': 'results_selected_models/selected_ids18_subset_ann_shallow_rep4', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [512], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 300, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/ids2018', 'description': 'selected_ids18_subset_ann_shallow_rep4'}
2019-12-22 18:53:58,353 [INFO] Created tensorboard log directory: results_selected_models/selected_ids18_subset_ann_shallow_rep4/tf_logs_run_2019_12_22-18_53_58
2019-12-22 18:53:58,353 [INFO] Loading datsets from: ../Datasets/small_datasets/ids2018
2019-12-22 18:53:58,354 [INFO] Reading X, y files
2019-12-22 18:53:58,354 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_train.h5
2019-12-22 18:54:02,383 [INFO] Reading complete. time_to_read=4.03 seconds
2019-12-22 18:54:02,383 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_val.h5
2019-12-22 18:54:03,763 [INFO] Reading complete. time_to_read=1.38 seconds
2019-12-22 18:54:03,763 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_test.h5
2019-12-22 18:54:05,140 [INFO] Reading complete. time_to_read=1.38 seconds
2019-12-22 18:54:05,140 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_train.h5
2019-12-22 18:54:05,430 [INFO] Reading complete. time_to_read=0.29 seconds
2019-12-22 18:54:05,431 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_val.h5
2019-12-22 18:54:05,532 [INFO] Reading complete. time_to_read=0.10 seconds
2019-12-22 18:54:05,533 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_test.h5
2019-12-22 18:54:05,634 [INFO] Reading complete. time_to_read=0.10 seconds
2019-12-22 18:54:08,991 [INFO] Initializing model
2019-12-22 18:54:09,122 [INFO] _________________________________________________________________
2019-12-22 18:54:09,122 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-22 18:54:09,122 [INFO] =================================================================
2019-12-22 18:54:09,122 [INFO] dense_37 (Dense)             (None, 512)               39936     
2019-12-22 18:54:09,122 [INFO] _________________________________________________________________
2019-12-22 18:54:09,122 [INFO] batch_normalization_19 (Batc (None, 512)               2048      
2019-12-22 18:54:09,122 [INFO] _________________________________________________________________
2019-12-22 18:54:09,122 [INFO] dropout_19 (Dropout)         (None, 512)               0         
2019-12-22 18:54:09,122 [INFO] _________________________________________________________________
2019-12-22 18:54:09,122 [INFO] dense_38 (Dense)             (None, 15)                7695      
2019-12-22 18:54:09,122 [INFO] =================================================================
2019-12-22 18:54:09,123 [INFO] Total params: 49,679
2019-12-22 18:54:09,123 [INFO] Trainable params: 48,655
2019-12-22 18:54:09,123 [INFO] Non-trainable params: 1,024
2019-12-22 18:54:09,123 [INFO] _________________________________________________________________
2019-12-22 18:54:09,123 [INFO] Training model
 - val_f1: 0.9837
Epoch 00134: early stopping
Train on 1936462 samples, validate on 645487 samples
Epoch 1/300
 - 51s - loss: 0.0119 - val_loss: 0.0086
 - val_f1: 0.9824
Epoch 2/300
 - 50s - loss: 0.0087 - val_loss: 0.0084
 - val_f1: 0.9830
Epoch 3/300
 - 50s - loss: 0.0085 - val_loss: 0.0138
 - val_f1: 0.9685
Epoch 4/300
 - 50s - loss: 0.0083 - val_loss: 0.0083
 - val_f1: 0.9830
Epoch 5/300
 - 50s - loss: 0.0083 - val_loss: 0.0082
 - val_f1: 0.9833
Epoch 6/300
 - 50s - loss: 0.0083 - val_loss: 0.0082
 - val_f1: 0.9833
Epoch 7/300
 - 50s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9825
Epoch 8/300
 - 50s - loss: 0.0082 - val_loss: 0.0084
 - val_f1: 0.9830
Epoch 9/300
 - 50s - loss: 0.0081 - val_loss: 0.0083
 - val_f1: 0.9831
Epoch 10/300
 - 50s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9831
Epoch 11/300
 - 50s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9831
Epoch 12/300
 - 50s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9830
Epoch 13/300
 - 50s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9830
Epoch 14/300
 - 50s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9835
Epoch 15/300
 - 50s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9829
Epoch 16/300
 - 50s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 17/300
 - 50s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9830
Epoch 18/300
 - 50s - loss: 0.0080 - val_loss: 0.0083
 - val_f1: 0.9824
Epoch 19/300
 - 50s - loss: 0.0080 - val_loss: 0.0102
 - val_f1: 0.9784
Epoch 20/300
 - 50s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9813
Epoch 21/300
 - 50s - loss: 0.0080 - val_loss: 0.0106
 - val_f1: 0.9788
Epoch 22/300
 - 50s - loss: 0.0080 - val_loss: 0.0127
 - val_f1: 0.9701
Epoch 23/300
 - 50s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9831
Epoch 24/300
 - 50s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9828
Epoch 25/300
 - 50s - loss: 0.0079 - val_loss: 0.0081
 - val_f1: 0.9831
Epoch 26/300
 - 50s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 27/300
 - 50s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 28/300
 - 50s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9836
Epoch 29/300
 - 50s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 30/300
 - 50s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9832
Epoch 31/300
 - 50s - loss: 0.0079 - val_loss: 0.0079
2019-12-22 19:31:42,856 [INFO] epoch = 30. Intermediate model saved to results_selected_models/selected_ids18_subset_ann_shallow_rep4/ann_model_epoch_30.pickle
 - val_f1: 0.9835
Epoch 32/300
 - 49s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 33/300
 - 49s - loss: 0.0079 - val_loss: 0.0083
 - val_f1: 0.9818
Epoch 34/300
 - 49s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9834
Epoch 35/300
 - 49s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9834
Epoch 36/300
 - 49s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 37/300
 - 50s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9836
Epoch 38/300
 - 49s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9832
Epoch 39/300
 - 49s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 40/300
 - 49s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 41/300
 - 49s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9832
Epoch 42/300
 - 49s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9834
Epoch 43/300
 - 50s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9830
Epoch 44/300
 - 50s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 45/300
 - 50s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 46/300
 - 50s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 47/300
 - 50s - loss: 0.0079 - val_loss: 0.0120
 - val_f1: 0.9709
Epoch 48/300
 - 50s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 49/300
 - 50s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 50/300
 - 50s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9833
Epoch 51/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 52/300
 - 50s - loss: 0.0078 - val_loss: 0.0083
 - val_f1: 0.9823
Epoch 53/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 54/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 55/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 56/300
 - 50s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9832
Epoch 57/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 58/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 59/300
 - 50s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9834
Epoch 60/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9837
Epoch 61/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
2019-12-22 20:08:17,599 [INFO] epoch = 60. Intermediate model saved to results_selected_models/selected_ids18_subset_ann_shallow_rep4/ann_model_epoch_60.pickle
 - val_f1: 0.9831
Epoch 62/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 63/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9817
Epoch 64/300
 - 50s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9834
Epoch 65/300
 - 50s - loss: 0.0078 - val_loss: 0.0084
 - val_f1: 0.9829
Epoch 66/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9832
Epoch 67/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9818
Epoch 68/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9833
Epoch 69/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9837
Epoch 70/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9834
Epoch 71/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 72/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9834
Epoch 73/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 74/300
 - 50s - loss: 0.0078 - val_loss: 0.0083
 - val_f1: 0.9827
Epoch 75/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 76/300
 - 50s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9835
Epoch 77/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 78/300
 - 50s - loss: 0.0078 - val_loss: 0.0097
 - val_f1: 0.9807
Epoch 79/300
 - 50s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9834
Epoch 80/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9834
Epoch 81/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 82/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 83/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 84/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 85/300
 - 50s - loss: 0.0078 - val_loss: 0.0097
 - val_f1: 0.9805
Epoch 86/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 87/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9838
Epoch 88/300
 - 50s - loss: 0.0078 - val_loss: 0.0082
 - val_f1: 0.9830
Epoch 89/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 90/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 91/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
2019-12-22 20:44:54,913 [INFO] epoch = 90. Intermediate model saved to results_selected_models/selected_ids18_subset_ann_shallow_rep4/ann_model_epoch_90.pickle
 - val_f1: 0.9837
Epoch 92/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9837
Epoch 93/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9833
Epoch 94/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 95/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 96/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 97/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 98/300
 - 49s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 99/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 100/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9831
Epoch 101/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 102/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9831
Epoch 103/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9833
Epoch 104/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 105/300
 - 49s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 106/300
 - 50s - loss: 0.0078 - val_loss: 0.0077
 - val_f1: 0.9836
Epoch 107/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 108/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 109/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 110/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9829
Epoch 111/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 112/300
 - 50s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9836
Epoch 113/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9837
Epoch 114/300
 - 50s - loss: 0.0078 - val_loss: 0.0110
 - val_f1: 0.9754
Epoch 115/300
 - 50s - loss: 0.0078 - val_loss: 0.0081
 - val_f1: 0.9832
Epoch 116/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 117/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 118/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 119/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 120/300
 - 50s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9832
Epoch 121/300
 - 50s - loss: 0.0078 - val_loss: 0.0080
2019-12-22 21:21:30,123 [INFO] epoch = 120. Intermediate model saved to results_selected_models/selected_ids18_subset_ann_shallow_rep4/ann_model_epoch_120.pickle
 - val_f1: 0.9834
Epoch 122/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9833
Epoch 123/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 124/300
 - 49s - loss: 0.0078 - val_loss: 0.0081
 - val_f1: 0.9826
Epoch 125/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 126/300
 - 50s - loss: 0.0078 - val_loss: 0.0089
 - val_f1: 0.9818
Epoch 127/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9837
Epoch 128/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 129/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 130/300
 - 50s - loss: 0.0078 - val_loss: 0.0112
 - val_f1: 0.9775
Epoch 131/300
 - 50s - loss: 0.0078 - val_loss: 0.0089
 - val_f1: 0.9817
Epoch 132/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9838
Epoch 133/300
 - 50s - loss: 0.0078 - val_loss: 0.0095
 - val_f1: 0.9790
Epoch 134/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 135/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 136/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 137/300
 - 50s - loss: 0.0078 - val_loss: 0.0099
 - val_f1: 0.9800
Epoch 138/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 139/300
 - 50s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9835
Epoch 140/300
 - 50s - loss: 0.0078 - val_loss: 0.0099
 - val_f1: 0.9795
Epoch 141/300
 - 50s - loss: 0.0078 - val_loss: 0.0084
 - val_f1: 0.9824
Epoch 142/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 143/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 144/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 145/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 146/300
 - 50s - loss: 0.0078 - val_loss: 0.0098
 - val_f1: 0.9802
Epoch 147/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 148/300
 - 50s - loss: 0.0078 - val_loss: 0.0081
 - val_f1: 0.9833
Epoch 149/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 150/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 151/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
2019-12-22 21:58:07,757 [INFO] epoch = 150. Intermediate model saved to results_selected_models/selected_ids18_subset_ann_shallow_rep4/ann_model_epoch_150.pickle
 - val_f1: 0.9833
Epoch 152/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9838
Epoch 153/300
 - 50s - loss: 0.0078 - val_loss: 0.0108
 - val_f1: 0.9768
Epoch 154/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9837
Epoch 155/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 156/300
 - 50s - loss: 0.0077 - val_loss: 0.0079
2019-12-22 22:04:37,216 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-22 22:06:20,275 [INFO] Last epoch loss evaluation: train_loss = 0.007703, val_loss = 0.007739
2019-12-22 22:06:20,276 [INFO] Training complete. time_to_train = 11531.15 sec, 192.19 min
2019-12-22 22:06:20,281 [INFO] Model saved to results_selected_models/selected_ids18_subset_ann_shallow_rep4/best_model.pickle
2019-12-22 22:06:20,479 [INFO] Plot saved to: results_selected_models/selected_ids18_subset_ann_shallow_rep4/training_error_history.png
2019-12-22 22:06:20,672 [INFO] Plot saved to: results_selected_models/selected_ids18_subset_ann_shallow_rep4/training_f1_history.png
2019-12-22 22:06:20,673 [INFO] Making predictions on training, validation, testing data
2019-12-22 22:08:12,670 [INFO] Evaluating predictions (results)
2019-12-22 22:08:35,855 [INFO] Dataset: Testing. Classification report below
2019-12-22 22:08:35,855 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       1.00      0.33      0.50        24
        Brute Force -XSS       1.00      0.33      0.50         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.70      1.00      0.82        67
  DDoS attacks-LOIC-HTTP       0.99      1.00      0.99     23010
   DoS attacks-GoldenEye       0.99      1.00      1.00      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.72      0.53      0.61      5596
   DoS attacks-Slowloris       0.96      0.98      0.97       440
          FTP-BruteForce       0.71      0.85      0.78      7718
           Infilteration       0.42      0.01      0.02      6404
           SQL Injection       1.00      0.75      0.86         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

                accuracy                           0.98    645488
               macro avg       0.90      0.79      0.80    645488
            weighted avg       0.98      0.98      0.98    645488

2019-12-22 22:08:35,855 [INFO] Overall accuracy (micro avg): 0.9834884614431252
2019-12-22 22:09:00,775 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9835         0.9835                       0.9835                0.0012                   0.0165  0.9835
1     Macro avg        0.9978         0.8987                       0.7856                0.0043                   0.2144  0.8029
2  Weighted avg        0.9910         0.9780                       0.9835                0.0483                   0.0165  0.9786
2019-12-22 22:09:23,925 [INFO] Dataset: Validation. Classification report below
2019-12-22 22:09:23,926 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       1.00      0.48      0.65        25
        Brute Force -XSS       1.00      0.67      0.80         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.76      0.99      0.86        68
  DDoS attacks-LOIC-HTTP       0.99      1.00      0.99     23009
   DoS attacks-GoldenEye       1.00      1.00      1.00      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.73      0.52      0.61      5596
   DoS attacks-Slowloris       0.95      0.98      0.97       439
          FTP-BruteForce       0.71      0.86      0.78      7718
           Infilteration       0.47      0.01      0.03      6403
           SQL Injection       0.50      0.25      0.33         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

                accuracy                           0.98    645487
               macro avg       0.87      0.78      0.80    645487
            weighted avg       0.98      0.98      0.98    645487

2019-12-22 22:09:23,926 [INFO] Overall accuracy (micro avg): 0.9835720936285316
2019-12-22 22:09:48,869 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9836         0.9836                       0.9836                0.0012                   0.0164  0.9836
1     Macro avg        0.9978         0.8732                       0.7841                0.0043                   0.2159  0.8006
2  Weighted avg        0.9910         0.9787                       0.9836                0.0481                   0.0164  0.9787
2019-12-22 22:11:04,524 [INFO] Dataset: Training. Classification report below
2019-12-22 22:11:04,524 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99   1606949
                     Bot       1.00      1.00      1.00     34396
        Brute Force -Web       0.96      0.37      0.53        73
        Brute Force -XSS       0.87      0.50      0.63        26
        DDOS attack-HOIC       1.00      1.00      1.00     82341
    DDOS attack-LOIC-UDP       0.73      1.00      0.85       203
  DDoS attacks-LOIC-HTTP       0.99      1.00      0.99     69029
   DoS attacks-GoldenEye       1.00      1.00      1.00      4954
        DoS attacks-Hulk       1.00      1.00      1.00     55435
DoS attacks-SlowHTTPTest       0.73      0.53      0.61     16787
   DoS attacks-Slowloris       0.97      0.99      0.98      1318
          FTP-BruteForce       0.71      0.86      0.78     23153
           Infilteration       0.50      0.02      0.03     19210
           SQL Injection       0.80      0.33      0.47        12
          SSH-Bruteforce       1.00      1.00      1.00     22576

                accuracy                           0.98   1936462
               macro avg       0.88      0.77      0.79   1936462
            weighted avg       0.98      0.98      0.98   1936462

2019-12-22 22:11:04,524 [INFO] Overall accuracy (micro avg): 0.9836067012933897
2019-12-22 22:12:26,167 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9836         0.9836                       0.9836                0.0012                   0.0164  0.9836
1     Macro avg        0.9978         0.8827                       0.7725                0.0043                   0.2275  0.7913
2  Weighted avg        0.9910         0.9789                       0.9836                0.0480                   0.0164  0.9788
2019-12-22 22:12:26,241 [INFO] Results saved to: results_selected_models/selected_ids18_subset_ann_shallow_rep4/selected_ids18_subset_ann_shallow_rep4_results.xlsx
2019-12-22 22:12:26,245 [INFO] ================= Finished running experiment no. 4 ================= 

2019-12-22 22:12:26,295 [INFO] Created directory: results_selected_models/selected_ids18_subset_ann_shallow_rep5
2019-12-22 22:12:26,296 [INFO] Initialized logging. log_filename = results_selected_models/selected_ids18_subset_ann_shallow_rep5/run_log.log
2019-12-22 22:12:26,296 [INFO] ================= Running experiment no. 5  ================= 

2019-12-22 22:12:26,296 [INFO] Experiment parameters given below
2019-12-22 22:12:26,296 [INFO] 
{'experiment_num': 5, 'results_dir': 'results_selected_models/selected_ids18_subset_ann_shallow_rep5', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'scaling_type': 'NA', 'ann_layer_units': [512], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 300, 'early_stop_patience': 50, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/ids2018', 'description': 'selected_ids18_subset_ann_shallow_rep5'}
2019-12-22 22:12:26,296 [INFO] Created tensorboard log directory: results_selected_models/selected_ids18_subset_ann_shallow_rep5/tf_logs_run_2019_12_22-22_12_26
2019-12-22 22:12:26,296 [INFO] Loading datsets from: ../Datasets/small_datasets/ids2018
2019-12-22 22:12:26,296 [INFO] Reading X, y files
2019-12-22 22:12:26,296 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_train.h5
2019-12-22 22:12:30,314 [INFO] Reading complete. time_to_read=4.02 seconds
2019-12-22 22:12:30,314 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_val.h5
2019-12-22 22:12:31,685 [INFO] Reading complete. time_to_read=1.37 seconds
2019-12-22 22:12:31,685 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_test.h5
2019-12-22 22:12:33,055 [INFO] Reading complete. time_to_read=1.37 seconds
2019-12-22 22:12:33,055 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_train.h5
2019-12-22 22:12:33,338 [INFO] Reading complete. time_to_read=0.28 seconds
2019-12-22 22:12:33,338 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_val.h5
2019-12-22 22:12:33,437 [INFO] Reading complete. time_to_read=0.10 seconds
2019-12-22 22:12:33,437 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_test.h5
2019-12-22 22:12:33,536 [INFO] Reading complete. time_to_read=0.10 seconds
2019-12-22 22:12:36,862 [INFO] Initializing model
2019-12-22 22:12:36,993 [INFO] _________________________________________________________________
2019-12-22 22:12:36,993 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-22 22:12:36,993 [INFO] =================================================================
2019-12-22 22:12:36,993 [INFO] dense_39 (Dense)             (None, 512)               39936     
2019-12-22 22:12:36,993 [INFO] _________________________________________________________________
2019-12-22 22:12:36,994 [INFO] batch_normalization_20 (Batc (None, 512)               2048      
2019-12-22 22:12:36,994 [INFO] _________________________________________________________________
2019-12-22 22:12:36,994 [INFO] dropout_20 (Dropout)         (None, 512)               0         
2019-12-22 22:12:36,994 [INFO] _________________________________________________________________
2019-12-22 22:12:36,994 [INFO] dense_40 (Dense)             (None, 15)                7695      
2019-12-22 22:12:36,994 [INFO] =================================================================
2019-12-22 22:12:36,994 [INFO] Total params: 49,679
2019-12-22 22:12:36,994 [INFO] Trainable params: 48,655
2019-12-22 22:12:36,994 [INFO] Non-trainable params: 1,024
2019-12-22 22:12:36,994 [INFO] _________________________________________________________________
2019-12-22 22:12:36,994 [INFO] Training model
 - val_f1: 0.9835
Epoch 00156: early stopping
Train on 1936462 samples, validate on 645487 samples
Epoch 1/300
 - 51s - loss: 0.0119 - val_loss: 0.0087
 - val_f1: 0.9826
Epoch 2/300
 - 50s - loss: 0.0090 - val_loss: 0.0086
 - val_f1: 0.9807
Epoch 3/300
 - 50s - loss: 0.0085 - val_loss: 0.0085
 - val_f1: 0.9825
Epoch 4/300
 - 50s - loss: 0.0084 - val_loss: 0.0082
 - val_f1: 0.9832
Epoch 5/300
 - 50s - loss: 0.0083 - val_loss: 0.0084
 - val_f1: 0.9825
Epoch 6/300
 - 50s - loss: 0.0082 - val_loss: 0.0080
 - val_f1: 0.9814
Epoch 7/300
 - 50s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9829
Epoch 8/300
 - 50s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9832
Epoch 9/300
 - 50s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9814
Epoch 10/300
 - 50s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9830
Epoch 11/300
 - 50s - loss: 0.0081 - val_loss: 0.0082
 - val_f1: 0.9832
Epoch 12/300
 - 50s - loss: 0.0081 - val_loss: 0.0082
 - val_f1: 0.9832
Epoch 13/300
 - 50s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9831
Epoch 14/300
 - 50s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9816
Epoch 15/300
 - 50s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9832
Epoch 16/300
 - 50s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9831
Epoch 17/300
 - 50s - loss: 0.0080 - val_loss: 0.0082
 - val_f1: 0.9831
Epoch 18/300
 - 50s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9833
Epoch 19/300
 - 50s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9817
Epoch 20/300
 - 50s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9816
Epoch 21/300
 - 50s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 22/300
 - 50s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9832
Epoch 23/300
 - 50s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 24/300
 - 50s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 25/300
 - 50s - loss: 0.0079 - val_loss: 0.0081
 - val_f1: 0.9834
Epoch 26/300
 - 50s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9829
Epoch 27/300
 - 50s - loss: 0.0079 - val_loss: 0.0082
 - val_f1: 0.9833
Epoch 28/300
 - 50s - loss: 0.0079 - val_loss: 0.0081
 - val_f1: 0.9830
Epoch 29/300
 - 50s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 30/300
 - 50s - loss: 0.0079 - val_loss: 0.0085
 - val_f1: 0.9814
Epoch 31/300
 - 50s - loss: 0.0079 - val_loss: 0.0079
2019-12-22 22:50:48,876 [INFO] epoch = 30. Intermediate model saved to results_selected_models/selected_ids18_subset_ann_shallow_rep5/ann_model_epoch_30.pickle
 - val_f1: 0.9835
Epoch 32/300
 - 50s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9833
Epoch 33/300
 - 50s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 34/300
 - 50s - loss: 0.0079 - val_loss: 0.0078
 - val_f1: 0.9830
Epoch 35/300
 - 50s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9833
Epoch 36/300
 - 50s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9818
Epoch 37/300
 - 50s - loss: 0.0079 - val_loss: 0.0081
 - val_f1: 0.9834
Epoch 38/300
 - 50s - loss: 0.0079 - val_loss: 0.0089
 - val_f1: 0.9809
Epoch 39/300
 - 50s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 40/300
 - 50s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 41/300
 - 50s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9820
Epoch 42/300
 - 50s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 43/300
 - 50s - loss: 0.0079 - val_loss: 0.0078
 - val_f1: 0.9832
Epoch 44/300
 - 50s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 45/300
 - 50s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9820
Epoch 46/300
 - 50s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 47/300
 - 50s - loss: 0.0079 - val_loss: 0.0101
 - val_f1: 0.9775
Epoch 48/300
 - 50s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9834
Epoch 49/300
 - 50s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 50/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 51/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 52/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 53/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 54/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 55/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 56/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 57/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 58/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 59/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9834
Epoch 60/300
 - 50s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9814
Epoch 61/300
 - 50s - loss: 0.0078 - val_loss: 0.0120
2019-12-22 23:28:05,953 [INFO] epoch = 60. Intermediate model saved to results_selected_models/selected_ids18_subset_ann_shallow_rep5/ann_model_epoch_60.pickle
 - val_f1: 0.9781
Epoch 62/300
 - 50s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9835
Epoch 63/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9833
Epoch 64/300
 - 50s - loss: 0.0078 - val_loss: 0.0085
 - val_f1: 0.9817
Epoch 65/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 66/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 67/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 68/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9832
Epoch 69/300
 - 50s - loss: 0.0078 - val_loss: 0.0090
 - val_f1: 0.9812
Epoch 70/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9819
Epoch 71/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 72/300
 - 50s - loss: 0.0078 - val_loss: 0.0081
 - val_f1: 0.9834
Epoch 73/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9838
Epoch 74/300
 - 50s - loss: 0.0078 - val_loss: 0.0103
 - val_f1: 0.9786
Epoch 75/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 76/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 77/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 78/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 79/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9833
Epoch 80/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 81/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9837
Epoch 82/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 83/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9833
Epoch 84/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 85/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9837
Epoch 86/300
 - 50s - loss: 0.0078 - val_loss: 0.0077
 - val_f1: 0.9837
Epoch 87/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 88/300
 - 50s - loss: 0.0078 - val_loss: 0.0081
 - val_f1: 0.9828
Epoch 89/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 90/300
 - 50s - loss: 0.0078 - val_loss: 0.0097
 - val_f1: 0.9791
Epoch 91/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
2019-12-23 00:05:26,090 [INFO] epoch = 90. Intermediate model saved to results_selected_models/selected_ids18_subset_ann_shallow_rep5/ann_model_epoch_90.pickle
 - val_f1: 0.9835
Epoch 92/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 93/300
 - 50s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9835
Epoch 94/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9838
Epoch 95/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9837
Epoch 96/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9833
Epoch 97/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9834
Epoch 98/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9819
Epoch 99/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 100/300
 - 50s - loss: 0.0078 - val_loss: 0.0087
 - val_f1: 0.9816
Epoch 101/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 102/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9832
Epoch 103/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 104/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9834
Epoch 105/300
 - 50s - loss: 0.0078 - val_loss: 0.0120
 - val_f1: 0.9735
Epoch 106/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 107/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9833
Epoch 108/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 109/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 110/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 111/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9832
Epoch 112/300
 - 60s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 113/300
 - 50s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9836
Epoch 114/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9833
Epoch 115/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 116/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9837
Epoch 117/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 118/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 119/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9834
Epoch 120/300
 - 50s - loss: 0.0078 - val_loss: 0.0084
 - val_f1: 0.9818
Epoch 121/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
2019-12-23 00:42:55,298 [INFO] epoch = 120. Intermediate model saved to results_selected_models/selected_ids18_subset_ann_shallow_rep5/ann_model_epoch_120.pickle
 - val_f1: 0.9835
Epoch 122/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9836
Epoch 123/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 124/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9838
Epoch 125/300
 - 50s - loss: 0.0078 - val_loss: 0.0083
 - val_f1: 0.9833
Epoch 126/300
 - 50s - loss: 0.0078 - val_loss: 0.0090
 - val_f1: 0.9808
Epoch 127/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9838
Epoch 128/300
 - 50s - loss: 0.0078 - val_loss: 0.0139
 - val_f1: 0.9673
Epoch 129/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 130/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9835
Epoch 131/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9836
Epoch 132/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9835
Epoch 133/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
 - val_f1: 0.9816
Epoch 134/300
 - 50s - loss: 0.0078 - val_loss: 0.0078
 - val_f1: 0.9834
Epoch 135/300
 - 50s - loss: 0.0078 - val_loss: 0.0080
 - val_f1: 0.9818
Epoch 136/300
 - 50s - loss: 0.0078 - val_loss: 0.0079
2019-12-23 01:01:57,783 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-23 01:03:43,513 [INFO] Last epoch loss evaluation: train_loss = 0.007715, val_loss = 0.007744
2019-12-23 01:03:43,513 [INFO] Training complete. time_to_train = 10266.52 sec, 171.11 min
2019-12-23 01:03:43,519 [INFO] Model saved to results_selected_models/selected_ids18_subset_ann_shallow_rep5/best_model.pickle
2019-12-23 01:03:43,710 [INFO] Plot saved to: results_selected_models/selected_ids18_subset_ann_shallow_rep5/training_error_history.png
2019-12-23 01:03:43,890 [INFO] Plot saved to: results_selected_models/selected_ids18_subset_ann_shallow_rep5/training_f1_history.png
2019-12-23 01:03:43,890 [INFO] Making predictions on training, validation, testing data
2019-12-23 01:05:38,554 [INFO] Evaluating predictions (results)
2019-12-23 01:06:01,836 [INFO] Dataset: Testing. Classification report below
2019-12-23 01:06:01,836 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       0.89      0.33      0.48        24
        Brute Force -XSS       1.00      0.33      0.50         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.66      1.00      0.80        67
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23010
   DoS attacks-GoldenEye       0.99      1.00      1.00      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.74      0.52      0.61      5596
   DoS attacks-Slowloris       0.95      0.98      0.96       440
          FTP-BruteForce       0.71      0.87      0.78      7718
           Infilteration       0.45      0.01      0.03      6404
           SQL Injection       1.00      0.50      0.67         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

                accuracy                           0.98    645488
               macro avg       0.89      0.77      0.79    645488
            weighted avg       0.98      0.98      0.98    645488

2019-12-23 01:06:01,836 [INFO] Overall accuracy (micro avg): 0.9836418337753762
2019-12-23 01:06:26,872 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9836         0.9836                       0.9836                0.0012                   0.0164  0.9836
1     Macro avg        0.9978         0.8923                       0.7688                0.0044                   0.2312  0.7875
2  Weighted avg        0.9910         0.9786                       0.9836                0.0492                   0.0164  0.9788
2019-12-23 01:06:49,965 [INFO] Dataset: Validation. Classification report below
2019-12-23 01:06:49,965 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       1.00      0.48      0.65        25
        Brute Force -XSS       1.00      0.67      0.80         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.70      1.00      0.82        68
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23009
   DoS attacks-GoldenEye       1.00      1.00      1.00      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.75      0.51      0.61      5596
   DoS attacks-Slowloris       0.94      0.98      0.96       439
          FTP-BruteForce       0.71      0.88      0.79      7718
           Infilteration       0.45      0.01      0.02      6403
           SQL Injection       1.00      0.25      0.40         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

                accuracy                           0.98    645487
               macro avg       0.90      0.78      0.80    645487
            weighted avg       0.98      0.98      0.98    645487

2019-12-23 01:06:49,965 [INFO] Overall accuracy (micro avg): 0.9837115232374936
2019-12-23 01:07:14,878 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9837         0.9837                       0.9837                0.0012                   0.0163  0.9837
1     Macro avg        0.9978         0.9016                       0.7846                0.0044                   0.2154  0.8023
2  Weighted avg        0.9910         0.9786                       0.9837                0.0490                   0.0163  0.9788
2019-12-23 01:08:30,547 [INFO] Dataset: Training. Classification report below
2019-12-23 01:08:30,547 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99   1606949
                     Bot       1.00      1.00      1.00     34396
        Brute Force -Web       0.96      0.37      0.53        73
        Brute Force -XSS       1.00      0.50      0.67        26
        DDOS attack-HOIC       1.00      1.00      1.00     82341
    DDOS attack-LOIC-UDP       0.70      1.00      0.82       203
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     69029
   DoS attacks-GoldenEye       1.00      1.00      1.00      4954
        DoS attacks-Hulk       1.00      1.00      1.00     55435
DoS attacks-SlowHTTPTest       0.75      0.51      0.61     16787
   DoS attacks-Slowloris       0.96      0.99      0.97      1318
          FTP-BruteForce       0.71      0.87      0.78     23153
           Infilteration       0.51      0.01      0.03     19210
           SQL Injection       1.00      0.33      0.50        12
          SSH-Bruteforce       1.00      1.00      1.00     22576

                accuracy                           0.98   1936462
               macro avg       0.90      0.77      0.79   1936462
            weighted avg       0.98      0.98      0.98   1936462

2019-12-23 01:08:30,547 [INFO] Overall accuracy (micro avg): 0.9837285730368063
2019-12-23 01:09:52,134 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9837         0.9837                       0.9837                0.0012                   0.0163  0.9837
1     Macro avg        0.9978         0.9044                       0.7724                0.0044                   0.2276  0.7935
2  Weighted avg        0.9911         0.9792                       0.9837                0.0490                   0.0163  0.9788
2019-12-23 01:09:52,208 [INFO] Results saved to: results_selected_models/selected_ids18_subset_ann_shallow_rep5/selected_ids18_subset_ann_shallow_rep5_results.xlsx
2019-12-23 01:09:52,212 [INFO] ================= Finished running experiment no. 5 ================= 

2019-12-23 01:09:52,261 [INFO] ================= Finished running 20 experiments ================= 

 - val_f1: 0.9836
Epoch 00136: early stopping
