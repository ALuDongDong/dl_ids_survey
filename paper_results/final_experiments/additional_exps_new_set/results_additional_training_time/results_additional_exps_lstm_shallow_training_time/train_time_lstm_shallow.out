Using TensorFlow backend.
/home/nilwala/anaconda3/envs/ml_env/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:526: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/nilwala/anaconda3/envs/ml_env/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:527: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/nilwala/anaconda3/envs/ml_env/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:528: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/nilwala/anaconda3/envs/ml_env/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:529: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/nilwala/anaconda3/envs/ml_env/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:530: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/nilwala/anaconda3/envs/ml_env/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:535: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
2020-01-13 20:44:58,555 [INFO] Read 12 experiments from file: experiment_specs/additional_exps/training_time/train_time_lstm.csv
2020-01-13 20:44:58,555 [INFO] ================= Started running experiments ================= 

2020-01-13 20:44:58,555 [INFO] Created directory: results_additional_exps/train_time_nsl_lstm_shallow_rep1
2020-01-13 20:44:58,555 [INFO] Initialized logging. log_filename = results_additional_exps/train_time_nsl_lstm_shallow_rep1/run_log.log
2020-01-13 20:44:58,555 [INFO] ================= Running experiment no. 1  ================= 

2020-01-13 20:44:58,555 [INFO] Experiment parameters given below
2020-01-13 20:44:58,556 [INFO] 
{'experiment_num': 1, 'results_dir': 'results_additional_exps/train_time_nsl_lstm_shallow_rep1', 'model': 'lstm', 'model_type': 'classifier', 'normal_label': 'normal', 'lstm_time_steps': 32, 'lstm_layer_units': [32], 'lstm_layer_activations': ['relu'], 'lstm_layer_dropout_rates': [0.2], 'batch_size': 256, 'epochs': 100, 'early_stop_patience': 100, 'goal_metric': 0.764, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/nsl_kdd_five_classes', 'description': 'train_time_nsl_lstm_shallow_rep1'}
2020-01-13 20:44:58,556 [INFO] Created tensorboard log directory: results_additional_exps/train_time_nsl_lstm_shallow_rep1/tf_logs_run_2020_01_13-20_44_58
2020-01-13 20:44:58,556 [INFO] Loading datsets from: ../Datasets/small_datasets/nsl_kdd_five_classes
2020-01-13 20:44:58,565 [INFO] Reading X, y files
2020-01-13 20:44:58,565 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_train.h5
2020-01-13 20:44:58,846 [INFO] NumExpr defaulting to 4 threads.
2020-01-13 20:44:59,656 [INFO] Reading complete. time_to_read=1.09 seconds
2020-01-13 20:44:59,656 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_val.h5
2020-01-13 20:44:59,868 [INFO] Reading complete. time_to_read=0.21 seconds
2020-01-13 20:44:59,868 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_test.h5
2020-01-13 20:45:00,103 [INFO] Reading complete. time_to_read=0.24 seconds
2020-01-13 20:45:00,103 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_train.h5
2020-01-13 20:45:00,185 [INFO] Reading complete. time_to_read=0.08 seconds
2020-01-13 20:45:00,186 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_val.h5
2020-01-13 20:45:00,245 [INFO] Reading complete. time_to_read=0.06 seconds
2020-01-13 20:45:00,246 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_test.h5
2020-01-13 20:45:00,286 [INFO] Reading complete. time_to_read=0.04 seconds
2020-01-13 20:45:00,397 [INFO] Preparing flow sequences
2020-01-13 20:45:01,531 [INFO] Extracting flows complete. time_taken = 1.13 sec
2020-01-13 20:45:01,577 [INFO] Initializing model
WARNING:tensorflow:From /home/nilwala/anaconda3/envs/ml_env/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
2020-01-13 20:45:01,697 [WARNING] From /home/nilwala/anaconda3/envs/ml_env/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
OMP: Info #212: KMP_AFFINITY: decoding x2APIC ids.
OMP: Info #210: KMP_AFFINITY: Affinity capable, using global cpuid leaf 11 info
OMP: Info #154: KMP_AFFINITY: Initial OS proc set respected: 0-3
OMP: Info #156: KMP_AFFINITY: 4 available OS procs
OMP: Info #157: KMP_AFFINITY: Uniform topology
OMP: Info #179: KMP_AFFINITY: 1 packages x 4 cores/pkg x 1 threads/core (4 total cores)
OMP: Info #214: KMP_AFFINITY: OS proc to physical thread map:
OMP: Info #171: KMP_AFFINITY: OS proc 0 maps to package 0 core 0 
OMP: Info #171: KMP_AFFINITY: OS proc 1 maps to package 0 core 1 
OMP: Info #171: KMP_AFFINITY: OS proc 2 maps to package 0 core 2 
OMP: Info #171: KMP_AFFINITY: OS proc 3 maps to package 0 core 3 
OMP: Info #250: KMP_AFFINITY: pid 4293 tid 4293 thread 0 bound to OS proc set 0
OMP: Info #250: KMP_AFFINITY: pid 4293 tid 4301 thread 1 bound to OS proc set 1
OMP: Info #250: KMP_AFFINITY: pid 4293 tid 4302 thread 2 bound to OS proc set 2
OMP: Info #250: KMP_AFFINITY: pid 4293 tid 4303 thread 3 bound to OS proc set 3
WARNING:tensorflow:From /home/nilwala/anaconda3/envs/ml_env/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2020-01-13 20:45:02,404 [WARNING] From /home/nilwala/anaconda3/envs/ml_env/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2020-01-13 20:45:02,444 [INFO] _________________________________________________________________
2020-01-13 20:45:02,444 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-13 20:45:02,444 [INFO] =================================================================
2020-01-13 20:45:02,444 [INFO] lstm_1 (LSTM)                (None, 32, 32)            19840     
2020-01-13 20:45:02,444 [INFO] _________________________________________________________________
2020-01-13 20:45:02,444 [INFO] batch_normalization_1 (Batch (None, 32, 32)            128       
2020-01-13 20:45:02,444 [INFO] _________________________________________________________________
2020-01-13 20:45:02,444 [INFO] dropout_1 (Dropout)          (None, 32, 32)            0         
2020-01-13 20:45:02,444 [INFO] _________________________________________________________________
2020-01-13 20:45:02,444 [INFO] time_distributed_1 (TimeDist (None, 32, 5)             165       
2020-01-13 20:45:02,444 [INFO] =================================================================
2020-01-13 20:45:02,445 [INFO] Total params: 20,133
2020-01-13 20:45:02,445 [INFO] Trainable params: 20,069
2020-01-13 20:45:02,445 [INFO] Non-trainable params: 64
2020-01-13 20:45:02,445 [INFO] _________________________________________________________________
2020-01-13 20:45:02,445 [INFO] Training model
WARNING:tensorflow:From /home/nilwala/anaconda3/envs/ml_env/lib/python3.7/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2020-01-13 20:45:09,815 [WARNING] From /home/nilwala/anaconda3/envs/ml_env/lib/python3.7/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2020-01-13 20:45:10.589384: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2020-01-13 20:45:10.772271: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2893400000 Hz
2020-01-13 20:45:10.818376: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x562d9fb51490 executing computations on platform Host. Devices:
2020-01-13 20:45:10.818411: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
2020-01-13 20:45:10.829069: I tensorflow/core/common_runtime/process_util.cc:71] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
OMP: Info #250: KMP_AFFINITY: pid 4293 tid 4310 thread 4 bound to OS proc set 0
OMP: Info #250: KMP_AFFINITY: pid 4293 tid 4311 thread 5 bound to OS proc set 1
OMP: Info #250: KMP_AFFINITY: pid 4293 tid 4339 thread 6 bound to OS proc set 2
OMP: Info #250: KMP_AFFINITY: pid 4293 tid 4340 thread 7 bound to OS proc set 3
OMP: Info #250: KMP_AFFINITY: pid 4293 tid 4341 thread 8 bound to OS proc set 0
Train on 3149 samples, validate on 787 samples
Epoch 1/100
 - 3s - loss: 0.5519 - val_loss: 0.3651
 - val_f1: 0.4390
 - out_of_sample_accuracy: 0.1824
Epoch 2/100
 - 1s - loss: 0.3484 - val_loss: 0.2177
 - val_f1: 0.8002
 - out_of_sample_accuracy: 0.4996
Epoch 3/100
 - 1s - loss: 0.2231 - val_loss: 0.1385
 - val_f1: 0.9072
 - out_of_sample_accuracy: 0.6390
Epoch 4/100
 - 1s - loss: 0.1481 - val_loss: 0.1001
 - val_f1: 0.9329
 - out_of_sample_accuracy: 0.6941
Epoch 5/100
 - 1s - loss: 0.1073 - val_loss: 0.0830
 - val_f1: 0.9477
 - out_of_sample_accuracy: 0.7044
Epoch 6/100
 - 1s - loss: 0.0853 - val_loss: 0.0722
 - val_f1: 0.9570
 - out_of_sample_accuracy: 0.7085
Epoch 7/100
 - 1s - loss: 0.0726 - val_loss: 0.0650
 - val_f1: 0.9618
 - out_of_sample_accuracy: 0.7114
Epoch 8/100
 - 1s - loss: 0.0639 - val_loss: 0.0595
 - val_f1: 0.9646
 - out_of_sample_accuracy: 0.7142
Epoch 9/100
 - 1s - loss: 0.0585 - val_loss: 0.0547
 - val_f1: 0.9659
 - out_of_sample_accuracy: 0.7170
Epoch 10/100
 - 1s - loss: 0.0540 - val_loss: 0.0505
 - val_f1: 0.9675
 - out_of_sample_accuracy: 0.7175
Epoch 11/100
 - 1s - loss: 0.0500 - val_loss: 0.0472
2020-01-13 20:45:23,095 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/train_time_nsl_lstm_shallow_rep1/_model_epoch_10.pickle
 - val_f1: 0.9688
 - out_of_sample_accuracy: 0.7172
Epoch 12/100
 - 1s - loss: 0.0469 - val_loss: 0.0441
 - val_f1: 0.9702
 - out_of_sample_accuracy: 0.7172
Epoch 13/100
 - 1s - loss: 0.0441 - val_loss: 0.0416
 - val_f1: 0.9713
 - out_of_sample_accuracy: 0.7181
Epoch 14/100
 - 1s - loss: 0.0420 - val_loss: 0.0394
 - val_f1: 0.9727
 - out_of_sample_accuracy: 0.7192
Epoch 15/100
 - 1s - loss: 0.0398 - val_loss: 0.0375
 - val_f1: 0.9729
 - out_of_sample_accuracy: 0.7194
Epoch 16/100
 - 1s - loss: 0.0377 - val_loss: 0.0357
 - val_f1: 0.9738
 - out_of_sample_accuracy: 0.7206
Epoch 17/100
 - 1s - loss: 0.0361 - val_loss: 0.0341
 - val_f1: 0.9745
 - out_of_sample_accuracy: 0.7207
Epoch 18/100
 - 1s - loss: 0.0342 - val_loss: 0.0324
 - val_f1: 0.9751
 - out_of_sample_accuracy: 0.7222
Epoch 19/100
 - 1s - loss: 0.0327 - val_loss: 0.0307
 - val_f1: 0.9755
 - out_of_sample_accuracy: 0.7240
Epoch 20/100
 - 1s - loss: 0.0312 - val_loss: 0.0292
 - val_f1: 0.9768
 - out_of_sample_accuracy: 0.7261
Epoch 21/100
 - 1s - loss: 0.0296 - val_loss: 0.0273
2020-01-13 20:45:31,031 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/train_time_nsl_lstm_shallow_rep1/_model_epoch_20.pickle
 - val_f1: 0.9771
 - out_of_sample_accuracy: 0.7284
Epoch 22/100
 - 1s - loss: 0.0281 - val_loss: 0.0257
 - val_f1: 0.9780
 - out_of_sample_accuracy: 0.7309
Epoch 23/100
 - 1s - loss: 0.0264 - val_loss: 0.0244
 - val_f1: 0.9786
 - out_of_sample_accuracy: 0.7343
Epoch 24/100
 - 1s - loss: 0.0253 - val_loss: 0.0230
 - val_f1: 0.9789
 - out_of_sample_accuracy: 0.7377
Epoch 25/100
 - 1s - loss: 0.0241 - val_loss: 0.0218
 - val_f1: 0.9813
 - out_of_sample_accuracy: 0.7400
Epoch 26/100
 - 1s - loss: 0.0229 - val_loss: 0.0207
 - val_f1: 0.9821
 - out_of_sample_accuracy: 0.7403
Epoch 27/100
 - 1s - loss: 0.0218 - val_loss: 0.0197
 - val_f1: 0.9831
 - out_of_sample_accuracy: 0.7421
Epoch 28/100
 - 1s - loss: 0.0205 - val_loss: 0.0189
 - val_f1: 0.9839
 - out_of_sample_accuracy: 0.7436
Epoch 29/100
 - 1s - loss: 0.0203 - val_loss: 0.0181
 - val_f1: 0.9843
 - out_of_sample_accuracy: 0.7459
Epoch 30/100
 - 1s - loss: 0.0193 - val_loss: 0.0173
 - val_f1: 0.9855
 - out_of_sample_accuracy: 0.7477
Epoch 31/100
 - 1s - loss: 0.0186 - val_loss: 0.0168
2020-01-13 20:45:38,950 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/train_time_nsl_lstm_shallow_rep1/_model_epoch_30.pickle
 - val_f1: 0.9860
 - out_of_sample_accuracy: 0.7483
Epoch 32/100
 - 1s - loss: 0.0179 - val_loss: 0.0163
 - val_f1: 0.9868
 - out_of_sample_accuracy: 0.7496
Epoch 33/100
 - 1s - loss: 0.0175 - val_loss: 0.0159
 - val_f1: 0.9873
 - out_of_sample_accuracy: 0.7511
Epoch 34/100
 - 1s - loss: 0.0169 - val_loss: 0.0154
 - val_f1: 0.9882
 - out_of_sample_accuracy: 0.7552
Epoch 35/100
 - 1s - loss: 0.0161 - val_loss: 0.0150
 - val_f1: 0.9880
 - out_of_sample_accuracy: 0.7566
Epoch 36/100
 - 1s - loss: 0.0159 - val_loss: 0.0146
 - val_f1: 0.9888
 - out_of_sample_accuracy: 0.7579
Epoch 37/100
 - 1s - loss: 0.0156 - val_loss: 0.0143
 - val_f1: 0.9886
 - out_of_sample_accuracy: 0.7576
Epoch 38/100
 - 1s - loss: 0.0153 - val_loss: 0.0139
 - val_f1: 0.9893
 - out_of_sample_accuracy: 0.7583
Epoch 39/100
 - 1s - loss: 0.0147 - val_loss: 0.0137
 - val_f1: 0.9894
 - out_of_sample_accuracy: 0.7602
Epoch 40/100
 - 1s - loss: 0.0143 - val_loss: 0.0134
 - val_f1: 0.9898
 - out_of_sample_accuracy: 0.7613
Epoch 41/100
 - 1s - loss: 0.0142 - val_loss: 0.0132
2020-01-13 20:45:46,868 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/train_time_nsl_lstm_shallow_rep1/_model_epoch_40.pickle
2020-01-13 20:45:47,123 [INFO] StopperOnGoal: reached goal_metric (accuracy). Stopping training. goal_metric = 0.7640, current_metric = 0.7655, num_epochs = 41
2020-01-13 20:45:47,124 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-13 20:45:47,769 [INFO] Last epoch loss evaluation: train_loss = 0.011468, val_loss = 0.013208
2020-01-13 20:45:47,769 [INFO] Training complete. time_to_train = 45.32 sec, 0.76 min
2020-01-13 20:45:47,772 [INFO] Model saved to results_additional_exps/train_time_nsl_lstm_shallow_rep1/best_model.pickle
2020-01-13 20:45:47,787 [INFO] Training history saved to: results_additional_exps/train_time_nsl_lstm_shallow_rep1/training_error_history.csv
2020-01-13 20:45:48,008 [INFO] Plot saved to: results_additional_exps/train_time_nsl_lstm_shallow_rep1/training_error_history.png
2020-01-13 20:45:48,148 [INFO] Plot saved to: results_additional_exps/train_time_nsl_lstm_shallow_rep1/training_f1_history.png
2020-01-13 20:45:48,149 [INFO] Making predictions on training, validation, testing data
2020-01-13 20:45:48,828 [INFO] Making predictions complete. time_to_predict = 0.68 sec, 0.01 min
2020-01-13 20:45:48,832 [INFO] Evaluating predictions (results)
2020-01-13 20:45:49,671 [INFO] Dataset: Testing. Classification report below
2020-01-13 20:45:49,672 [INFO] 
              precision    recall  f1-score   support

         dos       0.96      0.85      0.90      7450
      normal       0.68      0.93      0.79      9704
       probe       0.74      0.72      0.73      2420
         r2l       0.98      0.08      0.14      2421
         u2r       0.54      0.05      0.09       533

    accuracy                           0.77     22528
   macro avg       0.78      0.53      0.53     22528
weighted avg       0.81      0.77      0.73     22528

2020-01-13 20:45:49,672 [INFO] Overall accuracy (micro avg): 0.7699307528409091
2020-01-13 20:45:50,198 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.7699         0.7699                       0.7699                0.0575                   0.2301  0.7699
1     Macro avg        0.9080         0.7806                       0.5256                0.0766                   0.4744  0.5292
2  Weighted avg        0.8680         0.8071                       0.7699                0.1531                   0.2301  0.7324
2020-01-13 20:45:50,834 [INFO] Dataset: Validation. Classification report below
2020-01-13 20:45:50,834 [INFO] 
              precision    recall  f1-score   support

         dos       0.99      1.00      1.00      9183
      normal       0.99      0.99      0.99     13462
       probe       0.98      0.98      0.98      2330
         r2l       0.87      0.65      0.74       199
         u2r       0.57      0.40      0.47        10

    accuracy                           0.99     25184
   macro avg       0.88      0.80      0.84     25184
weighted avg       0.99      0.99      0.99     25184

2020-01-13 20:45:50,834 [INFO] Overall accuracy (micro avg): 0.9899539390088945
2020-01-13 20:45:51,453 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9900         0.9900                       0.9900                0.0025                   0.0100  0.9900
1     Macro avg        0.9960         0.8816                       0.8028                0.0035                   0.1972  0.8359
2  Weighted avg        0.9936         0.9897                       0.9900                0.0074                   0.0100  0.9897
2020-01-13 20:45:54,067 [INFO] Dataset: Training. Classification report below
2020-01-13 20:45:54,067 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00     36738
      normal       0.99      0.99      0.99     53871
       probe       0.99      0.97      0.98      9321
         r2l       0.94      0.69      0.80       796
         u2r       0.81      0.50      0.62        42

    accuracy                           0.99    100768
   macro avg       0.94      0.83      0.88    100768
weighted avg       0.99      0.99      0.99    100768

2020-01-13 20:45:54,067 [INFO] Overall accuracy (micro avg): 0.9916540965385837
2020-01-13 20:45:56,867 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9917         0.9917                       0.9917                0.0021                   0.0083  0.9917
1     Macro avg        0.9967         0.9443                       0.8324                0.0030                   0.1676  0.8774
2  Weighted avg        0.9947         0.9915                       0.9917                0.0068                   0.0083  0.9914
2020-01-13 20:45:56,916 [INFO] Results saved to: results_additional_exps/train_time_nsl_lstm_shallow_rep1/train_time_nsl_lstm_shallow_rep1_results.xlsx
2020-01-13 20:45:56,916 [INFO] ================= Finished running experiment no. 1 ================= 

2020-01-13 20:45:56,919 [INFO] Created directory: results_additional_exps/train_time_nsl_lstm_shallow_rep2
2020-01-13 20:45:56,919 [INFO] Initialized logging. log_filename = results_additional_exps/train_time_nsl_lstm_shallow_rep2/run_log.log
2020-01-13 20:45:56,919 [INFO] ================= Running experiment no. 2  ================= 

2020-01-13 20:45:56,919 [INFO] Experiment parameters given below
2020-01-13 20:45:56,919 [INFO] 
{'experiment_num': 2, 'results_dir': 'results_additional_exps/train_time_nsl_lstm_shallow_rep2', 'model': 'lstm', 'model_type': 'classifier', 'normal_label': 'normal', 'lstm_time_steps': 32, 'lstm_layer_units': [32], 'lstm_layer_activations': ['relu'], 'lstm_layer_dropout_rates': [0.2], 'batch_size': 256, 'epochs': 100, 'early_stop_patience': 100, 'goal_metric': 0.764, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/nsl_kdd_five_classes', 'description': 'train_time_nsl_lstm_shallow_rep2'}
2020-01-13 20:45:56,919 [INFO] Created tensorboard log directory: results_additional_exps/train_time_nsl_lstm_shallow_rep2/tf_logs_run_2020_01_13-20_45_56
2020-01-13 20:45:56,919 [INFO] Loading datsets from: ../Datasets/small_datasets/nsl_kdd_five_classes
2020-01-13 20:45:56,920 [INFO] Reading X, y files
2020-01-13 20:45:56,920 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_train.h5
2020-01-13 20:45:57,157 [INFO] Reading complete. time_to_read=0.24 seconds
2020-01-13 20:45:57,157 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_val.h5
2020-01-13 20:45:57,221 [INFO] Reading complete. time_to_read=0.06 seconds
2020-01-13 20:45:57,221 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_test.h5
2020-01-13 20:45:57,279 [INFO] Reading complete. time_to_read=0.06 seconds
2020-01-13 20:45:57,279 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_train.h5
2020-01-13 20:45:57,287 [INFO] Reading complete. time_to_read=0.01 seconds
2020-01-13 20:45:57,287 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_val.h5
2020-01-13 20:45:57,291 [INFO] Reading complete. time_to_read=0.00 seconds
2020-01-13 20:45:57,291 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_test.h5
2020-01-13 20:45:57,295 [INFO] Reading complete. time_to_read=0.00 seconds
2020-01-13 20:45:57,410 [INFO] Preparing flow sequences
2020-01-13 20:45:58,544 [INFO] Extracting flows complete. time_taken = 1.13 sec
2020-01-13 20:45:58,590 [INFO] Initializing model
2020-01-13 20:45:58,817 [INFO] _________________________________________________________________
2020-01-13 20:45:58,817 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-13 20:45:58,817 [INFO] =================================================================
2020-01-13 20:45:58,817 [INFO] lstm_2 (LSTM)                (None, 32, 32)            19840     
2020-01-13 20:45:58,817 [INFO] _________________________________________________________________
2020-01-13 20:45:58,817 [INFO] batch_normalization_2 (Batch (None, 32, 32)            128       
2020-01-13 20:45:58,817 [INFO] _________________________________________________________________
2020-01-13 20:45:58,817 [INFO] dropout_2 (Dropout)          (None, 32, 32)            0         
2020-01-13 20:45:58,817 [INFO] _________________________________________________________________
2020-01-13 20:45:58,817 [INFO] time_distributed_2 (TimeDist (None, 32, 5)             165       
2020-01-13 20:45:58,817 [INFO] =================================================================
2020-01-13 20:45:58,817 [INFO] Total params: 20,133
2020-01-13 20:45:58,817 [INFO] Trainable params: 20,069
2020-01-13 20:45:58,817 [INFO] Non-trainable params: 64
2020-01-13 20:45:58,817 [INFO] _________________________________________________________________
2020-01-13 20:45:58,818 [INFO] Training model
 - val_f1: 0.9898
 - out_of_sample_accuracy: 0.7655
Train on 3149 samples, validate on 787 samples
Epoch 1/100
 - 2s - loss: 0.5322 - val_loss: 0.3950
 - val_f1: 0.4084
 - out_of_sample_accuracy: 0.1846
Epoch 2/100
 - 1s - loss: 0.3350 - val_loss: 0.2504
 - val_f1: 0.7669
 - out_of_sample_accuracy: 0.4497
Epoch 3/100
 - 1s - loss: 0.2118 - val_loss: 0.1511
 - val_f1: 0.8958
 - out_of_sample_accuracy: 0.5776
Epoch 4/100
 - 1s - loss: 0.1351 - val_loss: 0.0983
 - val_f1: 0.9356
 - out_of_sample_accuracy: 0.6685
Epoch 5/100
 - 1s - loss: 0.0977 - val_loss: 0.0757
 - val_f1: 0.9538
 - out_of_sample_accuracy: 0.7035
Epoch 6/100
 - 1s - loss: 0.0793 - val_loss: 0.0645
 - val_f1: 0.9607
 - out_of_sample_accuracy: 0.7079
Epoch 7/100
 - 1s - loss: 0.0691 - val_loss: 0.0580
 - val_f1: 0.9642
 - out_of_sample_accuracy: 0.7101
Epoch 8/100
 - 1s - loss: 0.0619 - val_loss: 0.0535
 - val_f1: 0.9659
 - out_of_sample_accuracy: 0.7105
Epoch 9/100
 - 1s - loss: 0.0572 - val_loss: 0.0495
 - val_f1: 0.9673
 - out_of_sample_accuracy: 0.7121
Epoch 10/100
 - 1s - loss: 0.0533 - val_loss: 0.0463
 - val_f1: 0.9686
 - out_of_sample_accuracy: 0.7132
Epoch 11/100
 - 1s - loss: 0.0498 - val_loss: 0.0436
2020-01-13 20:46:10,752 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/train_time_nsl_lstm_shallow_rep2/_model_epoch_10.pickle
 - val_f1: 0.9699
 - out_of_sample_accuracy: 0.7141
Epoch 12/100
 - 1s - loss: 0.0474 - val_loss: 0.0413
 - val_f1: 0.9712
 - out_of_sample_accuracy: 0.7153
Epoch 13/100
 - 1s - loss: 0.0447 - val_loss: 0.0392
 - val_f1: 0.9717
 - out_of_sample_accuracy: 0.7166
Epoch 14/100
 - 1s - loss: 0.0428 - val_loss: 0.0373
 - val_f1: 0.9725
 - out_of_sample_accuracy: 0.7180
Epoch 15/100
 - 1s - loss: 0.0402 - val_loss: 0.0356
 - val_f1: 0.9730
 - out_of_sample_accuracy: 0.7185
Epoch 16/100
 - 1s - loss: 0.0387 - val_loss: 0.0341
 - val_f1: 0.9735
 - out_of_sample_accuracy: 0.7195
Epoch 17/100
 - 1s - loss: 0.0370 - val_loss: 0.0326
 - val_f1: 0.9745
 - out_of_sample_accuracy: 0.7212
Epoch 18/100
 - 1s - loss: 0.0349 - val_loss: 0.0311
 - val_f1: 0.9745
 - out_of_sample_accuracy: 0.7239
Epoch 19/100
 - 1s - loss: 0.0336 - val_loss: 0.0298
 - val_f1: 0.9752
 - out_of_sample_accuracy: 0.7266
Epoch 20/100
 - 1s - loss: 0.0320 - val_loss: 0.0287
 - val_f1: 0.9747
 - out_of_sample_accuracy: 0.7302
Epoch 21/100
 - 1s - loss: 0.0303 - val_loss: 0.0272
2020-01-13 20:46:18,747 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/train_time_nsl_lstm_shallow_rep2/_model_epoch_20.pickle
 - val_f1: 0.9752
 - out_of_sample_accuracy: 0.7347
Epoch 22/100
 - 1s - loss: 0.0287 - val_loss: 0.0260
 - val_f1: 0.9749
 - out_of_sample_accuracy: 0.7381
Epoch 23/100
 - 1s - loss: 0.0274 - val_loss: 0.0248
 - val_f1: 0.9766
 - out_of_sample_accuracy: 0.7397
Epoch 24/100
 - 1s - loss: 0.0259 - val_loss: 0.0236
 - val_f1: 0.9766
 - out_of_sample_accuracy: 0.7403
Epoch 25/100
 - 1s - loss: 0.0245 - val_loss: 0.0226
 - val_f1: 0.9767
 - out_of_sample_accuracy: 0.7411
Epoch 26/100
 - 1s - loss: 0.0230 - val_loss: 0.0215
 - val_f1: 0.9777
 - out_of_sample_accuracy: 0.7418
Epoch 27/100
 - 1s - loss: 0.0223 - val_loss: 0.0203
 - val_f1: 0.9792
 - out_of_sample_accuracy: 0.7418
Epoch 28/100
 - 1s - loss: 0.0211 - val_loss: 0.0195
 - val_f1: 0.9800
 - out_of_sample_accuracy: 0.7412
Epoch 29/100
 - 1s - loss: 0.0198 - val_loss: 0.0189
 - val_f1: 0.9805
 - out_of_sample_accuracy: 0.7412
Epoch 30/100
 - 1s - loss: 0.0192 - val_loss: 0.0182
 - val_f1: 0.9815
 - out_of_sample_accuracy: 0.7421
Epoch 31/100
 - 1s - loss: 0.0185 - val_loss: 0.0174
2020-01-13 20:46:26,749 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/train_time_nsl_lstm_shallow_rep2/_model_epoch_30.pickle
 - val_f1: 0.9828
 - out_of_sample_accuracy: 0.7422
Epoch 32/100
 - 1s - loss: 0.0180 - val_loss: 0.0166
 - val_f1: 0.9841
 - out_of_sample_accuracy: 0.7424
Epoch 33/100
 - 1s - loss: 0.0173 - val_loss: 0.0162
 - val_f1: 0.9844
 - out_of_sample_accuracy: 0.7431
Epoch 34/100
 - 1s - loss: 0.0167 - val_loss: 0.0155
 - val_f1: 0.9864
 - out_of_sample_accuracy: 0.7434
Epoch 35/100
 - 1s - loss: 0.0161 - val_loss: 0.0151
 - val_f1: 0.9873
 - out_of_sample_accuracy: 0.7442
Epoch 36/100
 - 1s - loss: 0.0158 - val_loss: 0.0146
 - val_f1: 0.9879
 - out_of_sample_accuracy: 0.7439
Epoch 37/100
 - 1s - loss: 0.0155 - val_loss: 0.0143
 - val_f1: 0.9881
 - out_of_sample_accuracy: 0.7441
Epoch 38/100
 - 1s - loss: 0.0150 - val_loss: 0.0138
 - val_f1: 0.9894
 - out_of_sample_accuracy: 0.7464
Epoch 39/100
 - 1s - loss: 0.0146 - val_loss: 0.0135
 - val_f1: 0.9893
 - out_of_sample_accuracy: 0.7468
Epoch 40/100
 - 1s - loss: 0.0143 - val_loss: 0.0133
 - val_f1: 0.9893
 - out_of_sample_accuracy: 0.7474
Epoch 41/100
 - 1s - loss: 0.0140 - val_loss: 0.0128
2020-01-13 20:46:34,743 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/train_time_nsl_lstm_shallow_rep2/_model_epoch_40.pickle
 - val_f1: 0.9902
 - out_of_sample_accuracy: 0.7480
Epoch 42/100
 - 1s - loss: 0.0138 - val_loss: 0.0125
 - val_f1: 0.9906
 - out_of_sample_accuracy: 0.7503
Epoch 43/100
 - 1s - loss: 0.0134 - val_loss: 0.0122
 - val_f1: 0.9910
 - out_of_sample_accuracy: 0.7516
Epoch 44/100
 - 1s - loss: 0.0131 - val_loss: 0.0122
 - val_f1: 0.9904
 - out_of_sample_accuracy: 0.7526
Epoch 45/100
 - 1s - loss: 0.0131 - val_loss: 0.0119
 - val_f1: 0.9912
 - out_of_sample_accuracy: 0.7524
Epoch 46/100
 - 1s - loss: 0.0128 - val_loss: 0.0117
 - val_f1: 0.9914
 - out_of_sample_accuracy: 0.7533
Epoch 47/100
 - 1s - loss: 0.0124 - val_loss: 0.0116
 - val_f1: 0.9911
 - out_of_sample_accuracy: 0.7561
Epoch 48/100
 - 1s - loss: 0.0123 - val_loss: 0.0114
 - val_f1: 0.9917
 - out_of_sample_accuracy: 0.7555
Epoch 49/100
 - 1s - loss: 0.0122 - val_loss: 0.0112
 - val_f1: 0.9918
 - out_of_sample_accuracy: 0.7557
Epoch 50/100
 - 1s - loss: 0.0121 - val_loss: 0.0112
 - val_f1: 0.9918
 - out_of_sample_accuracy: 0.7551
Epoch 51/100
 - 1s - loss: 0.0119 - val_loss: 0.0111
2020-01-13 20:46:42,729 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/train_time_nsl_lstm_shallow_rep2/_model_epoch_50.pickle
 - val_f1: 0.9915
 - out_of_sample_accuracy: 0.7544
Epoch 52/100
 - 1s - loss: 0.0118 - val_loss: 0.0109
 - val_f1: 0.9919
 - out_of_sample_accuracy: 0.7583
Epoch 53/100
 - 1s - loss: 0.0118 - val_loss: 0.0109
 - val_f1: 0.9920
 - out_of_sample_accuracy: 0.7566
Epoch 54/100
 - 1s - loss: 0.0113 - val_loss: 0.0107
 - val_f1: 0.9918
 - out_of_sample_accuracy: 0.7588
Epoch 55/100
 - 1s - loss: 0.0111 - val_loss: 0.0104
 - val_f1: 0.9922
 - out_of_sample_accuracy: 0.7595
Epoch 56/100
 - 1s - loss: 0.0111 - val_loss: 0.0103
 - val_f1: 0.9922
 - out_of_sample_accuracy: 0.7594
Epoch 57/100
 - 1s - loss: 0.0107 - val_loss: 0.0103
 - val_f1: 0.9924
 - out_of_sample_accuracy: 0.7601
Epoch 58/100
 - 1s - loss: 0.0108 - val_loss: 0.0102
 - val_f1: 0.9921
 - out_of_sample_accuracy: 0.7602
Epoch 59/100
 - 1s - loss: 0.0105 - val_loss: 0.0101
 - val_f1: 0.9921
 - out_of_sample_accuracy: 0.7605
Epoch 60/100
 - 1s - loss: 0.0101 - val_loss: 0.0100
 - val_f1: 0.9921
 - out_of_sample_accuracy: 0.7620
Epoch 61/100
 - 1s - loss: 0.0102 - val_loss: 0.0099
2020-01-13 20:46:50,740 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/train_time_nsl_lstm_shallow_rep2/_model_epoch_60.pickle
 - val_f1: 0.9924
 - out_of_sample_accuracy: 0.7614
Epoch 62/100
 - 1s - loss: 0.0102 - val_loss: 0.0098
 - val_f1: 0.9923
 - out_of_sample_accuracy: 0.7597
Epoch 63/100
 - 1s - loss: 0.0098 - val_loss: 0.0097
 - val_f1: 0.9923
 - out_of_sample_accuracy: 0.7603
Epoch 64/100
 - 1s - loss: 0.0097 - val_loss: 0.0097
 - val_f1: 0.9926
 - out_of_sample_accuracy: 0.7603
Epoch 65/100
 - 1s - loss: 0.0098 - val_loss: 0.0097
 - val_f1: 0.9924
 - out_of_sample_accuracy: 0.7614
Epoch 66/100
 - 1s - loss: 0.0096 - val_loss: 0.0097
 - val_f1: 0.9926
 - out_of_sample_accuracy: 0.7610
Epoch 67/100
 - 1s - loss: 0.0092 - val_loss: 0.0096
 - val_f1: 0.9924
 - out_of_sample_accuracy: 0.7634
Epoch 68/100
 - 1s - loss: 0.0091 - val_loss: 0.0095
 - val_f1: 0.9927
 - out_of_sample_accuracy: 0.7617
Epoch 69/100
 - 1s - loss: 0.0093 - val_loss: 0.0095
 - val_f1: 0.9929
 - out_of_sample_accuracy: 0.7633
Epoch 70/100
 - 1s - loss: 0.0092 - val_loss: 0.0095
 - val_f1: 0.9929
 - out_of_sample_accuracy: 0.7630
Epoch 71/100
 - 1s - loss: 0.0089 - val_loss: 0.0094
2020-01-13 20:46:58,717 [INFO] epoch = 70. Intermediate model saved to results_additional_exps/train_time_nsl_lstm_shallow_rep2/_model_epoch_70.pickle
 - val_f1: 0.9929
 - out_of_sample_accuracy: 0.7632
Epoch 72/100
 - 1s - loss: 0.0090 - val_loss: 0.0093
 - val_f1: 0.9931
 - out_of_sample_accuracy: 0.7625
Epoch 73/100
 - 1s - loss: 0.0087 - val_loss: 0.0093
 - val_f1: 0.9931
 - out_of_sample_accuracy: 0.7627
Epoch 74/100
 - 1s - loss: 0.0089 - val_loss: 0.0093
 - val_f1: 0.9931
 - out_of_sample_accuracy: 0.7634
Epoch 75/100
 - 1s - loss: 0.0085 - val_loss: 0.0093
 - val_f1: 0.9931
 - out_of_sample_accuracy: 0.7614
Epoch 76/100
 - 1s - loss: 0.0086 - val_loss: 0.0094
 - val_f1: 0.9931
 - out_of_sample_accuracy: 0.7615
Epoch 77/100
 - 1s - loss: 0.0085 - val_loss: 0.0092
 - val_f1: 0.9929
 - out_of_sample_accuracy: 0.7624
Epoch 78/100
 - 1s - loss: 0.0085 - val_loss: 0.0092
 - val_f1: 0.9930
 - out_of_sample_accuracy: 0.7637
Epoch 79/100
 - 1s - loss: 0.0082 - val_loss: 0.0092
2020-01-13 20:47:05,354 [INFO] StopperOnGoal: reached goal_metric (accuracy). Stopping training. goal_metric = 0.7640, current_metric = 0.7646, num_epochs = 79
2020-01-13 20:47:05,355 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-13 20:47:06,076 [INFO] Last epoch loss evaluation: train_loss = 0.005977, val_loss = 0.009151
2020-01-13 20:47:06,077 [INFO] Training complete. time_to_train = 67.26 sec, 1.12 min
2020-01-13 20:47:06,080 [INFO] Model saved to results_additional_exps/train_time_nsl_lstm_shallow_rep2/best_model.pickle
2020-01-13 20:47:06,082 [INFO] Training history saved to: results_additional_exps/train_time_nsl_lstm_shallow_rep2/training_error_history.csv
2020-01-13 20:47:06,235 [INFO] Plot saved to: results_additional_exps/train_time_nsl_lstm_shallow_rep2/training_error_history.png
2020-01-13 20:47:06,378 [INFO] Plot saved to: results_additional_exps/train_time_nsl_lstm_shallow_rep2/training_f1_history.png
2020-01-13 20:47:06,378 [INFO] Making predictions on training, validation, testing data
2020-01-13 20:47:07,050 [INFO] Making predictions complete. time_to_predict = 0.67 sec, 0.01 min
2020-01-13 20:47:07,054 [INFO] Evaluating predictions (results)
2020-01-13 20:47:07,543 [INFO] Dataset: Testing. Classification report below
2020-01-13 20:47:07,543 [INFO] 
              precision    recall  f1-score   support

         dos       0.96      0.85      0.90      7450
      normal       0.68      0.93      0.78      9704
       probe       0.70      0.70      0.70      2420
         r2l       0.94      0.08      0.14      2421
         u2r       0.58      0.01      0.03       533

    accuracy                           0.77     22528
   macro avg       0.77      0.51      0.51     22528
weighted avg       0.80      0.77      0.73     22528

2020-01-13 20:47:07,543 [INFO] Overall accuracy (micro avg): 0.7658913352272727
2020-01-13 20:47:08,068 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.7659         0.7659                       0.7659                0.0585                   0.2341  0.7659
1     Macro avg        0.9064         0.7722                       0.5148                0.0775                   0.4852  0.5117
2  Weighted avg        0.8668         0.7997                       0.7659                0.1534                   0.2341  0.7277
2020-01-13 20:47:08,666 [INFO] Dataset: Validation. Classification report below
2020-01-13 20:47:08,666 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00      9183
      normal       0.99      0.99      0.99     13462
       probe       0.98      0.99      0.98      2330
         r2l       0.86      0.82      0.84       199
         u2r       1.00      0.20      0.33        10

    accuracy                           0.99     25184
   macro avg       0.97      0.80      0.83     25184
weighted avg       0.99      0.99      0.99     25184

2020-01-13 20:47:08,666 [INFO] Overall accuracy (micro avg): 0.9928923125794155
2020-01-13 20:47:09,288 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9929         0.9929                       0.9929                0.0018                   0.0071  0.9929
1     Macro avg        0.9972         0.9663                       0.8003                0.0023                   0.1997  0.8299
2  Weighted avg        0.9955         0.9929                       0.9929                0.0045                   0.0071  0.9928
2020-01-13 20:47:11,904 [INFO] Dataset: Training. Classification report below
2020-01-13 20:47:11,904 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00     36738
      normal       1.00      1.00      1.00     53871
       probe       0.99      0.99      0.99      9321
         r2l       0.94      0.87      0.90       796
         u2r       0.92      0.52      0.67        42

    accuracy                           1.00    100768
   macro avg       0.97      0.88      0.91    100768
weighted avg       1.00      1.00      1.00    100768

2020-01-13 20:47:11,904 [INFO] Overall accuracy (micro avg): 0.9958220863766275
2020-01-13 20:47:14,711 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9958         0.9958                       0.9958                0.0010                   0.0042  0.9958
1     Macro avg        0.9983         0.9684                       0.8754                0.0014                   0.1246  0.9109
2  Weighted avg        0.9974         0.9958                       0.9958                0.0030                   0.0042  0.9958
2020-01-13 20:47:14,749 [INFO] Results saved to: results_additional_exps/train_time_nsl_lstm_shallow_rep2/train_time_nsl_lstm_shallow_rep2_results.xlsx
2020-01-13 20:47:14,749 [INFO] ================= Finished running experiment no. 2 ================= 

2020-01-13 20:47:14,752 [INFO] Created directory: results_additional_exps/train_time_nsl_lstm_shallow_rep3
2020-01-13 20:47:14,752 [INFO] Initialized logging. log_filename = results_additional_exps/train_time_nsl_lstm_shallow_rep3/run_log.log
2020-01-13 20:47:14,752 [INFO] ================= Running experiment no. 3  ================= 

2020-01-13 20:47:14,752 [INFO] Experiment parameters given below
2020-01-13 20:47:14,752 [INFO] 
{'experiment_num': 3, 'results_dir': 'results_additional_exps/train_time_nsl_lstm_shallow_rep3', 'model': 'lstm', 'model_type': 'classifier', 'normal_label': 'normal', 'lstm_time_steps': 32, 'lstm_layer_units': [32], 'lstm_layer_activations': ['relu'], 'lstm_layer_dropout_rates': [0.2], 'batch_size': 256, 'epochs': 100, 'early_stop_patience': 100, 'goal_metric': 0.764, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/nsl_kdd_five_classes', 'description': 'train_time_nsl_lstm_shallow_rep3'}
2020-01-13 20:47:14,759 [INFO] Created tensorboard log directory: results_additional_exps/train_time_nsl_lstm_shallow_rep3/tf_logs_run_2020_01_13-20_47_14
2020-01-13 20:47:14,759 [INFO] Loading datsets from: ../Datasets/small_datasets/nsl_kdd_five_classes
2020-01-13 20:47:14,759 [INFO] Reading X, y files
2020-01-13 20:47:14,759 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_train.h5
2020-01-13 20:47:15,003 [INFO] Reading complete. time_to_read=0.24 seconds
2020-01-13 20:47:15,003 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_val.h5
2020-01-13 20:47:15,068 [INFO] Reading complete. time_to_read=0.06 seconds
2020-01-13 20:47:15,068 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_test.h5
2020-01-13 20:47:15,126 [INFO] Reading complete. time_to_read=0.06 seconds
2020-01-13 20:47:15,126 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_train.h5
2020-01-13 20:47:15,134 [INFO] Reading complete. time_to_read=0.01 seconds
2020-01-13 20:47:15,134 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_val.h5
2020-01-13 20:47:15,138 [INFO] Reading complete. time_to_read=0.00 seconds
2020-01-13 20:47:15,138 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_test.h5
2020-01-13 20:47:15,142 [INFO] Reading complete. time_to_read=0.00 seconds
2020-01-13 20:47:15,256 [INFO] Preparing flow sequences
2020-01-13 20:47:16,390 [INFO] Extracting flows complete. time_taken = 1.13 sec
2020-01-13 20:47:16,436 [INFO] Initializing model
2020-01-13 20:47:16,652 [INFO] _________________________________________________________________
2020-01-13 20:47:16,652 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-13 20:47:16,652 [INFO] =================================================================
2020-01-13 20:47:16,653 [INFO] lstm_3 (LSTM)                (None, 32, 32)            19840     
2020-01-13 20:47:16,653 [INFO] _________________________________________________________________
2020-01-13 20:47:16,653 [INFO] batch_normalization_3 (Batch (None, 32, 32)            128       
2020-01-13 20:47:16,653 [INFO] _________________________________________________________________
2020-01-13 20:47:16,653 [INFO] dropout_3 (Dropout)          (None, 32, 32)            0         
2020-01-13 20:47:16,653 [INFO] _________________________________________________________________
2020-01-13 20:47:16,653 [INFO] time_distributed_3 (TimeDist (None, 32, 5)             165       
2020-01-13 20:47:16,653 [INFO] =================================================================
2020-01-13 20:47:16,653 [INFO] Total params: 20,133
2020-01-13 20:47:16,653 [INFO] Trainable params: 20,069
2020-01-13 20:47:16,653 [INFO] Non-trainable params: 64
2020-01-13 20:47:16,653 [INFO] _________________________________________________________________
2020-01-13 20:47:16,653 [INFO] Training model
 - val_f1: 0.9928
 - out_of_sample_accuracy: 0.7646
Train on 3149 samples, validate on 787 samples
Epoch 1/100
 - 2s - loss: 0.4864 - val_loss: 0.3199
 - val_f1: 0.5960
 - out_of_sample_accuracy: 0.3679
Epoch 2/100
 - 1s - loss: 0.3027 - val_loss: 0.2049
 - val_f1: 0.8270
 - out_of_sample_accuracy: 0.5261
Epoch 3/100
 - 1s - loss: 0.1904 - val_loss: 0.1361
 - val_f1: 0.9060
 - out_of_sample_accuracy: 0.6276
Epoch 4/100
 - 1s - loss: 0.1276 - val_loss: 0.1000
 - val_f1: 0.9361
 - out_of_sample_accuracy: 0.6782
Epoch 5/100
 - 1s - loss: 0.0940 - val_loss: 0.0795
 - val_f1: 0.9540
 - out_of_sample_accuracy: 0.6946
Epoch 6/100
 - 1s - loss: 0.0762 - val_loss: 0.0669
 - val_f1: 0.9623
 - out_of_sample_accuracy: 0.7026
Epoch 7/100
 - 1s - loss: 0.0657 - val_loss: 0.0585
 - val_f1: 0.9652
 - out_of_sample_accuracy: 0.7049
Epoch 8/100
 - 1s - loss: 0.0587 - val_loss: 0.0530
 - val_f1: 0.9675
 - out_of_sample_accuracy: 0.7073
Epoch 9/100
 - 1s - loss: 0.0533 - val_loss: 0.0481
 - val_f1: 0.9689
 - out_of_sample_accuracy: 0.7083
Epoch 10/100
 - 1s - loss: 0.0493 - val_loss: 0.0442
 - val_f1: 0.9698
 - out_of_sample_accuracy: 0.7095
Epoch 11/100
 - 1s - loss: 0.0461 - val_loss: 0.0408
2020-01-13 20:47:29,050 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/train_time_nsl_lstm_shallow_rep3/_model_epoch_10.pickle
 - val_f1: 0.9713
 - out_of_sample_accuracy: 0.7109
Epoch 12/100
 - 1s - loss: 0.0429 - val_loss: 0.0383
 - val_f1: 0.9712
 - out_of_sample_accuracy: 0.7126
Epoch 13/100
 - 1s - loss: 0.0409 - val_loss: 0.0361
 - val_f1: 0.9724
 - out_of_sample_accuracy: 0.7140
Epoch 14/100
 - 1s - loss: 0.0384 - val_loss: 0.0341
 - val_f1: 0.9728
 - out_of_sample_accuracy: 0.7149
Epoch 15/100
 - 1s - loss: 0.0362 - val_loss: 0.0323
 - val_f1: 0.9722
 - out_of_sample_accuracy: 0.7169
Epoch 16/100
 - 1s - loss: 0.0348 - val_loss: 0.0305
 - val_f1: 0.9731
 - out_of_sample_accuracy: 0.7200
Epoch 17/100
 - 1s - loss: 0.0326 - val_loss: 0.0289
 - val_f1: 0.9734
 - out_of_sample_accuracy: 0.7239
Epoch 18/100
 - 1s - loss: 0.0307 - val_loss: 0.0274
 - val_f1: 0.9743
 - out_of_sample_accuracy: 0.7277
Epoch 19/100
 - 1s - loss: 0.0295 - val_loss: 0.0259
 - val_f1: 0.9745
 - out_of_sample_accuracy: 0.7310
Epoch 20/100
 - 1s - loss: 0.0283 - val_loss: 0.0246
 - val_f1: 0.9764
 - out_of_sample_accuracy: 0.7353
Epoch 21/100
 - 1s - loss: 0.0267 - val_loss: 0.0234
2020-01-13 20:47:37,015 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/train_time_nsl_lstm_shallow_rep3/_model_epoch_20.pickle
 - val_f1: 0.9768
 - out_of_sample_accuracy: 0.7378
Epoch 22/100
 - 1s - loss: 0.0255 - val_loss: 0.0223
 - val_f1: 0.9785
 - out_of_sample_accuracy: 0.7414
Epoch 23/100
 - 1s - loss: 0.0239 - val_loss: 0.0214
 - val_f1: 0.9799
 - out_of_sample_accuracy: 0.7437
Epoch 24/100
 - 1s - loss: 0.0228 - val_loss: 0.0202
 - val_f1: 0.9818
 - out_of_sample_accuracy: 0.7461
Epoch 25/100
 - 1s - loss: 0.0216 - val_loss: 0.0195
 - val_f1: 0.9830
 - out_of_sample_accuracy: 0.7480
Epoch 26/100
 - 1s - loss: 0.0211 - val_loss: 0.0186
 - val_f1: 0.9840
 - out_of_sample_accuracy: 0.7488
Epoch 27/100
 - 1s - loss: 0.0201 - val_loss: 0.0180
 - val_f1: 0.9847
 - out_of_sample_accuracy: 0.7495
Epoch 28/100
 - 1s - loss: 0.0192 - val_loss: 0.0172
 - val_f1: 0.9860
 - out_of_sample_accuracy: 0.7516
Epoch 29/100
 - 1s - loss: 0.0184 - val_loss: 0.0166
 - val_f1: 0.9867
 - out_of_sample_accuracy: 0.7531
Epoch 30/100
 - 1s - loss: 0.0177 - val_loss: 0.0161
 - val_f1: 0.9871
 - out_of_sample_accuracy: 0.7532
Epoch 31/100
 - 1s - loss: 0.0173 - val_loss: 0.0154
2020-01-13 20:47:44,978 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/train_time_nsl_lstm_shallow_rep3/_model_epoch_30.pickle
 - val_f1: 0.9885
 - out_of_sample_accuracy: 0.7547
Epoch 32/100
 - 1s - loss: 0.0165 - val_loss: 0.0150
 - val_f1: 0.9885
 - out_of_sample_accuracy: 0.7565
Epoch 33/100
 - 1s - loss: 0.0162 - val_loss: 0.0146
 - val_f1: 0.9891
 - out_of_sample_accuracy: 0.7584
Epoch 34/100
 - 1s - loss: 0.0156 - val_loss: 0.0146
 - val_f1: 0.9883
 - out_of_sample_accuracy: 0.7599
Epoch 35/100
 - 1s - loss: 0.0154 - val_loss: 0.0139
 - val_f1: 0.9897
 - out_of_sample_accuracy: 0.7606
Epoch 36/100
 - 1s - loss: 0.0151 - val_loss: 0.0136
 - val_f1: 0.9896
 - out_of_sample_accuracy: 0.7625
Epoch 37/100
 - 1s - loss: 0.0144 - val_loss: 0.0132
 - val_f1: 0.9902
 - out_of_sample_accuracy: 0.7626
Epoch 38/100
 - 1s - loss: 0.0143 - val_loss: 0.0130
2020-01-13 20:47:50,806 [INFO] StopperOnGoal: reached goal_metric (accuracy). Stopping training. goal_metric = 0.7640, current_metric = 0.7645, num_epochs = 38
2020-01-13 20:47:50,807 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-13 20:47:51,584 [INFO] Last epoch loss evaluation: train_loss = 0.011461, val_loss = 0.012990
2020-01-13 20:47:51,585 [INFO] Training complete. time_to_train = 34.93 sec, 0.58 min
2020-01-13 20:47:51,588 [INFO] Model saved to results_additional_exps/train_time_nsl_lstm_shallow_rep3/best_model.pickle
2020-01-13 20:47:51,589 [INFO] Training history saved to: results_additional_exps/train_time_nsl_lstm_shallow_rep3/training_error_history.csv
2020-01-13 20:47:51,737 [INFO] Plot saved to: results_additional_exps/train_time_nsl_lstm_shallow_rep3/training_error_history.png
2020-01-13 20:47:51,883 [INFO] Plot saved to: results_additional_exps/train_time_nsl_lstm_shallow_rep3/training_f1_history.png
2020-01-13 20:47:51,883 [INFO] Making predictions on training, validation, testing data
2020-01-13 20:47:52,559 [INFO] Making predictions complete. time_to_predict = 0.68 sec, 0.01 min
2020-01-13 20:47:52,562 [INFO] Evaluating predictions (results)
2020-01-13 20:47:53,053 [INFO] Dataset: Testing. Classification report below
2020-01-13 20:47:53,053 [INFO] 
              precision    recall  f1-score   support

         dos       0.95      0.85      0.90      7450
      normal       0.68      0.93      0.79      9704
       probe       0.72      0.72      0.72      2420
         r2l       0.95      0.10      0.18      2421
         u2r       0.71      0.04      0.07       533

    accuracy                           0.77     22528
   macro avg       0.80      0.53      0.53     22528
weighted avg       0.81      0.77      0.73     22528

2020-01-13 20:47:53,053 [INFO] Overall accuracy (micro avg): 0.7689098011363636
2020-01-13 20:47:53,580 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.7689         0.7689                       0.7689                0.0578                   0.2311  0.7689
1     Macro avg        0.9076         0.8044                       0.5260                0.0766                   0.4740  0.5302
2  Weighted avg        0.8677         0.8057                       0.7689                0.1517                   0.2311  0.7335
2020-01-13 20:47:54,175 [INFO] Dataset: Validation. Classification report below
2020-01-13 20:47:54,175 [INFO] 
              precision    recall  f1-score   support

         dos       0.99      1.00      1.00      9183
      normal       0.99      0.99      0.99     13462
       probe       0.98      0.98      0.98      2330
         r2l       0.85      0.70      0.77       199
         u2r       0.75      0.30      0.43        10

    accuracy                           0.99     25184
   macro avg       0.91      0.79      0.83     25184
weighted avg       0.99      0.99      0.99     25184

2020-01-13 20:47:54,175 [INFO] Overall accuracy (micro avg): 0.9904701397712834
2020-01-13 20:47:54,796 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9905         0.9905                       0.9905                0.0024                   0.0095  0.9905
1     Macro avg        0.9962         0.9143                       0.7942                0.0033                   0.2058  0.8335
2  Weighted avg        0.9939         0.9902                       0.9905                0.0069                   0.0095  0.9902
2020-01-13 20:47:57,418 [INFO] Dataset: Training. Classification report below
2020-01-13 20:47:57,418 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00     36738
      normal       0.99      0.99      0.99     53871
       probe       0.98      0.98      0.98      9321
         r2l       0.93      0.75      0.83       796
         u2r       0.75      0.43      0.55        42

    accuracy                           0.99    100768
   macro avg       0.93      0.83      0.87    100768
weighted avg       0.99      0.99      0.99    100768

2020-01-13 20:47:57,418 [INFO] Overall accuracy (micro avg): 0.9921899809463322
2020-01-13 20:48:00,223 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9922         0.9922                       0.9922                0.0020                   0.0078  0.9922
1     Macro avg        0.9969         0.9298                       0.8302                0.0028                   0.1698  0.8694
2  Weighted avg        0.9950         0.9920                       0.9922                0.0059                   0.0078  0.9920
2020-01-13 20:48:00,263 [INFO] Results saved to: results_additional_exps/train_time_nsl_lstm_shallow_rep3/train_time_nsl_lstm_shallow_rep3_results.xlsx
2020-01-13 20:48:00,263 [INFO] ================= Finished running experiment no. 3 ================= 

2020-01-13 20:48:00,266 [INFO] Created directory: results_additional_exps/train_time_ids17_lstm_shallow_rep1
2020-01-13 20:48:00,266 [INFO] Initialized logging. log_filename = results_additional_exps/train_time_ids17_lstm_shallow_rep1/run_log.log
2020-01-13 20:48:00,266 [INFO] ================= Running experiment no. 1  ================= 

2020-01-13 20:48:00,266 [INFO] Experiment parameters given below
2020-01-13 20:48:00,266 [INFO] 
{'experiment_num': 1, 'results_dir': 'results_additional_exps/train_time_ids17_lstm_shallow_rep1', 'model': 'lstm', 'model_type': 'classifier', 'normal_label': 'BENIGN', 'lstm_time_steps': 32, 'lstm_layer_units': [32], 'lstm_layer_activations': ['relu'], 'lstm_layer_dropout_rates': [0.2], 'batch_size': 256, 'epochs': 100, 'early_stop_patience': 100, 'goal_metric': 0.994603352, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/full_datasets/ids2017', 'description': 'train_time_ids17_lstm_shallow_rep1'}
2020-01-13 20:48:00,266 [INFO] Created tensorboard log directory: results_additional_exps/train_time_ids17_lstm_shallow_rep1/tf_logs_run_2020_01_13-20_48_00
2020-01-13 20:48:00,266 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2017
2020-01-13 20:48:00,289 [INFO] Reading X, y files
2020-01-13 20:48:00,289 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_train.h5
2020-01-13 20:48:11,724 [INFO] Reading complete. time_to_read=11.44 seconds
2020-01-13 20:48:11,724 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_val.h5
2020-01-13 20:48:15,965 [INFO] Reading complete. time_to_read=4.24 seconds
2020-01-13 20:48:15,965 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_test.h5
2020-01-13 20:48:20,063 [INFO] Reading complete. time_to_read=4.10 seconds
2020-01-13 20:48:20,063 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_train.h5
2020-01-13 20:48:20,861 [INFO] Reading complete. time_to_read=0.80 seconds
2020-01-13 20:48:20,861 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_val.h5
2020-01-13 20:48:21,160 [INFO] Reading complete. time_to_read=0.30 seconds
2020-01-13 20:48:21,160 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_test.h5
2020-01-13 20:48:21,448 [INFO] Reading complete. time_to_read=0.29 seconds
2020-01-13 20:48:23,276 [INFO] Preparing flow sequences
2020-01-13 20:48:44,654 [INFO] Extracting flows complete. time_taken = 21.38 sec
2020-01-13 20:48:45,700 [INFO] Initializing model
2020-01-13 20:48:45,920 [INFO] _________________________________________________________________
2020-01-13 20:48:45,920 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-13 20:48:45,920 [INFO] =================================================================
2020-01-13 20:48:45,920 [INFO] lstm_4 (LSTM)                (None, 32, 32)            14208     
2020-01-13 20:48:45,920 [INFO] _________________________________________________________________
2020-01-13 20:48:45,920 [INFO] batch_normalization_4 (Batch (None, 32, 32)            128       
2020-01-13 20:48:45,920 [INFO] _________________________________________________________________
2020-01-13 20:48:45,921 [INFO] dropout_4 (Dropout)          (None, 32, 32)            0         
2020-01-13 20:48:45,921 [INFO] _________________________________________________________________
2020-01-13 20:48:45,921 [INFO] time_distributed_4 (TimeDist (None, 32, 12)            396       
2020-01-13 20:48:45,921 [INFO] =================================================================
2020-01-13 20:48:45,921 [INFO] Total params: 14,732
2020-01-13 20:48:45,921 [INFO] Trainable params: 14,668
2020-01-13 20:48:45,921 [INFO] Non-trainable params: 64
2020-01-13 20:48:45,921 [INFO] _________________________________________________________________
2020-01-13 20:48:45,921 [INFO] Training model
 - val_f1: 0.9900
 - out_of_sample_accuracy: 0.7645
Train on 53021 samples, validate on 17673 samples
Epoch 1/100
 - 11s - loss: 0.1205 - val_loss: 0.0510
OMP: Info #250: KMP_AFFINITY: pid 4293 tid 4543 thread 9 bound to OS proc set 1
OMP: Info #250: KMP_AFFINITY: pid 4293 tid 4544 thread 10 bound to OS proc set 2
OMP: Info #250: KMP_AFFINITY: pid 4293 tid 4545 thread 11 bound to OS proc set 3
 - val_f1: 0.9134
 - out_of_sample_accuracy: 0.8715
Epoch 2/100
 - 9s - loss: 0.0285 - val_loss: 0.0228
 - val_f1: 0.9544
 - out_of_sample_accuracy: 0.9516
Epoch 3/100
 - 9s - loss: 0.0208 - val_loss: 0.0168
 - val_f1: 0.9601
 - out_of_sample_accuracy: 0.9600
Epoch 4/100
 - 9s - loss: 0.0175 - val_loss: 0.0141
 - val_f1: 0.9636
 - out_of_sample_accuracy: 0.9642
Epoch 5/100
 - 9s - loss: 0.0154 - val_loss: 0.0123
 - val_f1: 0.9688
 - out_of_sample_accuracy: 0.9681
Epoch 6/100
 - 9s - loss: 0.0139 - val_loss: 0.0112
 - val_f1: 0.9718
 - out_of_sample_accuracy: 0.9710
Epoch 7/100
 - 9s - loss: 0.0128 - val_loss: 0.0107
 - val_f1: 0.9722
 - out_of_sample_accuracy: 0.9725
Epoch 8/100
 - 9s - loss: 0.0120 - val_loss: 0.0098
 - val_f1: 0.9760
 - out_of_sample_accuracy: 0.9742
Epoch 9/100
 - 9s - loss: 0.0112 - val_loss: 0.0091
 - val_f1: 0.9773
 - out_of_sample_accuracy: 0.9768
Epoch 10/100
 - 9s - loss: 0.0106 - val_loss: 0.0088
 - val_f1: 0.9766
 - out_of_sample_accuracy: 0.9767
Epoch 11/100
 - 9s - loss: 0.0101 - val_loss: 0.0085
2020-01-13 20:51:30,697 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/train_time_ids17_lstm_shallow_rep1/_model_epoch_10.pickle
 - val_f1: 0.9778
 - out_of_sample_accuracy: 0.9779
Epoch 12/100
 - 9s - loss: 0.0096 - val_loss: 0.0079
 - val_f1: 0.9798
 - out_of_sample_accuracy: 0.9799
Epoch 13/100
 - 9s - loss: 0.0092 - val_loss: 0.0080
 - val_f1: 0.9801
 - out_of_sample_accuracy: 0.9803
Epoch 14/100
 - 9s - loss: 0.0087 - val_loss: 0.0074
 - val_f1: 0.9819
 - out_of_sample_accuracy: 0.9821
Epoch 15/100
 - 9s - loss: 0.0082 - val_loss: 0.0077
 - val_f1: 0.9779
 - out_of_sample_accuracy: 0.9788
Epoch 16/100
 - 9s - loss: 0.0075 - val_loss: 0.0064
 - val_f1: 0.9872
 - out_of_sample_accuracy: 0.9870
Epoch 17/100
 - 9s - loss: 0.0069 - val_loss: 0.0056
 - val_f1: 0.9894
 - out_of_sample_accuracy: 0.9897
Epoch 18/100
 - 9s - loss: 0.0065 - val_loss: 0.0050
 - val_f1: 0.9895
 - out_of_sample_accuracy: 0.9898
Epoch 19/100
 - 9s - loss: 0.0059 - val_loss: 0.0047
 - val_f1: 0.9903
 - out_of_sample_accuracy: 0.9908
Epoch 20/100
 - 9s - loss: 0.0057 - val_loss: 0.0051
 - val_f1: 0.9878
 - out_of_sample_accuracy: 0.9883
Epoch 21/100
 - 9s - loss: 0.0054 - val_loss: 0.0046
2020-01-13 20:54:01,613 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/train_time_ids17_lstm_shallow_rep1/_model_epoch_20.pickle
 - val_f1: 0.9893
 - out_of_sample_accuracy: 0.9897
Epoch 22/100
 - 9s - loss: 0.0052 - val_loss: 0.0046
 - val_f1: 0.9895
 - out_of_sample_accuracy: 0.9899
Epoch 23/100
 - 9s - loss: 0.0050 - val_loss: 0.0039
 - val_f1: 0.9911
 - out_of_sample_accuracy: 0.9915
Epoch 24/100
 - 9s - loss: 0.0049 - val_loss: 0.0040
 - val_f1: 0.9914
 - out_of_sample_accuracy: 0.9918
Epoch 25/100
 - 9s - loss: 0.0048 - val_loss: 0.0040
 - val_f1: 0.9903
 - out_of_sample_accuracy: 0.9908
Epoch 26/100
 - 9s - loss: 0.0047 - val_loss: 0.0037
 - val_f1: 0.9921
 - out_of_sample_accuracy: 0.9924
Epoch 27/100
 - 9s - loss: 0.0047 - val_loss: 0.0048
 - val_f1: 0.9890
 - out_of_sample_accuracy: 0.9894
Epoch 28/100
 - 9s - loss: 0.0046 - val_loss: 0.0056
 - val_f1: 0.9885
 - out_of_sample_accuracy: 0.9889
Epoch 29/100
 - 9s - loss: 0.0045 - val_loss: 0.0035
 - val_f1: 0.9924
 - out_of_sample_accuracy: 0.9928
Epoch 30/100
 - 9s - loss: 0.0044 - val_loss: 0.0034
 - val_f1: 0.9929
 - out_of_sample_accuracy: 0.9932
Epoch 31/100
 - 9s - loss: 0.0045 - val_loss: 0.0174
2020-01-13 20:56:32,711 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/train_time_ids17_lstm_shallow_rep1/_model_epoch_30.pickle
 - val_f1: 0.9797
 - out_of_sample_accuracy: 0.9793
Epoch 32/100
 - 9s - loss: 0.0051 - val_loss: 0.0036
 - val_f1: 0.9926
 - out_of_sample_accuracy: 0.9930
Epoch 33/100
 - 9s - loss: 0.0047 - val_loss: 0.0041
 - val_f1: 0.9906
 - out_of_sample_accuracy: 0.9909
Epoch 34/100
 - 9s - loss: 0.0046 - val_loss: 0.0035
 - val_f1: 0.9909
 - out_of_sample_accuracy: 0.9915
Epoch 35/100
 - 9s - loss: 0.0045 - val_loss: 0.0044
 - val_f1: 0.9915
 - out_of_sample_accuracy: 0.9920
Epoch 36/100
 - 9s - loss: 0.0044 - val_loss: 0.0054
 - val_f1: 0.9878
 - out_of_sample_accuracy: 0.9884
Epoch 37/100
 - 9s - loss: 0.0044 - val_loss: 0.0053
 - val_f1: 0.9879
 - out_of_sample_accuracy: 0.9884
Epoch 38/100
 - 9s - loss: 0.0043 - val_loss: 0.0132
 - val_f1: 0.9593
 - out_of_sample_accuracy: 0.9638
Epoch 39/100
 - 9s - loss: 0.0042 - val_loss: 0.0036
 - val_f1: 0.9915
 - out_of_sample_accuracy: 0.9918
Epoch 40/100
 - 9s - loss: 0.0041 - val_loss: 0.0086
 - val_f1: 0.9674
 - out_of_sample_accuracy: 0.9703
Epoch 41/100
 - 9s - loss: 0.0046 - val_loss: 0.0046
2020-01-13 20:59:03,781 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/train_time_ids17_lstm_shallow_rep1/_model_epoch_40.pickle
 - val_f1: 0.9906
 - out_of_sample_accuracy: 0.9908
Epoch 42/100
 - 9s - loss: 0.0040 - val_loss: 0.0034
 - val_f1: 0.9917
 - out_of_sample_accuracy: 0.9920
Epoch 43/100
 - 9s - loss: 0.0040 - val_loss: 0.0031
 - val_f1: 0.9932
 - out_of_sample_accuracy: 0.9936
Epoch 44/100
 - 9s - loss: 0.0038 - val_loss: 0.0033
 - val_f1: 0.9918
 - out_of_sample_accuracy: 0.9921
Epoch 45/100
 - 9s - loss: 0.0039 - val_loss: 0.0042
 - val_f1: 0.9910
 - out_of_sample_accuracy: 0.9915
Epoch 46/100
 - 9s - loss: 0.0038 - val_loss: 0.0030
 - val_f1: 0.9939
 - out_of_sample_accuracy: 0.9943
Epoch 47/100
 - 9s - loss: 0.0037 - val_loss: 0.0032
 - val_f1: 0.9926
 - out_of_sample_accuracy: 0.9929
Epoch 48/100
 - 9s - loss: 0.0038 - val_loss: 0.0030
 - val_f1: 0.9935
 - out_of_sample_accuracy: 0.9938
Epoch 49/100
 - 9s - loss: 0.0037 - val_loss: 0.0042
 - val_f1: 0.9904
 - out_of_sample_accuracy: 0.9908
Epoch 50/100
 - 9s - loss: 0.0037 - val_loss: 0.0035
 - val_f1: 0.9912
 - out_of_sample_accuracy: 0.9916
Epoch 51/100
 - 9s - loss: 0.0037 - val_loss: 0.0029
2020-01-13 21:01:34,582 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/train_time_ids17_lstm_shallow_rep1/_model_epoch_50.pickle
 - val_f1: 0.9938
 - out_of_sample_accuracy: 0.9941
Epoch 52/100
 - 9s - loss: 0.0037 - val_loss: 0.0030
 - val_f1: 0.9939
 - out_of_sample_accuracy: 0.9943
Epoch 53/100
 - 9s - loss: 0.0036 - val_loss: 0.0029
 - val_f1: 0.9938
 - out_of_sample_accuracy: 0.9941
Epoch 54/100
 - 9s - loss: 0.0036 - val_loss: 0.0029
 - val_f1: 0.9926
 - out_of_sample_accuracy: 0.9929
Epoch 55/100
 - 9s - loss: 0.0036 - val_loss: 0.0032
 - val_f1: 0.9926
 - out_of_sample_accuracy: 0.9930
Epoch 56/100
 - 9s - loss: 0.0036 - val_loss: 0.0034
 - val_f1: 0.9926
 - out_of_sample_accuracy: 0.9928
Epoch 57/100
 - 9s - loss: 0.0037 - val_loss: 0.0035
 - val_f1: 0.9923
 - out_of_sample_accuracy: 0.9926
Epoch 58/100
 - 9s - loss: 0.0035 - val_loss: 0.0032
 - val_f1: 0.9921
 - out_of_sample_accuracy: 0.9925
Epoch 59/100
 - 9s - loss: 0.0036 - val_loss: 0.0032
 - val_f1: 0.9919
 - out_of_sample_accuracy: 0.9922
Epoch 60/100
 - 9s - loss: 0.0036 - val_loss: 0.0031
 - val_f1: 0.9922
 - out_of_sample_accuracy: 0.9925
Epoch 61/100
 - 9s - loss: 0.0035 - val_loss: 0.0034
2020-01-13 21:04:05,592 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/train_time_ids17_lstm_shallow_rep1/_model_epoch_60.pickle
 - val_f1: 0.9918
 - out_of_sample_accuracy: 0.9921
Epoch 62/100
 - 9s - loss: 0.0036 - val_loss: 0.0029
 - val_f1: 0.9939
 - out_of_sample_accuracy: 0.9943
Epoch 63/100
 - 9s - loss: 0.0036 - val_loss: 0.0030
 - val_f1: 0.9922
 - out_of_sample_accuracy: 0.9926
Epoch 64/100
 - 9s - loss: 0.0034 - val_loss: 0.0027
 - val_f1: 0.9937
 - out_of_sample_accuracy: 0.9941
Epoch 65/100
 - 9s - loss: 0.0034 - val_loss: 0.0049
 - val_f1: 0.9907
 - out_of_sample_accuracy: 0.9909
Epoch 66/100
 - 9s - loss: 0.0035 - val_loss: 0.0029
 - val_f1: 0.9943
 - out_of_sample_accuracy: 0.9945
Epoch 67/100
 - 9s - loss: 0.0035 - val_loss: 0.0030
 - val_f1: 0.9934
 - out_of_sample_accuracy: 0.9939
Epoch 68/100
 - 9s - loss: 0.0034 - val_loss: 0.0028
 - val_f1: 0.9929
 - out_of_sample_accuracy: 0.9932
Epoch 69/100
 - 9s - loss: 0.0033 - val_loss: 0.0028
 - val_f1: 0.9940
 - out_of_sample_accuracy: 0.9944
Epoch 70/100
 - 9s - loss: 0.0035 - val_loss: 0.0028
 - val_f1: 0.9938
 - out_of_sample_accuracy: 0.9941
Epoch 71/100
 - 9s - loss: 0.0034 - val_loss: 0.0029
2020-01-13 21:06:36,611 [INFO] epoch = 70. Intermediate model saved to results_additional_exps/train_time_ids17_lstm_shallow_rep1/_model_epoch_70.pickle
 - val_f1: 0.9931
 - out_of_sample_accuracy: 0.9935
Epoch 72/100
 - 9s - loss: 0.0034 - val_loss: 0.0028
 - val_f1: 0.9938
 - out_of_sample_accuracy: 0.9941
Epoch 73/100
 - 9s - loss: 0.0034 - val_loss: 0.0046
 - val_f1: 0.9915
 - out_of_sample_accuracy: 0.9918
Epoch 74/100
 - 9s - loss: 0.0035 - val_loss: 0.0028
 - val_f1: 0.9942
 - out_of_sample_accuracy: 0.9945
Epoch 75/100
 - 9s - loss: 0.0034 - val_loss: 0.0028
 - val_f1: 0.9930
 - out_of_sample_accuracy: 0.9933
Epoch 76/100
 - 9s - loss: 0.0033 - val_loss: 0.0029
 - val_f1: 0.9940
 - out_of_sample_accuracy: 0.9944
Epoch 77/100
 - 9s - loss: 0.0034 - val_loss: 0.0029
 - val_f1: 0.9932
 - out_of_sample_accuracy: 0.9937
Epoch 78/100
 - 9s - loss: 0.0033 - val_loss: 0.0027
 - val_f1: 0.9934
 - out_of_sample_accuracy: 0.9937
Epoch 79/100
 - 9s - loss: 0.0033 - val_loss: 0.0028
 - val_f1: 0.9926
 - out_of_sample_accuracy: 0.9930
Epoch 80/100
 - 9s - loss: 0.0033 - val_loss: 0.0030
 - val_f1: 0.9930
 - out_of_sample_accuracy: 0.9935
Epoch 81/100
 - 9s - loss: 0.0040 - val_loss: 0.0052
2020-01-13 21:09:07,528 [INFO] epoch = 80. Intermediate model saved to results_additional_exps/train_time_ids17_lstm_shallow_rep1/_model_epoch_80.pickle
 - val_f1: 0.9887
 - out_of_sample_accuracy: 0.9893
Epoch 82/100
 - 9s - loss: 0.0036 - val_loss: 0.0029
 - val_f1: 0.9940
 - out_of_sample_accuracy: 0.9943
Epoch 83/100
 - 9s - loss: 0.0036 - val_loss: 0.0033
 - val_f1: 0.9922
 - out_of_sample_accuracy: 0.9926
Epoch 84/100
 - 9s - loss: 0.0035 - val_loss: 0.0031
 - val_f1: 0.9925
 - out_of_sample_accuracy: 0.9928
Epoch 85/100
 - 9s - loss: 0.0035 - val_loss: 0.0035
 - val_f1: 0.9920
 - out_of_sample_accuracy: 0.9923
Epoch 86/100
 - 9s - loss: 0.0035 - val_loss: 0.0027
 - val_f1: 0.9938
 - out_of_sample_accuracy: 0.9942
Epoch 87/100
 - 9s - loss: 0.0034 - val_loss: 0.0031
 - val_f1: 0.9930
 - out_of_sample_accuracy: 0.9934
Epoch 88/100
 - 9s - loss: 0.0034 - val_loss: 0.0027
 - val_f1: 0.9940
 - out_of_sample_accuracy: 0.9944
Epoch 89/100
 - 9s - loss: 0.0034 - val_loss: 0.0027
 - val_f1: 0.9937
 - out_of_sample_accuracy: 0.9941
Epoch 90/100
 - 9s - loss: 0.0034 - val_loss: 0.0032
 - val_f1: 0.9923
 - out_of_sample_accuracy: 0.9926
Epoch 91/100
 - 9s - loss: 0.0034 - val_loss: 0.0028
2020-01-13 21:11:38,412 [INFO] epoch = 90. Intermediate model saved to results_additional_exps/train_time_ids17_lstm_shallow_rep1/_model_epoch_90.pickle
 - val_f1: 0.9943
 - out_of_sample_accuracy: 0.9946
Epoch 92/100
 - 9s - loss: 0.0033 - val_loss: 0.0033
 - val_f1: 0.9922
 - out_of_sample_accuracy: 0.9925
Epoch 93/100
 - 9s - loss: 0.0035 - val_loss: 0.0033
 - val_f1: 0.9926
 - out_of_sample_accuracy: 0.9931
Epoch 94/100
 - 9s - loss: 0.0040 - val_loss: 0.0028
 - val_f1: 0.9939
 - out_of_sample_accuracy: 0.9943
Epoch 95/100
 - 9s - loss: 0.0037 - val_loss: 0.0057
 - val_f1: 0.9824
 - out_of_sample_accuracy: 0.9833
Epoch 96/100
 - 9s - loss: 0.0035 - val_loss: 0.0032
 - val_f1: 0.9928
 - out_of_sample_accuracy: 0.9932
Epoch 97/100
 - 9s - loss: 0.0034 - val_loss: 0.0028
 - val_f1: 0.9925
 - out_of_sample_accuracy: 0.9928
Epoch 98/100
 - 9s - loss: 0.0033 - val_loss: 0.0030
 - val_f1: 0.9923
 - out_of_sample_accuracy: 0.9926
Epoch 99/100
 - 9s - loss: 0.0033 - val_loss: 0.0028
 - val_f1: 0.9943
 - out_of_sample_accuracy: 0.9946
Epoch 100/100
 - 9s - loss: 0.0033 - val_loss: 0.0028
2020-01-13 21:14:00,502 [INFO] StopperOnGoal: reached goal_metric (accuracy). Stopping training. goal_metric = 0.9946, current_metric = 0.9948, num_epochs = 100
2020-01-13 21:14:00,502 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-13 21:14:11,070 [INFO] Last epoch loss evaluation: train_loss = 0.002580, val_loss = 0.002683
2020-01-13 21:14:11,071 [INFO] Training complete. time_to_train = 1525.15 sec, 25.42 min
2020-01-13 21:14:11,074 [INFO] Model saved to results_additional_exps/train_time_ids17_lstm_shallow_rep1/best_model.pickle
2020-01-13 21:14:11,076 [INFO] Training history saved to: results_additional_exps/train_time_ids17_lstm_shallow_rep1/training_error_history.csv
2020-01-13 21:14:11,236 [INFO] Plot saved to: results_additional_exps/train_time_ids17_lstm_shallow_rep1/training_error_history.png
2020-01-13 21:14:11,381 [INFO] Plot saved to: results_additional_exps/train_time_ids17_lstm_shallow_rep1/training_f1_history.png
2020-01-13 21:14:11,381 [INFO] Making predictions on training, validation, testing data
2020-01-13 21:14:23,650 [INFO] Making predictions complete. time_to_predict = 12.27 sec, 0.20 min
2020-01-13 21:14:23,711 [INFO] Evaluating predictions (results)
/home/nilwala/anaconda3/envs/ml_env/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1268: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
2020-01-13 21:14:42,121 [INFO] Dataset: Testing. Classification report below
2020-01-13 21:14:42,122 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454243
                   Bot       0.96      0.36      0.52       391
                  DDoS       1.00      1.00      1.00     25604
         DoS GoldenEye       0.99      0.97      0.98      2058
              DoS Hulk       0.96      0.99      0.98     46023
      DoS Slowhttptest       0.92      0.95      0.93      1100
         DoS slowloris       0.98      0.98      0.98      1159
           FTP-Patator       1.00      1.00      1.00      1586
              PortScan       0.99      1.00      1.00     31761
           SSH-Patator       0.94      0.98      0.96      1179
Web Attack Brute Force       1.00      0.06      0.12       302
        Web Attack XSS       0.00      0.00      0.00       130

              accuracy                           0.99    565536
             macro avg       0.89      0.77      0.79    565536
          weighted avg       0.99      0.99      0.99    565536

2020-01-13 21:14:42,122 [INFO] Overall accuracy (micro avg): 0.9940905618740452
/home/nilwala/sunanda/ids_experiments/utility.py:328: RuntimeWarning: invalid value encountered in true_divide
  PPV = TP / (TP + FP)    # Precision or positive predictive value
/home/nilwala/sunanda/ids_experiments/utility.py:332: RuntimeWarning: invalid value encountered in true_divide
  FDR = FP / (TP + FP)    # False discovery rate
2020-01-13 21:15:02,011 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9941         0.9941                       0.9941                0.0005                   0.0059  0.9941
1     Macro avg        0.9990         0.8949                       0.7738                0.0012                   0.2262  0.7885
2  Weighted avg        0.9950         0.9940                       0.9941                0.0083                   0.0059  0.9937
2020-01-13 21:15:20,462 [INFO] Dataset: Validation. Classification report below
2020-01-13 21:15:20,462 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454243
                   Bot       0.98      0.32      0.48       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       0.99      0.97      0.98      2059
              DoS Hulk       0.96      0.99      0.98     46023
      DoS Slowhttptest       0.92      0.96      0.94      1099
         DoS slowloris       0.98      0.97      0.98      1159
           FTP-Patator       0.99      0.99      0.99      1587
              PortScan       0.99      1.00      1.00     31758
           SSH-Patator       0.94      0.98      0.96      1180
Web Attack Brute Force       0.71      0.03      0.06       301
        Web Attack XSS       0.00      0.00      0.00       131

              accuracy                           0.99    565536
             macro avg       0.87      0.77      0.78    565536
          weighted avg       0.99      0.99      0.99    565536

2020-01-13 21:15:20,462 [INFO] Overall accuracy (micro avg): 0.9941418406608952
2020-01-13 21:15:40,361 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9941         0.9941                       0.9941                0.0005                   0.0059  0.9941
1     Macro avg        0.9990         0.8722                       0.7682                0.0012                   0.2318  0.7805
2  Weighted avg        0.9951         0.9939                       0.9941                0.0082                   0.0059  0.9937
2020-01-13 21:16:41,725 [INFO] Dataset: Training. Classification report below
2020-01-13 21:16:41,725 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00   1362781
                   Bot       0.98      0.36      0.53      1174
                  DDoS       1.00      1.00      1.00     76815
         DoS GoldenEye       0.99      0.98      0.98      6176
              DoS Hulk       0.96      0.99      0.98    138073
      DoS Slowhttptest       0.94      0.96      0.95      3300
         DoS slowloris       0.98      0.99      0.98      3478
           FTP-Patator       1.00      0.99      1.00      4761
              PortScan       0.99      1.00      1.00     95281
           SSH-Patator       0.95      0.98      0.97      3538
Web Attack Brute Force       0.88      0.06      0.11       904
        Web Attack XSS       0.00      0.00      0.00       391

              accuracy                           0.99   1696672
             macro avg       0.89      0.78      0.79   1696672
          weighted avg       0.99      0.99      0.99   1696672

2020-01-13 21:16:41,725 [INFO] Overall accuracy (micro avg): 0.9943866581165953
/home/nilwala/sunanda/ids_experiments/utility.py:334: RuntimeWarning: invalid value encountered in true_divide
  F1 = (2 * PPV * TPR) / (PPV + TPR)  # F1 score
2020-01-13 21:17:47,880 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9944         0.9944                       0.9944                0.0005                   0.0056  0.9944
1     Macro avg        0.9991         0.8902                       0.7756                0.0011                   0.2244  0.7909
2  Weighted avg        0.9953         0.9942                       0.9944                0.0078                   0.0056  0.9940
2020-01-13 21:17:47,931 [INFO] Results saved to: results_additional_exps/train_time_ids17_lstm_shallow_rep1/train_time_ids17_lstm_shallow_rep1_results.xlsx
2020-01-13 21:17:47,935 [INFO] ================= Finished running experiment no. 1 ================= 

2020-01-13 21:17:48,003 [INFO] Created directory: results_additional_exps/train_time_ids17_lstm_shallow_rep2
2020-01-13 21:17:48,003 [INFO] Initialized logging. log_filename = results_additional_exps/train_time_ids17_lstm_shallow_rep2/run_log.log
2020-01-13 21:17:48,003 [INFO] ================= Running experiment no. 2  ================= 

2020-01-13 21:17:48,003 [INFO] Experiment parameters given below
2020-01-13 21:17:48,004 [INFO] 
{'experiment_num': 2, 'results_dir': 'results_additional_exps/train_time_ids17_lstm_shallow_rep2', 'model': 'lstm', 'model_type': 'classifier', 'normal_label': 'BENIGN', 'lstm_time_steps': 32, 'lstm_layer_units': [32], 'lstm_layer_activations': ['relu'], 'lstm_layer_dropout_rates': [0.2], 'batch_size': 256, 'epochs': 100, 'early_stop_patience': 100, 'goal_metric': 0.994603352, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/full_datasets/ids2017', 'description': 'train_time_ids17_lstm_shallow_rep2'}
2020-01-13 21:17:48,004 [INFO] Created tensorboard log directory: results_additional_exps/train_time_ids17_lstm_shallow_rep2/tf_logs_run_2020_01_13-21_17_48
2020-01-13 21:17:48,004 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2017
2020-01-13 21:17:48,004 [INFO] Reading X, y files
2020-01-13 21:17:48,004 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_train.h5
2020-01-13 21:17:52,109 [INFO] Reading complete. time_to_read=4.10 seconds
2020-01-13 21:17:52,109 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_val.h5
2020-01-13 21:17:53,498 [INFO] Reading complete. time_to_read=1.39 seconds
2020-01-13 21:17:53,498 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_test.h5
2020-01-13 21:17:54,890 [INFO] Reading complete. time_to_read=1.39 seconds
2020-01-13 21:17:54,891 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_train.h5
2020-01-13 21:17:55,115 [INFO] Reading complete. time_to_read=0.22 seconds
2020-01-13 21:17:55,116 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_val.h5
2020-01-13 21:17:55,192 [INFO] Reading complete. time_to_read=0.08 seconds
2020-01-13 21:17:55,193 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_test.h5
2020-01-13 21:17:55,270 [INFO] Reading complete. time_to_read=0.08 seconds
2020-01-13 21:17:57,104 [INFO] Preparing flow sequences
2020-01-13 21:18:18,565 [INFO] Extracting flows complete. time_taken = 21.46 sec
2020-01-13 21:18:19,628 [INFO] Initializing model
2020-01-13 21:18:19,849 [INFO] _________________________________________________________________
2020-01-13 21:18:19,849 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-13 21:18:19,849 [INFO] =================================================================
2020-01-13 21:18:19,849 [INFO] lstm_5 (LSTM)                (None, 32, 32)            14208     
2020-01-13 21:18:19,849 [INFO] _________________________________________________________________
2020-01-13 21:18:19,849 [INFO] batch_normalization_5 (Batch (None, 32, 32)            128       
2020-01-13 21:18:19,849 [INFO] _________________________________________________________________
2020-01-13 21:18:19,849 [INFO] dropout_5 (Dropout)          (None, 32, 32)            0         
2020-01-13 21:18:19,849 [INFO] _________________________________________________________________
2020-01-13 21:18:19,849 [INFO] time_distributed_5 (TimeDist (None, 32, 12)            396       
2020-01-13 21:18:19,849 [INFO] =================================================================
2020-01-13 21:18:19,849 [INFO] Total params: 14,732
2020-01-13 21:18:19,849 [INFO] Trainable params: 14,668
2020-01-13 21:18:19,850 [INFO] Non-trainable params: 64
2020-01-13 21:18:19,850 [INFO] _________________________________________________________________
2020-01-13 21:18:19,850 [INFO] Training model
 - val_f1: 0.9945
 - out_of_sample_accuracy: 0.9948
Train on 53021 samples, validate on 17673 samples
Epoch 1/100
 - 11s - loss: 0.1104 - val_loss: 0.0340
 - val_f1: 0.9321
 - out_of_sample_accuracy: 0.9208
Epoch 2/100
 - 9s - loss: 0.0275 - val_loss: 0.0209
 - val_f1: 0.9542
 - out_of_sample_accuracy: 0.9535
Epoch 3/100
 - 9s - loss: 0.0205 - val_loss: 0.0164
 - val_f1: 0.9612
 - out_of_sample_accuracy: 0.9616
Epoch 4/100
 - 9s - loss: 0.0171 - val_loss: 0.0137
 - val_f1: 0.9645
 - out_of_sample_accuracy: 0.9654
Epoch 5/100
 - 9s - loss: 0.0151 - val_loss: 0.0122
 - val_f1: 0.9688
 - out_of_sample_accuracy: 0.9691
Epoch 6/100
 - 9s - loss: 0.0137 - val_loss: 0.0109
 - val_f1: 0.9714
 - out_of_sample_accuracy: 0.9711
Epoch 7/100
 - 9s - loss: 0.0126 - val_loss: 0.0108
 - val_f1: 0.9728
 - out_of_sample_accuracy: 0.9727
Epoch 8/100
 - 9s - loss: 0.0119 - val_loss: 0.0098
 - val_f1: 0.9738
 - out_of_sample_accuracy: 0.9738
Epoch 9/100
 - 9s - loss: 0.0112 - val_loss: 0.0095
 - val_f1: 0.9747
 - out_of_sample_accuracy: 0.9746
Epoch 10/100
 - 9s - loss: 0.0107 - val_loss: 0.0090
 - val_f1: 0.9755
 - out_of_sample_accuracy: 0.9757
Epoch 11/100
 - 9s - loss: 0.0102 - val_loss: 0.0083
2020-01-13 21:21:05,372 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/train_time_ids17_lstm_shallow_rep2/_model_epoch_10.pickle
 - val_f1: 0.9797
 - out_of_sample_accuracy: 0.9794
Epoch 12/100
 - 9s - loss: 0.0098 - val_loss: 0.0080
 - val_f1: 0.9819
 - out_of_sample_accuracy: 0.9819
Epoch 13/100
 - 9s - loss: 0.0095 - val_loss: 0.0082
 - val_f1: 0.9767
 - out_of_sample_accuracy: 0.9768
Epoch 14/100
 - 9s - loss: 0.0090 - val_loss: 0.0078
 - val_f1: 0.9788
 - out_of_sample_accuracy: 0.9790
Epoch 15/100
 - 9s - loss: 0.0087 - val_loss: 0.0091
 - val_f1: 0.9728
 - out_of_sample_accuracy: 0.9742
Epoch 16/100
 - 9s - loss: 0.0083 - val_loss: 0.0072
 - val_f1: 0.9798
 - out_of_sample_accuracy: 0.9800
Epoch 17/100
 - 9s - loss: 0.0077 - val_loss: 0.0072
 - val_f1: 0.9814
 - out_of_sample_accuracy: 0.9816
Epoch 18/100
 - 9s - loss: 0.0072 - val_loss: 0.0065
 - val_f1: 0.9829
 - out_of_sample_accuracy: 0.9833
Epoch 19/100
 - 9s - loss: 0.0067 - val_loss: 0.0063
 - val_f1: 0.9853
 - out_of_sample_accuracy: 0.9858
Epoch 20/100
 - 9s - loss: 0.0062 - val_loss: 0.0068
 - val_f1: 0.9829
 - out_of_sample_accuracy: 0.9835
Epoch 21/100
 - 9s - loss: 0.0058 - val_loss: 0.0046
2020-01-13 21:23:36,803 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/train_time_ids17_lstm_shallow_rep2/_model_epoch_20.pickle
 - val_f1: 0.9912
 - out_of_sample_accuracy: 0.9917
Epoch 22/100
 - 9s - loss: 0.0056 - val_loss: 0.0055
 - val_f1: 0.9872
 - out_of_sample_accuracy: 0.9876
Epoch 23/100
 - 9s - loss: 0.0054 - val_loss: 0.0040
 - val_f1: 0.9911
 - out_of_sample_accuracy: 0.9914
Epoch 24/100
 - 9s - loss: 0.0052 - val_loss: 0.0038
 - val_f1: 0.9920
 - out_of_sample_accuracy: 0.9925
Epoch 25/100
 - 9s - loss: 0.0050 - val_loss: 0.0043
 - val_f1: 0.9912
 - out_of_sample_accuracy: 0.9915
Epoch 26/100
 - 9s - loss: 0.0048 - val_loss: 0.0036
 - val_f1: 0.9930
 - out_of_sample_accuracy: 0.9932
Epoch 27/100
 - 9s - loss: 0.0047 - val_loss: 0.0050
 - val_f1: 0.9886
 - out_of_sample_accuracy: 0.9888
Epoch 28/100
 - 9s - loss: 0.0047 - val_loss: 0.0038
 - val_f1: 0.9909
 - out_of_sample_accuracy: 0.9912
Epoch 29/100
 - 10s - loss: 0.0046 - val_loss: 0.0037
 - val_f1: 0.9910
 - out_of_sample_accuracy: 0.9914
Epoch 30/100
 - 9s - loss: 0.0044 - val_loss: 0.0037
 - val_f1: 0.9913
 - out_of_sample_accuracy: 0.9914
Epoch 31/100
 - 9s - loss: 0.0044 - val_loss: 0.0035
2020-01-13 21:26:08,739 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/train_time_ids17_lstm_shallow_rep2/_model_epoch_30.pickle
 - val_f1: 0.9923
 - out_of_sample_accuracy: 0.9928
Epoch 32/100
 - 9s - loss: 0.0043 - val_loss: 0.0032
 - val_f1: 0.9935
 - out_of_sample_accuracy: 0.9938
Epoch 33/100
 - 9s - loss: 0.0042 - val_loss: 0.0035
 - val_f1: 0.9923
 - out_of_sample_accuracy: 0.9928
Epoch 34/100
 - 9s - loss: 0.0042 - val_loss: 0.0035
 - val_f1: 0.9916
 - out_of_sample_accuracy: 0.9918
Epoch 35/100
 - 9s - loss: 0.0041 - val_loss: 0.0051
 - val_f1: 0.9890
 - out_of_sample_accuracy: 0.9894
Epoch 36/100
 - 9s - loss: 0.0040 - val_loss: 0.0040
 - val_f1: 0.9906
 - out_of_sample_accuracy: 0.9908
Epoch 37/100
 - 9s - loss: 0.0045 - val_loss: 0.0033
 - val_f1: 0.9926
 - out_of_sample_accuracy: 0.9931
Epoch 38/100
 - 9s - loss: 0.0043 - val_loss: 0.0031
 - val_f1: 0.9937
 - out_of_sample_accuracy: 0.9940
Epoch 39/100
 - 9s - loss: 0.0041 - val_loss: 0.0031
 - val_f1: 0.9934
 - out_of_sample_accuracy: 0.9938
Epoch 40/100
 - 9s - loss: 0.0040 - val_loss: 0.0032
 - val_f1: 0.9932
 - out_of_sample_accuracy: 0.9933
Epoch 41/100
 - 9s - loss: 0.0040 - val_loss: 0.0034
2020-01-13 21:28:40,709 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/train_time_ids17_lstm_shallow_rep2/_model_epoch_40.pickle
 - val_f1: 0.9916
 - out_of_sample_accuracy: 0.9919
Epoch 42/100
 - 9s - loss: 0.0040 - val_loss: 0.0031
 - val_f1: 0.9932
 - out_of_sample_accuracy: 0.9937
Epoch 43/100
 - 9s - loss: 0.0039 - val_loss: 0.0031
 - val_f1: 0.9938
 - out_of_sample_accuracy: 0.9940
Epoch 44/100
 - 9s - loss: 0.0039 - val_loss: 0.0034
 - val_f1: 0.9937
 - out_of_sample_accuracy: 0.9940
Epoch 45/100
 - 9s - loss: 0.0038 - val_loss: 0.0037
 - val_f1: 0.9908
 - out_of_sample_accuracy: 0.9910
Epoch 46/100
 - 9s - loss: 0.0039 - val_loss: 0.0040
 - val_f1: 0.9904
 - out_of_sample_accuracy: 0.9906
Epoch 47/100
 - 9s - loss: 0.0043 - val_loss: 0.0036
 - val_f1: 0.9924
 - out_of_sample_accuracy: 0.9927
Epoch 48/100
 - 9s - loss: 0.0043 - val_loss: 0.0034
 - val_f1: 0.9927
 - out_of_sample_accuracy: 0.9931
Epoch 49/100
 - 9s - loss: 0.0041 - val_loss: 0.0034
 - val_f1: 0.9919
 - out_of_sample_accuracy: 0.9922
Epoch 50/100
 - 9s - loss: 0.0039 - val_loss: 0.0033
 - val_f1: 0.9933
 - out_of_sample_accuracy: 0.9934
Epoch 51/100
 - 9s - loss: 0.0038 - val_loss: 0.0031
2020-01-13 21:31:11,924 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/train_time_ids17_lstm_shallow_rep2/_model_epoch_50.pickle
 - val_f1: 0.9927
 - out_of_sample_accuracy: 0.9928
Epoch 52/100
 - 9s - loss: 0.0038 - val_loss: 0.0033
 - val_f1: 0.9926
 - out_of_sample_accuracy: 0.9930
Epoch 53/100
 - 9s - loss: 0.0037 - val_loss: 0.0030
 - val_f1: 0.9941
 - out_of_sample_accuracy: 0.9944
Epoch 54/100
 - 9s - loss: 0.0037 - val_loss: 0.0031
 - val_f1: 0.9942
 - out_of_sample_accuracy: 0.9945
Epoch 55/100
 - 9s - loss: 0.0037 - val_loss: 0.0028
 - val_f1: 0.9942
 - out_of_sample_accuracy: 0.9946
Epoch 56/100
 - 9s - loss: 0.0036 - val_loss: 0.0029
 - val_f1: 0.9935
 - out_of_sample_accuracy: 0.9937
Epoch 57/100
 - 9s - loss: 0.0036 - val_loss: 0.0030
 - val_f1: 0.9931
 - out_of_sample_accuracy: 0.9936
Epoch 58/100
 - 9s - loss: 0.0037 - val_loss: 0.0041
 - val_f1: 0.9913
 - out_of_sample_accuracy: 0.9914
Epoch 59/100
 - 9s - loss: 0.0036 - val_loss: 0.0029
 - val_f1: 0.9932
 - out_of_sample_accuracy: 0.9937
Epoch 60/100
 - 9s - loss: 0.0035 - val_loss: 0.0028
 - val_f1: 0.9941
 - out_of_sample_accuracy: 0.9945
Epoch 61/100
 - 9s - loss: 0.0035 - val_loss: 0.0033
2020-01-13 21:33:43,215 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/train_time_ids17_lstm_shallow_rep2/_model_epoch_60.pickle
 - val_f1: 0.9920
 - out_of_sample_accuracy: 0.9923
Epoch 62/100
 - 9s - loss: 0.0036 - val_loss: 0.0030
 - val_f1: 0.9932
 - out_of_sample_accuracy: 0.9937
Epoch 63/100
 - 9s - loss: 0.0035 - val_loss: 0.0029
 - val_f1: 0.9923
 - out_of_sample_accuracy: 0.9926
Epoch 64/100
 - 9s - loss: 0.0035 - val_loss: 0.0028
2020-01-13 21:34:34,727 [INFO] StopperOnGoal: reached goal_metric (accuracy). Stopping training. goal_metric = 0.9946, current_metric = 0.9946, num_epochs = 64
2020-01-13 21:34:34,728 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-13 21:34:45,336 [INFO] Last epoch loss evaluation: train_loss = 0.002631, val_loss = 0.002775
2020-01-13 21:34:45,337 [INFO] Training complete. time_to_train = 985.49 sec, 16.42 min
2020-01-13 21:34:45,340 [INFO] Model saved to results_additional_exps/train_time_ids17_lstm_shallow_rep2/best_model.pickle
2020-01-13 21:34:45,342 [INFO] Training history saved to: results_additional_exps/train_time_ids17_lstm_shallow_rep2/training_error_history.csv
2020-01-13 21:34:45,487 [INFO] Plot saved to: results_additional_exps/train_time_ids17_lstm_shallow_rep2/training_error_history.png
2020-01-13 21:34:45,627 [INFO] Plot saved to: results_additional_exps/train_time_ids17_lstm_shallow_rep2/training_f1_history.png
2020-01-13 21:34:45,627 [INFO] Making predictions on training, validation, testing data
2020-01-13 21:34:58,012 [INFO] Making predictions complete. time_to_predict = 12.39 sec, 0.21 min
2020-01-13 21:34:58,074 [INFO] Evaluating predictions (results)
2020-01-13 21:35:16,472 [INFO] Dataset: Testing. Classification report below
2020-01-13 21:35:16,472 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454243
                   Bot       0.97      0.35      0.52       391
                  DDoS       1.00      1.00      1.00     25604
         DoS GoldenEye       0.99      0.97      0.98      2058
              DoS Hulk       0.98      0.99      0.98     46023
      DoS Slowhttptest       0.89      0.98      0.93      1100
         DoS slowloris       0.98      0.94      0.96      1159
           FTP-Patator       0.99      0.99      0.99      1586
              PortScan       0.99      1.00      1.00     31761
           SSH-Patator       0.95      0.97      0.96      1179
Web Attack Brute Force       0.96      0.08      0.15       302
        Web Attack XSS       0.00      0.00      0.00       130

              accuracy                           0.99    565536
             macro avg       0.89      0.77      0.79    565536
          weighted avg       0.99      0.99      0.99    565536

2020-01-13 21:35:16,473 [INFO] Overall accuracy (micro avg): 0.9946740791037175
2020-01-13 21:35:36,322 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9947         0.9947                       0.9947                0.0005                   0.0053  0.9947
1     Macro avg        0.9991         0.8920                       0.7726                0.0014                   0.2274  0.7892
2  Weighted avg        0.9956         0.9945                       0.9947                0.0109                   0.0053  0.9943
2020-01-13 21:35:54,718 [INFO] Dataset: Validation. Classification report below
2020-01-13 21:35:54,718 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454243
                   Bot       0.96      0.30      0.46       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       0.99      0.96      0.97      2059
              DoS Hulk       0.98      0.99      0.98     46023
      DoS Slowhttptest       0.89      0.98      0.93      1099
         DoS slowloris       0.98      0.94      0.96      1159
           FTP-Patator       0.99      0.98      0.99      1587
              PortScan       0.99      1.00      1.00     31758
           SSH-Patator       0.95      0.96      0.96      1180
Web Attack Brute Force       0.83      0.05      0.09       301
        Web Attack XSS       1.00      0.02      0.04       131

              accuracy                           0.99    565536
             macro avg       0.96      0.77      0.78    565536
          weighted avg       0.99      0.99      0.99    565536

2020-01-13 21:35:54,718 [INFO] Overall accuracy (micro avg): 0.9947377355287728
2020-01-13 21:36:14,548 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9947         0.9947                       0.9947                0.0005                   0.0053  0.9947
1     Macro avg        0.9991         0.9635                       0.7650                0.0014                   0.2350  0.7820
2  Weighted avg        0.9956         0.9947                       0.9947                0.0111                   0.0053  0.9943
2020-01-13 21:37:15,945 [INFO] Dataset: Training. Classification report below
2020-01-13 21:37:15,945 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00   1362781
                   Bot       0.98      0.35      0.52      1174
                  DDoS       1.00      1.00      1.00     76815
         DoS GoldenEye       0.99      0.97      0.98      6176
              DoS Hulk       0.98      0.99      0.98    138073
      DoS Slowhttptest       0.91      0.98      0.94      3300
         DoS slowloris       0.98      0.95      0.97      3478
           FTP-Patator       1.00      0.99      0.99      4761
              PortScan       0.99      1.00      1.00     95281
           SSH-Patator       0.96      0.97      0.97      3538
Web Attack Brute Force       0.96      0.08      0.14       904
        Web Attack XSS       1.00      0.02      0.04       391

              accuracy                           1.00   1696672
             macro avg       0.98      0.77      0.79   1696672
          weighted avg       1.00      1.00      0.99   1696672

2020-01-13 21:37:15,945 [INFO] Overall accuracy (micro avg): 0.995014946907829
2020-01-13 21:38:22,216 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9950         0.9950                       0.9950                0.0005                   0.0050  0.9950
1     Macro avg        0.9992         0.9789                       0.7749                0.0013                   0.2251  0.7942
2  Weighted avg        0.9958         0.9950                       0.9950                0.0105                   0.0050  0.9946
2020-01-13 21:38:22,272 [INFO] Results saved to: results_additional_exps/train_time_ids17_lstm_shallow_rep2/train_time_ids17_lstm_shallow_rep2_results.xlsx
2020-01-13 21:38:22,276 [INFO] ================= Finished running experiment no. 2 ================= 

2020-01-13 21:38:22,345 [INFO] Created directory: results_additional_exps/train_time_ids17_lstm_shallow_rep3
2020-01-13 21:38:22,345 [INFO] Initialized logging. log_filename = results_additional_exps/train_time_ids17_lstm_shallow_rep3/run_log.log
2020-01-13 21:38:22,345 [INFO] ================= Running experiment no. 3  ================= 

2020-01-13 21:38:22,345 [INFO] Experiment parameters given below
2020-01-13 21:38:22,345 [INFO] 
{'experiment_num': 3, 'results_dir': 'results_additional_exps/train_time_ids17_lstm_shallow_rep3', 'model': 'lstm', 'model_type': 'classifier', 'normal_label': 'BENIGN', 'lstm_time_steps': 32, 'lstm_layer_units': [32], 'lstm_layer_activations': ['relu'], 'lstm_layer_dropout_rates': [0.2], 'batch_size': 256, 'epochs': 100, 'early_stop_patience': 100, 'goal_metric': 0.994603352, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/full_datasets/ids2017', 'description': 'train_time_ids17_lstm_shallow_rep3'}
2020-01-13 21:38:22,345 [INFO] Created tensorboard log directory: results_additional_exps/train_time_ids17_lstm_shallow_rep3/tf_logs_run_2020_01_13-21_38_22
2020-01-13 21:38:22,345 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2017
2020-01-13 21:38:22,345 [INFO] Reading X, y files
2020-01-13 21:38:22,346 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_train.h5
2020-01-13 21:38:26,376 [INFO] Reading complete. time_to_read=4.03 seconds
2020-01-13 21:38:26,376 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_val.h5
2020-01-13 21:38:27,757 [INFO] Reading complete. time_to_read=1.38 seconds
2020-01-13 21:38:27,757 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_test.h5
2020-01-13 21:38:29,140 [INFO] Reading complete. time_to_read=1.38 seconds
2020-01-13 21:38:29,140 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_train.h5
2020-01-13 21:38:29,368 [INFO] Reading complete. time_to_read=0.23 seconds
2020-01-13 21:38:29,368 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_val.h5
2020-01-13 21:38:29,446 [INFO] Reading complete. time_to_read=0.08 seconds
2020-01-13 21:38:29,446 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_test.h5
2020-01-13 21:38:29,524 [INFO] Reading complete. time_to_read=0.08 seconds
2020-01-13 21:38:31,489 [INFO] Preparing flow sequences
2020-01-13 21:38:52,774 [INFO] Extracting flows complete. time_taken = 21.28 sec
2020-01-13 21:38:53,841 [INFO] Initializing model
2020-01-13 21:38:54,233 [INFO] _________________________________________________________________
2020-01-13 21:38:54,233 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-13 21:38:54,233 [INFO] =================================================================
2020-01-13 21:38:54,233 [INFO] lstm_6 (LSTM)                (None, 32, 32)            14208     
2020-01-13 21:38:54,233 [INFO] _________________________________________________________________
2020-01-13 21:38:54,233 [INFO] batch_normalization_6 (Batch (None, 32, 32)            128       
2020-01-13 21:38:54,233 [INFO] _________________________________________________________________
2020-01-13 21:38:54,233 [INFO] dropout_6 (Dropout)          (None, 32, 32)            0         
2020-01-13 21:38:54,233 [INFO] _________________________________________________________________
2020-01-13 21:38:54,233 [INFO] time_distributed_6 (TimeDist (None, 32, 12)            396       
2020-01-13 21:38:54,233 [INFO] =================================================================
2020-01-13 21:38:54,233 [INFO] Total params: 14,732
2020-01-13 21:38:54,233 [INFO] Trainable params: 14,668
2020-01-13 21:38:54,234 [INFO] Non-trainable params: 64
2020-01-13 21:38:54,234 [INFO] _________________________________________________________________
2020-01-13 21:38:54,234 [INFO] Training model
 - val_f1: 0.9943
 - out_of_sample_accuracy: 0.9946
Train on 53021 samples, validate on 17673 samples
Epoch 1/100
 - 11s - loss: 0.1353 - val_loss: 0.0635
 - val_f1: 0.9027
 - out_of_sample_accuracy: 0.8539
Epoch 2/100
 - 9s - loss: 0.0289 - val_loss: 0.0229
 - val_f1: 0.9542
 - out_of_sample_accuracy: 0.9530
Epoch 3/100
 - 9s - loss: 0.0206 - val_loss: 0.0177
 - val_f1: 0.9595
 - out_of_sample_accuracy: 0.9602
Epoch 4/100
 - 9s - loss: 0.0173 - val_loss: 0.0147
 - val_f1: 0.9628
 - out_of_sample_accuracy: 0.9633
Epoch 5/100
 - 9s - loss: 0.0153 - val_loss: 0.0126
 - val_f1: 0.9685
 - out_of_sample_accuracy: 0.9679
Epoch 6/100
 - 9s - loss: 0.0139 - val_loss: 0.0114
 - val_f1: 0.9723
 - out_of_sample_accuracy: 0.9673
Epoch 7/100
 - 9s - loss: 0.0129 - val_loss: 0.0105
 - val_f1: 0.9737
 - out_of_sample_accuracy: 0.9728
Epoch 8/100
 - 9s - loss: 0.0122 - val_loss: 0.0101
 - val_f1: 0.9735
 - out_of_sample_accuracy: 0.9734
Epoch 9/100
 - 9s - loss: 0.0114 - val_loss: 0.0098
 - val_f1: 0.9744
 - out_of_sample_accuracy: 0.9745
Epoch 10/100
 - 9s - loss: 0.0109 - val_loss: 0.0099
 - val_f1: 0.9740
 - out_of_sample_accuracy: 0.9743
Epoch 11/100
 - 9s - loss: 0.0104 - val_loss: 0.0087
2020-01-13 21:41:39,835 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/train_time_ids17_lstm_shallow_rep3/_model_epoch_10.pickle
 - val_f1: 0.9806
 - out_of_sample_accuracy: 0.9800
Epoch 12/100
 - 9s - loss: 0.0100 - val_loss: 0.0088
 - val_f1: 0.9761
 - out_of_sample_accuracy: 0.9760
Epoch 13/100
 - 9s - loss: 0.0097 - val_loss: 0.0089
 - val_f1: 0.9754
 - out_of_sample_accuracy: 0.9758
Epoch 14/100
 - 9s - loss: 0.0093 - val_loss: 0.0083
 - val_f1: 0.9811
 - out_of_sample_accuracy: 0.9810
Epoch 15/100
 - 9s - loss: 0.0089 - val_loss: 0.0078
 - val_f1: 0.9803
 - out_of_sample_accuracy: 0.9804
Epoch 16/100
 - 9s - loss: 0.0087 - val_loss: 0.0082
 - val_f1: 0.9777
 - out_of_sample_accuracy: 0.9780
Epoch 17/100
 - 9s - loss: 0.0083 - val_loss: 0.0091
 - val_f1: 0.9717
 - out_of_sample_accuracy: 0.9729
Epoch 18/100
 - 9s - loss: 0.0079 - val_loss: 0.0066
 - val_f1: 0.9838
 - out_of_sample_accuracy: 0.9843
Epoch 19/100
 - 9s - loss: 0.0074 - val_loss: 0.0069
 - val_f1: 0.9822
 - out_of_sample_accuracy: 0.9827
Epoch 20/100
 - 9s - loss: 0.0067 - val_loss: 0.0084
 - val_f1: 0.9710
 - out_of_sample_accuracy: 0.9724
Epoch 21/100
 - 9s - loss: 0.0062 - val_loss: 0.0049
2020-01-13 21:44:11,182 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/train_time_ids17_lstm_shallow_rep3/_model_epoch_20.pickle
 - val_f1: 0.9885
 - out_of_sample_accuracy: 0.9890
Epoch 22/100
 - 9s - loss: 0.0057 - val_loss: 0.0045
 - val_f1: 0.9921
 - out_of_sample_accuracy: 0.9923
Epoch 23/100
 - 9s - loss: 0.0053 - val_loss: 0.0050
 - val_f1: 0.9893
 - out_of_sample_accuracy: 0.9898
Epoch 24/100
 - 9s - loss: 0.0051 - val_loss: 0.0039
 - val_f1: 0.9928
 - out_of_sample_accuracy: 0.9929
Epoch 25/100
 - 9s - loss: 0.0049 - val_loss: 0.0039
 - val_f1: 0.9914
 - out_of_sample_accuracy: 0.9919
Epoch 26/100
 - 9s - loss: 0.0049 - val_loss: 0.0035
 - val_f1: 0.9932
 - out_of_sample_accuracy: 0.9935
Epoch 27/100
 - 9s - loss: 0.0047 - val_loss: 0.0035
 - val_f1: 0.9923
 - out_of_sample_accuracy: 0.9924
Epoch 28/100
 - 9s - loss: 0.0045 - val_loss: 0.0036
 - val_f1: 0.9922
 - out_of_sample_accuracy: 0.9925
Epoch 29/100
 - 9s - loss: 0.0045 - val_loss: 0.0036
 - val_f1: 0.9912
 - out_of_sample_accuracy: 0.9915
Epoch 30/100
 - 9s - loss: 0.0045 - val_loss: 0.0035
 - val_f1: 0.9917
 - out_of_sample_accuracy: 0.9920
Epoch 31/100
 - 9s - loss: 0.0044 - val_loss: 0.0042
2020-01-13 21:46:42,553 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/train_time_ids17_lstm_shallow_rep3/_model_epoch_30.pickle
 - val_f1: 0.9909
 - out_of_sample_accuracy: 0.9911
Epoch 32/100
 - 9s - loss: 0.0042 - val_loss: 0.0034
 - val_f1: 0.9922
 - out_of_sample_accuracy: 0.9925
Epoch 33/100
 - 9s - loss: 0.0042 - val_loss: 0.0036
 - val_f1: 0.9917
 - out_of_sample_accuracy: 0.9920
Epoch 34/100
 - 9s - loss: 0.0041 - val_loss: 0.0031
 - val_f1: 0.9936
 - out_of_sample_accuracy: 0.9939
Epoch 35/100
 - 9s - loss: 0.0040 - val_loss: 0.0031
 - val_f1: 0.9936
 - out_of_sample_accuracy: 0.9939
Epoch 36/100
 - 9s - loss: 0.0040 - val_loss: 0.0036
 - val_f1: 0.9920
 - out_of_sample_accuracy: 0.9923
Epoch 37/100
 - 9s - loss: 0.0039 - val_loss: 0.0042
 - val_f1: 0.9918
 - out_of_sample_accuracy: 0.9921
Epoch 38/100
 - 9s - loss: 0.0039 - val_loss: 0.0032
 - val_f1: 0.9932
 - out_of_sample_accuracy: 0.9935
Epoch 39/100
 - 9s - loss: 0.0039 - val_loss: 0.0037
 - val_f1: 0.9915
 - out_of_sample_accuracy: 0.9917
Epoch 40/100
 - 9s - loss: 0.0037 - val_loss: 0.0038
 - val_f1: 0.9902
 - out_of_sample_accuracy: 0.9906
Epoch 41/100
 - 9s - loss: 0.0037 - val_loss: 0.0030
2020-01-13 21:49:13,988 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/train_time_ids17_lstm_shallow_rep3/_model_epoch_40.pickle
 - val_f1: 0.9940
 - out_of_sample_accuracy: 0.9943
Epoch 42/100
 - 9s - loss: 0.0037 - val_loss: 0.0030
 - val_f1: 0.9933
 - out_of_sample_accuracy: 0.9937
Epoch 43/100
 - 9s - loss: 0.0037 - val_loss: 0.0032
 - val_f1: 0.9927
 - out_of_sample_accuracy: 0.9930
Epoch 44/100
 - 9s - loss: 0.0036 - val_loss: 0.0034
 - val_f1: 0.9929
 - out_of_sample_accuracy: 0.9931
Epoch 45/100
 - 9s - loss: 0.0037 - val_loss: 0.0029
 - val_f1: 0.9938
 - out_of_sample_accuracy: 0.9940
Epoch 46/100
 - 9s - loss: 0.0036 - val_loss: 0.0044
 - val_f1: 0.9926
 - out_of_sample_accuracy: 0.9928
Epoch 47/100
 - 9s - loss: 0.0043 - val_loss: 0.0038
 - val_f1: 0.9914
 - out_of_sample_accuracy: 0.9916
Epoch 48/100
 - 9s - loss: 0.0037 - val_loss: 0.0039
 - val_f1: 0.9921
 - out_of_sample_accuracy: 0.9924
Epoch 49/100
 - 9s - loss: 0.0037 - val_loss: 0.0031
 - val_f1: 0.9941
 - out_of_sample_accuracy: 0.9943
Epoch 50/100
 - 9s - loss: 0.0036 - val_loss: 0.0030
 - val_f1: 0.9923
 - out_of_sample_accuracy: 0.9925
Epoch 51/100
 - 9s - loss: 0.0035 - val_loss: 0.0034
2020-01-13 21:51:45,353 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/train_time_ids17_lstm_shallow_rep3/_model_epoch_50.pickle
 - val_f1: 0.9921
 - out_of_sample_accuracy: 0.9924
Epoch 52/100
 - 9s - loss: 0.0036 - val_loss: 0.0034
 - val_f1: 0.9929
 - out_of_sample_accuracy: 0.9933
Epoch 53/100
 - 9s - loss: 0.0035 - val_loss: 0.0040
 - val_f1: 0.9919
 - out_of_sample_accuracy: 0.9922
Epoch 54/100
 - 9s - loss: 0.0035 - val_loss: 0.0028
 - val_f1: 0.9938
 - out_of_sample_accuracy: 0.9942
Epoch 55/100
 - 9s - loss: 0.0034 - val_loss: 0.0032
 - val_f1: 0.9929
 - out_of_sample_accuracy: 0.9933
Epoch 56/100
 - 9s - loss: 0.0035 - val_loss: 0.0031
 - val_f1: 0.9931
 - out_of_sample_accuracy: 0.9935
Epoch 57/100
 - 9s - loss: 0.0034 - val_loss: 0.0029
 - val_f1: 0.9933
 - out_of_sample_accuracy: 0.9937
Epoch 58/100
 - 9s - loss: 0.0034 - val_loss: 0.0028
 - val_f1: 0.9934
 - out_of_sample_accuracy: 0.9939
Epoch 59/100
 - 9s - loss: 0.0033 - val_loss: 0.0027
 - val_f1: 0.9939
 - out_of_sample_accuracy: 0.9943
Epoch 60/100
 - 9s - loss: 0.0034 - val_loss: 0.0030
 - val_f1: 0.9932
 - out_of_sample_accuracy: 0.9937
Epoch 61/100
 - 9s - loss: 0.0034 - val_loss: 0.0029
2020-01-13 21:54:16,790 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/train_time_ids17_lstm_shallow_rep3/_model_epoch_60.pickle
 - val_f1: 0.9931
 - out_of_sample_accuracy: 0.9935
Epoch 62/100
 - 9s - loss: 0.0034 - val_loss: 0.0029
 - val_f1: 0.9941
 - out_of_sample_accuracy: 0.9943
Epoch 63/100
 - 9s - loss: 0.0033 - val_loss: 0.0032
 - val_f1: 0.9931
 - out_of_sample_accuracy: 0.9936
Epoch 64/100
 - 9s - loss: 0.0033 - val_loss: 0.0027
2020-01-13 21:55:08,337 [INFO] StopperOnGoal: reached goal_metric (accuracy). Stopping training. goal_metric = 0.9946, current_metric = 0.9946, num_epochs = 64
2020-01-13 21:55:08,338 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-13 21:55:18,976 [INFO] Last epoch loss evaluation: train_loss = 0.002543, val_loss = 0.002681
2020-01-13 21:55:18,977 [INFO] Training complete. time_to_train = 984.74 sec, 16.41 min
2020-01-13 21:55:18,980 [INFO] Model saved to results_additional_exps/train_time_ids17_lstm_shallow_rep3/best_model.pickle
2020-01-13 21:55:18,982 [INFO] Training history saved to: results_additional_exps/train_time_ids17_lstm_shallow_rep3/training_error_history.csv
2020-01-13 21:55:19,133 [INFO] Plot saved to: results_additional_exps/train_time_ids17_lstm_shallow_rep3/training_error_history.png
2020-01-13 21:55:19,265 [INFO] Plot saved to: results_additional_exps/train_time_ids17_lstm_shallow_rep3/training_f1_history.png
2020-01-13 21:55:19,265 [INFO] Making predictions on training, validation, testing data
2020-01-13 21:55:31,603 [INFO] Making predictions complete. time_to_predict = 12.34 sec, 0.21 min
2020-01-13 21:55:31,663 [INFO] Evaluating predictions (results)
2020-01-13 21:55:50,071 [INFO] Dataset: Testing. Classification report below
2020-01-13 21:55:50,071 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454243
                   Bot       0.97      0.36      0.52       391
                  DDoS       1.00      1.00      1.00     25604
         DoS GoldenEye       0.99      0.97      0.98      2058
              DoS Hulk       0.99      0.98      0.98     46023
      DoS Slowhttptest       0.89      0.99      0.93      1100
         DoS slowloris       0.98      0.96      0.97      1159
           FTP-Patator       0.99      0.99      0.99      1586
              PortScan       0.99      1.00      1.00     31761
           SSH-Patator       0.95      0.97      0.96      1179
Web Attack Brute Force       1.00      0.08      0.14       302
        Web Attack XSS       0.00      0.00      0.00       130

              accuracy                           0.99    565536
             macro avg       0.90      0.77      0.79    565536
          weighted avg       0.99      0.99      0.99    565536

2020-01-13 21:55:50,071 [INFO] Overall accuracy (micro avg): 0.9946634696995417
2020-01-13 21:56:09,933 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9947         0.9947                       0.9947                0.0005                   0.0053  0.9947
1     Macro avg        0.9991         0.8959                       0.7739                0.0016                   0.2261  0.7898
2  Weighted avg        0.9956         0.9944                       0.9947                0.0142                   0.0053  0.9942
2020-01-13 21:56:28,404 [INFO] Dataset: Validation. Classification report below
2020-01-13 21:56:28,404 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454243
                   Bot       0.97      0.32      0.48       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       0.99      0.96      0.97      2059
              DoS Hulk       0.99      0.98      0.98     46023
      DoS Slowhttptest       0.89      0.98      0.93      1099
         DoS slowloris       0.98      0.96      0.97      1159
           FTP-Patator       0.99      0.99      0.99      1587
              PortScan       0.99      1.00      1.00     31758
           SSH-Patator       0.94      0.97      0.95      1180
Web Attack Brute Force       0.78      0.05      0.09       301
        Web Attack XSS       0.00      0.00      0.00       131

              accuracy                           0.99    565536
             macro avg       0.88      0.77      0.78    565536
          weighted avg       0.99      0.99      0.99    565536

2020-01-13 21:56:28,405 [INFO] Overall accuracy (micro avg): 0.9949163271657331
2020-01-13 21:56:48,335 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9949         0.9949                       0.9949                0.0005                   0.0051  0.9949
1     Macro avg        0.9992         0.8769                       0.7659                0.0015                   0.2341  0.7804
2  Weighted avg        0.9958         0.9946                       0.9949                0.0134                   0.0051  0.9945
2020-01-13 21:57:49,963 [INFO] Dataset: Training. Classification report below
2020-01-13 21:57:49,963 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00   1362781
                   Bot       0.98      0.35      0.52      1174
                  DDoS       1.00      1.00      1.00     76815
         DoS GoldenEye       0.99      0.97      0.98      6176
              DoS Hulk       0.99      0.98      0.98    138073
      DoS Slowhttptest       0.90      0.99      0.94      3300
         DoS slowloris       0.99      0.97      0.98      3478
           FTP-Patator       0.99      0.99      0.99      4761
              PortScan       0.99      1.00      1.00     95281
           SSH-Patator       0.96      0.97      0.97      3538
Web Attack Brute Force       0.91      0.06      0.11       904
        Web Attack XSS       1.00      0.02      0.04       391

              accuracy                           1.00   1696672
             macro avg       0.97      0.77      0.79   1696672
          weighted avg       0.99      1.00      0.99   1696672

2020-01-13 21:57:49,964 [INFO] Overall accuracy (micro avg): 0.995014946907829
2020-01-13 21:58:56,397 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9950         0.9950                       0.9950                0.0005                   0.0050  0.9950
1     Macro avg        0.9992         0.9749                       0.7744                0.0015                   0.2256  0.7917
2  Weighted avg        0.9958         0.9950                       0.9950                0.0134                   0.0050  0.9946
2020-01-13 21:58:56,449 [INFO] Results saved to: results_additional_exps/train_time_ids17_lstm_shallow_rep3/train_time_ids17_lstm_shallow_rep3_results.xlsx
2020-01-13 21:58:56,453 [INFO] ================= Finished running experiment no. 3 ================= 

2020-01-13 21:58:56,539 [INFO] Created directory: results_additional_exps/train_time_kdd99_lstm_shallow_rep1
2020-01-13 21:58:56,540 [INFO] Initialized logging. log_filename = results_additional_exps/train_time_kdd99_lstm_shallow_rep1/run_log.log
2020-01-13 21:58:56,540 [INFO] ================= Running experiment no. 1  ================= 

2020-01-13 21:58:56,540 [INFO] Experiment parameters given below
2020-01-13 21:58:56,540 [INFO] 
{'experiment_num': 1, 'results_dir': 'results_additional_exps/train_time_kdd99_lstm_shallow_rep1', 'model': 'lstm', 'model_type': 'classifier', 'normal_label': 'normal', 'lstm_time_steps': 32, 'lstm_layer_units': [32], 'lstm_layer_activations': ['relu'], 'lstm_layer_dropout_rates': [0.2], 'batch_size': 256, 'epochs': 100, 'early_stop_patience': 100, 'goal_metric': 0.922115192, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/full_datasets/kdd99_five_classes', 'description': 'train_time_kdd99_lstm_shallow_rep1'}
2020-01-13 21:58:56,540 [INFO] Created tensorboard log directory: results_additional_exps/train_time_kdd99_lstm_shallow_rep1/tf_logs_run_2020_01_13-21_58_56
2020-01-13 21:58:56,540 [INFO] Loading datsets from: ../Datasets/full_datasets/kdd99_five_classes
2020-01-13 21:58:56,551 [INFO] Reading X, y files
2020-01-13 21:58:56,551 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/X_train.h5
2020-01-13 21:59:08,239 [INFO] Reading complete. time_to_read=11.69 seconds
2020-01-13 21:59:08,239 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/X_val.h5
2020-01-13 21:59:11,102 [INFO] Reading complete. time_to_read=2.86 seconds
2020-01-13 21:59:11,102 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/X_test.h5
2020-01-13 21:59:12,198 [INFO] Reading complete. time_to_read=1.10 seconds
2020-01-13 21:59:12,198 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/y_train.h5
2020-01-13 21:59:13,071 [INFO] Reading complete. time_to_read=0.87 seconds
2020-01-13 21:59:13,071 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/y_val.h5
2020-01-13 21:59:13,302 [INFO] Reading complete. time_to_read=0.23 seconds
2020-01-13 21:59:13,303 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/y_test.h5
2020-01-13 21:59:13,468 [INFO] Reading complete. time_to_read=0.17 seconds
2020-01-13 22:03:04,899 [INFO] Preparing flow sequences
2020-01-13 22:14:16,447 [INFO] Extracting flows complete. time_taken = 670.78 sec
2020-01-13 22:14:31,666 [INFO] Initializing model
2020-01-13 22:15:11,114 [INFO] _________________________________________________________________
2020-01-13 22:15:11,146 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-13 22:15:11,146 [INFO] =================================================================
2020-01-13 22:15:11,195 [INFO] lstm_7 (LSTM)                (None, 32, 32)            19968     
2020-01-13 22:15:11,195 [INFO] _________________________________________________________________
2020-01-13 22:15:11,195 [INFO] batch_normalization_7 (Batch (None, 32, 32)            128       
2020-01-13 22:15:11,196 [INFO] _________________________________________________________________
2020-01-13 22:15:11,196 [INFO] dropout_7 (Dropout)          (None, 32, 32)            0         
2020-01-13 22:15:11,196 [INFO] _________________________________________________________________
2020-01-13 22:15:11,196 [INFO] time_distributed_7 (TimeDist (None, 32, 5)             165       
2020-01-13 22:15:11,197 [INFO] =================================================================
2020-01-13 22:15:11,209 [INFO] Total params: 20,261
2020-01-13 22:15:11,209 [INFO] Trainable params: 20,197
2020-01-13 22:15:11,209 [INFO] Non-trainable params: 64
2020-01-13 22:15:11,209 [INFO] _________________________________________________________________
2020-01-13 22:15:11,209 [INFO] Training model
 - val_f1: 0.9945
 - out_of_sample_accuracy: 0.9946
Train on 122460 samples, validate on 30615 samples
Epoch 1/100
 - 287s - loss: 0.0506 - val_loss: 0.0031
 - val_f1: 0.9987
 - out_of_sample_accuracy: 0.9210
Epoch 2/100
 - 22s - loss: 0.0026 - val_loss: 0.0014
 - val_f1: 0.9992
 - out_of_sample_accuracy: 0.9205
Epoch 3/100
 - 21s - loss: 0.0015 - val_loss: 9.7621e-04
 - val_f1: 0.9995
 - out_of_sample_accuracy: 0.9216
Epoch 4/100
 - 21s - loss: 0.0011 - val_loss: 7.8926e-04
 - val_f1: 0.9996
 - out_of_sample_accuracy: 0.9217
Epoch 5/100
 - 21s - loss: 8.7903e-04 - val_loss: 6.7656e-04
 - val_f1: 0.9996
 - out_of_sample_accuracy: 0.9219
Epoch 6/100
 - 21s - loss: 7.8413e-04 - val_loss: 6.0445e-04
 - val_f1: 0.9997
 - out_of_sample_accuracy: 0.9216
Epoch 7/100
 - 21s - loss: 6.9580e-04 - val_loss: 5.4943e-04
 - val_f1: 0.9997
 - out_of_sample_accuracy: 0.9220
Epoch 8/100
 - 21s - loss: 6.2906e-04 - val_loss: 5.3372e-04
 - val_f1: 0.9997
 - out_of_sample_accuracy: 0.9219
Epoch 9/100
 - 21s - loss: 5.7783e-04 - val_loss: 5.1693e-04
2020-01-13 22:25:14,152 [INFO] StopperOnGoal: reached goal_metric (accuracy). Stopping training. goal_metric = 0.9221, current_metric = 0.9224, num_epochs = 9
2020-01-13 22:25:14,224 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-13 22:25:39,032 [INFO] Last epoch loss evaluation: train_loss = 0.000425, val_loss = 0.000517
2020-01-13 22:25:39,074 [INFO] Training complete. time_to_train = 627.85 sec, 10.46 min
2020-01-13 22:25:40,527 [INFO] Model saved to results_additional_exps/train_time_kdd99_lstm_shallow_rep1/best_model.pickle
2020-01-13 22:25:41,406 [INFO] Training history saved to: results_additional_exps/train_time_kdd99_lstm_shallow_rep1/training_error_history.csv
2020-01-13 22:25:44,491 [INFO] Plot saved to: results_additional_exps/train_time_kdd99_lstm_shallow_rep1/training_error_history.png
2020-01-13 22:25:44,648 [INFO] Plot saved to: results_additional_exps/train_time_kdd99_lstm_shallow_rep1/training_f1_history.png
2020-01-13 22:25:44,654 [INFO] Making predictions on training, validation, testing data
2020-01-13 22:26:09,602 [INFO] Making predictions complete. time_to_predict = 24.95 sec, 0.42 min
2020-01-13 22:26:09,736 [INFO] Evaluating predictions (results)
2020-01-13 22:26:18,713 [INFO] Dataset: Testing. Classification report below
2020-01-13 22:26:18,713 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      0.97      0.99    229853
     normal.       0.72      0.98      0.83     60580
       probe       0.77      0.82      0.79      4166
         r2l       0.95      0.03      0.06     13773
         u2r       0.15      0.00      0.00      2636

    accuracy                           0.92    311008
   macro avg       0.72      0.56      0.53    311008
weighted avg       0.93      0.92      0.90    311008

2020-01-13 22:26:18,713 [INFO] Overall accuracy (micro avg): 0.9225164625990329
2020-01-13 22:26:28,034 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9225         0.9225                       0.9225                0.0194                   0.0775  0.9225
1     Macro avg        0.9690         0.7185                       0.5605                0.0197                   0.4395  0.5341
2  Weighted avg        0.9672         0.9326                       0.9225                0.0210                   0.0775  0.9038
2020-01-13 22:26:57,167 [INFO] Dataset: Validation. Classification report below
2020-01-13 22:26:57,167 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00    776671
     normal.       1.00      1.00      1.00    194553
       probe       0.99      0.99      0.99      8221
         r2l       0.76      0.76      0.76       225
         u2r       0.20      0.10      0.13        10

    accuracy                           1.00    979680
   macro avg       0.79      0.77      0.78    979680
weighted avg       1.00      1.00      1.00    979680

2020-01-13 22:26:57,167 [INFO] Overall accuracy (micro avg): 0.9997070471990854
2020-01-13 22:27:28,001 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9997         0.9997                       0.9997                0.0001                   0.0003  0.9997
1     Macro avg        0.9999         0.7898                       0.7703                0.0001                   0.2297  0.7767
2  Weighted avg        0.9999         0.9997                       0.9997                0.0002                   0.0003  0.9997
2020-01-13 22:29:33,160 [INFO] Dataset: Training. Classification report below
2020-01-13 22:29:33,160 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00   3106675
     normal.       1.00      1.00      1.00    778221
       probe       0.99      0.99      0.99     32881
         r2l       0.76      0.81      0.79       901
         u2r       0.56      0.33      0.42        42

    accuracy                           1.00   3918720
   macro avg       0.86      0.83      0.84   3918720
weighted avg       1.00      1.00      1.00   3918720

2020-01-13 22:29:33,160 [INFO] Overall accuracy (micro avg): 0.9997389453699167
2020-01-13 22:31:47,641 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9997         0.9997                       0.9997                0.0001                   0.0003  0.9997
1     Macro avg        0.9999         0.8633                       0.8271                0.0001                   0.1729  0.8393
2  Weighted avg        0.9999         0.9997                       0.9997                0.0002                   0.0003  0.9997
2020-01-13 22:31:48,498 [INFO] Results saved to: results_additional_exps/train_time_kdd99_lstm_shallow_rep1/train_time_kdd99_lstm_shallow_rep1_results.xlsx
2020-01-13 22:31:48,506 [INFO] ================= Finished running experiment no. 1 ================= 

2020-01-13 22:31:48,794 [INFO] Created directory: results_additional_exps/train_time_kdd99_lstm_shallow_rep2
2020-01-13 22:31:49,012 [INFO] Initialized logging. log_filename = results_additional_exps/train_time_kdd99_lstm_shallow_rep2/run_log.log
2020-01-13 22:31:49,012 [INFO] ================= Running experiment no. 2  ================= 

2020-01-13 22:31:49,013 [INFO] Experiment parameters given below
2020-01-13 22:31:49,013 [INFO] 
{'experiment_num': 2, 'results_dir': 'results_additional_exps/train_time_kdd99_lstm_shallow_rep2', 'model': 'lstm', 'model_type': 'classifier', 'normal_label': 'normal', 'lstm_time_steps': 32, 'lstm_layer_units': [32], 'lstm_layer_activations': ['relu'], 'lstm_layer_dropout_rates': [0.2], 'batch_size': 256, 'epochs': 100, 'early_stop_patience': 100, 'goal_metric': 0.922115192, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/full_datasets/kdd99_five_classes', 'description': 'train_time_kdd99_lstm_shallow_rep2'}
2020-01-13 22:31:49,021 [INFO] Created tensorboard log directory: results_additional_exps/train_time_kdd99_lstm_shallow_rep2/tf_logs_run_2020_01_13-22_31_49
2020-01-13 22:31:49,022 [INFO] Loading datsets from: ../Datasets/full_datasets/kdd99_five_classes
2020-01-13 22:31:49,125 [INFO] Reading X, y files
2020-01-13 22:31:49,125 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/X_train.h5
2020-01-13 22:32:04,294 [INFO] Reading complete. time_to_read=15.17 seconds
2020-01-13 22:32:04,295 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/X_val.h5
2020-01-13 22:32:06,988 [INFO] Reading complete. time_to_read=2.69 seconds
2020-01-13 22:32:06,989 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/X_test.h5
2020-01-13 22:32:07,947 [INFO] Reading complete. time_to_read=0.96 seconds
2020-01-13 22:32:07,948 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/y_train.h5
2020-01-13 22:32:08,811 [INFO] Reading complete. time_to_read=0.86 seconds
2020-01-13 22:32:08,811 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/y_val.h5
2020-01-13 22:32:09,049 [INFO] Reading complete. time_to_read=0.24 seconds
2020-01-13 22:32:09,049 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/y_test.h5
2020-01-13 22:32:09,228 [INFO] Reading complete. time_to_read=0.18 seconds
2020-01-13 22:35:56,571 [INFO] Preparing flow sequences
2020-01-13 22:49:37,561 [INFO] Extracting flows complete. time_taken = 819.61 sec
2020-01-13 22:49:59,436 [INFO] Initializing model
2020-01-13 22:53:05,783 [INFO] _________________________________________________________________
2020-01-13 22:53:05,783 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-13 22:53:05,783 [INFO] =================================================================
2020-01-13 22:53:05,783 [INFO] lstm_8 (LSTM)                (None, 32, 32)            19968     
2020-01-13 22:53:05,783 [INFO] _________________________________________________________________
2020-01-13 22:53:05,783 [INFO] batch_normalization_8 (Batch (None, 32, 32)            128       
2020-01-13 22:53:05,783 [INFO] _________________________________________________________________
2020-01-13 22:53:05,783 [INFO] dropout_8 (Dropout)          (None, 32, 32)            0         
2020-01-13 22:53:05,783 [INFO] _________________________________________________________________
2020-01-13 22:53:05,784 [INFO] time_distributed_8 (TimeDist (None, 32, 5)             165       
2020-01-13 22:53:05,784 [INFO] =================================================================
2020-01-13 22:53:05,784 [INFO] Total params: 20,261
2020-01-13 22:53:05,784 [INFO] Trainable params: 20,197
2020-01-13 22:53:05,784 [INFO] Non-trainable params: 64
2020-01-13 22:53:05,784 [INFO] _________________________________________________________________
2020-01-13 22:53:05,784 [INFO] Training model
 - val_f1: 0.9997
 - out_of_sample_accuracy: 0.9224
Train on 122460 samples, validate on 30615 samples
Epoch 1/100
 - 327s - loss: 0.0594 - val_loss: 0.0033
 - val_f1: 0.9986
 - out_of_sample_accuracy: 0.9142
Epoch 2/100
 - 21s - loss: 0.0027 - val_loss: 0.0013
 - val_f1: 0.9992
 - out_of_sample_accuracy: 0.9160
Epoch 3/100
 - 21s - loss: 0.0015 - val_loss: 9.1950e-04
 - val_f1: 0.9994
 - out_of_sample_accuracy: 0.9186
Epoch 4/100
 - 21s - loss: 0.0011 - val_loss: 7.1034e-04
 - val_f1: 0.9995
 - out_of_sample_accuracy: 0.9185
Epoch 5/100
 - 21s - loss: 9.2265e-04 - val_loss: 6.0310e-04
 - val_f1: 0.9996
 - out_of_sample_accuracy: 0.9194
Epoch 6/100
 - 21s - loss: 7.8893e-04 - val_loss: 5.6180e-04
 - val_f1: 0.9996
 - out_of_sample_accuracy: 0.9184
Epoch 7/100
 - 21s - loss: 6.9856e-04 - val_loss: 5.1180e-04
 - val_f1: 0.9997
 - out_of_sample_accuracy: 0.9206
Epoch 8/100
 - 21s - loss: 6.2253e-04 - val_loss: 4.8175e-04
 - val_f1: 0.9997
 - out_of_sample_accuracy: 0.9214
Epoch 9/100
 - 21s - loss: 5.7335e-04 - val_loss: 4.5738e-04
 - val_f1: 0.9997
 - out_of_sample_accuracy: 0.9217
Epoch 10/100
 - 21s - loss: 5.3042e-04 - val_loss: 4.3969e-04
2020-01-13 23:04:32,230 [INFO] StopperOnGoal: reached goal_metric (accuracy). Stopping training. goal_metric = 0.9221, current_metric = 0.9222, num_epochs = 10
2020-01-13 23:04:32,259 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-13 23:04:57,333 [INFO] Last epoch loss evaluation: train_loss = 0.000355, val_loss = 0.000440
2020-01-13 23:04:57,334 [INFO] Training complete. time_to_train = 711.55 sec, 11.86 min
2020-01-13 23:04:58,534 [INFO] Model saved to results_additional_exps/train_time_kdd99_lstm_shallow_rep2/best_model.pickle
2020-01-13 23:04:58,713 [INFO] Training history saved to: results_additional_exps/train_time_kdd99_lstm_shallow_rep2/training_error_history.csv
2020-01-13 23:04:59,649 [INFO] Plot saved to: results_additional_exps/train_time_kdd99_lstm_shallow_rep2/training_error_history.png
2020-01-13 23:04:59,780 [INFO] Plot saved to: results_additional_exps/train_time_kdd99_lstm_shallow_rep2/training_f1_history.png
2020-01-13 23:04:59,781 [INFO] Making predictions on training, validation, testing data
2020-01-13 23:05:26,130 [INFO] Making predictions complete. time_to_predict = 26.35 sec, 0.44 min
2020-01-13 23:05:26,238 [INFO] Evaluating predictions (results)
2020-01-13 23:05:34,316 [INFO] Dataset: Testing. Classification report below
2020-01-13 23:05:34,317 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      0.97      0.99    229853
     normal.       0.73      0.98      0.84     60580
       probe       0.73      0.75      0.74      4166
         r2l       0.96      0.03      0.06     13773
         u2r       0.10      0.00      0.00      2636

    accuracy                           0.92    311008
   macro avg       0.70      0.55      0.52    311008
weighted avg       0.93      0.92      0.90    311008

2020-01-13 23:05:34,317 [INFO] Overall accuracy (micro avg): 0.9223299722193641
2020-01-13 23:05:43,162 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9223         0.9223                       0.9223                0.0194                   0.0777  0.9223
1     Macro avg        0.9689         0.7008                       0.5483                0.0199                   0.4517  0.5248
2  Weighted avg        0.9675         0.9319                       0.9223                0.0219                   0.0777  0.9037
2020-01-13 23:06:11,846 [INFO] Dataset: Validation. Classification report below
2020-01-13 23:06:11,847 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00    776671
     normal.       1.00      1.00      1.00    194553
       probe       0.99      0.99      0.99      8221
         r2l       0.87      0.70      0.78       225
         u2r       0.67      0.20      0.31        10

    accuracy                           1.00    979680
   macro avg       0.91      0.78      0.82    979680
weighted avg       1.00      1.00      1.00    979680

2020-01-13 23:06:11,847 [INFO] Overall accuracy (micro avg): 0.9997274620284174
2020-01-13 23:06:42,665 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9997         0.9997                       0.9997                0.0001                   0.0003  0.9997
1     Macro avg        0.9999         0.9055                       0.7788                0.0001                   0.2212  0.8153
2  Weighted avg        0.9999         0.9997                       0.9997                0.0003                   0.0003  0.9997
2020-01-13 23:08:47,744 [INFO] Dataset: Training. Classification report below
2020-01-13 23:08:47,744 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00   3106675
     normal.       1.00      1.00      1.00    778221
       probe       0.99      0.99      0.99     32881
         r2l       0.89      0.73      0.80       901
         u2r       0.61      0.40      0.49        42

    accuracy                           1.00   3918720
   macro avg       0.90      0.82      0.86   3918720
weighted avg       1.00      1.00      1.00   3918720

2020-01-13 23:08:47,744 [INFO] Overall accuracy (micro avg): 0.9997542564919157
2020-01-13 23:11:02,147 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9998         0.9998                       0.9998                0.0001                   0.0002  0.9998
1     Macro avg        0.9999         0.8982                       0.8245                0.0001                   0.1755  0.8556
2  Weighted avg        0.9999         0.9997                       0.9998                0.0002                   0.0002  0.9997
2020-01-13 23:11:02,418 [INFO] Results saved to: results_additional_exps/train_time_kdd99_lstm_shallow_rep2/train_time_kdd99_lstm_shallow_rep2_results.xlsx
2020-01-13 23:11:02,426 [INFO] ================= Finished running experiment no. 2 ================= 

2020-01-13 23:11:02,682 [INFO] Created directory: results_additional_exps/train_time_kdd99_lstm_shallow_rep3
2020-01-13 23:11:02,683 [INFO] Initialized logging. log_filename = results_additional_exps/train_time_kdd99_lstm_shallow_rep3/run_log.log
2020-01-13 23:11:02,683 [INFO] ================= Running experiment no. 3  ================= 

2020-01-13 23:11:02,683 [INFO] Experiment parameters given below
2020-01-13 23:11:02,683 [INFO] 
{'experiment_num': 3, 'results_dir': 'results_additional_exps/train_time_kdd99_lstm_shallow_rep3', 'model': 'lstm', 'model_type': 'classifier', 'normal_label': 'normal', 'lstm_time_steps': 32, 'lstm_layer_units': [32], 'lstm_layer_activations': ['relu'], 'lstm_layer_dropout_rates': [0.2], 'batch_size': 256, 'epochs': 100, 'early_stop_patience': 100, 'goal_metric': 0.922115192, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/full_datasets/kdd99_five_classes', 'description': 'train_time_kdd99_lstm_shallow_rep3'}
2020-01-13 23:11:02,683 [INFO] Created tensorboard log directory: results_additional_exps/train_time_kdd99_lstm_shallow_rep3/tf_logs_run_2020_01_13-23_11_02
2020-01-13 23:11:02,683 [INFO] Loading datsets from: ../Datasets/full_datasets/kdd99_five_classes
2020-01-13 23:11:02,714 [INFO] Reading X, y files
2020-01-13 23:11:02,714 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/X_train.h5
2020-01-13 23:11:16,790 [INFO] Reading complete. time_to_read=14.08 seconds
2020-01-13 23:11:16,791 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/X_val.h5
2020-01-13 23:11:19,953 [INFO] Reading complete. time_to_read=3.16 seconds
2020-01-13 23:11:19,953 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/X_test.h5
2020-01-13 23:11:20,944 [INFO] Reading complete. time_to_read=0.99 seconds
2020-01-13 23:11:20,944 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/y_train.h5
2020-01-13 23:11:21,720 [INFO] Reading complete. time_to_read=0.78 seconds
2020-01-13 23:11:21,720 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/y_val.h5
2020-01-13 23:11:21,989 [INFO] Reading complete. time_to_read=0.27 seconds
2020-01-13 23:11:21,989 [INFO] Reading HDF dataset ../Datasets/full_datasets/kdd99_five_classes/y_test.h5
2020-01-13 23:11:22,175 [INFO] Reading complete. time_to_read=0.19 seconds
2020-01-13 23:14:58,380 [INFO] Preparing flow sequences
2020-01-13 23:42:11,908 [INFO] Extracting flows complete. time_taken = 1632.38 sec
2020-01-13 23:42:36,580 [INFO] Initializing model
2020-01-13 23:44:58,424 [INFO] _________________________________________________________________
2020-01-13 23:44:58,468 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-13 23:44:58,468 [INFO] =================================================================
2020-01-13 23:44:58,542 [INFO] lstm_9 (LSTM)                (None, 32, 32)            19968     
2020-01-13 23:44:58,543 [INFO] _________________________________________________________________
2020-01-13 23:44:58,543 [INFO] batch_normalization_9 (Batch (None, 32, 32)            128       
2020-01-13 23:44:58,543 [INFO] _________________________________________________________________
2020-01-13 23:44:58,543 [INFO] dropout_9 (Dropout)          (None, 32, 32)            0         
2020-01-13 23:44:58,543 [INFO] _________________________________________________________________
2020-01-13 23:44:58,543 [INFO] time_distributed_9 (TimeDist (None, 32, 5)             165       
2020-01-13 23:44:58,543 [INFO] =================================================================
2020-01-13 23:44:58,549 [INFO] Total params: 20,261
2020-01-13 23:44:58,550 [INFO] Trainable params: 20,197
2020-01-13 23:44:58,550 [INFO] Non-trainable params: 64
2020-01-13 23:44:58,550 [INFO] _________________________________________________________________
2020-01-13 23:44:58,550 [INFO] Training model
 - val_f1: 0.9997
 - out_of_sample_accuracy: 0.9222
Train on 122460 samples, validate on 30615 samples
Epoch 1/100
 - 472s - loss: 0.0618 - val_loss: 0.0037
 - val_f1: 0.9985
 - out_of_sample_accuracy: 0.9188
Epoch 2/100
 - 26s - loss: 0.0030 - val_loss: 0.0014
2020-01-13 23:56:33,055 [INFO] StopperOnGoal: reached goal_metric (accuracy). Stopping training. goal_metric = 0.9221, current_metric = 0.9223, num_epochs = 2
2020-01-13 23:56:33,127 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-13 23:56:57,937 [INFO] Last epoch loss evaluation: train_loss = 0.001388, val_loss = 0.001404
2020-01-13 23:56:57,951 [INFO] Training complete. time_to_train = 719.39 sec, 11.99 min
2020-01-13 23:56:59,836 [INFO] Model saved to results_additional_exps/train_time_kdd99_lstm_shallow_rep3/best_model.pickle
2020-01-13 23:57:01,248 [INFO] Training history saved to: results_additional_exps/train_time_kdd99_lstm_shallow_rep3/training_error_history.csv
2020-01-13 23:57:07,511 [INFO] Plot saved to: results_additional_exps/train_time_kdd99_lstm_shallow_rep3/training_error_history.png
2020-01-13 23:57:07,664 [INFO] Plot saved to: results_additional_exps/train_time_kdd99_lstm_shallow_rep3/training_f1_history.png
2020-01-13 23:57:07,675 [INFO] Making predictions on training, validation, testing data
2020-01-13 23:57:32,596 [INFO] Making predictions complete. time_to_predict = 24.92 sec, 0.42 min
2020-01-13 23:57:33,895 [INFO] Evaluating predictions (results)
2020-01-13 23:57:43,844 [INFO] Dataset: Testing. Classification report below
2020-01-13 23:57:43,844 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      0.97      0.98    229853
     normal.       0.73      0.99      0.84     60580
       probe       0.73      0.75      0.74      4166
         r2l       0.89      0.04      0.08     13773
         u2r       0.45      0.00      0.01      2636

    accuracy                           0.92    311008
   macro avg       0.76      0.55      0.53    311008
weighted avg       0.93      0.92      0.90    311008

2020-01-13 23:57:43,845 [INFO] Overall accuracy (micro avg): 0.9228797973042494
2020-01-13 23:57:53,462 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9229         0.9229                       0.9229                0.0193                   0.0771  0.9229
1     Macro avg        0.9692         0.7605                       0.5514                0.0198                   0.4486  0.5303
2  Weighted avg        0.9667         0.9327                       0.9229                0.0220                   0.0771  0.9048
2020-01-13 23:58:22,991 [INFO] Dataset: Validation. Classification report below
2020-01-13 23:58:22,991 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00    776671
     normal.       1.00      1.00      1.00    194553
       probe       0.99      0.97      0.98      8221
         r2l       0.72      0.16      0.26       225
         u2r       0.00      0.00      0.00        10

    accuracy                           1.00    979680
   macro avg       0.74      0.62      0.65    979680
weighted avg       1.00      1.00      1.00    979680

2020-01-13 23:58:22,991 [INFO] Overall accuracy (micro avg): 0.9992650661440471
2020-01-13 23:58:53,853 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9993         0.9993                       0.9993                0.0002                   0.0007  0.9993
1     Macro avg        0.9997         0.7415                       0.6249                0.0003                   0.3751  0.6475
2  Weighted avg        0.9997         0.9992                       0.9993                0.0008                   0.0007  0.9992
2020-01-14 00:00:59,168 [INFO] Dataset: Training. Classification report below
2020-01-14 00:00:59,168 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00   3106675
     normal.       1.00      1.00      1.00    778221
       probe       0.99      0.96      0.98     32881
         r2l       0.70      0.13      0.22       901
         u2r       0.60      0.29      0.39        42

    accuracy                           1.00   3918720
   macro avg       0.86      0.68      0.72   3918720
weighted avg       1.00      1.00      1.00   3918720

2020-01-14 00:00:59,168 [INFO] Overall accuracy (micro avg): 0.9992576657684141
2020-01-14 00:03:13,772 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9993         0.9993                       0.9993                0.0002                   0.0007  0.9993
1     Macro avg        0.9997         0.8586                       0.6758                0.0003                   0.3242  0.7164
2  Weighted avg        0.9997         0.9992                       0.9993                0.0008                   0.0007  0.9992
2020-01-14 00:03:15,226 [INFO] Results saved to: results_additional_exps/train_time_kdd99_lstm_shallow_rep3/train_time_kdd99_lstm_shallow_rep3_results.xlsx
2020-01-14 00:03:15,234 [INFO] ================= Finished running experiment no. 3 ================= 

2020-01-14 00:03:15,574 [INFO] Created directory: results_additional_exps/train_time_ids18_subset_lstm_shallow_rep1
2020-01-14 00:03:15,807 [INFO] Initialized logging. log_filename = results_additional_exps/train_time_ids18_subset_lstm_shallow_rep1/run_log.log
2020-01-14 00:03:15,807 [INFO] ================= Running experiment no. 1  ================= 

2020-01-14 00:03:15,807 [INFO] Experiment parameters given below
2020-01-14 00:03:15,808 [INFO] 
{'experiment_num': 1, 'results_dir': 'results_additional_exps/train_time_ids18_subset_lstm_shallow_rep1', 'model': 'lstm', 'model_type': 'classifier', 'normal_label': 'BENIGN', 'lstm_time_steps': 32, 'lstm_layer_units': [32], 'lstm_layer_activations': ['relu'], 'lstm_layer_dropout_rates': [0.2], 'batch_size': 256, 'epochs': 100, 'early_stop_patience': 100, 'goal_metric': 0.982977526, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/ids2018', 'description': 'train_time_ids18_subset_lstm_shallow_rep1'}
2020-01-14 00:03:15,848 [INFO] Created tensorboard log directory: results_additional_exps/train_time_ids18_subset_lstm_shallow_rep1/tf_logs_run_2020_01_14-00_03_15
2020-01-14 00:03:15,849 [INFO] Loading datsets from: ../Datasets/small_datasets/ids2018
2020-01-14 00:03:16,007 [INFO] Reading X, y files
2020-01-14 00:03:16,014 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_train.h5
2020-01-14 00:03:31,559 [INFO] Reading complete. time_to_read=15.55 seconds
2020-01-14 00:03:31,559 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_val.h5
2020-01-14 00:03:35,881 [INFO] Reading complete. time_to_read=4.32 seconds
2020-01-14 00:03:35,881 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_test.h5
2020-01-14 00:03:40,231 [INFO] Reading complete. time_to_read=4.35 seconds
2020-01-14 00:03:40,231 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_train.h5
2020-01-14 00:03:43,993 [INFO] Reading complete. time_to_read=3.76 seconds
2020-01-14 00:03:43,993 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_val.h5
2020-01-14 00:03:44,333 [INFO] Reading complete. time_to_read=0.34 seconds
2020-01-14 00:03:44,333 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_test.h5
2020-01-14 00:03:44,675 [INFO] Reading complete. time_to_read=0.34 seconds
2020-01-14 00:03:47,664 [INFO] Preparing flow sequences
2020-01-14 00:04:12,124 [INFO] Extracting flows complete. time_taken = 24.46 sec
2020-01-14 00:04:13,362 [INFO] Initializing model
2020-01-14 00:04:14,222 [INFO] _________________________________________________________________
2020-01-14 00:04:14,222 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-14 00:04:14,222 [INFO] =================================================================
2020-01-14 00:04:14,222 [INFO] lstm_10 (LSTM)               (None, 32, 32)            14080     
2020-01-14 00:04:14,222 [INFO] _________________________________________________________________
2020-01-14 00:04:14,222 [INFO] batch_normalization_10 (Batc (None, 32, 32)            128       
2020-01-14 00:04:14,222 [INFO] _________________________________________________________________
2020-01-14 00:04:14,223 [INFO] dropout_10 (Dropout)         (None, 32, 32)            0         
2020-01-14 00:04:14,223 [INFO] _________________________________________________________________
2020-01-14 00:04:14,223 [INFO] time_distributed_10 (TimeDis (None, 32, 15)            495       
2020-01-14 00:04:14,223 [INFO] =================================================================
2020-01-14 00:04:14,235 [INFO] Total params: 14,703
2020-01-14 00:04:14,236 [INFO] Trainable params: 14,639
2020-01-14 00:04:14,236 [INFO] Non-trainable params: 64
2020-01-14 00:04:14,236 [INFO] _________________________________________________________________
2020-01-14 00:04:14,236 [INFO] Training model
 - val_f1: 0.9992
 - out_of_sample_accuracy: 0.9223
Train on 60514 samples, validate on 20171 samples
Epoch 1/100
 - 13s - loss: 0.1261 - val_loss: 0.0430
 - val_f1: 0.8507
 - out_of_sample_accuracy: 0.8461
Epoch 2/100
 - 11s - loss: 0.0239 - val_loss: 0.0216
 - val_f1: 0.9428
 - out_of_sample_accuracy: 0.9544
Epoch 3/100
 - 11s - loss: 0.0147 - val_loss: 0.0145
 - val_f1: 0.9567
 - out_of_sample_accuracy: 0.9621
Epoch 4/100
 - 11s - loss: 0.0124 - val_loss: 0.0123
 - val_f1: 0.9645
 - out_of_sample_accuracy: 0.9700
Epoch 5/100
 - 11s - loss: 0.0113 - val_loss: 0.0106
 - val_f1: 0.9742
 - out_of_sample_accuracy: 0.9781
Epoch 6/100
 - 11s - loss: 0.0107 - val_loss: 0.0098
 - val_f1: 0.9758
 - out_of_sample_accuracy: 0.9800
Epoch 7/100
 - 11s - loss: 0.0102 - val_loss: 0.0088
 - val_f1: 0.9766
 - out_of_sample_accuracy: 0.9815
Epoch 8/100
 - 11s - loss: 0.0095 - val_loss: 0.0087
 - val_f1: 0.9771
 - out_of_sample_accuracy: 0.9819
Epoch 9/100
 - 11s - loss: 0.0093 - val_loss: 0.0085
 - val_f1: 0.9771
 - out_of_sample_accuracy: 0.9820
Epoch 10/100
 - 11s - loss: 0.0091 - val_loss: 0.0085
 - val_f1: 0.9772
 - out_of_sample_accuracy: 0.9822
Epoch 11/100
 - 11s - loss: 0.0090 - val_loss: 0.0084
2020-01-14 00:08:20,693 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/train_time_ids18_subset_lstm_shallow_rep1/_model_epoch_10.pickle
 - val_f1: 0.9773
 - out_of_sample_accuracy: 0.9824
Epoch 12/100
 - 11s - loss: 0.0089 - val_loss: 0.0084
 - val_f1: 0.9756
 - out_of_sample_accuracy: 0.9806
Epoch 13/100
 - 11s - loss: 0.0088 - val_loss: 0.0083
 - val_f1: 0.9774
 - out_of_sample_accuracy: 0.9823
Epoch 14/100
 - 11s - loss: 0.0087 - val_loss: 0.0083
 - val_f1: 0.9759
 - out_of_sample_accuracy: 0.9810
Epoch 15/100
 - 11s - loss: 0.0087 - val_loss: 0.0083
 - val_f1: 0.9773
 - out_of_sample_accuracy: 0.9822
Epoch 16/100
 - 11s - loss: 0.0086 - val_loss: 0.0083
 - val_f1: 0.9759
 - out_of_sample_accuracy: 0.9809
Epoch 17/100
 - 11s - loss: 0.0086 - val_loss: 0.0084
 - val_f1: 0.9764
 - out_of_sample_accuracy: 0.9812
Epoch 18/100
 - 11s - loss: 0.0085 - val_loss: 0.0083
 - val_f1: 0.9769
 - out_of_sample_accuracy: 0.9820
Epoch 19/100
 - 11s - loss: 0.0085 - val_loss: 0.0084
 - val_f1: 0.9762
 - out_of_sample_accuracy: 0.9811
Epoch 20/100
 - 11s - loss: 0.0085 - val_loss: 0.0083
 - val_f1: 0.9762
 - out_of_sample_accuracy: 0.9810
Epoch 21/100
 - 11s - loss: 0.0084 - val_loss: 0.0083
2020-01-14 00:11:29,381 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/train_time_ids18_subset_lstm_shallow_rep1/_model_epoch_20.pickle
 - val_f1: 0.9764
 - out_of_sample_accuracy: 0.9814
Epoch 22/100
 - 11s - loss: 0.0084 - val_loss: 0.0083
 - val_f1: 0.9767
 - out_of_sample_accuracy: 0.9817
Epoch 23/100
 - 11s - loss: 0.0083 - val_loss: 0.0083
 - val_f1: 0.9765
 - out_of_sample_accuracy: 0.9814
Epoch 24/100
 - 11s - loss: 0.0083 - val_loss: 0.0082
 - val_f1: 0.9771
 - out_of_sample_accuracy: 0.9820
Epoch 25/100
 - 11s - loss: 0.0083 - val_loss: 0.0082
 - val_f1: 0.9767
 - out_of_sample_accuracy: 0.9816
Epoch 26/100
 - 11s - loss: 0.0083 - val_loss: 0.0082
 - val_f1: 0.9771
 - out_of_sample_accuracy: 0.9822
Epoch 27/100
 - 11s - loss: 0.0083 - val_loss: 0.0084
 - val_f1: 0.9762
 - out_of_sample_accuracy: 0.9813
Epoch 28/100
 - 11s - loss: 0.0083 - val_loss: 0.0083
 - val_f1: 0.9769
 - out_of_sample_accuracy: 0.9817
Epoch 29/100
 - 11s - loss: 0.0082 - val_loss: 0.0084
 - val_f1: 0.9763
 - out_of_sample_accuracy: 0.9813
Epoch 30/100
 - 11s - loss: 0.0082 - val_loss: 0.0083
 - val_f1: 0.9765
 - out_of_sample_accuracy: 0.9815
Epoch 31/100
 - 11s - loss: 0.0082 - val_loss: 0.0083
2020-01-14 00:14:30,090 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/train_time_ids18_subset_lstm_shallow_rep1/_model_epoch_30.pickle
 - val_f1: 0.9767
 - out_of_sample_accuracy: 0.9816
Epoch 32/100
 - 11s - loss: 0.0082 - val_loss: 0.0083
 - val_f1: 0.9765
 - out_of_sample_accuracy: 0.9814
Epoch 33/100
 - 11s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9769
 - out_of_sample_accuracy: 0.9818
Epoch 34/100
 - 11s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9767
 - out_of_sample_accuracy: 0.9816
Epoch 35/100
 - 11s - loss: 0.0082 - val_loss: 0.0084
 - val_f1: 0.9764
 - out_of_sample_accuracy: 0.9815
Epoch 36/100
 - 11s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9776
 - out_of_sample_accuracy: 0.9828
Epoch 37/100
 - 11s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9776
 - out_of_sample_accuracy: 0.9827
Epoch 38/100
 - 11s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9775
 - out_of_sample_accuracy: 0.9827
Epoch 39/100
 - 11s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9776
 - out_of_sample_accuracy: 0.9828
Epoch 40/100
 - 11s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9777
 - out_of_sample_accuracy: 0.9829
Epoch 41/100
 - 11s - loss: 0.0081 - val_loss: 0.0080
2020-01-14 00:17:30,732 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/train_time_ids18_subset_lstm_shallow_rep1/_model_epoch_40.pickle
 - val_f1: 0.9775
 - out_of_sample_accuracy: 0.9827
Epoch 42/100
 - 11s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9776
 - out_of_sample_accuracy: 0.9827
Epoch 43/100
 - 11s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9773
 - out_of_sample_accuracy: 0.9824
Epoch 44/100
 - 11s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9776
 - out_of_sample_accuracy: 0.9828
Epoch 45/100
 - 11s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9778
 - out_of_sample_accuracy: 0.9829
Epoch 46/100
 - 11s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9777
 - out_of_sample_accuracy: 0.9829
Epoch 47/100
 - 11s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9776
 - out_of_sample_accuracy: 0.9828
Epoch 48/100
 - 11s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9776
 - out_of_sample_accuracy: 0.9828
Epoch 49/100
 - 11s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9777
 - out_of_sample_accuracy: 0.9829
Epoch 50/100
 - 11s - loss: 0.0080 - val_loss: 0.0082
 - val_f1: 0.9774
 - out_of_sample_accuracy: 0.9826
Epoch 51/100
 - 11s - loss: 0.0080 - val_loss: 0.0080
2020-01-14 00:20:31,325 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/train_time_ids18_subset_lstm_shallow_rep1/_model_epoch_50.pickle
 - val_f1: 0.9777
 - out_of_sample_accuracy: 0.9829
Epoch 52/100
 - 11s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9777
 - out_of_sample_accuracy: 0.9829
Epoch 53/100
 - 11s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9774
 - out_of_sample_accuracy: 0.9826
Epoch 54/100
 - 11s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9775
 - out_of_sample_accuracy: 0.9825
Epoch 55/100
 - 11s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9776
 - out_of_sample_accuracy: 0.9827
Epoch 56/100
 - 11s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9772
 - out_of_sample_accuracy: 0.9820
Epoch 57/100
 - 11s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9777
 - out_of_sample_accuracy: 0.9829
Epoch 58/100
 - 11s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9776
 - out_of_sample_accuracy: 0.9828
Epoch 59/100
 - 11s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9774
 - out_of_sample_accuracy: 0.9822
Epoch 60/100
 - 11s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9777
 - out_of_sample_accuracy: 0.9829
Epoch 61/100
 - 11s - loss: 0.0080 - val_loss: 0.0082
2020-01-14 00:23:32,137 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/train_time_ids18_subset_lstm_shallow_rep1/_model_epoch_60.pickle
 - val_f1: 0.9769
 - out_of_sample_accuracy: 0.9817
Epoch 62/100
 - 11s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9778
 - out_of_sample_accuracy: 0.9829
Epoch 63/100
 - 11s - loss: 0.0080 - val_loss: 0.0079
2020-01-14 00:24:15,713 [INFO] StopperOnGoal: reached goal_metric (accuracy). Stopping training. goal_metric = 0.9830, current_metric = 0.9830, num_epochs = 63
2020-01-14 00:24:15,714 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-14 00:24:28,674 [INFO] Last epoch loss evaluation: train_loss = 0.007809, val_loss = 0.007886
2020-01-14 00:24:28,674 [INFO] Training complete. time_to_train = 1214.44 sec, 20.24 min
2020-01-14 00:24:28,679 [INFO] Model saved to results_additional_exps/train_time_ids18_subset_lstm_shallow_rep1/best_model.pickle
2020-01-14 00:24:28,715 [INFO] Training history saved to: results_additional_exps/train_time_ids18_subset_lstm_shallow_rep1/training_error_history.csv
2020-01-14 00:24:28,975 [INFO] Plot saved to: results_additional_exps/train_time_ids18_subset_lstm_shallow_rep1/training_error_history.png
2020-01-14 00:24:29,113 [INFO] Plot saved to: results_additional_exps/train_time_ids18_subset_lstm_shallow_rep1/training_f1_history.png
2020-01-14 00:24:29,113 [INFO] Making predictions on training, validation, testing data
2020-01-14 00:24:43,611 [INFO] Making predictions complete. time_to_predict = 14.50 sec, 0.24 min
2020-01-14 00:24:43,699 [INFO] Evaluating predictions (results)
2020-01-14 00:25:05,122 [INFO] Dataset: Testing. Classification report below
2020-01-14 00:25:05,122 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535639
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       1.00      0.12      0.22        24
        Brute Force -XSS       1.00      0.33      0.50         9
        DDOS attack-HOIC       1.00      1.00      1.00     27446
    DDOS attack-LOIC-UDP       0.69      0.36      0.47        67
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23008
   DoS attacks-GoldenEye       0.99      1.00      0.99      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18477
DoS attacks-SlowHTTPTest       0.73      0.45      0.55      5596
   DoS attacks-Slowloris       0.99      0.75      0.85       440
          FTP-BruteForce       0.69      0.88      0.77      7718
           Infilteration       0.50      0.00      0.00      6403
           SQL Injection       0.00      0.00      0.00         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

                accuracy                           0.98    645472
               macro avg       0.84      0.66      0.69    645472
            weighted avg       0.98      0.98      0.98    645472

2020-01-14 00:25:05,122 [INFO] Overall accuracy (micro avg): 0.9828729983639879
2020-01-14 00:25:28,288 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9829         0.9829                       0.9829                0.0012                   0.0171  0.9829
1     Macro avg        0.9977         0.8375                       0.6584                0.0046                   0.3416  0.6899
2  Weighted avg        0.9908         0.9782                       0.9829                0.0516                   0.0171  0.9776
2020-01-14 00:25:49,940 [INFO] Dataset: Validation. Classification report below
2020-01-14 00:25:49,940 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535636
                     Bot       1.00      1.00      1.00     11464
        Brute Force -Web       1.00      0.20      0.33        25
        Brute Force -XSS       0.86      0.67      0.75         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.60      0.22      0.32        68
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23009
   DoS attacks-GoldenEye       0.99      1.00      1.00      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.75      0.44      0.56      5596
   DoS attacks-Slowloris       0.99      0.81      0.89       439
          FTP-BruteForce       0.69      0.89      0.78      7718
           Infilteration       0.41      0.00      0.00      6403
           SQL Injection       0.00      0.00      0.00         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

                accuracy                           0.98    645472
               macro avg       0.82      0.68      0.71    645472
            weighted avg       0.98      0.98      0.98    645472

2020-01-14 00:25:49,940 [INFO] Overall accuracy (micro avg): 0.983013980467007
2020-01-14 00:26:13,255 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9830         0.9830                       0.9830                0.0012                   0.0170  0.9830
1     Macro avg        0.9977         0.8173                       0.6812                0.0045                   0.3188  0.7072
2  Weighted avg        0.9908         0.9775                       0.9830                0.0512                   0.0170  0.9777
2020-01-14 00:27:23,770 [INFO] Dataset: Training. Classification report below
2020-01-14 00:27:23,770 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99   1606935
                     Bot       1.00      1.00      1.00     34396
        Brute Force -Web       1.00      0.12      0.22        73
        Brute Force -XSS       1.00      0.50      0.67        26
        DDOS attack-HOIC       1.00      1.00      1.00     82341
    DDOS attack-LOIC-UDP       0.80      0.39      0.53       203
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     69029
   DoS attacks-GoldenEye       0.99      1.00      1.00      4954
        DoS attacks-Hulk       1.00      1.00      1.00     55435
DoS attacks-SlowHTTPTest       0.74      0.44      0.55     16787
   DoS attacks-Slowloris       0.99      0.79      0.88      1318
          FTP-BruteForce       0.69      0.89      0.77     23153
           Infilteration       0.71      0.00      0.00     19210
           SQL Injection       0.00      0.00      0.00        12
          SSH-Bruteforce       1.00      1.00      1.00     22576

                accuracy                           0.98   1936448
               macro avg       0.86      0.67      0.71   1936448
            weighted avg       0.98      0.98      0.98   1936448

2020-01-14 00:27:23,770 [INFO] Overall accuracy (micro avg): 0.9830121955250025
2020-01-14 00:28:40,048 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9830         0.9830                       0.9830                0.0012                   0.0170  0.9830
1     Macro avg        0.9977         0.8600                       0.6750                0.0045                   0.3250  0.7069
2  Weighted avg        0.9909         0.9804                       0.9830                0.0512                   0.0170  0.9777
2020-01-14 00:28:40,124 [INFO] Results saved to: results_additional_exps/train_time_ids18_subset_lstm_shallow_rep1/train_time_ids18_subset_lstm_shallow_rep1_results.xlsx
2020-01-14 00:28:40,129 [INFO] ================= Finished running experiment no. 1 ================= 

2020-01-14 00:28:40,217 [INFO] Created directory: results_additional_exps/train_time_ids18_subset_lstm_shallow_rep2
2020-01-14 00:28:40,218 [INFO] Initialized logging. log_filename = results_additional_exps/train_time_ids18_subset_lstm_shallow_rep2/run_log.log
2020-01-14 00:28:40,218 [INFO] ================= Running experiment no. 2  ================= 

2020-01-14 00:28:40,218 [INFO] Experiment parameters given below
2020-01-14 00:28:40,218 [INFO] 
{'experiment_num': 2, 'results_dir': 'results_additional_exps/train_time_ids18_subset_lstm_shallow_rep2', 'model': 'lstm', 'model_type': 'classifier', 'normal_label': 'BENIGN', 'lstm_time_steps': 32, 'lstm_layer_units': [32], 'lstm_layer_activations': ['relu'], 'lstm_layer_dropout_rates': [0.2], 'batch_size': 256, 'epochs': 100, 'early_stop_patience': 100, 'goal_metric': 0.982977526, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/ids2018', 'description': 'train_time_ids18_subset_lstm_shallow_rep2'}
2020-01-14 00:28:40,218 [INFO] Created tensorboard log directory: results_additional_exps/train_time_ids18_subset_lstm_shallow_rep2/tf_logs_run_2020_01_14-00_28_40
2020-01-14 00:28:40,218 [INFO] Loading datsets from: ../Datasets/small_datasets/ids2018
2020-01-14 00:28:40,218 [INFO] Reading X, y files
2020-01-14 00:28:40,218 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_train.h5
2020-01-14 00:28:50,339 [INFO] Reading complete. time_to_read=10.12 seconds
2020-01-14 00:28:50,339 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_val.h5
2020-01-14 00:28:54,224 [INFO] Reading complete. time_to_read=3.88 seconds
2020-01-14 00:28:54,224 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_test.h5
2020-01-14 00:28:58,012 [INFO] Reading complete. time_to_read=3.79 seconds
2020-01-14 00:28:58,012 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_train.h5
2020-01-14 00:28:58,880 [INFO] Reading complete. time_to_read=0.87 seconds
2020-01-14 00:28:58,881 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_val.h5
2020-01-14 00:28:59,191 [INFO] Reading complete. time_to_read=0.31 seconds
2020-01-14 00:28:59,191 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_test.h5
2020-01-14 00:28:59,528 [INFO] Reading complete. time_to_read=0.34 seconds
2020-01-14 00:29:02,266 [INFO] Preparing flow sequences
2020-01-14 00:29:26,622 [INFO] Extracting flows complete. time_taken = 24.36 sec
2020-01-14 00:29:27,872 [INFO] Initializing model
2020-01-14 00:29:28,130 [INFO] _________________________________________________________________
2020-01-14 00:29:28,130 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-14 00:29:28,130 [INFO] =================================================================
2020-01-14 00:29:28,130 [INFO] lstm_11 (LSTM)               (None, 32, 32)            14080     
2020-01-14 00:29:28,130 [INFO] _________________________________________________________________
2020-01-14 00:29:28,130 [INFO] batch_normalization_11 (Batc (None, 32, 32)            128       
2020-01-14 00:29:28,131 [INFO] _________________________________________________________________
2020-01-14 00:29:28,131 [INFO] dropout_11 (Dropout)         (None, 32, 32)            0         
2020-01-14 00:29:28,131 [INFO] _________________________________________________________________
2020-01-14 00:29:28,131 [INFO] time_distributed_11 (TimeDis (None, 32, 15)            495       
2020-01-14 00:29:28,131 [INFO] =================================================================
2020-01-14 00:29:28,131 [INFO] Total params: 14,703
2020-01-14 00:29:28,131 [INFO] Trainable params: 14,639
2020-01-14 00:29:28,131 [INFO] Non-trainable params: 64
2020-01-14 00:29:28,131 [INFO] _________________________________________________________________
2020-01-14 00:29:28,131 [INFO] Training model
 - val_f1: 0.9777
 - out_of_sample_accuracy: 0.9830
Train on 60514 samples, validate on 20171 samples
Epoch 1/100
 - 13s - loss: 0.1395 - val_loss: 0.0489
 - val_f1: 0.8544
 - out_of_sample_accuracy: 0.8554
Epoch 2/100
 - 11s - loss: 0.0354 - val_loss: 0.0270
 - val_f1: 0.9194
 - out_of_sample_accuracy: 0.9226
Epoch 3/100
 - 11s - loss: 0.0228 - val_loss: 0.0178
 - val_f1: 0.9551
 - out_of_sample_accuracy: 0.9609
Epoch 4/100
 - 11s - loss: 0.0180 - val_loss: 0.0141
 - val_f1: 0.9624
 - out_of_sample_accuracy: 0.9661
Epoch 5/100
 - 11s - loss: 0.0150 - val_loss: 0.0137
 - val_f1: 0.9582
 - out_of_sample_accuracy: 0.9646
Epoch 6/100
 - 11s - loss: 0.0134 - val_loss: 0.0115
 - val_f1: 0.9725
 - out_of_sample_accuracy: 0.9761
Epoch 7/100
 - 11s - loss: 0.0124 - val_loss: 0.0110
 - val_f1: 0.9726
 - out_of_sample_accuracy: 0.9766
Epoch 8/100
 - 11s - loss: 0.0117 - val_loss: 0.0103
 - val_f1: 0.9747
 - out_of_sample_accuracy: 0.9788
Epoch 9/100
 - 11s - loss: 0.0112 - val_loss: 0.0103
 - val_f1: 0.9741
 - out_of_sample_accuracy: 0.9782
Epoch 10/100
 - 11s - loss: 0.0109 - val_loss: 0.0096
 - val_f1: 0.9754
 - out_of_sample_accuracy: 0.9795
Epoch 11/100
 - 11s - loss: 0.0104 - val_loss: 0.0094
2020-01-14 00:32:58,430 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/train_time_ids18_subset_lstm_shallow_rep2/_model_epoch_10.pickle
 - val_f1: 0.9756
 - out_of_sample_accuracy: 0.9798
Epoch 12/100
 - 11s - loss: 0.0101 - val_loss: 0.0094
 - val_f1: 0.9752
 - out_of_sample_accuracy: 0.9794
Epoch 13/100
 - 11s - loss: 0.0099 - val_loss: 0.0091
 - val_f1: 0.9758
 - out_of_sample_accuracy: 0.9800
Epoch 14/100
 - 11s - loss: 0.0097 - val_loss: 0.0091
 - val_f1: 0.9764
 - out_of_sample_accuracy: 0.9805
Epoch 15/100
 - 11s - loss: 0.0096 - val_loss: 0.0094
 - val_f1: 0.9754
 - out_of_sample_accuracy: 0.9797
Epoch 16/100
 - 11s - loss: 0.0095 - val_loss: 0.0091
 - val_f1: 0.9740
 - out_of_sample_accuracy: 0.9788
Epoch 17/100
 - 11s - loss: 0.0094 - val_loss: 0.0091
 - val_f1: 0.9756
 - out_of_sample_accuracy: 0.9805
Epoch 18/100
 - 11s - loss: 0.0093 - val_loss: 0.0090
 - val_f1: 0.9758
 - out_of_sample_accuracy: 0.9800
Epoch 19/100
 - 11s - loss: 0.0092 - val_loss: 0.0092
 - val_f1: 0.9759
 - out_of_sample_accuracy: 0.9804
Epoch 20/100
 - 11s - loss: 0.0091 - val_loss: 0.0089
 - val_f1: 0.9743
 - out_of_sample_accuracy: 0.9791
Epoch 21/100
 - 11s - loss: 0.0091 - val_loss: 0.0088
2020-01-14 00:36:00,055 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/train_time_ids18_subset_lstm_shallow_rep2/_model_epoch_20.pickle
 - val_f1: 0.9764
 - out_of_sample_accuracy: 0.9806
Epoch 22/100
 - 11s - loss: 0.0090 - val_loss: 0.0087
 - val_f1: 0.9763
 - out_of_sample_accuracy: 0.9810
Epoch 23/100
 - 11s - loss: 0.0089 - val_loss: 0.0087
 - val_f1: 0.9749
 - out_of_sample_accuracy: 0.9796
Epoch 24/100
 - 11s - loss: 0.0089 - val_loss: 0.0103
 - val_f1: 0.9706
 - out_of_sample_accuracy: 0.9752
Epoch 25/100
 - 11s - loss: 0.0089 - val_loss: 0.0102
 - val_f1: 0.9678
 - out_of_sample_accuracy: 0.9734
Epoch 26/100
 - 11s - loss: 0.0088 - val_loss: 0.0104
 - val_f1: 0.9653
 - out_of_sample_accuracy: 0.9712
Epoch 27/100
 - 11s - loss: 0.0088 - val_loss: 0.0106
 - val_f1: 0.9634
 - out_of_sample_accuracy: 0.9701
Epoch 28/100
 - 11s - loss: 0.0087 - val_loss: 0.0099
 - val_f1: 0.9707
 - out_of_sample_accuracy: 0.9755
Epoch 29/100
 - 11s - loss: 0.0087 - val_loss: 0.0104
 - val_f1: 0.9658
 - out_of_sample_accuracy: 0.9717
Epoch 30/100
 - 11s - loss: 0.0086 - val_loss: 0.0096
 - val_f1: 0.9743
 - out_of_sample_accuracy: 0.9786
Epoch 31/100
 - 11s - loss: 0.0086 - val_loss: 0.0101
2020-01-14 00:39:01,519 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/train_time_ids18_subset_lstm_shallow_rep2/_model_epoch_30.pickle
 - val_f1: 0.9676
 - out_of_sample_accuracy: 0.9735
Epoch 32/100
 - 11s - loss: 0.0086 - val_loss: 0.0099
 - val_f1: 0.9691
 - out_of_sample_accuracy: 0.9739
Epoch 33/100
 - 11s - loss: 0.0085 - val_loss: 0.0095
 - val_f1: 0.9744
 - out_of_sample_accuracy: 0.9792
Epoch 34/100
 - 11s - loss: 0.0085 - val_loss: 0.0095
 - val_f1: 0.9724
 - out_of_sample_accuracy: 0.9773
Epoch 35/100
 - 11s - loss: 0.0085 - val_loss: 0.0094
 - val_f1: 0.9735
 - out_of_sample_accuracy: 0.9783
Epoch 36/100
 - 11s - loss: 0.0085 - val_loss: 0.0091
 - val_f1: 0.9760
 - out_of_sample_accuracy: 0.9808
Epoch 37/100
 - 11s - loss: 0.0084 - val_loss: 0.0094
 - val_f1: 0.9738
 - out_of_sample_accuracy: 0.9787
Epoch 38/100
 - 11s - loss: 0.0084 - val_loss: 0.0091
 - val_f1: 0.9760
 - out_of_sample_accuracy: 0.9809
Epoch 39/100
 - 11s - loss: 0.0084 - val_loss: 0.0094
 - val_f1: 0.9742
 - out_of_sample_accuracy: 0.9789
Epoch 40/100
 - 11s - loss: 0.0084 - val_loss: 0.0094
 - val_f1: 0.9721
 - out_of_sample_accuracy: 0.9770
Epoch 41/100
 - 11s - loss: 0.0083 - val_loss: 0.0090
2020-01-14 00:42:03,005 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/train_time_ids18_subset_lstm_shallow_rep2/_model_epoch_40.pickle
 - val_f1: 0.9757
 - out_of_sample_accuracy: 0.9807
Epoch 42/100
 - 11s - loss: 0.0083 - val_loss: 0.0097
 - val_f1: 0.9691
 - out_of_sample_accuracy: 0.9745
Epoch 43/100
 - 11s - loss: 0.0083 - val_loss: 0.0097
 - val_f1: 0.9694
 - out_of_sample_accuracy: 0.9747
Epoch 44/100
 - 11s - loss: 0.0083 - val_loss: 0.0104
 - val_f1: 0.9665
 - out_of_sample_accuracy: 0.9727
Epoch 45/100
 - 11s - loss: 0.0083 - val_loss: 0.0097
 - val_f1: 0.9682
 - out_of_sample_accuracy: 0.9741
Epoch 46/100
 - 11s - loss: 0.0083 - val_loss: 0.0090
 - val_f1: 0.9761
 - out_of_sample_accuracy: 0.9811
Epoch 47/100
 - 11s - loss: 0.0082 - val_loss: 0.0088
 - val_f1: 0.9763
 - out_of_sample_accuracy: 0.9812
Epoch 48/100
 - 11s - loss: 0.0083 - val_loss: 0.0084
 - val_f1: 0.9770
 - out_of_sample_accuracy: 0.9819
Epoch 49/100
 - 11s - loss: 0.0082 - val_loss: 0.0097
 - val_f1: 0.9682
 - out_of_sample_accuracy: 0.9735
Epoch 50/100
 - 11s - loss: 0.0082 - val_loss: 0.0095
 - val_f1: 0.9696
 - out_of_sample_accuracy: 0.9750
Epoch 51/100
 - 11s - loss: 0.0082 - val_loss: 0.0088
2020-01-14 00:45:04,595 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/train_time_ids18_subset_lstm_shallow_rep2/_model_epoch_50.pickle
 - val_f1: 0.9761
 - out_of_sample_accuracy: 0.9808
Epoch 52/100
 - 14s - loss: 0.0082 - val_loss: 0.0090
 - val_f1: 0.9747
 - out_of_sample_accuracy: 0.9795
Epoch 53/100
 - 11s - loss: 0.0082 - val_loss: 0.0089
 - val_f1: 0.9760
 - out_of_sample_accuracy: 0.9810
Epoch 54/100
 - 11s - loss: 0.0082 - val_loss: 0.0087
 - val_f1: 0.9766
 - out_of_sample_accuracy: 0.9818
Epoch 55/100
 - 11s - loss: 0.0082 - val_loss: 0.0098
 - val_f1: 0.9670
 - out_of_sample_accuracy: 0.9730
Epoch 56/100
 - 11s - loss: 0.0082 - val_loss: 0.0093
 - val_f1: 0.9709
 - out_of_sample_accuracy: 0.9762
Epoch 57/100
 - 11s - loss: 0.0081 - val_loss: 0.0087
 - val_f1: 0.9765
 - out_of_sample_accuracy: 0.9815
Epoch 58/100
 - 11s - loss: 0.0081 - val_loss: 0.0094
 - val_f1: 0.9692
 - out_of_sample_accuracy: 0.9748
Epoch 59/100
 - 11s - loss: 0.0081 - val_loss: 0.0087
 - val_f1: 0.9764
 - out_of_sample_accuracy: 0.9815
Epoch 60/100
 - 11s - loss: 0.0081 - val_loss: 0.0091
 - val_f1: 0.9722
 - out_of_sample_accuracy: 0.9772
Epoch 61/100
 - 11s - loss: 0.0081 - val_loss: 0.0086
2020-01-14 00:48:09,425 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/train_time_ids18_subset_lstm_shallow_rep2/_model_epoch_60.pickle
 - val_f1: 0.9765
 - out_of_sample_accuracy: 0.9814
Epoch 62/100
 - 11s - loss: 0.0081 - val_loss: 0.0097
 - val_f1: 0.9674
 - out_of_sample_accuracy: 0.9737
Epoch 63/100
 - 11s - loss: 0.0081 - val_loss: 0.0087
 - val_f1: 0.9764
 - out_of_sample_accuracy: 0.9815
Epoch 64/100
 - 11s - loss: 0.0081 - val_loss: 0.0092
 - val_f1: 0.9736
 - out_of_sample_accuracy: 0.9785
Epoch 65/100
 - 11s - loss: 0.0081 - val_loss: 0.0097
 - val_f1: 0.9681
 - out_of_sample_accuracy: 0.9735
Epoch 66/100
 - 11s - loss: 0.0081 - val_loss: 0.0090
 - val_f1: 0.9754
 - out_of_sample_accuracy: 0.9803
Epoch 67/100
 - 11s - loss: 0.0081 - val_loss: 0.0093
 - val_f1: 0.9715
 - out_of_sample_accuracy: 0.9765
Epoch 68/100
 - 11s - loss: 0.0081 - val_loss: 0.0086
 - val_f1: 0.9766
 - out_of_sample_accuracy: 0.9818
Epoch 69/100
 - 11s - loss: 0.0081 - val_loss: 0.0103
 - val_f1: 0.9664
 - out_of_sample_accuracy: 0.9724
Epoch 70/100
 - 11s - loss: 0.0081 - val_loss: 0.0096
 - val_f1: 0.9697
 - out_of_sample_accuracy: 0.9750
Epoch 71/100
 - 11s - loss: 0.0081 - val_loss: 0.0100
2020-01-14 00:51:10,935 [INFO] epoch = 70. Intermediate model saved to results_additional_exps/train_time_ids18_subset_lstm_shallow_rep2/_model_epoch_70.pickle
 - val_f1: 0.9670
 - out_of_sample_accuracy: 0.9733
Epoch 72/100
 - 11s - loss: 0.0081 - val_loss: 0.0090
 - val_f1: 0.9757
 - out_of_sample_accuracy: 0.9801
Epoch 73/100
 - 11s - loss: 0.0080 - val_loss: 0.0087
 - val_f1: 0.9762
 - out_of_sample_accuracy: 0.9808
Epoch 74/100
 - 11s - loss: 0.0080 - val_loss: 0.0094
 - val_f1: 0.9696
 - out_of_sample_accuracy: 0.9751
Epoch 75/100
 - 11s - loss: 0.0080 - val_loss: 0.0083
 - val_f1: 0.9767
 - out_of_sample_accuracy: 0.9817
Epoch 76/100
 - 14s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9775
 - out_of_sample_accuracy: 0.9827
Epoch 77/100
 - 11s - loss: 0.0080 - val_loss: 0.0083
 - val_f1: 0.9766
 - out_of_sample_accuracy: 0.9818
Epoch 78/100
 - 11s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9771
 - out_of_sample_accuracy: 0.9823
Epoch 79/100
 - 11s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9776
 - out_of_sample_accuracy: 0.9829
Epoch 80/100
 - 11s - loss: 0.0080 - val_loss: 0.0079
2020-01-14 00:54:04,747 [INFO] StopperOnGoal: reached goal_metric (accuracy). Stopping training. goal_metric = 0.9830, current_metric = 0.9832, num_epochs = 80
2020-01-14 00:54:04,748 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-14 00:54:17,825 [INFO] Last epoch loss evaluation: train_loss = 0.007849, val_loss = 0.007928
2020-01-14 00:54:17,826 [INFO] Training complete. time_to_train = 1489.69 sec, 24.83 min
2020-01-14 00:54:17,830 [INFO] Model saved to results_additional_exps/train_time_ids18_subset_lstm_shallow_rep2/best_model.pickle
2020-01-14 00:54:17,860 [INFO] Training history saved to: results_additional_exps/train_time_ids18_subset_lstm_shallow_rep2/training_error_history.csv
/home/nilwala/sunanda/ids_experiments/utility.py:289: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  plt.figure()
2020-01-14 00:54:18,099 [INFO] Plot saved to: results_additional_exps/train_time_ids18_subset_lstm_shallow_rep2/training_error_history.png
/home/nilwala/sunanda/ids_experiments/utility.py:306: RuntimeWarning: More than 20 figures have been opened. Figures created through the pyplot interface (`matplotlib.pyplot.figure`) are retained until explicitly closed and may consume too much memory. (To control this warning, see the rcParam `figure.max_open_warning`).
  plt.figure()
2020-01-14 00:54:18,246 [INFO] Plot saved to: results_additional_exps/train_time_ids18_subset_lstm_shallow_rep2/training_f1_history.png
2020-01-14 00:54:18,246 [INFO] Making predictions on training, validation, testing data
2020-01-14 00:54:32,851 [INFO] Making predictions complete. time_to_predict = 14.60 sec, 0.24 min
2020-01-14 00:54:32,919 [INFO] Evaluating predictions (results)
2020-01-14 00:54:54,060 [INFO] Dataset: Testing. Classification report below
2020-01-14 00:54:54,060 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535639
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       1.00      0.12      0.22        24
        Brute Force -XSS       0.75      0.33      0.46         9
        DDOS attack-HOIC       1.00      1.00      1.00     27446
    DDOS attack-LOIC-UDP       0.71      0.70      0.71        67
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23008
   DoS attacks-GoldenEye       0.99      1.00      1.00      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18477
DoS attacks-SlowHTTPTest       0.72      0.49      0.58      5596
   DoS attacks-Slowloris       0.93      0.97      0.95       440
          FTP-BruteForce       0.70      0.86      0.77      7718
           Infilteration       0.57      0.01      0.01      6403
           SQL Injection       0.00      0.00      0.00         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

                accuracy                           0.98    645472
               macro avg       0.82      0.70      0.71    645472
            weighted avg       0.98      0.98      0.98    645472

2020-01-14 00:54:54,060 [INFO] Overall accuracy (micro avg): 0.9832091864558029
2020-01-14 00:55:16,883 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9832         0.9832                       0.9832                0.0012                   0.0168  0.9832
1     Macro avg        0.9978         0.8239                       0.6980                0.0045                   0.3020  0.7125
2  Weighted avg        0.9909         0.9792                       0.9832                0.0501                   0.0168  0.9781
2020-01-14 00:55:38,608 [INFO] Dataset: Validation. Classification report below
2020-01-14 00:55:38,608 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535636
                     Bot       1.00      1.00      1.00     11464
        Brute Force -Web       1.00      0.20      0.33        25
        Brute Force -XSS       1.00      0.67      0.80         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.71      0.50      0.59        68
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23009
   DoS attacks-GoldenEye       0.99      1.00      0.99      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.73      0.48      0.58      5596
   DoS attacks-Slowloris       0.93      0.97      0.95       439
          FTP-BruteForce       0.70      0.87      0.78      7718
           Infilteration       0.45      0.00      0.01      6403
           SQL Injection       0.00      0.00      0.00         4
          SSH-Bruteforce       1.00      0.99      1.00      7525

                accuracy                           0.98    645472
               macro avg       0.83      0.71      0.73    645472
            weighted avg       0.98      0.98      0.98    645472

2020-01-14 00:55:38,608 [INFO] Overall accuracy (micro avg): 0.9831843983937336
2020-01-14 00:56:01,993 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9832         0.9832                       0.9832                0.0012                   0.0168  0.9832
1     Macro avg        0.9978         0.8321                       0.7117                0.0045                   0.2883  0.7338
2  Weighted avg        0.9909         0.9780                       0.9832                0.0504                   0.0168  0.9781
2020-01-14 00:57:12,392 [INFO] Dataset: Training. Classification report below
2020-01-14 00:57:12,392 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99   1606935
                     Bot       1.00      1.00      1.00     34396
        Brute Force -Web       1.00      0.12      0.22        73
        Brute Force -XSS       0.93      0.50      0.65        26
        DDOS attack-HOIC       1.00      1.00      1.00     82341
    DDOS attack-LOIC-UDP       0.72      0.57      0.64       203
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     69029
   DoS attacks-GoldenEye       0.99      1.00      1.00      4954
        DoS attacks-Hulk       1.00      1.00      1.00     55435
DoS attacks-SlowHTTPTest       0.73      0.49      0.58     16787
   DoS attacks-Slowloris       0.95      0.99      0.97      1318
          FTP-BruteForce       0.70      0.87      0.77     23153
           Infilteration       0.59      0.01      0.01     19210
           SQL Injection       0.00      0.00      0.00        12
          SSH-Bruteforce       1.00      1.00      1.00     22576

                accuracy                           0.98   1936448
               macro avg       0.84      0.70      0.72   1936448
            weighted avg       0.98      0.98      0.98   1936448

2020-01-14 00:57:12,392 [INFO] Overall accuracy (micro avg): 0.9833003519846647
2020-01-14 00:58:28,263 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9833         0.9833                       0.9833                0.0012                   0.0167  0.9833
1     Macro avg        0.9978         0.8396                       0.7017                0.0044                   0.2983  0.7217
2  Weighted avg        0.9910         0.9795                       0.9833                0.0500                   0.0167  0.9782
2020-01-14 00:58:28,325 [INFO] Results saved to: results_additional_exps/train_time_ids18_subset_lstm_shallow_rep2/train_time_ids18_subset_lstm_shallow_rep2_results.xlsx
2020-01-14 00:58:28,330 [INFO] ================= Finished running experiment no. 2 ================= 

2020-01-14 00:58:28,415 [INFO] Created directory: results_additional_exps/train_time_ids18_subset_lstm_shallow_rep3
2020-01-14 00:58:28,415 [INFO] Initialized logging. log_filename = results_additional_exps/train_time_ids18_subset_lstm_shallow_rep3/run_log.log
2020-01-14 00:58:28,415 [INFO] ================= Running experiment no. 3  ================= 

2020-01-14 00:58:28,415 [INFO] Experiment parameters given below
2020-01-14 00:58:28,415 [INFO] 
{'experiment_num': 3, 'results_dir': 'results_additional_exps/train_time_ids18_subset_lstm_shallow_rep3', 'model': 'lstm', 'model_type': 'classifier', 'normal_label': 'BENIGN', 'lstm_time_steps': 32, 'lstm_layer_units': [32], 'lstm_layer_activations': ['relu'], 'lstm_layer_dropout_rates': [0.2], 'batch_size': 256, 'epochs': 100, 'early_stop_patience': 100, 'goal_metric': 0.982977526, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/ids2018', 'description': 'train_time_ids18_subset_lstm_shallow_rep3'}
2020-01-14 00:58:28,415 [INFO] Created tensorboard log directory: results_additional_exps/train_time_ids18_subset_lstm_shallow_rep3/tf_logs_run_2020_01_14-00_58_28
2020-01-14 00:58:28,415 [INFO] Loading datsets from: ../Datasets/small_datasets/ids2018
2020-01-14 00:58:28,416 [INFO] Reading X, y files
2020-01-14 00:58:28,416 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_train.h5
2020-01-14 00:58:38,144 [INFO] Reading complete. time_to_read=9.73 seconds
2020-01-14 00:58:38,144 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_val.h5
2020-01-14 00:58:42,268 [INFO] Reading complete. time_to_read=4.12 seconds
2020-01-14 00:58:42,268 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_test.h5
2020-01-14 00:58:46,193 [INFO] Reading complete. time_to_read=3.92 seconds
2020-01-14 00:58:46,193 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_train.h5
2020-01-14 00:58:46,666 [INFO] Reading complete. time_to_read=0.47 seconds
2020-01-14 00:58:46,666 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_val.h5
2020-01-14 00:58:47,017 [INFO] Reading complete. time_to_read=0.35 seconds
2020-01-14 00:58:47,017 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_test.h5
2020-01-14 00:58:47,285 [INFO] Reading complete. time_to_read=0.27 seconds
2020-01-14 00:58:49,924 [INFO] Preparing flow sequences
2020-01-14 00:59:14,363 [INFO] Extracting flows complete. time_taken = 24.44 sec
2020-01-14 00:59:15,606 [INFO] Initializing model
2020-01-14 00:59:15,828 [INFO] _________________________________________________________________
2020-01-14 00:59:15,829 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-14 00:59:15,829 [INFO] =================================================================
2020-01-14 00:59:15,829 [INFO] lstm_12 (LSTM)               (None, 32, 32)            14080     
2020-01-14 00:59:15,829 [INFO] _________________________________________________________________
2020-01-14 00:59:15,829 [INFO] batch_normalization_12 (Batc (None, 32, 32)            128       
2020-01-14 00:59:15,829 [INFO] _________________________________________________________________
2020-01-14 00:59:15,829 [INFO] dropout_12 (Dropout)         (None, 32, 32)            0         
2020-01-14 00:59:15,829 [INFO] _________________________________________________________________
2020-01-14 00:59:15,829 [INFO] time_distributed_12 (TimeDis (None, 32, 15)            495       
2020-01-14 00:59:15,829 [INFO] =================================================================
2020-01-14 00:59:15,829 [INFO] Total params: 14,703
2020-01-14 00:59:15,829 [INFO] Trainable params: 14,639
2020-01-14 00:59:15,829 [INFO] Non-trainable params: 64
2020-01-14 00:59:15,829 [INFO] _________________________________________________________________
2020-01-14 00:59:15,829 [INFO] Training model
 - val_f1: 0.9781
 - out_of_sample_accuracy: 0.9832
Train on 60514 samples, validate on 20171 samples
Epoch 1/100
 - 13s - loss: 0.1252 - val_loss: 0.0453
 - val_f1: 0.8490
 - out_of_sample_accuracy: 0.8269
Epoch 2/100
 - 11s - loss: 0.0213 - val_loss: 0.0204
 - val_f1: 0.9403
 - out_of_sample_accuracy: 0.9444
Epoch 3/100
 - 11s - loss: 0.0135 - val_loss: 0.0155
 - val_f1: 0.9586
 - out_of_sample_accuracy: 0.9637
Epoch 4/100
 - 11s - loss: 0.0115 - val_loss: 0.0146
 - val_f1: 0.9597
 - out_of_sample_accuracy: 0.9647
Epoch 5/100
 - 11s - loss: 0.0105 - val_loss: 0.0118
 - val_f1: 0.9690
 - out_of_sample_accuracy: 0.9715
Epoch 6/100
 - 11s - loss: 0.0099 - val_loss: 0.0100
 - val_f1: 0.9751
 - out_of_sample_accuracy: 0.9792
Epoch 7/100
 - 11s - loss: 0.0096 - val_loss: 0.0107
 - val_f1: 0.9734
 - out_of_sample_accuracy: 0.9773
Epoch 8/100
 - 11s - loss: 0.0093 - val_loss: 0.0096
 - val_f1: 0.9748
 - out_of_sample_accuracy: 0.9792
Epoch 9/100
 - 11s - loss: 0.0091 - val_loss: 0.0102
 - val_f1: 0.9724
 - out_of_sample_accuracy: 0.9764
Epoch 10/100
 - 11s - loss: 0.0090 - val_loss: 0.0096
 - val_f1: 0.9746
 - out_of_sample_accuracy: 0.9791
Epoch 11/100
 - 11s - loss: 0.0089 - val_loss: 0.0097
2020-01-14 01:02:36,793 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/train_time_ids18_subset_lstm_shallow_rep3/_model_epoch_10.pickle
 - val_f1: 0.9744
 - out_of_sample_accuracy: 0.9792
Epoch 12/100
 - 11s - loss: 0.0088 - val_loss: 0.0093
 - val_f1: 0.9749
 - out_of_sample_accuracy: 0.9798
Epoch 13/100
 - 11s - loss: 0.0087 - val_loss: 0.0095
 - val_f1: 0.9745
 - out_of_sample_accuracy: 0.9790
Epoch 14/100
 - 11s - loss: 0.0087 - val_loss: 0.0094
 - val_f1: 0.9740
 - out_of_sample_accuracy: 0.9784
Epoch 15/100
 - 11s - loss: 0.0086 - val_loss: 0.0099
 - val_f1: 0.9683
 - out_of_sample_accuracy: 0.9735
Epoch 16/100
 - 11s - loss: 0.0085 - val_loss: 0.0103
 - val_f1: 0.9678
 - out_of_sample_accuracy: 0.9729
Epoch 17/100
 - 11s - loss: 0.0085 - val_loss: 0.0088
 - val_f1: 0.9764
 - out_of_sample_accuracy: 0.9810
Epoch 18/100
 - 11s - loss: 0.0085 - val_loss: 0.0091
 - val_f1: 0.9752
 - out_of_sample_accuracy: 0.9800
Epoch 19/100
 - 11s - loss: 0.0085 - val_loss: 0.0099
 - val_f1: 0.9723
 - out_of_sample_accuracy: 0.9771
Epoch 20/100
 - 11s - loss: 0.0084 - val_loss: 0.0094
 - val_f1: 0.9743
 - out_of_sample_accuracy: 0.9793
Epoch 21/100
 - 11s - loss: 0.0084 - val_loss: 0.0091
2020-01-14 01:05:38,682 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/train_time_ids18_subset_lstm_shallow_rep3/_model_epoch_20.pickle
 - val_f1: 0.9750
 - out_of_sample_accuracy: 0.9800
Epoch 22/100
 - 11s - loss: 0.0084 - val_loss: 0.0092
 - val_f1: 0.9743
 - out_of_sample_accuracy: 0.9793
Epoch 23/100
 - 11s - loss: 0.0083 - val_loss: 0.0093
 - val_f1: 0.9741
 - out_of_sample_accuracy: 0.9792
Epoch 24/100
 - 11s - loss: 0.0083 - val_loss: 0.0097
 - val_f1: 0.9739
 - out_of_sample_accuracy: 0.9787
Epoch 25/100
 - 11s - loss: 0.0083 - val_loss: 0.0091
 - val_f1: 0.9749
 - out_of_sample_accuracy: 0.9799
Epoch 26/100
 - 11s - loss: 0.0084 - val_loss: 0.0093
 - val_f1: 0.9742
 - out_of_sample_accuracy: 0.9793
Epoch 27/100
 - 11s - loss: 0.0083 - val_loss: 0.0089
 - val_f1: 0.9753
 - out_of_sample_accuracy: 0.9806
Epoch 28/100
 - 11s - loss: 0.0082 - val_loss: 0.0085
 - val_f1: 0.9775
 - out_of_sample_accuracy: 0.9826
Epoch 29/100
 - 11s - loss: 0.0082 - val_loss: 0.0086
 - val_f1: 0.9768
 - out_of_sample_accuracy: 0.9819
Epoch 30/100
 - 11s - loss: 0.0082 - val_loss: 0.0085
 - val_f1: 0.9771
 - out_of_sample_accuracy: 0.9823
Epoch 31/100
 - 11s - loss: 0.0082 - val_loss: 0.0084
2020-01-14 01:08:40,410 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/train_time_ids18_subset_lstm_shallow_rep3/_model_epoch_30.pickle
 - val_f1: 0.9771
 - out_of_sample_accuracy: 0.9822
Epoch 32/100
 - 11s - loss: 0.0082 - val_loss: 0.0085
 - val_f1: 0.9776
 - out_of_sample_accuracy: 0.9827
Epoch 33/100
 - 11s - loss: 0.0081 - val_loss: 0.0085
 - val_f1: 0.9778
 - out_of_sample_accuracy: 0.9828
Epoch 34/100
 - 11s - loss: 0.0081 - val_loss: 0.0084
 - val_f1: 0.9771
 - out_of_sample_accuracy: 0.9824
Epoch 35/100
 - 11s - loss: 0.0081 - val_loss: 0.0084
 - val_f1: 0.9772
 - out_of_sample_accuracy: 0.9823
Epoch 36/100
 - 11s - loss: 0.0081 - val_loss: 0.0085
 - val_f1: 0.9775
 - out_of_sample_accuracy: 0.9826
Epoch 37/100
 - 11s - loss: 0.0081 - val_loss: 0.0083
 - val_f1: 0.9777
 - out_of_sample_accuracy: 0.9829
Epoch 38/100
 - 11s - loss: 0.0081 - val_loss: 0.0090
 - val_f1: 0.9753
 - out_of_sample_accuracy: 0.9805
Epoch 39/100
 - 11s - loss: 0.0081 - val_loss: 0.0086
 - val_f1: 0.9765
 - out_of_sample_accuracy: 0.9816
Epoch 40/100
 - 11s - loss: 0.0081 - val_loss: 0.0084
 - val_f1: 0.9774
 - out_of_sample_accuracy: 0.9825
Epoch 41/100
 - 11s - loss: 0.0081 - val_loss: 0.0084
2020-01-14 01:11:42,251 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/train_time_ids18_subset_lstm_shallow_rep3/_model_epoch_40.pickle
 - val_f1: 0.9771
 - out_of_sample_accuracy: 0.9823
Epoch 42/100
 - 13s - loss: 0.0081 - val_loss: 0.0084
 - val_f1: 0.9772
 - out_of_sample_accuracy: 0.9822
Epoch 43/100
 - 11s - loss: 0.0081 - val_loss: 0.0084
 - val_f1: 0.9771
 - out_of_sample_accuracy: 0.9822
Epoch 44/100
 - 11s - loss: 0.0080 - val_loss: 0.0083
 - val_f1: 0.9778
 - out_of_sample_accuracy: 0.9828
Epoch 45/100
 - 11s - loss: 0.0080 - val_loss: 0.0083
 - val_f1: 0.9777
 - out_of_sample_accuracy: 0.9828
Epoch 46/100
 - 11s - loss: 0.0080 - val_loss: 0.0083
 - val_f1: 0.9776
 - out_of_sample_accuracy: 0.9827
Epoch 47/100
 - 11s - loss: 0.0080 - val_loss: 0.0082
 - val_f1: 0.9777
 - out_of_sample_accuracy: 0.9828
Epoch 48/100
 - 11s - loss: 0.0080 - val_loss: 0.0084
 - val_f1: 0.9774
 - out_of_sample_accuracy: 0.9826
Epoch 49/100
 - 11s - loss: 0.0080 - val_loss: 0.0082
 - val_f1: 0.9777
 - out_of_sample_accuracy: 0.9828
Epoch 50/100
 - 11s - loss: 0.0080 - val_loss: 0.0082
 - val_f1: 0.9777
 - out_of_sample_accuracy: 0.9828
Epoch 51/100
 - 11s - loss: 0.0080 - val_loss: 0.0083
2020-01-14 01:14:46,311 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/train_time_ids18_subset_lstm_shallow_rep3/_model_epoch_50.pickle
 - val_f1: 0.9776
 - out_of_sample_accuracy: 0.9828
Epoch 52/100
 - 11s - loss: 0.0080 - val_loss: 0.0082
 - val_f1: 0.9777
 - out_of_sample_accuracy: 0.9829
Epoch 53/100
 - 11s - loss: 0.0080 - val_loss: 0.0082
 - val_f1: 0.9776
 - out_of_sample_accuracy: 0.9828
Epoch 54/100
 - 11s - loss: 0.0080 - val_loss: 0.0082
 - val_f1: 0.9778
 - out_of_sample_accuracy: 0.9829
Epoch 55/100
 - 11s - loss: 0.0080 - val_loss: 0.0082
 - val_f1: 0.9777
 - out_of_sample_accuracy: 0.9828
Epoch 56/100
 - 11s - loss: 0.0080 - val_loss: 0.0081
2020-01-14 01:16:24,696 [INFO] StopperOnGoal: reached goal_metric (accuracy). Stopping training. goal_metric = 0.9830, current_metric = 0.9830, num_epochs = 56
2020-01-14 01:16:24,698 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-14 01:16:37,897 [INFO] Last epoch loss evaluation: train_loss = 0.008076, val_loss = 0.008146
2020-01-14 01:16:37,898 [INFO] Training complete. time_to_train = 1042.07 sec, 17.37 min
2020-01-14 01:16:37,901 [INFO] Model saved to results_additional_exps/train_time_ids18_subset_lstm_shallow_rep3/best_model.pickle
2020-01-14 01:16:37,903 [INFO] Training history saved to: results_additional_exps/train_time_ids18_subset_lstm_shallow_rep3/training_error_history.csv
2020-01-14 01:16:38,048 [INFO] Plot saved to: results_additional_exps/train_time_ids18_subset_lstm_shallow_rep3/training_error_history.png
2020-01-14 01:16:38,183 [INFO] Plot saved to: results_additional_exps/train_time_ids18_subset_lstm_shallow_rep3/training_f1_history.png
2020-01-14 01:16:38,184 [INFO] Making predictions on training, validation, testing data
2020-01-14 01:16:52,952 [INFO] Making predictions complete. time_to_predict = 14.77 sec, 0.25 min
2020-01-14 01:16:53,021 [INFO] Evaluating predictions (results)
2020-01-14 01:17:14,339 [INFO] Dataset: Testing. Classification report below
2020-01-14 01:17:14,340 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535639
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       1.00      0.04      0.08        24
        Brute Force -XSS       1.00      0.22      0.36         9
        DDOS attack-HOIC       1.00      1.00      1.00     27446
    DDOS attack-LOIC-UDP       0.70      0.10      0.18        67
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23008
   DoS attacks-GoldenEye       0.99      0.98      0.99      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18477
DoS attacks-SlowHTTPTest       0.74      0.45      0.56      5596
   DoS attacks-Slowloris       0.99      0.75      0.85       440
          FTP-BruteForce       0.69      0.89      0.78      7718
           Infilteration       0.83      0.00      0.00      6403
           SQL Injection       1.00      0.25      0.40         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

                accuracy                           0.98    645472
               macro avg       0.93      0.65      0.68    645472
            weighted avg       0.98      0.98      0.98    645472

2020-01-14 01:17:14,340 [INFO] Overall accuracy (micro avg): 0.9829969386743345
2020-01-14 01:17:37,337 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9830         0.9830                       0.9830                0.0012                   0.0170  0.9830
1     Macro avg        0.9977         0.9279                       0.6452                0.0045                   0.3548  0.6790
2  Weighted avg        0.9908         0.9816                       0.9830                0.0510                   0.0170  0.9777
2020-01-14 01:17:58,936 [INFO] Dataset: Validation. Classification report below
2020-01-14 01:17:58,937 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535636
                     Bot       1.00      1.00      1.00     11464
        Brute Force -Web       1.00      0.08      0.15        25
        Brute Force -XSS       1.00      0.67      0.80         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.71      0.07      0.13        68
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23009
   DoS attacks-GoldenEye       0.99      0.98      0.99      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.76      0.45      0.56      5596
   DoS attacks-Slowloris       0.98      0.81      0.89       439
          FTP-BruteForce       0.69      0.90      0.78      7718
           Infilteration       0.38      0.00      0.00      6403
           SQL Injection       0.00      0.00      0.00         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

                accuracy                           0.98    645472
               macro avg       0.83      0.66      0.69    645472
            weighted avg       0.98      0.98      0.98    645472

2020-01-14 01:17:58,937 [INFO] Overall accuracy (micro avg): 0.9831441177928709
2020-01-14 01:18:22,218 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9831         0.9831                       0.9831                0.0012                   0.0169  0.9831
1     Macro avg        0.9978         0.8325                       0.6631                0.0045                   0.3369  0.6856
2  Weighted avg        0.9909         0.9773                       0.9831                0.0506                   0.0169  0.9778
2020-01-14 01:19:32,515 [INFO] Dataset: Training. Classification report below
2020-01-14 01:19:32,516 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99   1606935
                     Bot       1.00      1.00      1.00     34396
        Brute Force -Web       1.00      0.08      0.15        73
        Brute Force -XSS       1.00      0.46      0.63        26
        DDOS attack-HOIC       1.00      1.00      1.00     82341
    DDOS attack-LOIC-UDP       0.77      0.10      0.17       203
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     69029
   DoS attacks-GoldenEye       0.99      0.99      0.99      4954
        DoS attacks-Hulk       1.00      1.00      1.00     55435
DoS attacks-SlowHTTPTest       0.75      0.45      0.56     16787
   DoS attacks-Slowloris       0.99      0.79      0.88      1318
          FTP-BruteForce       0.69      0.89      0.78     23153
           Infilteration       0.60      0.00      0.00     19210
           SQL Injection       0.00      0.00      0.00        12
          SSH-Bruteforce       1.00      1.00      1.00     22576

                accuracy                           0.98   1936448
               macro avg       0.85      0.65      0.68   1936448
            weighted avg       0.98      0.98      0.98   1936448

2020-01-14 01:19:32,516 [INFO] Overall accuracy (micro avg): 0.9831304532835377
2020-01-14 01:20:48,311 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9831         0.9831                       0.9831                0.0012                   0.0169  0.9831
1     Macro avg        0.9978         0.8516                       0.6498                0.0045                   0.3502  0.6767
2  Weighted avg        0.9909         0.9795                       0.9831                0.0507                   0.0169  0.9778
2020-01-14 01:20:48,372 [INFO] Results saved to: results_additional_exps/train_time_ids18_subset_lstm_shallow_rep3/train_time_ids18_subset_lstm_shallow_rep3_results.xlsx
2020-01-14 01:20:48,377 [INFO] ================= Finished running experiment no. 3 ================= 

2020-01-14 01:20:48,459 [INFO] ================= Finished running 12 experiments ================= 

 - val_f1: 0.9778
 - out_of_sample_accuracy: 0.9830
