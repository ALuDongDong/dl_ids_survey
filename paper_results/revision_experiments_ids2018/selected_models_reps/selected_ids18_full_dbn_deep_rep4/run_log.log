2020-05-09 20:37:05,359 [INFO] Initialized logging. log_filename = results_selected_models/selected_ids18_full_dbn_deep_rep4/run_log.log
2020-05-09 20:37:05,359 [INFO] ================= Running experiment no. 4  ================= 

2020-05-09 20:37:05,359 [INFO] Experiment parameters given below
2020-05-09 20:37:05,360 [INFO] 
{'experiment_num': 4, 'results_dir': 'results_selected_models/selected_ids18_full_dbn_deep_rep4', 'model_type': 'classifier', 'model': 'dbn', 'normal_label': 'BENIGN', 'scaling_type': 'NA', 'dbn_layer_units': [128, 64, 35], 'ann_layer_activations': ['relu', 'relu', 'relu'], 'ann_layer_dropout_rates': [0.2, 0.2, 0.5], 'unsupervised_ratio': 0.5, 'dbn_learning_rate': 0.0001, 'pretrain_epochs': 12, 'fine_tune_epochs': 80, 'early_stop_patience': 20, 'batch_size': 8192, 'dataset_dir': '../Datasets/full_datasets/ids2018', 'description': 'selected_ids18_full_dbn_deep_rep4'}
2020-05-09 20:37:05,360 [INFO] Created tensorboard log directory: results_selected_models/selected_ids18_full_dbn_deep_rep4/tf_logs_run_2020_05_09-20_37_05
2020-05-09 20:37:05,361 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2018
2020-05-09 20:37:05,361 [INFO] Reading X, y files
2020-05-09 20:37:05,361 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_1.h5
2020-05-09 20:37:06,803 [INFO] Reading complete. time_to_read=1.44 seconds
2020-05-09 20:37:06,804 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_10.h5
2020-05-09 20:37:08,249 [INFO] Reading complete. time_to_read=1.45 seconds
2020-05-09 20:37:08,250 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_11.h5
2020-05-09 20:37:09,697 [INFO] Reading complete. time_to_read=1.45 seconds
2020-05-09 20:37:09,697 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_12.h5
2020-05-09 20:37:10,983 [INFO] Reading complete. time_to_read=1.29 seconds
2020-05-09 20:37:10,983 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_13.h5
2020-05-09 20:37:11,833 [INFO] Reading complete. time_to_read=0.85 seconds
2020-05-09 20:37:11,834 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_2.h5
2020-05-09 20:37:13,146 [INFO] Reading complete. time_to_read=1.31 seconds
2020-05-09 20:37:13,146 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_3.h5
2020-05-09 20:37:14,587 [INFO] Reading complete. time_to_read=1.44 seconds
2020-05-09 20:37:14,587 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_4.h5
2020-05-09 20:37:17,345 [INFO] Reading complete. time_to_read=2.76 seconds
2020-05-09 20:37:17,345 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_5.h5
2020-05-09 20:37:20,058 [INFO] Reading complete. time_to_read=2.71 seconds
2020-05-09 20:37:20,058 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_6.h5
2020-05-09 20:37:22,764 [INFO] Reading complete. time_to_read=2.71 seconds
2020-05-09 20:37:22,764 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_7.h5
2020-05-09 20:37:25,485 [INFO] Reading complete. time_to_read=2.72 seconds
2020-05-09 20:37:25,485 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_8.h5
2020-05-09 20:37:25,942 [INFO] Reading complete. time_to_read=0.46 seconds
2020-05-09 20:37:25,942 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_9.h5
2020-05-09 20:37:27,377 [INFO] Reading complete. time_to_read=1.44 seconds
2020-05-09 20:37:27,377 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_1.h5
2020-05-09 20:37:27,861 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-09 20:37:27,861 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_10.h5
2020-05-09 20:37:28,346 [INFO] Reading complete. time_to_read=0.49 seconds
2020-05-09 20:37:28,346 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_11.h5
2020-05-09 20:37:28,831 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-09 20:37:28,831 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_12.h5
2020-05-09 20:37:29,264 [INFO] Reading complete. time_to_read=0.43 seconds
2020-05-09 20:37:29,264 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_13.h5
2020-05-09 20:37:29,542 [INFO] Reading complete. time_to_read=0.28 seconds
2020-05-09 20:37:29,542 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_2.h5
2020-05-09 20:37:29,983 [INFO] Reading complete. time_to_read=0.44 seconds
2020-05-09 20:37:29,983 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_3.h5
2020-05-09 20:37:30,467 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-09 20:37:30,468 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_4.h5
2020-05-09 20:37:31,388 [INFO] Reading complete. time_to_read=0.92 seconds
2020-05-09 20:37:31,388 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_5.h5
2020-05-09 20:37:32,293 [INFO] Reading complete. time_to_read=0.90 seconds
2020-05-09 20:37:32,293 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_6.h5
2020-05-09 20:37:33,200 [INFO] Reading complete. time_to_read=0.91 seconds
2020-05-09 20:37:33,200 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_7.h5
2020-05-09 20:37:34,114 [INFO] Reading complete. time_to_read=0.91 seconds
2020-05-09 20:37:34,114 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_8.h5
2020-05-09 20:37:34,270 [INFO] Reading complete. time_to_read=0.16 seconds
2020-05-09 20:37:34,270 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_9.h5
2020-05-09 20:37:34,752 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-09 20:37:34,752 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_1.h5
2020-05-09 20:37:35,235 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-09 20:37:35,235 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_10.h5
2020-05-09 20:37:35,721 [INFO] Reading complete. time_to_read=0.49 seconds
2020-05-09 20:37:35,721 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_11.h5
2020-05-09 20:37:36,205 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-09 20:37:36,205 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_12.h5
2020-05-09 20:37:36,638 [INFO] Reading complete. time_to_read=0.43 seconds
2020-05-09 20:37:36,638 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_13.h5
2020-05-09 20:37:36,919 [INFO] Reading complete. time_to_read=0.28 seconds
2020-05-09 20:37:36,919 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_2.h5
2020-05-09 20:37:37,359 [INFO] Reading complete. time_to_read=0.44 seconds
2020-05-09 20:37:37,359 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_3.h5
2020-05-09 20:37:37,846 [INFO] Reading complete. time_to_read=0.49 seconds
2020-05-09 20:37:37,846 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_4.h5
2020-05-09 20:37:38,772 [INFO] Reading complete. time_to_read=0.93 seconds
2020-05-09 20:37:38,773 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_5.h5
2020-05-09 20:37:39,679 [INFO] Reading complete. time_to_read=0.91 seconds
2020-05-09 20:37:39,679 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_6.h5
2020-05-09 20:37:40,587 [INFO] Reading complete. time_to_read=0.91 seconds
2020-05-09 20:37:40,587 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_7.h5
2020-05-09 20:37:41,497 [INFO] Reading complete. time_to_read=0.91 seconds
2020-05-09 20:37:41,497 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_8.h5
2020-05-09 20:37:41,653 [INFO] Reading complete. time_to_read=0.16 seconds
2020-05-09 20:37:41,653 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_9.h5
2020-05-09 20:37:42,135 [INFO] Reading complete. time_to_read=0.48 seconds
2020-05-09 20:37:42,135 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_1.h5
2020-05-09 20:37:42,442 [INFO] Reading complete. time_to_read=0.31 seconds
2020-05-09 20:37:42,442 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_10.h5
2020-05-09 20:37:42,758 [INFO] Reading complete. time_to_read=0.32 seconds
2020-05-09 20:37:42,758 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_11.h5
2020-05-09 20:37:43,077 [INFO] Reading complete. time_to_read=0.32 seconds
2020-05-09 20:37:43,077 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_12.h5
2020-05-09 20:37:43,416 [INFO] Reading complete. time_to_read=0.34 seconds
2020-05-09 20:37:43,416 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_13.h5
2020-05-09 20:37:43,601 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-09 20:37:43,602 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_2.h5
2020-05-09 20:37:43,955 [INFO] Reading complete. time_to_read=0.35 seconds
2020-05-09 20:37:43,955 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_3.h5
2020-05-09 20:37:44,274 [INFO] Reading complete. time_to_read=0.32 seconds
2020-05-09 20:37:44,274 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_4.h5
2020-05-09 20:37:44,909 [INFO] Reading complete. time_to_read=0.63 seconds
2020-05-09 20:37:44,909 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_5.h5
2020-05-09 20:37:45,460 [INFO] Reading complete. time_to_read=0.55 seconds
2020-05-09 20:37:45,460 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_6.h5
2020-05-09 20:37:46,016 [INFO] Reading complete. time_to_read=0.56 seconds
2020-05-09 20:37:46,016 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_7.h5
2020-05-09 20:37:46,568 [INFO] Reading complete. time_to_read=0.55 seconds
2020-05-09 20:37:46,568 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_8.h5
2020-05-09 20:37:46,725 [INFO] Reading complete. time_to_read=0.16 seconds
2020-05-09 20:37:46,725 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_9.h5
2020-05-09 20:37:47,044 [INFO] Reading complete. time_to_read=0.32 seconds
2020-05-09 20:37:47,044 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_1.h5
2020-05-09 20:37:47,151 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-09 20:37:47,151 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_10.h5
2020-05-09 20:37:47,261 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-09 20:37:47,261 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_11.h5
2020-05-09 20:37:47,371 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-09 20:37:47,371 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_12.h5
2020-05-09 20:37:47,488 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-09 20:37:47,488 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_13.h5
2020-05-09 20:37:47,553 [INFO] Reading complete. time_to_read=0.07 seconds
2020-05-09 20:37:47,553 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_2.h5
2020-05-09 20:37:47,673 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-09 20:37:47,673 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_3.h5
2020-05-09 20:37:47,783 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-09 20:37:47,784 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_4.h5
2020-05-09 20:37:48,000 [INFO] Reading complete. time_to_read=0.22 seconds
2020-05-09 20:37:48,000 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_5.h5
2020-05-09 20:37:48,191 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-09 20:37:48,192 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_6.h5
2020-05-09 20:37:48,384 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-09 20:37:48,384 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_7.h5
2020-05-09 20:37:48,604 [INFO] Reading complete. time_to_read=0.22 seconds
2020-05-09 20:37:48,604 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_8.h5
2020-05-09 20:37:48,644 [INFO] Reading complete. time_to_read=0.04 seconds
2020-05-09 20:37:48,644 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_9.h5
2020-05-09 20:37:48,757 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-09 20:37:48,757 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_1.h5
2020-05-09 20:37:48,863 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-09 20:37:48,863 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_10.h5
2020-05-09 20:37:48,973 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-09 20:37:48,974 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_11.h5
2020-05-09 20:37:49,085 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-09 20:37:49,085 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_12.h5
2020-05-09 20:37:49,202 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-09 20:37:49,202 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_13.h5
2020-05-09 20:37:49,267 [INFO] Reading complete. time_to_read=0.06 seconds
2020-05-09 20:37:49,267 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_2.h5
2020-05-09 20:37:49,389 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-09 20:37:49,389 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_3.h5
2020-05-09 20:37:49,499 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-09 20:37:49,499 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_4.h5
2020-05-09 20:37:49,721 [INFO] Reading complete. time_to_read=0.22 seconds
2020-05-09 20:37:49,721 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_5.h5
2020-05-09 20:37:49,913 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-09 20:37:49,913 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_6.h5
2020-05-09 20:37:50,122 [INFO] Reading complete. time_to_read=0.21 seconds
2020-05-09 20:37:50,122 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_7.h5
2020-05-09 20:37:50,318 [INFO] Reading complete. time_to_read=0.20 seconds
2020-05-09 20:37:50,318 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_8.h5
2020-05-09 20:37:50,357 [INFO] Reading complete. time_to_read=0.04 seconds
2020-05-09 20:37:50,357 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_9.h5
2020-05-09 20:37:50,468 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-09 20:37:57,404 [INFO] Initializing model
2020-05-09 20:37:57,404 [INFO] Training model
2020-05-09 20:37:57,404 [INFO] Splitting train set into 2 sets (unsupervised, supervised), random_seed = None
2020-05-09 20:39:34,833 [INFO] Split sizes (instances). total = 9682309, unsupervised = 4841154, supervised = 4841155, unsupervised dataset hash = 7db6e7d4a55f99fb32ffde4926d3d190baf2671a
2020-05-09 20:39:34,833 [INFO] Pretraining Deep Belief Network
2020-05-09 21:08:53,227 [INFO] Pretraining Complete
2020-05-09 21:08:53,227 [INFO] Getting pretrained weights
2020-05-09 21:08:53,227 [INFO] Creating and initializing feed forward neural network
2020-05-09 21:08:53,330 [INFO] Model: "sequential_4"
2020-05-09 21:08:53,330 [INFO] _________________________________________________________________
2020-05-09 21:08:53,330 [INFO] Layer (type)                 Output Shape              Param #   
2020-05-09 21:08:53,330 [INFO] =================================================================
2020-05-09 21:08:53,330 [INFO] dense_13 (Dense)             (None, 128)               9984      
2020-05-09 21:08:53,330 [INFO] _________________________________________________________________
2020-05-09 21:08:53,330 [INFO] batch_normalization_10 (Batc (None, 128)               512       
2020-05-09 21:08:53,330 [INFO] _________________________________________________________________
2020-05-09 21:08:53,330 [INFO] dropout_10 (Dropout)         (None, 128)               0         
2020-05-09 21:08:53,330 [INFO] _________________________________________________________________
2020-05-09 21:08:53,331 [INFO] dense_14 (Dense)             (None, 64)                8256      
2020-05-09 21:08:53,331 [INFO] _________________________________________________________________
2020-05-09 21:08:53,331 [INFO] batch_normalization_11 (Batc (None, 64)                256       
2020-05-09 21:08:53,331 [INFO] _________________________________________________________________
2020-05-09 21:08:53,331 [INFO] dropout_11 (Dropout)         (None, 64)                0         
2020-05-09 21:08:53,331 [INFO] _________________________________________________________________
2020-05-09 21:08:53,331 [INFO] dense_15 (Dense)             (None, 35)                2275      
2020-05-09 21:08:53,331 [INFO] _________________________________________________________________
2020-05-09 21:08:53,331 [INFO] batch_normalization_12 (Batc (None, 35)                140       
2020-05-09 21:08:53,331 [INFO] _________________________________________________________________
2020-05-09 21:08:53,331 [INFO] dropout_12 (Dropout)         (None, 35)                0         
2020-05-09 21:08:53,331 [INFO] _________________________________________________________________
2020-05-09 21:08:53,331 [INFO] dense_16 (Dense)             (None, 15)                540       
2020-05-09 21:08:53,331 [INFO] =================================================================
2020-05-09 21:08:53,331 [INFO] Total params: 21,963
2020-05-09 21:08:53,331 [INFO] Trainable params: 21,509
2020-05-09 21:08:53,331 [INFO] Non-trainable params: 454
2020-05-09 21:08:53,331 [INFO] _________________________________________________________________
2020-05-09 21:08:53,333 [INFO] Fine-tuning final neural network
2020-05-09 21:18:43,819 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-05-09 21:18:43,832 [INFO] Training complete. time_to_train = 2446.43 sec, 40.77 min
2020-05-09 21:18:43,846 [INFO] Model saved to results_selected_models/selected_ids18_full_dbn_deep_rep4/best_model.pickle
2020-05-09 21:18:43,847 [INFO] Training history saved to: results_selected_models/selected_ids18_full_dbn_deep_rep4/training_error_history.csv
2020-05-09 21:18:43,948 [INFO] Plot saved to: results_selected_models/selected_ids18_full_dbn_deep_rep4/training_error_history.png
2020-05-09 21:18:43,949 [INFO] Making predictions on training, validation, testing data
2020-05-09 21:20:12,390 [INFO] Making predictions complete. time_to_predict = 88.44 sec, 1.47 min
2020-05-09 21:20:12,436 [INFO] Evaluating predictions (results)
2020-05-09 21:22:00,404 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate    avg f1
0     Micro avg      0.982631       0.982631                     0.982631              0.001241                 0.017369  0.982631
1     Macro avg      0.997684       0.709033                     0.692959              0.004453                 0.307041  0.691624
2  Weighted avg      0.990816       0.973074                     0.982631              0.049423                 0.017369  0.977221
2020-05-09 21:22:00,439 [INFO] Results saved to: results_selected_models/selected_ids18_full_dbn_deep_rep4/selected_ids18_full_dbn_deep_rep4_results.xlsx
2020-05-09 21:22:00,444 [INFO] ================= Finished running experiment no. 4 ================= 

2020-05-09 21:22:00,608 [INFO] ================= Finished running 4 experiments ================= 

