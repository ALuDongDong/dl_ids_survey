2020-05-10 01:17:41,121 [INFO] Initialized logging. log_filename = results_selected_models/selected_ids18_full_lstm_shallow_rep4/run_log.log
2020-05-10 01:17:41,121 [INFO] ================= Running experiment no. 4  ================= 

2020-05-10 01:17:41,121 [INFO] Experiment parameters given below
2020-05-10 01:17:41,121 [INFO] 
{'experiment_num': 4, 'results_dir': 'results_selected_models/selected_ids18_full_lstm_shallow_rep4', 'model': 'lstm', 'model_type': 'classifier', 'normal_label': 'BENIGN', 'lstm_time_steps': 32, 'lstm_layer_units': [32], 'lstm_layer_activations': ['relu'], 'lstm_layer_dropout_rates': [0.2], 'batch_size': 8192, 'epochs': 80, 'early_stop_patience': 20, 'dataset_dir': '../Datasets/full_datasets/ids2018', 'description': 'selected_ids18_full_lstm_shallow_rep4'}
2020-05-10 01:17:41,122 [INFO] Created tensorboard log directory: results_selected_models/selected_ids18_full_lstm_shallow_rep4/tf_logs_run_2020_05_10-01_17_41
2020-05-10 01:17:41,122 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2018
2020-05-10 01:17:41,122 [INFO] Reading X, y files
2020-05-10 01:17:41,122 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_1.h5
2020-05-10 01:17:42,508 [INFO] Reading complete. time_to_read=1.39 seconds
2020-05-10 01:17:42,508 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_10.h5
2020-05-10 01:17:43,893 [INFO] Reading complete. time_to_read=1.39 seconds
2020-05-10 01:17:43,893 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_11.h5
2020-05-10 01:17:45,281 [INFO] Reading complete. time_to_read=1.39 seconds
2020-05-10 01:17:45,281 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_12.h5
2020-05-10 01:17:46,511 [INFO] Reading complete. time_to_read=1.23 seconds
2020-05-10 01:17:46,511 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_13.h5
2020-05-10 01:17:47,326 [INFO] Reading complete. time_to_read=0.81 seconds
2020-05-10 01:17:47,326 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_2.h5
2020-05-10 01:17:48,582 [INFO] Reading complete. time_to_read=1.26 seconds
2020-05-10 01:17:48,582 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_3.h5
2020-05-10 01:17:49,963 [INFO] Reading complete. time_to_read=1.38 seconds
2020-05-10 01:17:49,963 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_4.h5
2020-05-10 01:17:52,609 [INFO] Reading complete. time_to_read=2.65 seconds
2020-05-10 01:17:52,609 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_5.h5
2020-05-10 01:17:55,213 [INFO] Reading complete. time_to_read=2.60 seconds
2020-05-10 01:17:55,213 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_6.h5
2020-05-10 01:17:57,810 [INFO] Reading complete. time_to_read=2.60 seconds
2020-05-10 01:17:57,811 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_7.h5
2020-05-10 01:18:00,423 [INFO] Reading complete. time_to_read=2.61 seconds
2020-05-10 01:18:00,423 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_8.h5
2020-05-10 01:18:00,861 [INFO] Reading complete. time_to_read=0.44 seconds
2020-05-10 01:18:00,861 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_train_9.h5
2020-05-10 01:18:02,239 [INFO] Reading complete. time_to_read=1.38 seconds
2020-05-10 01:18:02,239 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_1.h5
2020-05-10 01:18:02,696 [INFO] Reading complete. time_to_read=0.46 seconds
2020-05-10 01:18:02,696 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_10.h5
2020-05-10 01:18:03,155 [INFO] Reading complete. time_to_read=0.46 seconds
2020-05-10 01:18:03,155 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_11.h5
2020-05-10 01:18:03,620 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-10 01:18:03,621 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_12.h5
2020-05-10 01:18:04,035 [INFO] Reading complete. time_to_read=0.41 seconds
2020-05-10 01:18:04,035 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_13.h5
2020-05-10 01:18:04,301 [INFO] Reading complete. time_to_read=0.27 seconds
2020-05-10 01:18:04,302 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_2.h5
2020-05-10 01:18:04,724 [INFO] Reading complete. time_to_read=0.42 seconds
2020-05-10 01:18:04,725 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_3.h5
2020-05-10 01:18:05,189 [INFO] Reading complete. time_to_read=0.46 seconds
2020-05-10 01:18:05,189 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_4.h5
2020-05-10 01:18:06,073 [INFO] Reading complete. time_to_read=0.88 seconds
2020-05-10 01:18:06,073 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_5.h5
2020-05-10 01:18:06,941 [INFO] Reading complete. time_to_read=0.87 seconds
2020-05-10 01:18:06,941 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_6.h5
2020-05-10 01:18:07,812 [INFO] Reading complete. time_to_read=0.87 seconds
2020-05-10 01:18:07,812 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_7.h5
2020-05-10 01:18:08,687 [INFO] Reading complete. time_to_read=0.87 seconds
2020-05-10 01:18:08,687 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_8.h5
2020-05-10 01:18:08,834 [INFO] Reading complete. time_to_read=0.15 seconds
2020-05-10 01:18:08,834 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_val_9.h5
2020-05-10 01:18:09,295 [INFO] Reading complete. time_to_read=0.46 seconds
2020-05-10 01:18:09,295 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_1.h5
2020-05-10 01:18:09,758 [INFO] Reading complete. time_to_read=0.46 seconds
2020-05-10 01:18:09,758 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_10.h5
2020-05-10 01:18:10,223 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-10 01:18:10,223 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_11.h5
2020-05-10 01:18:10,688 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-10 01:18:10,688 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_12.h5
2020-05-10 01:18:11,103 [INFO] Reading complete. time_to_read=0.41 seconds
2020-05-10 01:18:11,103 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_13.h5
2020-05-10 01:18:11,368 [INFO] Reading complete. time_to_read=0.27 seconds
2020-05-10 01:18:11,368 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_2.h5
2020-05-10 01:18:11,791 [INFO] Reading complete. time_to_read=0.42 seconds
2020-05-10 01:18:11,791 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_3.h5
2020-05-10 01:18:12,257 [INFO] Reading complete. time_to_read=0.47 seconds
2020-05-10 01:18:12,257 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_4.h5
2020-05-10 01:18:13,143 [INFO] Reading complete. time_to_read=0.89 seconds
2020-05-10 01:18:13,143 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_5.h5
2020-05-10 01:18:14,013 [INFO] Reading complete. time_to_read=0.87 seconds
2020-05-10 01:18:14,013 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_6.h5
2020-05-10 01:18:14,885 [INFO] Reading complete. time_to_read=0.87 seconds
2020-05-10 01:18:14,885 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_7.h5
2020-05-10 01:18:15,758 [INFO] Reading complete. time_to_read=0.87 seconds
2020-05-10 01:18:15,758 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_8.h5
2020-05-10 01:18:15,905 [INFO] Reading complete. time_to_read=0.15 seconds
2020-05-10 01:18:15,905 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/X_test_9.h5
2020-05-10 01:18:16,367 [INFO] Reading complete. time_to_read=0.46 seconds
2020-05-10 01:18:16,368 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_1.h5
2020-05-10 01:18:16,664 [INFO] Reading complete. time_to_read=0.30 seconds
2020-05-10 01:18:16,664 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_10.h5
2020-05-10 01:18:16,974 [INFO] Reading complete. time_to_read=0.31 seconds
2020-05-10 01:18:16,974 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_11.h5
2020-05-10 01:18:17,280 [INFO] Reading complete. time_to_read=0.31 seconds
2020-05-10 01:18:17,280 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_12.h5
2020-05-10 01:18:17,605 [INFO] Reading complete. time_to_read=0.33 seconds
2020-05-10 01:18:17,606 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_13.h5
2020-05-10 01:18:17,784 [INFO] Reading complete. time_to_read=0.18 seconds
2020-05-10 01:18:17,784 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_2.h5
2020-05-10 01:18:18,124 [INFO] Reading complete. time_to_read=0.34 seconds
2020-05-10 01:18:18,124 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_3.h5
2020-05-10 01:18:18,434 [INFO] Reading complete. time_to_read=0.31 seconds
2020-05-10 01:18:18,434 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_4.h5
2020-05-10 01:18:19,053 [INFO] Reading complete. time_to_read=0.62 seconds
2020-05-10 01:18:19,053 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_5.h5
2020-05-10 01:18:19,590 [INFO] Reading complete. time_to_read=0.54 seconds
2020-05-10 01:18:19,590 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_6.h5
2020-05-10 01:18:20,135 [INFO] Reading complete. time_to_read=0.55 seconds
2020-05-10 01:18:20,135 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_7.h5
2020-05-10 01:18:20,731 [INFO] Reading complete. time_to_read=0.60 seconds
2020-05-10 01:18:20,731 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_8.h5
2020-05-10 01:18:20,826 [INFO] Reading complete. time_to_read=0.10 seconds
2020-05-10 01:18:20,826 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_train_9.h5
2020-05-10 01:18:21,132 [INFO] Reading complete. time_to_read=0.31 seconds
2020-05-10 01:18:21,132 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_1.h5
2020-05-10 01:18:21,234 [INFO] Reading complete. time_to_read=0.10 seconds
2020-05-10 01:18:21,234 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_10.h5
2020-05-10 01:18:21,341 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:18:21,341 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_11.h5
2020-05-10 01:18:21,449 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:18:21,449 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_12.h5
2020-05-10 01:18:21,564 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:18:21,564 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_13.h5
2020-05-10 01:18:21,626 [INFO] Reading complete. time_to_read=0.06 seconds
2020-05-10 01:18:21,626 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_2.h5
2020-05-10 01:18:21,742 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 01:18:21,742 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_3.h5
2020-05-10 01:18:21,848 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:18:21,849 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_4.h5
2020-05-10 01:18:22,058 [INFO] Reading complete. time_to_read=0.21 seconds
2020-05-10 01:18:22,058 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_5.h5
2020-05-10 01:18:22,241 [INFO] Reading complete. time_to_read=0.18 seconds
2020-05-10 01:18:22,241 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_6.h5
2020-05-10 01:18:22,443 [INFO] Reading complete. time_to_read=0.20 seconds
2020-05-10 01:18:22,443 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_7.h5
2020-05-10 01:18:22,631 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:18:22,631 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_8.h5
2020-05-10 01:18:22,668 [INFO] Reading complete. time_to_read=0.04 seconds
2020-05-10 01:18:22,668 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_val_9.h5
2020-05-10 01:18:22,775 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:18:22,775 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_1.h5
2020-05-10 01:18:22,875 [INFO] Reading complete. time_to_read=0.10 seconds
2020-05-10 01:18:22,875 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_10.h5
2020-05-10 01:18:22,981 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:18:22,981 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_11.h5
2020-05-10 01:18:23,088 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:18:23,088 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_12.h5
2020-05-10 01:18:23,200 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:18:23,200 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_13.h5
2020-05-10 01:18:23,263 [INFO] Reading complete. time_to_read=0.06 seconds
2020-05-10 01:18:23,263 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_2.h5
2020-05-10 01:18:23,381 [INFO] Reading complete. time_to_read=0.12 seconds
2020-05-10 01:18:23,381 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_3.h5
2020-05-10 01:18:23,487 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:18:23,487 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_4.h5
2020-05-10 01:18:23,697 [INFO] Reading complete. time_to_read=0.21 seconds
2020-05-10 01:18:23,697 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_5.h5
2020-05-10 01:18:23,899 [INFO] Reading complete. time_to_read=0.20 seconds
2020-05-10 01:18:23,899 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_6.h5
2020-05-10 01:18:24,083 [INFO] Reading complete. time_to_read=0.18 seconds
2020-05-10 01:18:24,083 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_7.h5
2020-05-10 01:18:24,269 [INFO] Reading complete. time_to_read=0.19 seconds
2020-05-10 01:18:24,269 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_8.h5
2020-05-10 01:18:24,305 [INFO] Reading complete. time_to_read=0.04 seconds
2020-05-10 01:18:24,305 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2018/y_test_9.h5
2020-05-10 01:18:24,411 [INFO] Reading complete. time_to_read=0.11 seconds
2020-05-10 01:18:27,389 [INFO] Preparing flow sequences
2020-05-10 01:19:42,017 [INFO] Extracting flows complete. time_taken = 74.63 sec
2020-05-10 01:19:46,211 [INFO] Initializing model
2020-05-10 01:19:46,569 [INFO] Model: "sequential_4"
2020-05-10 01:19:46,569 [INFO] _________________________________________________________________
2020-05-10 01:19:46,569 [INFO] Layer (type)                 Output Shape              Param #   
2020-05-10 01:19:46,569 [INFO] =================================================================
2020-05-10 01:19:46,569 [INFO] lstm_4 (LSTM)                (None, 32, 32)            14080     
2020-05-10 01:19:46,569 [INFO] _________________________________________________________________
2020-05-10 01:19:46,569 [INFO] batch_normalization_4 (Batch (None, 32, 32)            128       
2020-05-10 01:19:46,569 [INFO] _________________________________________________________________
2020-05-10 01:19:46,569 [INFO] dropout_4 (Dropout)          (None, 32, 32)            0         
2020-05-10 01:19:46,569 [INFO] _________________________________________________________________
2020-05-10 01:19:46,569 [INFO] time_distributed_4 (TimeDist (None, 32, 15)            495       
2020-05-10 01:19:46,569 [INFO] =================================================================
2020-05-10 01:19:46,569 [INFO] Total params: 14,703
2020-05-10 01:19:46,569 [INFO] Trainable params: 14,639
2020-05-10 01:19:46,569 [INFO] Non-trainable params: 64
2020-05-10 01:19:46,569 [INFO] _________________________________________________________________
2020-05-10 01:19:46,569 [INFO] Training model
2020-05-10 01:24:30,662 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-05-10 01:24:30,664 [INFO] Training complete. time_to_train = 284.09 sec, 4.73 min
2020-05-10 01:24:30,669 [INFO] Model saved to results_selected_models/selected_ids18_full_lstm_shallow_rep4/best_model.pickle
2020-05-10 01:24:30,670 [INFO] Training history saved to: results_selected_models/selected_ids18_full_lstm_shallow_rep4/training_error_history.csv
2020-05-10 01:24:30,772 [INFO] Plot saved to: results_selected_models/selected_ids18_full_lstm_shallow_rep4/training_error_history.png
2020-05-10 01:24:30,772 [INFO] Making predictions on training, validation, testing data
2020-05-10 01:24:47,775 [INFO] Making predictions complete. time_to_predict = 17.00 sec, 0.28 min
2020-05-10 01:24:47,823 [INFO] Evaluating predictions (results)
2020-05-10 01:26:40,464 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate    avg f1
0     Micro avg      0.988967       0.988967                     0.988967              0.000788                 0.011033  0.988967
1     Macro avg      0.998529       0.762667                     0.716940              0.004129                 0.283060  0.720912
2  Weighted avg      0.990981       0.984769                     0.988967              0.050904                 0.011033  0.984041
2020-05-10 01:26:40,499 [INFO] Results saved to: results_selected_models/selected_ids18_full_lstm_shallow_rep4/selected_ids18_full_lstm_shallow_rep4_results.xlsx
2020-05-10 01:26:40,504 [INFO] ================= Finished running experiment no. 4 ================= 

2020-05-10 01:26:40,785 [INFO] Created directory: results_selected_models/selected_ids18_full_lstm_deep_rep1
