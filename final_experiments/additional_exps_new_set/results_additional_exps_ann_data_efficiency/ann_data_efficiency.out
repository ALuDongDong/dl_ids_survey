2019-12-24 02:02:14,117 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_nsl_p10/run_log.log
2019-12-24 02:02:14,117 [INFO] ================= Running experiment no. 1  ================= 

2019-12-24 02:02:14,117 [INFO] Experiment parameters given below
2019-12-24 02:02:14,117 [INFO] 
{'experiment_num': 1, 'results_dir': 'results_additional_exps/ann_data_efficiency_nsl_p10', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': 0.9, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/nsl_kdd_five_classes', 'description': 'ann_data_efficiency_nsl_p10'}
2019-12-24 02:02:14,118 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_nsl_p10/tf_logs_run_2019_12_24-02_02_14
2019-12-24 02:02:14,118 [INFO] Loading datsets from: ../Datasets/small_datasets/nsl_kdd_five_classes
2019-12-24 02:02:14,118 [INFO] Reading X, y files
2019-12-24 02:02:14,118 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_train.h5
2019-12-24 02:02:14,381 [INFO] Reading complete. time_to_read=0.26 seconds
2019-12-24 02:02:14,381 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_val.h5
2019-12-24 02:02:14,446 [INFO] Reading complete. time_to_read=0.07 seconds
2019-12-24 02:02:14,447 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_test.h5
2019-12-24 02:02:14,506 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-24 02:02:14,506 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_train.h5
2019-12-24 02:02:14,513 [INFO] Reading complete. time_to_read=0.01 seconds
2019-12-24 02:02:14,513 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_val.h5
2019-12-24 02:02:14,517 [INFO] Reading complete. time_to_read=0.00 seconds
2019-12-24 02:02:14,517 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_test.h5
2019-12-24 02:02:14,520 [INFO] Reading complete. time_to_read=0.00 seconds
2019-12-24 02:02:14,719 [INFO] Initializing model
2019-12-24 02:02:14,733 [WARNING] From /home/sunanda/test/ml_env/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
2019-12-24 02:02:14,794 [WARNING] From /home/sunanda/test/ml_env/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2019-12-24 02:02:14,831 [INFO] _________________________________________________________________
2019-12-24 02:02:14,831 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-24 02:02:14,831 [INFO] =================================================================
2019-12-24 02:02:14,831 [INFO] dense_1 (Dense)              (None, 64)                7872      
2019-12-24 02:02:14,831 [INFO] _________________________________________________________________
2019-12-24 02:02:14,832 [INFO] batch_normalization_1 (Batch (None, 64)                256       
2019-12-24 02:02:14,832 [INFO] _________________________________________________________________
2019-12-24 02:02:14,832 [INFO] dropout_1 (Dropout)          (None, 64)                0         
2019-12-24 02:02:14,832 [INFO] _________________________________________________________________
2019-12-24 02:02:14,832 [INFO] dense_2 (Dense)              (None, 5)                 325       
2019-12-24 02:02:14,832 [INFO] =================================================================
2019-12-24 02:02:14,832 [INFO] Total params: 8,453
2019-12-24 02:02:14,832 [INFO] Trainable params: 8,325
2019-12-24 02:02:14,832 [INFO] Non-trainable params: 128
2019-12-24 02:02:14,832 [INFO] _________________________________________________________________
2019-12-24 02:02:14,832 [INFO] Training model
2019-12-24 02:02:14,832 [INFO] Splitting train set into 2 sets (set1, set2), random_seed = 42
2019-12-24 02:02:15,514 [INFO] Split sizes (instances). total = 100778, set1 = 90700, set2 = 10078, set1 dataset hash = cb1cbb91fa1a2e64bb54dc7c31da45662219b162
2019-12-24 02:02:15,911 [WARNING] From /home/sunanda/test/ml_env/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-12-24 02:02:20,398 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p10/ann_model_epoch_10.pickle
2019-12-24 02:02:24,031 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p10/ann_model_epoch_20.pickle
2019-12-24 02:02:27,697 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p10/ann_model_epoch_30.pickle
2019-12-24 02:02:31,334 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p10/ann_model_epoch_40.pickle
2019-12-24 02:02:34,948 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p10/ann_model_epoch_50.pickle
2019-12-24 02:02:38,578 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p10/ann_model_epoch_60.pickle
2019-12-24 02:02:42,228 [INFO] epoch = 70. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p10/ann_model_epoch_70.pickle
2019-12-24 02:02:45,847 [INFO] epoch = 80. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p10/ann_model_epoch_80.pickle
2019-12-24 02:02:49,465 [INFO] epoch = 90. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p10/ann_model_epoch_90.pickle
2019-12-24 02:02:52,925 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-24 02:02:53,328 [INFO] Last epoch loss evaluation: train_loss = 0.004279, val_loss = 0.010958
2019-12-24 02:02:53,332 [INFO] Training complete. time_to_train = 38.50 sec, 0.64 min
2019-12-24 02:02:53,356 [INFO] Model saved to results_additional_exps/ann_data_efficiency_nsl_p10/best_model.pickle
2019-12-24 02:02:53,362 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_nsl_p10/training_error_history.csv
2019-12-24 02:02:53,538 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_nsl_p10/training_error_history.png
2019-12-24 02:02:53,704 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_nsl_p10/training_f1_history.png
2019-12-24 02:02:53,704 [INFO] Making predictions on training, validation, testing data
2019-12-24 02:02:54,904 [INFO] Evaluating predictions (results)
2019-12-24 02:02:55,257 [INFO] Dataset: Testing. Classification report below
2019-12-24 02:02:55,257 [INFO] 
              precision    recall  f1-score   support

         dos       0.97      0.86      0.91      7458
      normal       0.69      0.97      0.81      9711
       probe       0.87      0.71      0.78      2421
         r2l       0.98      0.11      0.19      2421
         u2r       1.00      0.02      0.05       533

   micro avg       0.79      0.79      0.79     22544
   macro avg       0.90      0.53      0.55     22544
weighted avg       0.84      0.79      0.75     22544

2019-12-24 02:02:55,257 [INFO] Overall accuracy (micro avg): 0.7910752306600426
2019-12-24 02:02:55,552 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.7911         0.7911                       0.7911                0.0522                   0.2089  0.7911
1     Macro avg        0.9164         0.9008                       0.5348                0.0714                   0.4652  0.5481
2  Weighted avg        0.8798         0.8395                       0.7911                0.1481                   0.2089  0.7547
2019-12-24 02:02:55,885 [INFO] Dataset: Validation. Classification report below
2019-12-24 02:02:55,885 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00      9186
      normal       0.99      0.99      0.99     13469
       probe       0.98      0.99      0.98      2331
         r2l       0.88      0.83      0.85       199
         u2r       0.00      0.00      0.00        10

   micro avg       0.99      0.99      0.99     25195
   macro avg       0.77      0.76      0.77     25195
weighted avg       0.99      0.99      0.99     25195

2019-12-24 02:02:55,885 [INFO] Overall accuracy (micro avg): 0.9931732486604485
2019-12-24 02:02:56,239 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9932         0.9932                       0.9932                0.0017                   0.0068  0.9932
1     Macro avg        0.9973         0.7705                       0.7615                0.0022                   0.2385  0.7659
2  Weighted avg        0.9958         0.9928                       0.9932                0.0041                   0.0068  0.9930
2019-12-24 02:02:57,676 [INFO] Dataset: Training. Classification report below
2019-12-24 02:02:57,676 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00     36741
      normal       0.99      0.99      0.99     53874
       probe       0.98      0.98      0.98      9325
         r2l       0.85      0.84      0.84       796
         u2r       0.47      0.17      0.25        42

   micro avg       0.99      0.99      0.99    100778
   macro avg       0.86      0.80      0.81    100778
weighted avg       0.99      0.99      0.99    100778

2019-12-24 02:02:57,676 [INFO] Overall accuracy (micro avg): 0.992696818750124
2019-12-24 02:02:59,291 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9927         0.9927                       0.9927                0.0018                   0.0073  0.9927
1     Macro avg        0.9971         0.8573                       0.7960                0.0024                   0.2040  0.8124
2  Weighted avg        0.9956         0.9925                       0.9927                0.0045                   0.0073  0.9926
2019-12-24 02:02:59,330 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_nsl_p10/ann_data_efficiency_nsl_p10_results.xlsx
2019-12-24 02:02:59,330 [INFO] ================= Finished running experiment no. 1 ================= 

2019-12-24 02:02:59,335 [INFO] Created directory: results_additional_exps/ann_data_efficiency_nsl_p20
2019-12-24 02:02:59,335 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_nsl_p20/run_log.log
2019-12-24 02:02:59,335 [INFO] ================= Running experiment no. 2  ================= 

2019-12-24 02:02:59,335 [INFO] Experiment parameters given below
2019-12-24 02:02:59,335 [INFO] 
{'experiment_num': 2, 'results_dir': 'results_additional_exps/ann_data_efficiency_nsl_p20', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': 0.8, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/nsl_kdd_five_classes', 'description': 'ann_data_efficiency_nsl_p20'}
2019-12-24 02:02:59,336 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_nsl_p20/tf_logs_run_2019_12_24-02_02_59
2019-12-24 02:02:59,336 [INFO] Loading datsets from: ../Datasets/small_datasets/nsl_kdd_five_classes
2019-12-24 02:02:59,336 [INFO] Reading X, y files
2019-12-24 02:02:59,336 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_train.h5
2019-12-24 02:02:59,583 [INFO] Reading complete. time_to_read=0.25 seconds
2019-12-24 02:02:59,583 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_val.h5
2019-12-24 02:02:59,646 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-24 02:02:59,646 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_test.h5
2019-12-24 02:02:59,705 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-24 02:02:59,705 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_train.h5
2019-12-24 02:02:59,712 [INFO] Reading complete. time_to_read=0.01 seconds
2019-12-24 02:02:59,712 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_val.h5
2019-12-24 02:02:59,716 [INFO] Reading complete. time_to_read=0.00 seconds
2019-12-24 02:02:59,716 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_test.h5
2019-12-24 02:02:59,719 [INFO] Reading complete. time_to_read=0.00 seconds
2019-12-24 02:02:59,910 [INFO] Initializing model
2019-12-24 02:03:00,074 [INFO] _________________________________________________________________
2019-12-24 02:03:00,074 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-24 02:03:00,074 [INFO] =================================================================
2019-12-24 02:03:00,074 [INFO] dense_3 (Dense)              (None, 64)                7872      
2019-12-24 02:03:00,075 [INFO] _________________________________________________________________
2019-12-24 02:03:00,075 [INFO] batch_normalization_2 (Batch (None, 64)                256       
2019-12-24 02:03:00,075 [INFO] _________________________________________________________________
2019-12-24 02:03:00,075 [INFO] dropout_2 (Dropout)          (None, 64)                0         
2019-12-24 02:03:00,075 [INFO] _________________________________________________________________
2019-12-24 02:03:00,075 [INFO] dense_4 (Dense)              (None, 5)                 325       
2019-12-24 02:03:00,075 [INFO] =================================================================
2019-12-24 02:03:00,075 [INFO] Total params: 8,453
2019-12-24 02:03:00,075 [INFO] Trainable params: 8,325
2019-12-24 02:03:00,075 [INFO] Non-trainable params: 128
2019-12-24 02:03:00,075 [INFO] _________________________________________________________________
2019-12-24 02:03:00,075 [INFO] Training model
2019-12-24 02:03:00,075 [INFO] Splitting train set into 2 sets (set1, set2), random_seed = 42
2019-12-24 02:03:00,736 [INFO] Split sizes (instances). total = 100778, set1 = 80622, set2 = 20156, set1 dataset hash = 2dddb397200c6da34a6b8410ec1ddeeabc384d49
2019-12-24 02:03:06,345 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p20/ann_model_epoch_10.pickle
2019-12-24 02:03:10,854 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p20/ann_model_epoch_20.pickle
2019-12-24 02:03:15,343 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p20/ann_model_epoch_30.pickle
2019-12-24 02:03:19,852 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p20/ann_model_epoch_40.pickle
2019-12-24 02:03:24,354 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p20/ann_model_epoch_50.pickle
2019-12-24 02:03:28,877 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p20/ann_model_epoch_60.pickle
2019-12-24 02:03:33,412 [INFO] epoch = 70. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p20/ann_model_epoch_70.pickle
2019-12-24 02:03:37,906 [INFO] epoch = 80. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p20/ann_model_epoch_80.pickle
2019-12-24 02:03:42,368 [INFO] epoch = 90. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p20/ann_model_epoch_90.pickle
2019-12-24 02:03:44,830 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-24 02:03:45,389 [INFO] Last epoch loss evaluation: train_loss = 0.003923, val_loss = 0.008470
2019-12-24 02:03:45,393 [INFO] Training complete. time_to_train = 45.32 sec, 0.76 min
2019-12-24 02:03:45,418 [INFO] Model saved to results_additional_exps/ann_data_efficiency_nsl_p20/best_model.pickle
2019-12-24 02:03:45,421 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_nsl_p20/training_error_history.csv
2019-12-24 02:03:45,586 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_nsl_p20/training_error_history.png
2019-12-24 02:03:45,756 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_nsl_p20/training_f1_history.png
2019-12-24 02:03:45,756 [INFO] Making predictions on training, validation, testing data
2019-12-24 02:03:47,039 [INFO] Evaluating predictions (results)
2019-12-24 02:03:47,298 [INFO] Dataset: Testing. Classification report below
2019-12-24 02:03:47,298 [INFO] 
              precision    recall  f1-score   support

         dos       0.97      0.84      0.90      7458
      normal       0.67      0.94      0.78      9711
       probe       0.71      0.65      0.68      2421
         r2l       0.93      0.11      0.20      2421
         u2r       0.90      0.03      0.07       533

   micro avg       0.76      0.76      0.76     22544
   macro avg       0.84      0.51      0.52     22544
weighted avg       0.81      0.76      0.73     22544

2019-12-24 02:03:47,298 [INFO] Overall accuracy (micro avg): 0.7642388218594748
2019-12-24 02:03:47,593 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.7642         0.7642                       0.7642                0.0589                   0.2358  0.7642
1     Macro avg        0.9057         0.8369                       0.5134                0.0788                   0.4866  0.5245
2  Weighted avg        0.8649         0.8085                       0.7642                0.1581                   0.2358  0.7305
2019-12-24 02:03:47,925 [INFO] Dataset: Validation. Classification report below
2019-12-24 02:03:47,925 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00      9186
      normal       0.99      1.00      1.00     13469
       probe       0.98      0.99      0.99      2331
         r2l       0.93      0.87      0.90       199
         u2r       1.00      0.40      0.57        10

   micro avg       0.99      0.99      0.99     25195
   macro avg       0.98      0.85      0.89     25195
weighted avg       0.99      0.99      0.99     25195

2019-12-24 02:03:47,925 [INFO] Overall accuracy (micro avg): 0.9947211748362771
2019-12-24 02:03:48,279 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9947         0.9947                       0.9947                0.0013                   0.0053  0.9947
1     Macro avg        0.9979         0.9804                       0.8505                0.0018                   0.1495  0.8896
2  Weighted avg        0.9966         0.9947                       0.9947                0.0036                   0.0053  0.9946
2019-12-24 02:03:49,720 [INFO] Dataset: Training. Classification report below
2019-12-24 02:03:49,720 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00     36741
      normal       0.99      1.00      1.00     53874
       probe       0.99      0.98      0.99      9325
         r2l       0.93      0.88      0.91       796
         u2r       0.83      0.45      0.58        42

   micro avg       0.99      0.99      0.99    100778
   macro avg       0.95      0.86      0.89    100778
weighted avg       0.99      0.99      0.99    100778

2019-12-24 02:03:49,720 [INFO] Overall accuracy (micro avg): 0.9947607612772629
2019-12-24 02:03:51,340 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9948         0.9948                       0.9948                0.0013                   0.0052  0.9948
1     Macro avg        0.9979         0.9479                       0.8625                0.0018                   0.1375  0.8941
2  Weighted avg        0.9966         0.9947                       0.9948                0.0040                   0.0052  0.9947
2019-12-24 02:03:51,377 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_nsl_p20/ann_data_efficiency_nsl_p20_results.xlsx
2019-12-24 02:03:51,378 [INFO] ================= Finished running experiment no. 2 ================= 

2019-12-24 02:03:51,381 [INFO] Created directory: results_additional_exps/ann_data_efficiency_nsl_p30
2019-12-24 02:03:51,382 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_nsl_p30/run_log.log
2019-12-24 02:03:51,382 [INFO] ================= Running experiment no. 3  ================= 

2019-12-24 02:03:51,382 [INFO] Experiment parameters given below
2019-12-24 02:03:51,382 [INFO] 
{'experiment_num': 3, 'results_dir': 'results_additional_exps/ann_data_efficiency_nsl_p30', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': 0.7, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/nsl_kdd_five_classes', 'description': 'ann_data_efficiency_nsl_p30'}
2019-12-24 02:03:51,382 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_nsl_p30/tf_logs_run_2019_12_24-02_03_51
2019-12-24 02:03:51,382 [INFO] Loading datsets from: ../Datasets/small_datasets/nsl_kdd_five_classes
2019-12-24 02:03:51,382 [INFO] Reading X, y files
2019-12-24 02:03:51,382 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_train.h5
2019-12-24 02:03:51,629 [INFO] Reading complete. time_to_read=0.25 seconds
2019-12-24 02:03:51,629 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_val.h5
2019-12-24 02:03:51,691 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-24 02:03:51,692 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_test.h5
2019-12-24 02:03:51,748 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-24 02:03:51,748 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_train.h5
2019-12-24 02:03:51,755 [INFO] Reading complete. time_to_read=0.01 seconds
2019-12-24 02:03:51,755 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_val.h5
2019-12-24 02:03:51,759 [INFO] Reading complete. time_to_read=0.00 seconds
2019-12-24 02:03:51,759 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_test.h5
2019-12-24 02:03:51,763 [INFO] Reading complete. time_to_read=0.00 seconds
2019-12-24 02:03:51,954 [INFO] Initializing model
2019-12-24 02:03:52,056 [INFO] _________________________________________________________________
2019-12-24 02:03:52,056 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-24 02:03:52,056 [INFO] =================================================================
2019-12-24 02:03:52,056 [INFO] dense_5 (Dense)              (None, 64)                7872      
2019-12-24 02:03:52,056 [INFO] _________________________________________________________________
2019-12-24 02:03:52,057 [INFO] batch_normalization_3 (Batch (None, 64)                256       
2019-12-24 02:03:52,057 [INFO] _________________________________________________________________
2019-12-24 02:03:52,057 [INFO] dropout_3 (Dropout)          (None, 64)                0         
2019-12-24 02:03:52,057 [INFO] _________________________________________________________________
2019-12-24 02:03:52,057 [INFO] dense_6 (Dense)              (None, 5)                 325       
2019-12-24 02:03:52,057 [INFO] =================================================================
2019-12-24 02:03:52,057 [INFO] Total params: 8,453
2019-12-24 02:03:52,057 [INFO] Trainable params: 8,325
2019-12-24 02:03:52,057 [INFO] Non-trainable params: 128
2019-12-24 02:03:52,057 [INFO] _________________________________________________________________
2019-12-24 02:03:52,057 [INFO] Training model
2019-12-24 02:03:52,057 [INFO] Splitting train set into 2 sets (set1, set2), random_seed = 42
2019-12-24 02:03:52,724 [INFO] Split sizes (instances). total = 100778, set1 = 70544, set2 = 30234, set1 dataset hash = 796cfa24bd3d2ec119fca6f374494bd556442748
2019-12-24 02:03:59,560 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p30/ann_model_epoch_10.pickle
2019-12-24 02:04:04,955 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p30/ann_model_epoch_20.pickle
2019-12-24 02:04:10,301 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p30/ann_model_epoch_30.pickle
2019-12-24 02:04:15,660 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p30/ann_model_epoch_40.pickle
2019-12-24 02:04:20,989 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p30/ann_model_epoch_50.pickle
2019-12-24 02:04:26,373 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p30/ann_model_epoch_60.pickle
2019-12-24 02:04:31,748 [INFO] epoch = 70. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p30/ann_model_epoch_70.pickle
2019-12-24 02:04:37,098 [INFO] epoch = 80. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p30/ann_model_epoch_80.pickle
2019-12-24 02:04:40,594 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-24 02:04:41,316 [INFO] Last epoch loss evaluation: train_loss = 0.003712, val_loss = 0.008512
2019-12-24 02:04:41,320 [INFO] Training complete. time_to_train = 49.26 sec, 0.82 min
2019-12-24 02:04:41,339 [INFO] Model saved to results_additional_exps/ann_data_efficiency_nsl_p30/best_model.pickle
2019-12-24 02:04:41,342 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_nsl_p30/training_error_history.csv
2019-12-24 02:04:41,514 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_nsl_p30/training_error_history.png
2019-12-24 02:04:41,677 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_nsl_p30/training_f1_history.png
2019-12-24 02:04:41,677 [INFO] Making predictions on training, validation, testing data
2019-12-24 02:04:43,079 [INFO] Evaluating predictions (results)
2019-12-24 02:04:43,338 [INFO] Dataset: Testing. Classification report below
2019-12-24 02:04:43,338 [INFO] 
              precision    recall  f1-score   support

         dos       0.98      0.86      0.91      7458
      normal       0.69      0.97      0.81      9711
       probe       0.86      0.73      0.79      2421
         r2l       0.87      0.08      0.14      2421
         u2r       0.63      0.05      0.08       533

   micro avg       0.79      0.79      0.79     22544
   macro avg       0.81      0.54      0.55     22544
weighted avg       0.82      0.79      0.75     22544

2019-12-24 02:04:43,338 [INFO] Overall accuracy (micro avg): 0.7917405961674947
2019-12-24 02:04:43,633 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.7917         0.7917                       0.7917                0.0521                   0.2083  0.7917
1     Macro avg        0.9167         0.8051                       0.5368                0.0709                   0.4632  0.5471
2  Weighted avg        0.8814         0.8213                       0.7917                0.1464                   0.2083  0.7528
2019-12-24 02:04:43,966 [INFO] Dataset: Validation. Classification report below
2019-12-24 02:04:43,966 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00      9186
      normal       1.00      1.00      1.00     13469
       probe       0.99      0.99      0.99      2331
         r2l       0.94      0.87      0.91       199
         u2r       0.67      0.40      0.50        10

   micro avg       1.00      1.00      1.00     25195
   macro avg       0.92      0.85      0.88     25195
weighted avg       1.00      1.00      1.00     25195

2019-12-24 02:04:43,966 [INFO] Overall accuracy (micro avg): 0.9957531256201627
2019-12-24 02:04:44,322 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9958         0.9958                       0.9958                0.0011                   0.0042  0.9958
1     Macro avg        0.9983         0.9183                       0.8517                0.0014                   0.1483  0.8781
2  Weighted avg        0.9974         0.9957                       0.9958                0.0030                   0.0042  0.9957
2019-12-24 02:04:45,766 [INFO] Dataset: Training. Classification report below
2019-12-24 02:04:45,766 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00     36741
      normal       1.00      1.00      1.00     53874
       probe       0.99      0.99      0.99      9325
         r2l       0.95      0.89      0.92       796
         u2r       0.70      0.45      0.55        42

   micro avg       1.00      1.00      1.00    100778
   macro avg       0.93      0.87      0.89    100778
weighted avg       1.00      1.00      1.00    100778

2019-12-24 02:04:45,766 [INFO] Overall accuracy (micro avg): 0.9961201849610034
2019-12-24 02:04:47,389 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9961         0.9961                       0.9961                0.0010                   0.0039  0.9961
1     Macro avg        0.9984         0.9280                       0.8660                0.0014                   0.1340  0.8914
2  Weighted avg        0.9976         0.9961                       0.9961                0.0031                   0.0039  0.9961
2019-12-24 02:04:47,427 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_nsl_p30/ann_data_efficiency_nsl_p30_results.xlsx
2019-12-24 02:04:47,427 [INFO] ================= Finished running experiment no. 3 ================= 

2019-12-24 02:04:47,432 [INFO] Created directory: results_additional_exps/ann_data_efficiency_nsl_p40
2019-12-24 02:04:47,433 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_nsl_p40/run_log.log
2019-12-24 02:04:47,433 [INFO] ================= Running experiment no. 4  ================= 

2019-12-24 02:04:47,433 [INFO] Experiment parameters given below
2019-12-24 02:04:47,433 [INFO] 
{'experiment_num': 4, 'results_dir': 'results_additional_exps/ann_data_efficiency_nsl_p40', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': 0.6, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/nsl_kdd_five_classes', 'description': 'ann_data_efficiency_nsl_p40'}
2019-12-24 02:04:47,433 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_nsl_p40/tf_logs_run_2019_12_24-02_04_47
2019-12-24 02:04:47,433 [INFO] Loading datsets from: ../Datasets/small_datasets/nsl_kdd_five_classes
2019-12-24 02:04:47,433 [INFO] Reading X, y files
2019-12-24 02:04:47,433 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_train.h5
2019-12-24 02:04:47,681 [INFO] Reading complete. time_to_read=0.25 seconds
2019-12-24 02:04:47,682 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_val.h5
2019-12-24 02:04:47,744 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-24 02:04:47,744 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_test.h5
2019-12-24 02:04:47,800 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-24 02:04:47,800 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_train.h5
2019-12-24 02:04:47,807 [INFO] Reading complete. time_to_read=0.01 seconds
2019-12-24 02:04:47,807 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_val.h5
2019-12-24 02:04:47,811 [INFO] Reading complete. time_to_read=0.00 seconds
2019-12-24 02:04:47,811 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_test.h5
2019-12-24 02:04:47,814 [INFO] Reading complete. time_to_read=0.00 seconds
2019-12-24 02:04:47,999 [INFO] Initializing model
2019-12-24 02:04:48,102 [INFO] _________________________________________________________________
2019-12-24 02:04:48,102 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-24 02:04:48,102 [INFO] =================================================================
2019-12-24 02:04:48,102 [INFO] dense_7 (Dense)              (None, 64)                7872      
2019-12-24 02:04:48,102 [INFO] _________________________________________________________________
2019-12-24 02:04:48,103 [INFO] batch_normalization_4 (Batch (None, 64)                256       
2019-12-24 02:04:48,103 [INFO] _________________________________________________________________
2019-12-24 02:04:48,103 [INFO] dropout_4 (Dropout)          (None, 64)                0         
2019-12-24 02:04:48,103 [INFO] _________________________________________________________________
2019-12-24 02:04:48,103 [INFO] dense_8 (Dense)              (None, 5)                 325       
2019-12-24 02:04:48,103 [INFO] =================================================================
2019-12-24 02:04:48,103 [INFO] Total params: 8,453
2019-12-24 02:04:48,103 [INFO] Trainable params: 8,325
2019-12-24 02:04:48,103 [INFO] Non-trainable params: 128
2019-12-24 02:04:48,103 [INFO] _________________________________________________________________
2019-12-24 02:04:48,103 [INFO] Training model
2019-12-24 02:04:48,103 [INFO] Splitting train set into 2 sets (set1, set2), random_seed = 42
2019-12-24 02:04:48,770 [INFO] Split sizes (instances). total = 100778, set1 = 60466, set2 = 40312, set1 dataset hash = de51f2a9879ba49429890d68ba6f13b44593d279
2019-12-24 02:04:56,792 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p40/ann_model_epoch_10.pickle
2019-12-24 02:05:03,075 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p40/ann_model_epoch_20.pickle
2019-12-24 02:05:09,368 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p40/ann_model_epoch_30.pickle
2019-12-24 02:05:15,700 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p40/ann_model_epoch_40.pickle
2019-12-24 02:05:19,687 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-24 02:05:20,579 [INFO] Last epoch loss evaluation: train_loss = 0.005784, val_loss = 0.008022
2019-12-24 02:05:20,582 [INFO] Training complete. time_to_train = 32.48 sec, 0.54 min
2019-12-24 02:05:20,605 [INFO] Model saved to results_additional_exps/ann_data_efficiency_nsl_p40/best_model.pickle
2019-12-24 02:05:20,607 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_nsl_p40/training_error_history.csv
2019-12-24 02:05:20,782 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_nsl_p40/training_error_history.png
2019-12-24 02:05:20,945 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_nsl_p40/training_f1_history.png
2019-12-24 02:05:20,945 [INFO] Making predictions on training, validation, testing data
2019-12-24 02:05:22,512 [INFO] Evaluating predictions (results)
2019-12-24 02:05:22,773 [INFO] Dataset: Testing. Classification report below
2019-12-24 02:05:22,773 [INFO] 
              precision    recall  f1-score   support

         dos       0.96      0.85      0.90      7458
      normal       0.69      0.96      0.80      9711
       probe       0.79      0.75      0.77      2421
         r2l       0.98      0.08      0.15      2421
         u2r       0.67      0.03      0.05       533

   micro avg       0.78      0.78      0.78     22544
   macro avg       0.82      0.53      0.53     22544
weighted avg       0.82      0.78      0.74     22544

2019-12-24 02:05:22,775 [INFO] Overall accuracy (micro avg): 0.7826916252661462
2019-12-24 02:05:23,071 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.7827         0.7827                       0.7827                0.0543                   0.2173  0.7827
1     Macro avg        0.9131         0.8163                       0.5326                0.0729                   0.4674  0.5349
2  Weighted avg        0.8762         0.8209                       0.7827                0.1471                   0.2173  0.7440
2019-12-24 02:05:23,404 [INFO] Dataset: Validation. Classification report below
2019-12-24 02:05:23,404 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00      9186
      normal       0.99      1.00      0.99     13469
       probe       0.98      0.99      0.99      2331
         r2l       0.92      0.84      0.88       199
         u2r       0.80      0.40      0.53        10

   micro avg       0.99      0.99      0.99     25195
   macro avg       0.94      0.84      0.88     25195
weighted avg       0.99      0.99      0.99     25195

2019-12-24 02:05:23,404 [INFO] Overall accuracy (micro avg): 0.9943242706886287
2019-12-24 02:05:23,760 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9943         0.9943                       0.9943                0.0014                   0.0057  0.9943
1     Macro avg        0.9977         0.9384                       0.8445                0.0019                   0.1555  0.8778
2  Weighted avg        0.9964         0.9942                       0.9943                0.0037                   0.0057  0.9942
2019-12-24 02:05:25,201 [INFO] Dataset: Training. Classification report below
2019-12-24 02:05:25,201 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00     36741
      normal       0.99      1.00      0.99     53874
       probe       0.98      0.99      0.99      9325
         r2l       0.91      0.83      0.87       796
         u2r       0.64      0.43      0.51        42

   micro avg       0.99      0.99      0.99    100778
   macro avg       0.91      0.85      0.87    100778
weighted avg       0.99      0.99      0.99    100778

2019-12-24 02:05:25,201 [INFO] Overall accuracy (micro avg): 0.9942050844430332
2019-12-24 02:05:26,821 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9942         0.9942                       0.9942                0.0014                   0.0058  0.9942
1     Macro avg        0.9977         0.9069                       0.8478                0.0020                   0.1522  0.8727
2  Weighted avg        0.9964         0.9941                       0.9942                0.0041                   0.0058  0.9941
2019-12-24 02:05:26,859 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_nsl_p40/ann_data_efficiency_nsl_p40_results.xlsx
2019-12-24 02:05:26,859 [INFO] ================= Finished running experiment no. 4 ================= 

2019-12-24 02:05:26,863 [INFO] Created directory: results_additional_exps/ann_data_efficiency_nsl_p50
2019-12-24 02:05:26,863 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_nsl_p50/run_log.log
2019-12-24 02:05:26,863 [INFO] ================= Running experiment no. 5  ================= 

2019-12-24 02:05:26,863 [INFO] Experiment parameters given below
2019-12-24 02:05:26,864 [INFO] 
{'experiment_num': 5, 'results_dir': 'results_additional_exps/ann_data_efficiency_nsl_p50', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': 0.5, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/nsl_kdd_five_classes', 'description': 'ann_data_efficiency_nsl_p50'}
2019-12-24 02:05:26,864 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_nsl_p50/tf_logs_run_2019_12_24-02_05_26
2019-12-24 02:05:26,864 [INFO] Loading datsets from: ../Datasets/small_datasets/nsl_kdd_five_classes
2019-12-24 02:05:26,864 [INFO] Reading X, y files
2019-12-24 02:05:26,864 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_train.h5
2019-12-24 02:05:27,113 [INFO] Reading complete. time_to_read=0.25 seconds
2019-12-24 02:05:27,114 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_val.h5
2019-12-24 02:05:27,176 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-24 02:05:27,176 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_test.h5
2019-12-24 02:05:27,232 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-24 02:05:27,233 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_train.h5
2019-12-24 02:05:27,240 [INFO] Reading complete. time_to_read=0.01 seconds
2019-12-24 02:05:27,240 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_val.h5
2019-12-24 02:05:27,244 [INFO] Reading complete. time_to_read=0.00 seconds
2019-12-24 02:05:27,244 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_test.h5
2019-12-24 02:05:27,247 [INFO] Reading complete. time_to_read=0.00 seconds
2019-12-24 02:05:27,432 [INFO] Initializing model
2019-12-24 02:05:27,536 [INFO] _________________________________________________________________
2019-12-24 02:05:27,536 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-24 02:05:27,536 [INFO] =================================================================
2019-12-24 02:05:27,536 [INFO] dense_9 (Dense)              (None, 64)                7872      
2019-12-24 02:05:27,536 [INFO] _________________________________________________________________
2019-12-24 02:05:27,536 [INFO] batch_normalization_5 (Batch (None, 64)                256       
2019-12-24 02:05:27,536 [INFO] _________________________________________________________________
2019-12-24 02:05:27,537 [INFO] dropout_5 (Dropout)          (None, 64)                0         
2019-12-24 02:05:27,537 [INFO] _________________________________________________________________
2019-12-24 02:05:27,537 [INFO] dense_10 (Dense)             (None, 5)                 325       
2019-12-24 02:05:27,537 [INFO] =================================================================
2019-12-24 02:05:27,537 [INFO] Total params: 8,453
2019-12-24 02:05:27,537 [INFO] Trainable params: 8,325
2019-12-24 02:05:27,537 [INFO] Non-trainable params: 128
2019-12-24 02:05:27,537 [INFO] _________________________________________________________________
2019-12-24 02:05:27,537 [INFO] Training model
2019-12-24 02:05:27,537 [INFO] Splitting train set into 2 sets (set1, set2), random_seed = 42
2019-12-24 02:05:28,182 [INFO] Split sizes (instances). total = 100778, set1 = 50389, set2 = 50389, set1 dataset hash = 06e3c0571318a4e80f9239b32a18cc0a10c17120
2019-12-24 02:05:37,724 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p50/ann_model_epoch_10.pickle
2019-12-24 02:05:45,009 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p50/ann_model_epoch_20.pickle
2019-12-24 02:05:52,306 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p50/ann_model_epoch_30.pickle
2019-12-24 02:05:59,674 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p50/ann_model_epoch_40.pickle
2019-12-24 02:06:07,030 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p50/ann_model_epoch_50.pickle
2019-12-24 02:06:14,371 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p50/ann_model_epoch_60.pickle
2019-12-24 02:06:21,741 [INFO] epoch = 70. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p50/ann_model_epoch_70.pickle
2019-12-24 02:06:29,038 [INFO] epoch = 80. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p50/ann_model_epoch_80.pickle
2019-12-24 02:06:36,335 [INFO] epoch = 90. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p50/ann_model_epoch_90.pickle
2019-12-24 02:06:43,222 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-24 02:06:44,308 [INFO] Last epoch loss evaluation: train_loss = 0.003008, val_loss = 0.007106
2019-12-24 02:06:44,312 [INFO] Training complete. time_to_train = 76.77 sec, 1.28 min
2019-12-24 02:06:44,331 [INFO] Model saved to results_additional_exps/ann_data_efficiency_nsl_p50/best_model.pickle
2019-12-24 02:06:44,334 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_nsl_p50/training_error_history.csv
2019-12-24 02:06:44,507 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_nsl_p50/training_error_history.png
2019-12-24 02:06:44,669 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_nsl_p50/training_f1_history.png
2019-12-24 02:06:44,669 [INFO] Making predictions on training, validation, testing data
2019-12-24 02:06:46,325 [INFO] Evaluating predictions (results)
2019-12-24 02:06:46,585 [INFO] Dataset: Testing. Classification report below
2019-12-24 02:06:46,585 [INFO] 
              precision    recall  f1-score   support

         dos       0.97      0.84      0.90      7458
      normal       0.68      0.97      0.80      9711
       probe       0.85      0.72      0.78      2421
         r2l       0.97      0.11      0.19      2421
         u2r       0.76      0.05      0.10       533

   micro avg       0.78      0.78      0.78     22544
   macro avg       0.84      0.54      0.55     22544
weighted avg       0.83      0.78      0.75     22544

2019-12-24 02:06:46,585 [INFO] Overall accuracy (micro avg): 0.7823367636621718
2019-12-24 02:06:46,881 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.7823         0.7823                       0.7823                0.0544                   0.2177  0.7823
1     Macro avg        0.9129         0.8445                       0.5356                0.0742                   0.4644  0.5529
2  Weighted avg        0.8735         0.8274                       0.7823                0.1532                   0.2177  0.7478
2019-12-24 02:06:47,214 [INFO] Dataset: Validation. Classification report below
2019-12-24 02:06:47,214 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00      9186
      normal       1.00      1.00      1.00     13469
       probe       0.99      0.99      0.99      2331
         r2l       0.97      0.86      0.91       199
         u2r       0.50      0.30      0.37        10

   micro avg       1.00      1.00      1.00     25195
   macro avg       0.89      0.83      0.85     25195
weighted avg       1.00      1.00      1.00     25195

2019-12-24 02:06:47,214 [INFO] Overall accuracy (micro avg): 0.9962691010121055
2019-12-24 02:06:47,570 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9963         0.9963                       0.9963                0.0009                   0.0037  0.9963
1     Macro avg        0.9985         0.8907                       0.8302                0.0013                   0.1698  0.8549
2  Weighted avg        0.9978         0.9962                       0.9963                0.0029                   0.0037  0.9962
2019-12-24 02:06:49,006 [INFO] Dataset: Training. Classification report below
2019-12-24 02:06:49,007 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00     36741
      normal       1.00      1.00      1.00     53874
       probe       1.00      0.99      0.99      9325
         r2l       0.98      0.90      0.93       796
         u2r       0.76      0.62      0.68        42

   micro avg       1.00      1.00      1.00    100778
   macro avg       0.95      0.90      0.92    100778
weighted avg       1.00      1.00      1.00    100778

2019-12-24 02:06:49,007 [INFO] Overall accuracy (micro avg): 0.9970330826172379
2019-12-24 02:06:50,622 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9970         0.9970                       0.9970                0.0007                   0.0030  0.9970
1     Macro avg        0.9988         0.9466                       0.9006                0.0011                   0.0994  0.9217
2  Weighted avg        0.9981         0.9970                       0.9970                0.0025                   0.0030  0.9970
2019-12-24 02:06:50,661 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_nsl_p50/ann_data_efficiency_nsl_p50_results.xlsx
2019-12-24 02:06:50,662 [INFO] ================= Finished running experiment no. 5 ================= 

2019-12-24 02:06:50,665 [INFO] Created directory: results_additional_exps/ann_data_efficiency_nsl_p60
2019-12-24 02:06:50,665 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_nsl_p60/run_log.log
2019-12-24 02:06:50,665 [INFO] ================= Running experiment no. 6  ================= 

2019-12-24 02:06:50,665 [INFO] Experiment parameters given below
2019-12-24 02:06:50,665 [INFO] 
{'experiment_num': 6, 'results_dir': 'results_additional_exps/ann_data_efficiency_nsl_p60', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': 0.4, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/nsl_kdd_five_classes', 'description': 'ann_data_efficiency_nsl_p60'}
2019-12-24 02:06:50,665 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_nsl_p60/tf_logs_run_2019_12_24-02_06_50
2019-12-24 02:06:50,665 [INFO] Loading datsets from: ../Datasets/small_datasets/nsl_kdd_five_classes
2019-12-24 02:06:50,666 [INFO] Reading X, y files
2019-12-24 02:06:50,666 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_train.h5
2019-12-24 02:06:50,918 [INFO] Reading complete. time_to_read=0.25 seconds
2019-12-24 02:06:50,918 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_val.h5
2019-12-24 02:06:50,981 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-24 02:06:50,981 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_test.h5
2019-12-24 02:06:51,037 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-24 02:06:51,037 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_train.h5
2019-12-24 02:06:51,045 [INFO] Reading complete. time_to_read=0.01 seconds
2019-12-24 02:06:51,045 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_val.h5
2019-12-24 02:06:51,049 [INFO] Reading complete. time_to_read=0.00 seconds
2019-12-24 02:06:51,049 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_test.h5
2019-12-24 02:06:51,052 [INFO] Reading complete. time_to_read=0.00 seconds
2019-12-24 02:06:51,232 [INFO] Initializing model
2019-12-24 02:06:51,335 [INFO] _________________________________________________________________
2019-12-24 02:06:51,335 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-24 02:06:51,337 [INFO] =================================================================
2019-12-24 02:06:51,337 [INFO] dense_11 (Dense)             (None, 64)                7872      
2019-12-24 02:06:51,337 [INFO] _________________________________________________________________
2019-12-24 02:06:51,337 [INFO] batch_normalization_6 (Batch (None, 64)                256       
2019-12-24 02:06:51,337 [INFO] _________________________________________________________________
2019-12-24 02:06:51,338 [INFO] dropout_6 (Dropout)          (None, 64)                0         
2019-12-24 02:06:51,338 [INFO] _________________________________________________________________
2019-12-24 02:06:51,338 [INFO] dense_12 (Dense)             (None, 5)                 325       
2019-12-24 02:06:51,338 [INFO] =================================================================
2019-12-24 02:06:51,338 [INFO] Total params: 8,453
2019-12-24 02:06:51,338 [INFO] Trainable params: 8,325
2019-12-24 02:06:51,338 [INFO] Non-trainable params: 128
2019-12-24 02:06:51,338 [INFO] _________________________________________________________________
2019-12-24 02:06:51,338 [INFO] Training model
2019-12-24 02:06:51,338 [INFO] Splitting train set into 2 sets (set1, set2), random_seed = 42
2019-12-24 02:06:52,022 [INFO] Split sizes (instances). total = 100778, set1 = 40311, set2 = 60467, set1 dataset hash = ca92932349ce42ce14443767786c72da38659e77
2019-12-24 02:07:02,895 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p60/ann_model_epoch_10.pickle
2019-12-24 02:07:11,365 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p60/ann_model_epoch_20.pickle
2019-12-24 02:07:19,809 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p60/ann_model_epoch_30.pickle
2019-12-24 02:07:28,325 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p60/ann_model_epoch_40.pickle
2019-12-24 02:07:36,778 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p60/ann_model_epoch_50.pickle
2019-12-24 02:07:45,196 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p60/ann_model_epoch_60.pickle
2019-12-24 02:07:53,676 [INFO] epoch = 70. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p60/ann_model_epoch_70.pickle
2019-12-24 02:07:57,383 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-24 02:07:58,682 [INFO] Last epoch loss evaluation: train_loss = 0.003789, val_loss = 0.006591
2019-12-24 02:07:58,685 [INFO] Training complete. time_to_train = 67.35 sec, 1.12 min
2019-12-24 02:07:58,709 [INFO] Model saved to results_additional_exps/ann_data_efficiency_nsl_p60/best_model.pickle
2019-12-24 02:07:58,711 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_nsl_p60/training_error_history.csv
2019-12-24 02:07:58,890 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_nsl_p60/training_error_history.png
2019-12-24 02:07:59,059 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_nsl_p60/training_f1_history.png
2019-12-24 02:07:59,059 [INFO] Making predictions on training, validation, testing data
2019-12-24 02:08:00,761 [INFO] Evaluating predictions (results)
2019-12-24 02:08:01,020 [INFO] Dataset: Testing. Classification report below
2019-12-24 02:08:01,020 [INFO] 
              precision    recall  f1-score   support

         dos       0.96      0.85      0.90      7458
      normal       0.70      0.97      0.81      9711
       probe       0.87      0.75      0.81      2421
         r2l       0.96      0.10      0.18      2421
         u2r       0.48      0.03      0.05       533

   micro avg       0.79      0.79      0.79     22544
   macro avg       0.79      0.54      0.55     22544
weighted avg       0.83      0.79      0.76     22544

2019-12-24 02:08:01,020 [INFO] Overall accuracy (micro avg): 0.7929382540809085
2019-12-24 02:08:01,318 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.7929         0.7929                       0.7929                0.0518                   0.2071  0.7929
1     Macro avg        0.9172         0.7933                       0.5406                0.0705                   0.4594  0.5500
2  Weighted avg        0.8812         0.8259                       0.7929                0.1453                   0.2071  0.7556
2019-12-24 02:08:01,651 [INFO] Dataset: Validation. Classification report below
2019-12-24 02:08:01,651 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00      9186
      normal       1.00      1.00      1.00     13469
       probe       0.99      0.99      0.99      2331
         r2l       0.95      0.87      0.91       199
         u2r       0.50      0.30      0.37        10

   micro avg       1.00      1.00      1.00     25195
   macro avg       0.89      0.83      0.85     25195
weighted avg       1.00      1.00      1.00     25195

2019-12-24 02:08:01,652 [INFO] Overall accuracy (micro avg): 0.9957928160349275
2019-12-24 02:08:02,008 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9958         0.9958                       0.9958                0.0011                   0.0042  0.9958
1     Macro avg        0.9983         0.8868                       0.8314                0.0014                   0.1686  0.8537
2  Weighted avg        0.9974         0.9957                       0.9958                0.0028                   0.0042  0.9957
2019-12-24 02:08:03,450 [INFO] Dataset: Training. Classification report below
2019-12-24 02:08:03,450 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00     36741
      normal       1.00      1.00      1.00     53874
       probe       0.99      0.99      0.99      9325
         r2l       0.96      0.91      0.93       796
         u2r       0.80      0.48      0.60        42

   micro avg       1.00      1.00      1.00    100778
   macro avg       0.95      0.88      0.90    100778
weighted avg       1.00      1.00      1.00    100778

2019-12-24 02:08:03,450 [INFO] Overall accuracy (micro avg): 0.9971025422215166
2019-12-24 02:08:05,074 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9971         0.9971                       0.9971                0.0007                   0.0029  0.9971
1     Macro avg        0.9988         0.9497                       0.8756                0.0010                   0.1244  0.9043
2  Weighted avg        0.9982         0.9971                       0.9971                0.0021                   0.0029  0.9971
2019-12-24 02:08:05,113 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_nsl_p60/ann_data_efficiency_nsl_p60_results.xlsx
2019-12-24 02:08:05,113 [INFO] ================= Finished running experiment no. 6 ================= 

2019-12-24 02:08:05,116 [INFO] Created directory: results_additional_exps/ann_data_efficiency_nsl_p70
2019-12-24 02:08:05,117 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_nsl_p70/run_log.log
2019-12-24 02:08:05,117 [INFO] ================= Running experiment no. 7  ================= 

2019-12-24 02:08:05,117 [INFO] Experiment parameters given below
2019-12-24 02:08:05,117 [INFO] 
{'experiment_num': 7, 'results_dir': 'results_additional_exps/ann_data_efficiency_nsl_p70', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': 0.3, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/nsl_kdd_five_classes', 'description': 'ann_data_efficiency_nsl_p70'}
2019-12-24 02:08:05,117 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_nsl_p70/tf_logs_run_2019_12_24-02_08_05
2019-12-24 02:08:05,117 [INFO] Loading datsets from: ../Datasets/small_datasets/nsl_kdd_five_classes
2019-12-24 02:08:05,117 [INFO] Reading X, y files
2019-12-24 02:08:05,117 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_train.h5
2019-12-24 02:08:05,366 [INFO] Reading complete. time_to_read=0.25 seconds
2019-12-24 02:08:05,366 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_val.h5
2019-12-24 02:08:05,429 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-24 02:08:05,429 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_test.h5
2019-12-24 02:08:05,485 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-24 02:08:05,486 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_train.h5
2019-12-24 02:08:05,493 [INFO] Reading complete. time_to_read=0.01 seconds
2019-12-24 02:08:05,493 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_val.h5
2019-12-24 02:08:05,497 [INFO] Reading complete. time_to_read=0.00 seconds
2019-12-24 02:08:05,497 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_test.h5
2019-12-24 02:08:05,500 [INFO] Reading complete. time_to_read=0.00 seconds
2019-12-24 02:08:05,685 [INFO] Initializing model
2019-12-24 02:08:05,790 [INFO] _________________________________________________________________
2019-12-24 02:08:05,790 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-24 02:08:05,790 [INFO] =================================================================
2019-12-24 02:08:05,790 [INFO] dense_13 (Dense)             (None, 64)                7872      
2019-12-24 02:08:05,790 [INFO] _________________________________________________________________
2019-12-24 02:08:05,790 [INFO] batch_normalization_7 (Batch (None, 64)                256       
2019-12-24 02:08:05,790 [INFO] _________________________________________________________________
2019-12-24 02:08:05,791 [INFO] dropout_7 (Dropout)          (None, 64)                0         
2019-12-24 02:08:05,791 [INFO] _________________________________________________________________
2019-12-24 02:08:05,791 [INFO] dense_14 (Dense)             (None, 5)                 325       
2019-12-24 02:08:05,791 [INFO] =================================================================
2019-12-24 02:08:05,791 [INFO] Total params: 8,453
2019-12-24 02:08:05,791 [INFO] Trainable params: 8,325
2019-12-24 02:08:05,791 [INFO] Non-trainable params: 128
2019-12-24 02:08:05,791 [INFO] _________________________________________________________________
2019-12-24 02:08:05,791 [INFO] Training model
2019-12-24 02:08:05,791 [INFO] Splitting train set into 2 sets (set1, set2), random_seed = 42
2019-12-24 02:08:06,437 [INFO] Split sizes (instances). total = 100778, set1 = 30233, set2 = 70545, set1 dataset hash = f138064a9de3d5c4575f10c672fbbe1b418030c6
2019-12-24 02:08:18,636 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p70/ann_model_epoch_10.pickle
2019-12-24 02:08:28,089 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p70/ann_model_epoch_20.pickle
2019-12-24 02:08:37,546 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p70/ann_model_epoch_30.pickle
2019-12-24 02:08:46,978 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p70/ann_model_epoch_40.pickle
2019-12-24 02:08:56,465 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p70/ann_model_epoch_50.pickle
2019-12-24 02:09:05,892 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p70/ann_model_epoch_60.pickle
2019-12-24 02:09:15,335 [INFO] epoch = 70. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p70/ann_model_epoch_70.pickle
2019-12-24 02:09:24,128 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-24 02:09:25,656 [INFO] Last epoch loss evaluation: train_loss = 0.003557, val_loss = 0.006855
2019-12-24 02:09:25,659 [INFO] Training complete. time_to_train = 79.87 sec, 1.33 min
2019-12-24 02:09:25,680 [INFO] Model saved to results_additional_exps/ann_data_efficiency_nsl_p70/best_model.pickle
2019-12-24 02:09:25,682 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_nsl_p70/training_error_history.csv
2019-12-24 02:09:25,860 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_nsl_p70/training_error_history.png
2019-12-24 02:09:26,029 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_nsl_p70/training_f1_history.png
2019-12-24 02:09:26,029 [INFO] Making predictions on training, validation, testing data
2019-12-24 02:09:27,815 [INFO] Evaluating predictions (results)
2019-12-24 02:09:28,079 [INFO] Dataset: Testing. Classification report below
2019-12-24 02:09:28,079 [INFO] 
              precision    recall  f1-score   support

         dos       0.97      0.83      0.90      7458
      normal       0.68      0.97      0.80      9711
       probe       0.86      0.68      0.76      2421
         r2l       0.87      0.11      0.19      2421
         u2r       0.94      0.03      0.05       533

   micro avg       0.78      0.78      0.78     22544
   macro avg       0.86      0.53      0.54     22544
weighted avg       0.82      0.78      0.75     22544

2019-12-24 02:09:28,079 [INFO] Overall accuracy (micro avg): 0.7805624556422995
2019-12-24 02:09:28,374 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.7806         0.7806                       0.7806                0.0549                   0.2194  0.7806
1     Macro avg        0.9122         0.8644                       0.5251                0.0750                   0.4749  0.5413
2  Weighted avg        0.8729         0.8224                       0.7806                0.1555                   0.2194  0.7453
2019-12-24 02:09:28,708 [INFO] Dataset: Validation. Classification report below
2019-12-24 02:09:28,708 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00      9186
      normal       1.00      1.00      1.00     13469
       probe       0.99      0.99      0.99      2331
         r2l       0.95      0.87      0.91       199
         u2r       0.75      0.30      0.43        10

   micro avg       1.00      1.00      1.00     25195
   macro avg       0.94      0.83      0.86     25195
weighted avg       1.00      1.00      1.00     25195

2019-12-24 02:09:28,708 [INFO] Overall accuracy (micro avg): 0.9961500297678111
2019-12-24 02:09:29,065 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9962         0.9962                       0.9962                0.0010                   0.0038  0.9962
1     Macro avg        0.9985         0.9360                       0.8327                0.0013                   0.1673  0.8648
2  Weighted avg        0.9977         0.9961                       0.9962                0.0026                   0.0038  0.9961
2019-12-24 02:09:30,510 [INFO] Dataset: Training. Classification report below
2019-12-24 02:09:30,510 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00     36741
      normal       1.00      1.00      1.00     53874
       probe       1.00      0.99      0.99      9325
         r2l       0.97      0.91      0.94       796
         u2r       1.00      0.50      0.67        42

   micro avg       1.00      1.00      1.00    100778
   macro avg       0.99      0.88      0.92    100778
weighted avg       1.00      1.00      1.00    100778

2019-12-24 02:09:30,510 [INFO] Overall accuracy (micro avg): 0.9971720018257954
2019-12-24 02:09:32,130 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9972         0.9972                       0.9972                0.0007                   0.0028  0.9972
1     Macro avg        0.9989         0.9915                       0.8792                0.0010                   0.1208  0.9185
2  Weighted avg        0.9982         0.9972                       0.9972                0.0023                   0.0028  0.9971
2019-12-24 02:09:32,169 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_nsl_p70/ann_data_efficiency_nsl_p70_results.xlsx
2019-12-24 02:09:32,169 [INFO] ================= Finished running experiment no. 7 ================= 

2019-12-24 02:09:32,172 [INFO] Created directory: results_additional_exps/ann_data_efficiency_nsl_p80
2019-12-24 02:09:32,172 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_nsl_p80/run_log.log
2019-12-24 02:09:32,172 [INFO] ================= Running experiment no. 8  ================= 

2019-12-24 02:09:32,172 [INFO] Experiment parameters given below
2019-12-24 02:09:32,172 [INFO] 
{'experiment_num': 8, 'results_dir': 'results_additional_exps/ann_data_efficiency_nsl_p80', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': 0.2, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/nsl_kdd_five_classes', 'description': 'ann_data_efficiency_nsl_p80'}
2019-12-24 02:09:32,173 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_nsl_p80/tf_logs_run_2019_12_24-02_09_32
2019-12-24 02:09:32,173 [INFO] Loading datsets from: ../Datasets/small_datasets/nsl_kdd_five_classes
2019-12-24 02:09:32,173 [INFO] Reading X, y files
2019-12-24 02:09:32,173 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_train.h5
2019-12-24 02:09:32,424 [INFO] Reading complete. time_to_read=0.25 seconds
2019-12-24 02:09:32,424 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_val.h5
2019-12-24 02:09:32,487 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-24 02:09:32,487 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_test.h5
2019-12-24 02:09:32,544 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-24 02:09:32,544 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_train.h5
2019-12-24 02:09:32,552 [INFO] Reading complete. time_to_read=0.01 seconds
2019-12-24 02:09:32,552 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_val.h5
2019-12-24 02:09:32,556 [INFO] Reading complete. time_to_read=0.00 seconds
2019-12-24 02:09:32,556 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_test.h5
2019-12-24 02:09:32,559 [INFO] Reading complete. time_to_read=0.00 seconds
2019-12-24 02:09:32,739 [INFO] Initializing model
2019-12-24 02:09:32,843 [INFO] _________________________________________________________________
2019-12-24 02:09:32,843 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-24 02:09:32,843 [INFO] =================================================================
2019-12-24 02:09:32,843 [INFO] dense_15 (Dense)             (None, 64)                7872      
2019-12-24 02:09:32,843 [INFO] _________________________________________________________________
2019-12-24 02:09:32,844 [INFO] batch_normalization_8 (Batch (None, 64)                256       
2019-12-24 02:09:32,844 [INFO] _________________________________________________________________
2019-12-24 02:09:32,844 [INFO] dropout_8 (Dropout)          (None, 64)                0         
2019-12-24 02:09:32,844 [INFO] _________________________________________________________________
2019-12-24 02:09:32,844 [INFO] dense_16 (Dense)             (None, 5)                 325       
2019-12-24 02:09:32,844 [INFO] =================================================================
2019-12-24 02:09:32,844 [INFO] Total params: 8,453
2019-12-24 02:09:32,844 [INFO] Trainable params: 8,325
2019-12-24 02:09:32,844 [INFO] Non-trainable params: 128
2019-12-24 02:09:32,844 [INFO] _________________________________________________________________
2019-12-24 02:09:32,844 [INFO] Training model
2019-12-24 02:09:32,844 [INFO] Splitting train set into 2 sets (set1, set2), random_seed = 42
2019-12-24 02:09:33,546 [INFO] Split sizes (instances). total = 100778, set1 = 20155, set2 = 80623, set1 dataset hash = 8b3871424c4262fd443fec179988445ec9c2875d
2019-12-24 02:09:47,349 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p80/ann_model_epoch_10.pickle
2019-12-24 02:09:57,918 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p80/ann_model_epoch_20.pickle
2019-12-24 02:10:08,336 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p80/ann_model_epoch_30.pickle
2019-12-24 02:10:18,861 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p80/ann_model_epoch_40.pickle
2019-12-24 02:10:29,407 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p80/ann_model_epoch_50.pickle
2019-12-24 02:10:33,933 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-24 02:10:35,674 [INFO] Last epoch loss evaluation: train_loss = 0.004978, val_loss = 0.006830
2019-12-24 02:10:35,677 [INFO] Training complete. time_to_train = 62.83 sec, 1.05 min
2019-12-24 02:10:35,702 [INFO] Model saved to results_additional_exps/ann_data_efficiency_nsl_p80/best_model.pickle
2019-12-24 02:10:35,704 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_nsl_p80/training_error_history.csv
2019-12-24 02:10:35,868 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_nsl_p80/training_error_history.png
2019-12-24 02:10:36,027 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_nsl_p80/training_f1_history.png
2019-12-24 02:10:36,027 [INFO] Making predictions on training, validation, testing data
2019-12-24 02:10:37,960 [INFO] Evaluating predictions (results)
2019-12-24 02:10:38,219 [INFO] Dataset: Testing. Classification report below
2019-12-24 02:10:38,219 [INFO] 
              precision    recall  f1-score   support

         dos       0.96      0.85      0.90      7458
      normal       0.69      0.97      0.81      9711
       probe       0.87      0.68      0.76      2421
         r2l       0.97      0.12      0.22      2421
         u2r       0.75      0.05      0.09       533

   micro avg       0.79      0.79      0.79     22544
   macro avg       0.85      0.53      0.56     22544
weighted avg       0.83      0.79      0.75     22544

2019-12-24 02:10:38,219 [INFO] Overall accuracy (micro avg): 0.7871717530163236
2019-12-24 02:10:38,515 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.7872         0.7872                       0.7872                0.0532                   0.2128  0.7872
1     Macro avg        0.9149         0.8486                       0.5347                0.0727                   0.4653  0.5565
2  Weighted avg        0.8774         0.8293                       0.7872                0.1504                   0.2128  0.7528
2019-12-24 02:10:38,848 [INFO] Dataset: Validation. Classification report below
2019-12-24 02:10:38,848 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00      9186
      normal       1.00      1.00      1.00     13469
       probe       0.99      0.99      0.99      2331
         r2l       0.93      0.84      0.88       199
         u2r       0.44      0.40      0.42        10

   micro avg       1.00      1.00      1.00     25195
   macro avg       0.87      0.84      0.86     25195
weighted avg       1.00      1.00      1.00     25195

2019-12-24 02:10:38,848 [INFO] Overall accuracy (micro avg): 0.9954356023020441
2019-12-24 02:10:39,204 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9954         0.9954                       0.9954                0.0011                   0.0046  0.9954
1     Macro avg        0.9982         0.8713                       0.8448                0.0015                   0.1552  0.8573
2  Weighted avg        0.9973         0.9954                       0.9954                0.0032                   0.0046  0.9954
2019-12-24 02:10:40,642 [INFO] Dataset: Training. Classification report below
2019-12-24 02:10:40,642 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00     36741
      normal       1.00      1.00      1.00     53874
       probe       1.00      0.99      0.99      9325
         r2l       0.90      0.86      0.88       796
         u2r       0.79      0.64      0.71        42

   micro avg       1.00      1.00      1.00    100778
   macro avg       0.94      0.90      0.92    100778
weighted avg       1.00      1.00      1.00    100778

2019-12-24 02:10:40,642 [INFO] Overall accuracy (micro avg): 0.9958522693444998
2019-12-24 02:10:42,260 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9959         0.9959                       0.9959                0.0010                   0.0041  0.9959
1     Macro avg        0.9983         0.9376                       0.8968                0.0015                   0.1032  0.9155
2  Weighted avg        0.9974         0.9958                       0.9959                0.0032                   0.0041  0.9958
2019-12-24 02:10:42,298 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_nsl_p80/ann_data_efficiency_nsl_p80_results.xlsx
2019-12-24 02:10:42,298 [INFO] ================= Finished running experiment no. 8 ================= 

2019-12-24 02:10:42,301 [INFO] Created directory: results_additional_exps/ann_data_efficiency_nsl_p90
2019-12-24 02:10:42,301 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_nsl_p90/run_log.log
2019-12-24 02:10:42,301 [INFO] ================= Running experiment no. 9  ================= 

2019-12-24 02:10:42,301 [INFO] Experiment parameters given below
2019-12-24 02:10:42,301 [INFO] 
{'experiment_num': 9, 'results_dir': 'results_additional_exps/ann_data_efficiency_nsl_p90', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': 0.1, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/nsl_kdd_five_classes', 'description': 'ann_data_efficiency_nsl_p90'}
2019-12-24 02:10:42,301 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_nsl_p90/tf_logs_run_2019_12_24-02_10_42
2019-12-24 02:10:42,302 [INFO] Loading datsets from: ../Datasets/small_datasets/nsl_kdd_five_classes
2019-12-24 02:10:42,302 [INFO] Reading X, y files
2019-12-24 02:10:42,302 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_train.h5
2019-12-24 02:10:42,552 [INFO] Reading complete. time_to_read=0.25 seconds
2019-12-24 02:10:42,552 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_val.h5
2019-12-24 02:10:42,616 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-24 02:10:42,616 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_test.h5
2019-12-24 02:10:42,673 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-24 02:10:42,673 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_train.h5
2019-12-24 02:10:42,680 [INFO] Reading complete. time_to_read=0.01 seconds
2019-12-24 02:10:42,680 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_val.h5
2019-12-24 02:10:42,684 [INFO] Reading complete. time_to_read=0.00 seconds
2019-12-24 02:10:42,684 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_test.h5
2019-12-24 02:10:42,688 [INFO] Reading complete. time_to_read=0.00 seconds
2019-12-24 02:10:42,873 [INFO] Initializing model
2019-12-24 02:10:42,979 [INFO] _________________________________________________________________
2019-12-24 02:10:42,980 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-24 02:10:42,980 [INFO] =================================================================
2019-12-24 02:10:42,980 [INFO] dense_17 (Dense)             (None, 64)                7872      
2019-12-24 02:10:42,980 [INFO] _________________________________________________________________
2019-12-24 02:10:42,980 [INFO] batch_normalization_9 (Batch (None, 64)                256       
2019-12-24 02:10:42,980 [INFO] _________________________________________________________________
2019-12-24 02:10:42,980 [INFO] dropout_9 (Dropout)          (None, 64)                0         
2019-12-24 02:10:42,980 [INFO] _________________________________________________________________
2019-12-24 02:10:42,980 [INFO] dense_18 (Dense)             (None, 5)                 325       
2019-12-24 02:10:42,980 [INFO] =================================================================
2019-12-24 02:10:42,981 [INFO] Total params: 8,453
2019-12-24 02:10:42,981 [INFO] Trainable params: 8,325
2019-12-24 02:10:42,981 [INFO] Non-trainable params: 128
2019-12-24 02:10:42,981 [INFO] _________________________________________________________________
2019-12-24 02:10:42,981 [INFO] Training model
2019-12-24 02:10:42,981 [INFO] Splitting train set into 2 sets (set1, set2), random_seed = 42
2019-12-24 02:10:43,687 [INFO] Split sizes (instances). total = 100778, set1 = 10077, set2 = 90701, set1 dataset hash = a95f9ccb43acf9b12d43dc33be8688b1717c6f47
2019-12-24 02:10:58,860 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p90/ann_model_epoch_10.pickle
2019-12-24 02:11:10,562 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p90/ann_model_epoch_20.pickle
2019-12-24 02:11:22,308 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p90/ann_model_epoch_30.pickle
2019-12-24 02:11:33,956 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p90/ann_model_epoch_40.pickle
2019-12-24 02:11:45,620 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p90/ann_model_epoch_50.pickle
2019-12-24 02:11:57,318 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p90/ann_model_epoch_60.pickle
2019-12-24 02:12:09,014 [INFO] epoch = 70. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p90/ann_model_epoch_70.pickle
2019-12-24 02:12:20,704 [INFO] epoch = 80. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p90/ann_model_epoch_80.pickle
2019-12-24 02:12:28,101 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-24 02:12:30,081 [INFO] Last epoch loss evaluation: train_loss = 0.003445, val_loss = 0.005875
2019-12-24 02:12:30,085 [INFO] Training complete. time_to_train = 107.10 sec, 1.79 min
2019-12-24 02:12:30,104 [INFO] Model saved to results_additional_exps/ann_data_efficiency_nsl_p90/best_model.pickle
2019-12-24 02:12:30,107 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_nsl_p90/training_error_history.csv
2019-12-24 02:12:30,273 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_nsl_p90/training_error_history.png
2019-12-24 02:12:30,430 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_nsl_p90/training_f1_history.png
2019-12-24 02:12:30,430 [INFO] Making predictions on training, validation, testing data
2019-12-24 02:12:32,407 [INFO] Evaluating predictions (results)
2019-12-24 02:12:32,668 [INFO] Dataset: Testing. Classification report below
2019-12-24 02:12:32,668 [INFO] 
              precision    recall  f1-score   support

         dos       0.96      0.82      0.88      7458
      normal       0.67      0.95      0.79      9711
       probe       0.79      0.70      0.74      2421
         r2l       0.95      0.09      0.16      2421
         u2r       0.70      0.04      0.07       533

   micro avg       0.77      0.77      0.77     22544
   macro avg       0.81      0.52      0.53     22544
weighted avg       0.81      0.77      0.73     22544

2019-12-24 02:12:32,668 [INFO] Overall accuracy (micro avg): 0.7672551454932577
2019-12-24 02:12:32,964 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.7673         0.7673                       0.7673                0.0582                   0.2327  0.7673
1     Macro avg        0.9069         0.8138                       0.5197                0.0784                   0.4803  0.5291
2  Weighted avg        0.8648         0.8097                       0.7673                0.1594                   0.2327  0.7309
2019-12-24 02:12:33,297 [INFO] Dataset: Validation. Classification report below
2019-12-24 02:12:33,297 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00      9186
      normal       1.00      1.00      1.00     13469
       probe       0.99      0.99      0.99      2331
         r2l       0.97      0.86      0.91       199
         u2r       0.80      0.40      0.53        10

   micro avg       1.00      1.00      1.00     25195
   macro avg       0.95      0.85      0.89     25195
weighted avg       1.00      1.00      1.00     25195

2019-12-24 02:12:33,297 [INFO] Overall accuracy (micro avg): 0.9965469339154595
2019-12-24 02:12:33,652 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9965         0.9965                       0.9965                0.0009                   0.0035  0.9965
1     Macro avg        0.9986         0.9507                       0.8509                0.0012                   0.1491  0.8869
2  Weighted avg        0.9979         0.9965                       0.9965                0.0027                   0.0035  0.9965
2019-12-24 02:12:35,098 [INFO] Dataset: Training. Classification report below
2019-12-24 02:12:35,098 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00     36741
      normal       1.00      1.00      1.00     53874
       probe       1.00      0.99      0.99      9325
         r2l       0.98      0.88      0.93       796
         u2r       0.93      0.62      0.74        42

   micro avg       1.00      1.00      1.00    100778
   macro avg       0.98      0.90      0.93    100778
weighted avg       1.00      1.00      1.00    100778

2019-12-24 02:12:35,098 [INFO] Overall accuracy (micro avg): 0.9974299946416877
2019-12-24 02:12:36,724 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9974         0.9974                       0.9974                0.0006                   0.0026  0.9974
1     Macro avg        0.9990         0.9796                       0.8991                0.0010                   0.1009  0.9327
2  Weighted avg        0.9984         0.9974                       0.9974                0.0022                   0.0026  0.9974
2019-12-24 02:12:36,761 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_nsl_p90/ann_data_efficiency_nsl_p90_results.xlsx
2019-12-24 02:12:36,762 [INFO] ================= Finished running experiment no. 9 ================= 

2019-12-24 02:12:36,764 [INFO] Created directory: results_additional_exps/ann_data_efficiency_nsl_p100
2019-12-24 02:12:36,765 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_nsl_p100/run_log.log
2019-12-24 02:12:36,765 [INFO] ================= Running experiment no. 10  ================= 

2019-12-24 02:12:36,765 [INFO] Experiment parameters given below
2019-12-24 02:12:36,765 [INFO] 
{'experiment_num': 10, 'results_dir': 'results_additional_exps/ann_data_efficiency_nsl_p100', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'normal', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': -1, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/nsl_kdd_five_classes', 'description': 'ann_data_efficiency_nsl_p100'}
2019-12-24 02:12:36,765 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_nsl_p100/tf_logs_run_2019_12_24-02_12_36
2019-12-24 02:12:36,765 [INFO] Loading datsets from: ../Datasets/small_datasets/nsl_kdd_five_classes
2019-12-24 02:12:36,765 [INFO] Reading X, y files
2019-12-24 02:12:36,765 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_train.h5
2019-12-24 02:12:37,013 [INFO] Reading complete. time_to_read=0.25 seconds
2019-12-24 02:12:37,014 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_val.h5
2019-12-24 02:12:37,076 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-24 02:12:37,076 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/X_test.h5
2019-12-24 02:12:37,133 [INFO] Reading complete. time_to_read=0.06 seconds
2019-12-24 02:12:37,133 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_train.h5
2019-12-24 02:12:37,140 [INFO] Reading complete. time_to_read=0.01 seconds
2019-12-24 02:12:37,140 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_val.h5
2019-12-24 02:12:37,144 [INFO] Reading complete. time_to_read=0.00 seconds
2019-12-24 02:12:37,144 [INFO] Reading HDF dataset ../Datasets/small_datasets/nsl_kdd_five_classes/y_test.h5
2019-12-24 02:12:37,148 [INFO] Reading complete. time_to_read=0.00 seconds
2019-12-24 02:12:37,326 [INFO] Initializing model
2019-12-24 02:12:37,432 [INFO] _________________________________________________________________
2019-12-24 02:12:37,432 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-24 02:12:37,432 [INFO] =================================================================
2019-12-24 02:12:37,432 [INFO] dense_19 (Dense)             (None, 64)                7872      
2019-12-24 02:12:37,432 [INFO] _________________________________________________________________
2019-12-24 02:12:37,432 [INFO] batch_normalization_10 (Batc (None, 64)                256       
2019-12-24 02:12:37,432 [INFO] _________________________________________________________________
2019-12-24 02:12:37,432 [INFO] dropout_10 (Dropout)         (None, 64)                0         
2019-12-24 02:12:37,432 [INFO] _________________________________________________________________
2019-12-24 02:12:37,432 [INFO] dense_20 (Dense)             (None, 5)                 325       
2019-12-24 02:12:37,433 [INFO] =================================================================
2019-12-24 02:12:37,433 [INFO] Total params: 8,453
2019-12-24 02:12:37,433 [INFO] Trainable params: 8,325
2019-12-24 02:12:37,433 [INFO] Non-trainable params: 128
2019-12-24 02:12:37,433 [INFO] _________________________________________________________________
2019-12-24 02:12:37,433 [INFO] Training model
2019-12-24 02:12:54,437 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p100/ann_model_epoch_10.pickle
2019-12-24 02:13:07,467 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p100/ann_model_epoch_20.pickle
2019-12-24 02:13:20,526 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p100/ann_model_epoch_30.pickle
2019-12-24 02:13:33,578 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p100/ann_model_epoch_40.pickle
2019-12-24 02:13:46,644 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p100/ann_model_epoch_50.pickle
2019-12-24 02:13:59,748 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p100/ann_model_epoch_60.pickle
2019-12-24 02:14:12,867 [INFO] epoch = 70. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p100/ann_model_epoch_70.pickle
2019-12-24 02:14:25,977 [INFO] epoch = 80. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p100/ann_model_epoch_80.pickle
2019-12-24 02:14:39,145 [INFO] epoch = 90. Intermediate model saved to results_additional_exps/ann_data_efficiency_nsl_p100/ann_model_epoch_90.pickle
2019-12-24 02:14:49,893 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-24 02:14:52,111 [INFO] Last epoch loss evaluation: train_loss = 0.002995, val_loss = 0.005543
2019-12-24 02:14:52,111 [INFO] Training complete. time_to_train = 134.68 sec, 2.24 min
2019-12-24 02:14:52,138 [INFO] Model saved to results_additional_exps/ann_data_efficiency_nsl_p100/best_model.pickle
2019-12-24 02:14:52,140 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_nsl_p100/training_error_history.csv
2019-12-24 02:14:52,309 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_nsl_p100/training_error_history.png
2019-12-24 02:14:52,465 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_nsl_p100/training_f1_history.png
2019-12-24 02:14:52,465 [INFO] Making predictions on training, validation, testing data
2019-12-24 02:14:54,613 [INFO] Evaluating predictions (results)
2019-12-24 02:14:54,873 [INFO] Dataset: Testing. Classification report below
2019-12-24 02:14:54,873 [INFO] 
              precision    recall  f1-score   support

         dos       0.97      0.82      0.89      7458
      normal       0.67      0.97      0.80      9711
       probe       0.87      0.66      0.75      2421
         r2l       0.71      0.11      0.18      2421
         u2r       0.78      0.03      0.06       533

   micro avg       0.77      0.77      0.77     22544
   macro avg       0.80      0.52      0.54     22544
weighted avg       0.80      0.77      0.74     22544

2019-12-24 02:14:54,873 [INFO] Overall accuracy (micro avg): 0.7734208658623137
2019-12-24 02:14:55,168 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.7734         0.7734                       0.7734                0.0566                   0.2266  0.7734
1     Macro avg        0.9094         0.8009                       0.5181                0.0772                   0.4819  0.5367
2  Weighted avg        0.8688         0.7993                       0.7734                0.1595                   0.2266  0.7390
2019-12-24 02:14:55,500 [INFO] Dataset: Validation. Classification report below
2019-12-24 02:14:55,500 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00      9186
      normal       1.00      1.00      1.00     13469
       probe       0.99      0.99      0.99      2331
         r2l       0.96      0.89      0.92       199
         u2r       0.71      0.50      0.59        10

   micro avg       1.00      1.00      1.00     25195
   macro avg       0.93      0.88      0.90     25195
weighted avg       1.00      1.00      1.00     25195

2019-12-24 02:14:55,500 [INFO] Overall accuracy (micro avg): 0.9964278626711649
2019-12-24 02:14:55,856 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9964         0.9964                       0.9964                0.0009                   0.0036  0.9964
1     Macro avg        0.9986         0.9314                       0.8768                0.0012                   0.1232  0.9001
2  Weighted avg        0.9977         0.9964                       0.9964                0.0025                   0.0036  0.9964
2019-12-24 02:14:57,295 [INFO] Dataset: Training. Classification report below
2019-12-24 02:14:57,295 [INFO] 
              precision    recall  f1-score   support

         dos       1.00      1.00      1.00     36741
      normal       1.00      1.00      1.00     53874
       probe       1.00      1.00      1.00      9325
         r2l       0.97      0.92      0.94       796
         u2r       0.97      0.69      0.81        42

   micro avg       1.00      1.00      1.00    100778
   macro avg       0.99      0.92      0.95    100778
weighted avg       1.00      1.00      1.00    100778

2019-12-24 02:14:57,295 [INFO] Overall accuracy (micro avg): 0.9976780646569687
2019-12-24 02:14:58,912 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9977         0.9977                       0.9977                0.0006                   0.0023  0.9977
1     Macro avg        0.9991         0.9862                       0.9203                0.0008                   0.0797  0.9485
2  Weighted avg        0.9985         0.9977                       0.9977                0.0019                   0.0023  0.9977
2019-12-24 02:14:58,950 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_nsl_p100/ann_data_efficiency_nsl_p100_results.xlsx
2019-12-24 02:14:58,950 [INFO] ================= Finished running experiment no. 10 ================= 

2019-12-24 02:14:58,953 [INFO] Created directory: results_additional_exps/ann_data_efficiency_ids17_p10
2019-12-24 02:14:58,953 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_ids17_p10/run_log.log
2019-12-24 02:14:58,953 [INFO] ================= Running experiment no. 1  ================= 

2019-12-24 02:14:58,953 [INFO] Experiment parameters given below
2019-12-24 02:14:58,954 [INFO] 
{'experiment_num': 1, 'results_dir': 'results_additional_exps/ann_data_efficiency_ids17_p10', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': 0.9, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/full_datasets/ids2017', 'description': 'ann_data_efficiency_ids17_p10'}
2019-12-24 02:14:58,954 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_ids17_p10/tf_logs_run_2019_12_24-02_14_58
2019-12-24 02:14:58,954 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2017
2019-12-24 02:14:58,954 [INFO] Reading X, y files
2019-12-24 02:14:58,954 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_train.h5
2019-12-24 02:15:03,036 [INFO] Reading complete. time_to_read=4.08 seconds
2019-12-24 02:15:03,036 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_val.h5
2019-12-24 02:15:04,428 [INFO] Reading complete. time_to_read=1.39 seconds
2019-12-24 02:15:04,428 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_test.h5
2019-12-24 02:15:05,818 [INFO] Reading complete. time_to_read=1.39 seconds
2019-12-24 02:15:05,818 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_train.h5
2019-12-24 02:15:06,027 [INFO] Reading complete. time_to_read=0.21 seconds
2019-12-24 02:15:06,028 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_val.h5
2019-12-24 02:15:06,095 [INFO] Reading complete. time_to_read=0.07 seconds
2019-12-24 02:15:06,095 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_test.h5
2019-12-24 02:15:06,163 [INFO] Reading complete. time_to_read=0.07 seconds
2019-12-24 02:15:09,301 [INFO] Initializing model
2019-12-24 02:15:09,409 [INFO] _________________________________________________________________
2019-12-24 02:15:09,409 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-24 02:15:09,409 [INFO] =================================================================
2019-12-24 02:15:09,409 [INFO] dense_21 (Dense)             (None, 64)                5056      
2019-12-24 02:15:09,409 [INFO] _________________________________________________________________
2019-12-24 02:15:09,409 [INFO] batch_normalization_11 (Batc (None, 64)                256       
2019-12-24 02:15:09,409 [INFO] _________________________________________________________________
2019-12-24 02:15:09,409 [INFO] dropout_11 (Dropout)         (None, 64)                0         
2019-12-24 02:15:09,409 [INFO] _________________________________________________________________
2019-12-24 02:15:09,409 [INFO] dense_22 (Dense)             (None, 12)                780       
2019-12-24 02:15:09,409 [INFO] =================================================================
2019-12-24 02:15:09,409 [INFO] Total params: 6,092
2019-12-24 02:15:09,409 [INFO] Trainable params: 5,964
2019-12-24 02:15:09,409 [INFO] Non-trainable params: 128
2019-12-24 02:15:09,409 [INFO] _________________________________________________________________
2019-12-24 02:15:09,409 [INFO] Training model
2019-12-24 02:15:09,410 [INFO] Splitting train set into 2 sets (set1, set2), random_seed = 42
2019-12-24 02:15:25,825 [INFO] Split sizes (instances). total = 1696684, set1 = 1527015, set2 = 169669, set1 dataset hash = ac57ac2a4aef54882c16ae882c47563b7f08ce6d
2019-12-24 02:17:28,206 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p10/ann_model_epoch_10.pickle
2019-12-24 02:19:24,751 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p10/ann_model_epoch_20.pickle
2019-12-24 02:21:21,411 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p10/ann_model_epoch_30.pickle
2019-12-24 02:23:18,513 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p10/ann_model_epoch_40.pickle
2019-12-24 02:25:15,685 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p10/ann_model_epoch_50.pickle
2019-12-24 02:27:12,538 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p10/ann_model_epoch_60.pickle
2019-12-24 02:29:09,239 [INFO] epoch = 70. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p10/ann_model_epoch_70.pickle
2019-12-24 02:29:52,653 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-24 02:30:04,712 [INFO] Last epoch loss evaluation: train_loss = 0.003605, val_loss = 0.003863
2019-12-24 02:30:04,743 [INFO] Training complete. time_to_train = 895.33 sec, 14.92 min
2019-12-24 02:30:05,175 [INFO] Model saved to results_additional_exps/ann_data_efficiency_ids17_p10/best_model.pickle
2019-12-24 02:30:05,177 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_ids17_p10/training_error_history.csv
2019-12-24 02:30:05,357 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids17_p10/training_error_history.png
2019-12-24 02:30:05,653 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids17_p10/training_f1_history.png
2019-12-24 02:30:05,653 [INFO] Making predictions on training, validation, testing data
2019-12-24 02:30:46,727 [INFO] Evaluating predictions (results)
2019-12-24 02:30:56,869 [INFO] Dataset: Testing. Classification report below
2019-12-24 02:30:56,869 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      0.99      1.00    454265
                   Bot       0.00      0.00      0.00       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       0.99      0.96      0.98      2058
              DoS Hulk       0.96      1.00      0.98     46025
      DoS Slowhttptest       0.91      0.44      0.59      1100
         DoS slowloris       0.96      0.89      0.92      1159
           FTP-Patator       0.92      0.99      0.95      1587
              PortScan       0.99      1.00      0.99     31761
           SSH-Patator       0.96      0.97      0.97      1179
Web Attack Brute Force       0.00      0.00      0.00       302
        Web Attack XSS       0.00      0.00      0.00       130

             micro avg       0.99      0.99      0.99    565562
             macro avg       0.72      0.69      0.70    565562
          weighted avg       0.99      0.99      0.99    565562

2019-12-24 02:30:56,869 [INFO] Overall accuracy (micro avg): 0.9924552922579664
2019-12-24 02:31:08,404 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9925         0.9925                       0.9925                0.0007                   0.0075  0.9925
1     Macro avg        0.9987         0.7244                       0.6862                0.0018                   0.3138  0.6983
2  Weighted avg        0.9938         0.9910                       0.9925                0.0135                   0.0075  0.9916
2019-12-24 02:31:18,723 [INFO] Dataset: Validation. Classification report below
2019-12-24 02:31:18,723 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454264
                   Bot       0.00      0.00      0.00       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       0.99      0.95      0.97      2059
              DoS Hulk       0.96      1.00      0.98     46025
      DoS Slowhttptest       0.92      0.46      0.62      1099
         DoS slowloris       0.97      0.88      0.92      1159
           FTP-Patator       0.91      0.98      0.95      1587
              PortScan       0.99      1.00      1.00     31761
           SSH-Patator       0.97      0.96      0.97      1180
Web Attack Brute Force       0.00      0.00      0.00       301
        Web Attack XSS       1.00      0.02      0.04       131

             micro avg       0.99      0.99      0.99    565562
             macro avg       0.81      0.69      0.70    565562
          weighted avg       0.99      0.99      0.99    565562

2019-12-24 02:31:18,723 [INFO] Overall accuracy (micro avg): 0.9925083368401696
2019-12-24 02:31:30,433 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9925         0.9925                       0.9925                0.0007                   0.0075  0.9925
1     Macro avg        0.9988         0.8085                       0.6874                0.0018                   0.3126  0.7025
2  Weighted avg        0.9939         0.9913                       0.9925                0.0135                   0.0075  0.9916
2019-12-24 02:32:04,424 [INFO] Dataset: Training. Classification report below
2019-12-24 02:32:04,424 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      0.99      1.00   1362791
                   Bot       0.00      0.00      0.00      1174
                  DDoS       1.00      1.00      1.00     76815
         DoS GoldenEye       0.99      0.96      0.97      6176
              DoS Hulk       0.96      1.00      0.98    138074
      DoS Slowhttptest       0.93      0.45      0.61      3300
         DoS slowloris       0.96      0.90      0.93      3478
           FTP-Patator       0.91      0.98      0.95      4761
              PortScan       0.99      1.00      1.00     95282
           SSH-Patator       0.97      0.97      0.97      3538
Web Attack Brute Force       0.00      0.00      0.00       904
        Web Attack XSS       1.00      0.03      0.06       391

             micro avg       0.99      0.99      0.99   1696684
             macro avg       0.81      0.69      0.70   1696684
          weighted avg       0.99      0.99      0.99   1696684

2019-12-24 02:32:04,424 [INFO] Overall accuracy (micro avg): 0.9925218838628761
2019-12-24 02:32:43,027 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9925         0.9925                       0.9925                0.0007                   0.0075  0.9925
1     Macro avg        0.9988         0.8091                       0.6899                0.0017                   0.3101  0.7045
2  Weighted avg        0.9939         0.9914                       0.9925                0.0135                   0.0075  0.9916
2019-12-24 02:32:43,079 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_ids17_p10/ann_data_efficiency_ids17_p10_results.xlsx
2019-12-24 02:32:43,083 [INFO] ================= Finished running experiment no. 1 ================= 

2019-12-24 02:32:43,152 [INFO] Created directory: results_additional_exps/ann_data_efficiency_ids17_p20
2019-12-24 02:32:43,152 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_ids17_p20/run_log.log
2019-12-24 02:32:43,152 [INFO] ================= Running experiment no. 2  ================= 

2019-12-24 02:32:43,152 [INFO] Experiment parameters given below
2019-12-24 02:32:43,152 [INFO] 
{'experiment_num': 2, 'results_dir': 'results_additional_exps/ann_data_efficiency_ids17_p20', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': 0.8, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/full_datasets/ids2017', 'description': 'ann_data_efficiency_ids17_p20'}
2019-12-24 02:32:43,152 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_ids17_p20/tf_logs_run_2019_12_24-02_32_43
2019-12-24 02:32:43,152 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2017
2019-12-24 02:32:43,153 [INFO] Reading X, y files
2019-12-24 02:32:43,153 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_train.h5
2019-12-24 02:32:47,234 [INFO] Reading complete. time_to_read=4.08 seconds
2019-12-24 02:32:47,235 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_val.h5
2019-12-24 02:32:48,622 [INFO] Reading complete. time_to_read=1.39 seconds
2019-12-24 02:32:48,623 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_test.h5
2019-12-24 02:32:50,012 [INFO] Reading complete. time_to_read=1.39 seconds
2019-12-24 02:32:50,012 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_train.h5
2019-12-24 02:32:50,210 [INFO] Reading complete. time_to_read=0.20 seconds
2019-12-24 02:32:50,210 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_val.h5
2019-12-24 02:32:50,277 [INFO] Reading complete. time_to_read=0.07 seconds
2019-12-24 02:32:50,277 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_test.h5
2019-12-24 02:32:50,345 [INFO] Reading complete. time_to_read=0.07 seconds
2019-12-24 02:32:53,532 [INFO] Initializing model
2019-12-24 02:32:53,640 [INFO] _________________________________________________________________
2019-12-24 02:32:53,640 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-24 02:32:53,640 [INFO] =================================================================
2019-12-24 02:32:53,641 [INFO] dense_23 (Dense)             (None, 64)                5056      
2019-12-24 02:32:53,641 [INFO] _________________________________________________________________
2019-12-24 02:32:53,641 [INFO] batch_normalization_12 (Batc (None, 64)                256       
2019-12-24 02:32:53,641 [INFO] _________________________________________________________________
2019-12-24 02:32:53,641 [INFO] dropout_12 (Dropout)         (None, 64)                0         
2019-12-24 02:32:53,641 [INFO] _________________________________________________________________
2019-12-24 02:32:53,641 [INFO] dense_24 (Dense)             (None, 12)                780       
2019-12-24 02:32:53,641 [INFO] =================================================================
2019-12-24 02:32:53,641 [INFO] Total params: 6,092
2019-12-24 02:32:53,641 [INFO] Trainable params: 5,964
2019-12-24 02:32:53,641 [INFO] Non-trainable params: 128
2019-12-24 02:32:53,641 [INFO] _________________________________________________________________
2019-12-24 02:32:53,641 [INFO] Training model
2019-12-24 02:32:53,641 [INFO] Splitting train set into 2 sets (set1, set2), random_seed = 42
2019-12-24 02:33:10,784 [INFO] Split sizes (instances). total = 1696684, set1 = 1357347, set2 = 339337, set1 dataset hash = 8dd1f4ff848da0129a2a8144c1565541d2c22622
2019-12-24 02:35:33,982 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p20/ann_model_epoch_10.pickle
2019-12-24 02:37:49,067 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p20/ann_model_epoch_20.pickle
2019-12-24 02:40:03,784 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p20/ann_model_epoch_30.pickle
2019-12-24 02:42:18,707 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p20/ann_model_epoch_40.pickle
2019-12-24 02:42:27,555 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-24 02:42:42,893 [INFO] Last epoch loss evaluation: train_loss = 0.004387, val_loss = 0.004607
2019-12-24 02:42:42,927 [INFO] Training complete. time_to_train = 589.29 sec, 9.82 min
2019-12-24 02:42:43,361 [INFO] Model saved to results_additional_exps/ann_data_efficiency_ids17_p20/best_model.pickle
2019-12-24 02:42:43,363 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_ids17_p20/training_error_history.csv
2019-12-24 02:42:43,552 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids17_p20/training_error_history.png
2019-12-24 02:42:43,724 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids17_p20/training_f1_history.png
2019-12-24 02:42:43,724 [INFO] Making predictions on training, validation, testing data
2019-12-24 02:43:25,845 [INFO] Evaluating predictions (results)
2019-12-24 02:43:35,949 [INFO] Dataset: Testing. Classification report below
2019-12-24 02:43:35,949 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       0.99      1.00      0.99    454265
                   Bot       0.90      0.36      0.52       391
                  DDoS       1.00      0.99      0.99     25605
         DoS GoldenEye       1.00      0.95      0.97      2058
              DoS Hulk       1.00      0.94      0.97     46025
      DoS Slowhttptest       0.86      0.95      0.90      1100
         DoS slowloris       0.98      0.91      0.94      1159
           FTP-Patator       1.00      0.94      0.97      1587
              PortScan       0.99      1.00      0.99     31761
           SSH-Patator       0.96      0.92      0.94      1179
Web Attack Brute Force       0.00      0.00      0.00       302
        Web Attack XSS       0.00      0.00      0.00       130

             micro avg       0.99      0.99      0.99    565562
             macro avg       0.81      0.75      0.77    565562
          weighted avg       0.99      0.99      0.99    565562

2019-12-24 02:43:35,949 [INFO] Overall accuracy (micro avg): 0.991284775144016
2019-12-24 02:43:47,454 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9913         0.9913                       0.9913                0.0008                   0.0087  0.9913
1     Macro avg        0.9985         0.8066                       0.7457                0.0033                   0.2543  0.7659
2  Weighted avg        0.9927         0.9905                       0.9913                0.0303                   0.0087  0.9907
2019-12-24 02:43:57,756 [INFO] Dataset: Validation. Classification report below
2019-12-24 02:43:57,756 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       0.99      1.00      0.99    454264
                   Bot       0.91      0.32      0.47       391
                  DDoS       1.00      0.99      0.99     25605
         DoS GoldenEye       0.99      0.94      0.97      2059
              DoS Hulk       1.00      0.94      0.97     46025
      DoS Slowhttptest       0.86      0.93      0.90      1099
         DoS slowloris       0.98      0.91      0.94      1159
           FTP-Patator       1.00      0.93      0.96      1587
              PortScan       0.99      1.00      1.00     31761
           SSH-Patator       0.97      0.93      0.95      1180
Web Attack Brute Force       0.00      0.00      0.00       301
        Web Attack XSS       0.00      0.00      0.00       131

             micro avg       0.99      0.99      0.99    565562
             macro avg       0.81      0.74      0.76    565562
          weighted avg       0.99      0.99      0.99    565562

2019-12-24 02:43:57,756 [INFO] Overall accuracy (micro avg): 0.9915712158879133
2019-12-24 02:44:09,443 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9916         0.9916                       0.9916                0.0008                   0.0084  0.9916
1     Macro avg        0.9986         0.8075                       0.7402                0.0032                   0.2598  0.7614
2  Weighted avg        0.9929         0.9908                       0.9916                0.0296                   0.0084  0.9910
2019-12-24 02:44:43,465 [INFO] Dataset: Training. Classification report below
2019-12-24 02:44:43,465 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       0.99      1.00      0.99   1362791
                   Bot       0.91      0.35      0.51      1174
                  DDoS       1.00      0.99      0.99     76815
         DoS GoldenEye       0.99      0.95      0.97      6176
              DoS Hulk       1.00      0.94      0.97    138074
      DoS Slowhttptest       0.88      0.94      0.91      3300
         DoS slowloris       0.98      0.92      0.95      3478
           FTP-Patator       1.00      0.93      0.96      4761
              PortScan       0.99      1.00      1.00     95282
           SSH-Patator       0.97      0.93      0.95      3538
Web Attack Brute Force       0.00      0.00      0.00       904
        Web Attack XSS       1.00      0.02      0.04       391

             micro avg       0.99      0.99      0.99   1696684
             macro avg       0.89      0.75      0.77   1696684
          weighted avg       0.99      0.99      0.99   1696684

2019-12-24 02:44:43,467 [INFO] Overall accuracy (micro avg): 0.9915264126967661
2019-12-24 02:45:22,111 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9915         0.9915                       0.9915                0.0008                   0.0085  0.9915
1     Macro avg        0.9986         0.8916                       0.7474                0.0032                   0.2526  0.7698
2  Weighted avg        0.9929         0.9910                       0.9915                0.0297                   0.0085  0.9910
2019-12-24 02:45:22,163 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_ids17_p20/ann_data_efficiency_ids17_p20_results.xlsx
2019-12-24 02:45:22,167 [INFO] ================= Finished running experiment no. 2 ================= 

2019-12-24 02:45:22,235 [INFO] Created directory: results_additional_exps/ann_data_efficiency_ids17_p30
2019-12-24 02:45:22,236 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_ids17_p30/run_log.log
2019-12-24 02:45:22,236 [INFO] ================= Running experiment no. 3  ================= 

2019-12-24 02:45:22,236 [INFO] Experiment parameters given below
2019-12-24 02:45:22,236 [INFO] 
{'experiment_num': 3, 'results_dir': 'results_additional_exps/ann_data_efficiency_ids17_p30', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': 0.7, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/full_datasets/ids2017', 'description': 'ann_data_efficiency_ids17_p30'}
2019-12-24 02:45:22,236 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_ids17_p30/tf_logs_run_2019_12_24-02_45_22
2019-12-24 02:45:22,236 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2017
2019-12-24 02:45:22,236 [INFO] Reading X, y files
2019-12-24 02:45:22,236 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_train.h5
2019-12-24 02:45:26,287 [INFO] Reading complete. time_to_read=4.05 seconds
2019-12-24 02:45:26,288 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_val.h5
2019-12-24 02:45:27,667 [INFO] Reading complete. time_to_read=1.38 seconds
2019-12-24 02:45:27,667 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_test.h5
2019-12-24 02:45:29,045 [INFO] Reading complete. time_to_read=1.38 seconds
2019-12-24 02:45:29,046 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_train.h5
2019-12-24 02:45:29,247 [INFO] Reading complete. time_to_read=0.20 seconds
2019-12-24 02:45:29,247 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_val.h5
2019-12-24 02:45:29,315 [INFO] Reading complete. time_to_read=0.07 seconds
2019-12-24 02:45:29,315 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_test.h5
2019-12-24 02:45:29,382 [INFO] Reading complete. time_to_read=0.07 seconds
2019-12-24 02:45:32,581 [INFO] Initializing model
2019-12-24 02:45:32,689 [INFO] _________________________________________________________________
2019-12-24 02:45:32,689 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-24 02:45:32,689 [INFO] =================================================================
2019-12-24 02:45:32,689 [INFO] dense_25 (Dense)             (None, 64)                5056      
2019-12-24 02:45:32,689 [INFO] _________________________________________________________________
2019-12-24 02:45:32,689 [INFO] batch_normalization_13 (Batc (None, 64)                256       
2019-12-24 02:45:32,689 [INFO] _________________________________________________________________
2019-12-24 02:45:32,689 [INFO] dropout_13 (Dropout)         (None, 64)                0         
2019-12-24 02:45:32,689 [INFO] _________________________________________________________________
2019-12-24 02:45:32,689 [INFO] dense_26 (Dense)             (None, 12)                780       
2019-12-24 02:45:32,689 [INFO] =================================================================
2019-12-24 02:45:32,690 [INFO] Total params: 6,092
2019-12-24 02:45:32,690 [INFO] Trainable params: 5,964
2019-12-24 02:45:32,690 [INFO] Non-trainable params: 128
2019-12-24 02:45:32,690 [INFO] _________________________________________________________________
2019-12-24 02:45:32,690 [INFO] Training model
2019-12-24 02:45:32,690 [INFO] Splitting train set into 2 sets (set1, set2), random_seed = 42
2019-12-24 02:45:48,698 [INFO] Split sizes (instances). total = 1696684, set1 = 1187678, set2 = 509006, set1 dataset hash = ebf5bf833102e1fe21145cb61e1cbcb0ae4ce5ee
2019-12-24 02:48:32,491 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p30/ann_model_epoch_10.pickle
2019-12-24 02:51:05,951 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p30/ann_model_epoch_20.pickle
2019-12-24 02:53:38,827 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p30/ann_model_epoch_30.pickle
2019-12-24 02:56:11,835 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p30/ann_model_epoch_40.pickle
2019-12-24 02:58:45,157 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p30/ann_model_epoch_50.pickle
2019-12-24 03:01:18,209 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p30/ann_model_epoch_60.pickle
2019-12-24 03:03:50,937 [INFO] epoch = 70. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p30/ann_model_epoch_70.pickle
2019-12-24 03:04:30,510 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-24 03:04:49,077 [INFO] Last epoch loss evaluation: train_loss = 0.003099, val_loss = 0.003224
2019-12-24 03:04:49,116 [INFO] Training complete. time_to_train = 1156.43 sec, 19.27 min
2019-12-24 03:04:49,558 [INFO] Model saved to results_additional_exps/ann_data_efficiency_ids17_p30/best_model.pickle
2019-12-24 03:04:49,560 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_ids17_p30/training_error_history.csv
2019-12-24 03:04:49,743 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids17_p30/training_error_history.png
2019-12-24 03:04:49,916 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids17_p30/training_f1_history.png
2019-12-24 03:04:49,916 [INFO] Making predictions on training, validation, testing data
2019-12-24 03:05:34,004 [INFO] Evaluating predictions (results)
2019-12-24 03:05:44,134 [INFO] Dataset: Testing. Classification report below
2019-12-24 03:05:44,134 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454265
                   Bot       0.95      0.37      0.54       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       0.99      0.96      0.98      2058
              DoS Hulk       0.97      0.99      0.98     46025
      DoS Slowhttptest       0.88      0.98      0.93      1100
         DoS slowloris       0.98      0.92      0.95      1159
           FTP-Patator       0.99      0.96      0.98      1587
              PortScan       0.99      0.99      0.99     31761
           SSH-Patator       0.96      0.96      0.96      1179
Web Attack Brute Force       0.95      0.06      0.11       302
        Web Attack XSS       0.00      0.00      0.00       130

             micro avg       0.99      0.99      0.99    565562
             macro avg       0.89      0.77      0.78    565562
          weighted avg       0.99      0.99      0.99    565562

2019-12-24 03:05:44,134 [INFO] Overall accuracy (micro avg): 0.9942216768453326
2019-12-24 03:05:55,664 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9942         0.9942                       0.9942                0.0005                   0.0058  0.9942
1     Macro avg        0.9990         0.8887                       0.7673                0.0014                   0.2327  0.7845
2  Weighted avg        0.9952         0.9940                       0.9942                0.0105                   0.0058  0.9938
2019-12-24 03:06:05,959 [INFO] Dataset: Validation. Classification report below
2019-12-24 03:06:05,960 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454264
                   Bot       0.96      0.34      0.51       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       0.99      0.95      0.97      2059
              DoS Hulk       0.97      0.99      0.98     46025
      DoS Slowhttptest       0.88      0.97      0.92      1099
         DoS slowloris       0.98      0.92      0.95      1159
           FTP-Patator       0.99      0.96      0.97      1587
              PortScan       0.99      1.00      0.99     31761
           SSH-Patator       0.97      0.96      0.96      1180
Web Attack Brute Force       0.92      0.04      0.07       301
        Web Attack XSS       0.50      0.02      0.03       131

             micro avg       0.99      0.99      0.99    565562
             macro avg       0.93      0.76      0.78    565562
          weighted avg       0.99      0.99      0.99    565562

2019-12-24 03:06:05,960 [INFO] Overall accuracy (micro avg): 0.9943153889405583
2019-12-24 03:06:17,636 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9943         0.9943                       0.9943                0.0005                   0.0057  0.9943
1     Macro avg        0.9991         0.9290                       0.7620                0.0013                   0.2380  0.7800
2  Weighted avg        0.9953         0.9942                       0.9943                0.0104                   0.0057  0.9939
2019-12-24 03:06:51,693 [INFO] Dataset: Training. Classification report below
2019-12-24 03:06:51,693 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00   1362791
                   Bot       0.97      0.36      0.53      1174
                  DDoS       1.00      1.00      1.00     76815
         DoS GoldenEye       0.99      0.96      0.98      6176
              DoS Hulk       0.97      0.99      0.98    138074
      DoS Slowhttptest       0.89      0.98      0.93      3300
         DoS slowloris       0.98      0.93      0.96      3478
           FTP-Patator       0.99      0.96      0.97      4761
              PortScan       0.99      0.99      0.99     95282
           SSH-Patator       0.97      0.96      0.97      3538
Web Attack Brute Force       1.00      0.05      0.09       904
        Web Attack XSS       0.75      0.03      0.06       391

             micro avg       0.99      0.99      0.99   1696684
             macro avg       0.96      0.77      0.79   1696684
          weighted avg       0.99      0.99      0.99   1696684

2019-12-24 03:06:51,693 [INFO] Overall accuracy (micro avg): 0.9943643011898503
2019-12-24 03:07:30,363 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9944         0.9944                       0.9944                0.0005                   0.0056  0.9944
1     Macro avg        0.9991         0.9590                       0.7682                0.0013                   0.2318  0.7879
2  Weighted avg        0.9953         0.9944                       0.9944                0.0104                   0.0056  0.9939
2019-12-24 03:07:30,415 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_ids17_p30/ann_data_efficiency_ids17_p30_results.xlsx
2019-12-24 03:07:30,419 [INFO] ================= Finished running experiment no. 3 ================= 

2019-12-24 03:07:30,487 [INFO] Created directory: results_additional_exps/ann_data_efficiency_ids17_p40
2019-12-24 03:07:30,487 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_ids17_p40/run_log.log
2019-12-24 03:07:30,487 [INFO] ================= Running experiment no. 4  ================= 

2019-12-24 03:07:30,487 [INFO] Experiment parameters given below
2019-12-24 03:07:30,487 [INFO] 
{'experiment_num': 4, 'results_dir': 'results_additional_exps/ann_data_efficiency_ids17_p40', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': 0.6, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/full_datasets/ids2017', 'description': 'ann_data_efficiency_ids17_p40'}
2019-12-24 03:07:30,487 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_ids17_p40/tf_logs_run_2019_12_24-03_07_30
2019-12-24 03:07:30,487 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2017
2019-12-24 03:07:30,487 [INFO] Reading X, y files
2019-12-24 03:07:30,487 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_train.h5
2019-12-24 03:07:34,579 [INFO] Reading complete. time_to_read=4.09 seconds
2019-12-24 03:07:34,580 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_val.h5
2019-12-24 03:07:35,965 [INFO] Reading complete. time_to_read=1.39 seconds
2019-12-24 03:07:35,965 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_test.h5
2019-12-24 03:07:37,351 [INFO] Reading complete. time_to_read=1.39 seconds
2019-12-24 03:07:37,352 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_train.h5
2019-12-24 03:07:37,558 [INFO] Reading complete. time_to_read=0.21 seconds
2019-12-24 03:07:37,558 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_val.h5
2019-12-24 03:07:37,625 [INFO] Reading complete. time_to_read=0.07 seconds
2019-12-24 03:07:37,625 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_test.h5
2019-12-24 03:07:37,693 [INFO] Reading complete. time_to_read=0.07 seconds
2019-12-24 03:07:40,895 [INFO] Initializing model
2019-12-24 03:07:41,003 [INFO] _________________________________________________________________
2019-12-24 03:07:41,003 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-24 03:07:41,005 [INFO] =================================================================
2019-12-24 03:07:41,005 [INFO] dense_27 (Dense)             (None, 64)                5056      
2019-12-24 03:07:41,005 [INFO] _________________________________________________________________
2019-12-24 03:07:41,005 [INFO] batch_normalization_14 (Batc (None, 64)                256       
2019-12-24 03:07:41,005 [INFO] _________________________________________________________________
2019-12-24 03:07:41,005 [INFO] dropout_14 (Dropout)         (None, 64)                0         
2019-12-24 03:07:41,005 [INFO] _________________________________________________________________
2019-12-24 03:07:41,005 [INFO] dense_28 (Dense)             (None, 12)                780       
2019-12-24 03:07:41,006 [INFO] =================================================================
2019-12-24 03:07:41,006 [INFO] Total params: 6,092
2019-12-24 03:07:41,006 [INFO] Trainable params: 5,964
2019-12-24 03:07:41,006 [INFO] Non-trainable params: 128
2019-12-24 03:07:41,006 [INFO] _________________________________________________________________
2019-12-24 03:07:41,006 [INFO] Training model
2019-12-24 03:07:41,006 [INFO] Splitting train set into 2 sets (set1, set2), random_seed = 42
2019-12-24 03:07:56,839 [INFO] Split sizes (instances). total = 1696684, set1 = 1018010, set2 = 678674, set1 dataset hash = d02176b1ed05b0d1a28cd0db129f656e7fef4010
2019-12-24 03:11:03,480 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p40/ann_model_epoch_10.pickle
2019-12-24 03:13:57,756 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p40/ann_model_epoch_20.pickle
2019-12-24 03:16:52,027 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p40/ann_model_epoch_30.pickle
2019-12-24 03:19:46,591 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p40/ann_model_epoch_40.pickle
2019-12-24 03:22:40,558 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p40/ann_model_epoch_50.pickle
2019-12-24 03:24:34,493 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-24 03:24:56,881 [INFO] Last epoch loss evaluation: train_loss = 0.003107, val_loss = 0.003247
2019-12-24 03:24:56,918 [INFO] Training complete. time_to_train = 1035.91 sec, 17.27 min
2019-12-24 03:24:57,351 [INFO] Model saved to results_additional_exps/ann_data_efficiency_ids17_p40/best_model.pickle
2019-12-24 03:24:57,353 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_ids17_p40/training_error_history.csv
2019-12-24 03:24:57,526 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids17_p40/training_error_history.png
2019-12-24 03:24:57,691 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids17_p40/training_f1_history.png
2019-12-24 03:24:57,691 [INFO] Making predictions on training, validation, testing data
2019-12-24 03:25:44,327 [INFO] Evaluating predictions (results)
2019-12-24 03:25:54,444 [INFO] Dataset: Testing. Classification report below
2019-12-24 03:25:54,444 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454265
                   Bot       0.97      0.36      0.53       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       0.99      0.96      0.98      2058
              DoS Hulk       0.98      0.98      0.98     46025
      DoS Slowhttptest       0.87      0.98      0.92      1100
         DoS slowloris       0.97      0.94      0.95      1159
           FTP-Patator       0.99      0.95      0.97      1587
              PortScan       0.99      1.00      0.99     31761
           SSH-Patator       0.95      0.98      0.97      1179
Web Attack Brute Force       1.00      0.06      0.11       302
        Web Attack XSS       0.00      0.00      0.00       130

             micro avg       0.99      0.99      0.99    565562
             macro avg       0.89      0.77      0.78    565562
          weighted avg       0.99      0.99      0.99    565562

2019-12-24 03:25:54,444 [INFO] Overall accuracy (micro avg): 0.9938432921589498
2019-12-24 03:26:05,961 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9938         0.9938                       0.9938                0.0006                   0.0062  0.9938
1     Macro avg        0.9990         0.8935                       0.7669                0.0017                   0.2331  0.7835
2  Weighted avg        0.9949         0.9936                       0.9938                0.0143                   0.0062  0.9934
2019-12-24 03:26:16,268 [INFO] Dataset: Validation. Classification report below
2019-12-24 03:26:16,268 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454264
                   Bot       0.98      0.32      0.49       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       0.99      0.96      0.97      2059
              DoS Hulk       0.98      0.98      0.98     46025
      DoS Slowhttptest       0.88      0.97      0.92      1099
         DoS slowloris       0.97      0.94      0.95      1159
           FTP-Patator       0.99      0.95      0.97      1587
              PortScan       0.99      1.00      1.00     31761
           SSH-Patator       0.96      0.97      0.96      1180
Web Attack Brute Force       1.00      0.04      0.07       301
        Web Attack XSS       1.00      0.02      0.03       131

             micro avg       0.99      0.99      0.99    565562
             macro avg       0.98      0.76      0.78    565562
          weighted avg       0.99      0.99      0.99    565562

2019-12-24 03:26:16,268 [INFO] Overall accuracy (micro avg): 0.9940731520151637
2019-12-24 03:26:27,963 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9941         0.9941                       0.9941                0.0005                   0.0059  0.9941
1     Macro avg        0.9990         0.9774                       0.7621                0.0016                   0.2379  0.7787
2  Weighted avg        0.9951         0.9941                       0.9941                0.0137                   0.0059  0.9936
2019-12-24 03:27:02,081 [INFO] Dataset: Training. Classification report below
2019-12-24 03:27:02,081 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00   1362791
                   Bot       0.98      0.35      0.52      1174
                  DDoS       1.00      1.00      1.00     76815
         DoS GoldenEye       0.99      0.96      0.98      6176
              DoS Hulk       0.98      0.98      0.98    138074
      DoS Slowhttptest       0.89      0.98      0.93      3300
         DoS slowloris       0.97      0.95      0.96      3478
           FTP-Patator       1.00      0.96      0.98      4761
              PortScan       0.99      1.00      1.00     95282
           SSH-Patator       0.96      0.97      0.97      3538
Web Attack Brute Force       1.00      0.05      0.09       904
        Web Attack XSS       1.00      0.03      0.06       391

             micro avg       0.99      0.99      0.99   1696684
             macro avg       0.98      0.77      0.79   1696684
          weighted avg       0.99      0.99      0.99   1696684

2019-12-24 03:27:02,081 [INFO] Overall accuracy (micro avg): 0.9941079187403193
2019-12-24 03:27:40,815 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9941         0.9941                       0.9941                0.0005                   0.0059  0.9941
1     Macro avg        0.9990         0.9801                       0.7687                0.0016                   0.2313  0.7877
2  Weighted avg        0.9951         0.9941                       0.9941                0.0138                   0.0059  0.9937
2019-12-24 03:27:40,866 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_ids17_p40/ann_data_efficiency_ids17_p40_results.xlsx
2019-12-24 03:27:40,870 [INFO] ================= Finished running experiment no. 4 ================= 

2019-12-24 03:27:40,936 [INFO] Created directory: results_additional_exps/ann_data_efficiency_ids17_p50
2019-12-24 03:27:40,936 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_ids17_p50/run_log.log
2019-12-24 03:27:40,936 [INFO] ================= Running experiment no. 5  ================= 

2019-12-24 03:27:40,936 [INFO] Experiment parameters given below
2019-12-24 03:27:40,936 [INFO] 
{'experiment_num': 5, 'results_dir': 'results_additional_exps/ann_data_efficiency_ids17_p50', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': 0.5, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/full_datasets/ids2017', 'description': 'ann_data_efficiency_ids17_p50'}
2019-12-24 03:27:40,936 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_ids17_p50/tf_logs_run_2019_12_24-03_27_40
2019-12-24 03:27:40,936 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2017
2019-12-24 03:27:40,937 [INFO] Reading X, y files
2019-12-24 03:27:40,937 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_train.h5
2019-12-24 03:27:45,007 [INFO] Reading complete. time_to_read=4.07 seconds
2019-12-24 03:27:45,007 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_val.h5
2019-12-24 03:27:46,393 [INFO] Reading complete. time_to_read=1.39 seconds
2019-12-24 03:27:46,393 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_test.h5
2019-12-24 03:27:47,783 [INFO] Reading complete. time_to_read=1.39 seconds
2019-12-24 03:27:47,783 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_train.h5
2019-12-24 03:27:47,972 [INFO] Reading complete. time_to_read=0.19 seconds
2019-12-24 03:27:47,972 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_val.h5
2019-12-24 03:27:48,040 [INFO] Reading complete. time_to_read=0.07 seconds
2019-12-24 03:27:48,040 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_test.h5
2019-12-24 03:27:48,108 [INFO] Reading complete. time_to_read=0.07 seconds
2019-12-24 03:27:51,287 [INFO] Initializing model
2019-12-24 03:27:51,395 [INFO] _________________________________________________________________
2019-12-24 03:27:51,396 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-24 03:27:51,398 [INFO] =================================================================
2019-12-24 03:27:51,398 [INFO] dense_29 (Dense)             (None, 64)                5056      
2019-12-24 03:27:51,398 [INFO] _________________________________________________________________
2019-12-24 03:27:51,398 [INFO] batch_normalization_15 (Batc (None, 64)                256       
2019-12-24 03:27:51,398 [INFO] _________________________________________________________________
2019-12-24 03:27:51,398 [INFO] dropout_15 (Dropout)         (None, 64)                0         
2019-12-24 03:27:51,398 [INFO] _________________________________________________________________
2019-12-24 03:27:51,398 [INFO] dense_30 (Dense)             (None, 12)                780       
2019-12-24 03:27:51,398 [INFO] =================================================================
2019-12-24 03:27:51,398 [INFO] Total params: 6,092
2019-12-24 03:27:51,398 [INFO] Trainable params: 5,964
2019-12-24 03:27:51,398 [INFO] Non-trainable params: 128
2019-12-24 03:27:51,398 [INFO] _________________________________________________________________
2019-12-24 03:27:51,398 [INFO] Training model
2019-12-24 03:27:51,398 [INFO] Splitting train set into 2 sets (set1, set2), random_seed = 42
2019-12-24 03:28:07,613 [INFO] Split sizes (instances). total = 1696684, set1 = 848342, set2 = 848342, set1 dataset hash = b75e78959164c90d19a336ef2d2a5a10f094d2bb
2019-12-24 03:31:38,223 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p50/ann_model_epoch_10.pickle
2019-12-24 03:34:53,776 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p50/ann_model_epoch_20.pickle
2019-12-24 03:38:09,487 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p50/ann_model_epoch_30.pickle
2019-12-24 03:41:25,295 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p50/ann_model_epoch_40.pickle
2019-12-24 03:44:41,107 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p50/ann_model_epoch_50.pickle
2019-12-24 03:46:28,526 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-24 03:46:54,538 [INFO] Last epoch loss evaluation: train_loss = 0.003243, val_loss = 0.003369
2019-12-24 03:46:54,576 [INFO] Training complete. time_to_train = 1143.18 sec, 19.05 min
2019-12-24 03:46:55,019 [INFO] Model saved to results_additional_exps/ann_data_efficiency_ids17_p50/best_model.pickle
2019-12-24 03:46:55,021 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_ids17_p50/training_error_history.csv
2019-12-24 03:46:55,189 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids17_p50/training_error_history.png
2019-12-24 03:46:55,347 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids17_p50/training_f1_history.png
2019-12-24 03:46:55,348 [INFO] Making predictions on training, validation, testing data
2019-12-24 03:47:42,556 [INFO] Evaluating predictions (results)
2019-12-24 03:47:52,692 [INFO] Dataset: Testing. Classification report below
2019-12-24 03:47:52,692 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454265
                   Bot       0.97      0.37      0.53       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       1.00      0.96      0.98      2058
              DoS Hulk       0.98      0.98      0.98     46025
      DoS Slowhttptest       0.86      0.99      0.92      1100
         DoS slowloris       0.98      0.88      0.93      1159
           FTP-Patator       1.00      0.95      0.98      1587
              PortScan       0.99      0.99      0.99     31761
           SSH-Patator       0.96      0.97      0.97      1179
Web Attack Brute Force       0.83      0.02      0.03       302
        Web Attack XSS       0.00      0.00      0.00       130

             micro avg       0.99      0.99      0.99    565562
             macro avg       0.88      0.76      0.77    565562
          weighted avg       0.99      0.99      0.99    565562

2019-12-24 03:47:52,692 [INFO] Overall accuracy (micro avg): 0.9935091112910698
2019-12-24 03:48:04,225 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9935         0.9935                       0.9935                0.0006                   0.0065  0.9935
1     Macro avg        0.9989         0.8805                       0.7583                0.0019                   0.2417  0.7745
2  Weighted avg        0.9946         0.9932                       0.9935                0.0158                   0.0065  0.9930
2019-12-24 03:48:14,569 [INFO] Dataset: Validation. Classification report below
2019-12-24 03:48:14,569 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454264
                   Bot       0.98      0.32      0.49       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       1.00      0.95      0.97      2059
              DoS Hulk       0.98      0.98      0.98     46025
      DoS Slowhttptest       0.87      0.98      0.92      1099
         DoS slowloris       0.98      0.89      0.93      1159
           FTP-Patator       1.00      0.95      0.97      1587
              PortScan       0.99      0.99      0.99     31761
           SSH-Patator       0.97      0.96      0.97      1180
Web Attack Brute Force       0.50      0.01      0.01       301
        Web Attack XSS       0.00      0.00      0.00       131

             micro avg       0.99      0.99      0.99    565562
             macro avg       0.86      0.75      0.77    565562
          weighted avg       0.99      0.99      0.99    565562

2019-12-24 03:48:14,569 [INFO] Overall accuracy (micro avg): 0.9938167698678483
2019-12-24 03:48:26,301 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9938         0.9938                       0.9938                0.0006                   0.0062  0.9938
1     Macro avg        0.9990         0.8551                       0.7530                0.0018                   0.2470  0.7696
2  Weighted avg        0.9949         0.9934                       0.9938                0.0153                   0.0062  0.9933
2019-12-24 03:49:00,404 [INFO] Dataset: Training. Classification report below
2019-12-24 03:49:00,404 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00   1362791
                   Bot       0.98      0.36      0.53      1174
                  DDoS       1.00      1.00      1.00     76815
         DoS GoldenEye       0.99      0.96      0.97      6176
              DoS Hulk       0.98      0.98      0.98    138074
      DoS Slowhttptest       0.88      0.98      0.93      3300
         DoS slowloris       0.98      0.90      0.94      3478
           FTP-Patator       1.00      0.95      0.97      4761
              PortScan       0.99      0.99      0.99     95282
           SSH-Patator       0.97      0.97      0.97      3538
Web Attack Brute Force       0.78      0.02      0.03       904
        Web Attack XSS       0.00      0.00      0.00       391

             micro avg       0.99      0.99      0.99   1696684
             macro avg       0.88      0.76      0.78   1696684
          weighted avg       0.99      0.99      0.99   1696684

2019-12-24 03:49:00,404 [INFO] Overall accuracy (micro avg): 0.9938179413491257
2019-12-24 03:49:39,113 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9938         0.9938                       0.9938                0.0006                   0.0062  0.9938
1     Macro avg        0.9990         0.8789                       0.7591                0.0018                   0.2409  0.7762
2  Weighted avg        0.9948         0.9935                       0.9938                0.0154                   0.0062  0.9933
2019-12-24 03:49:39,165 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_ids17_p50/ann_data_efficiency_ids17_p50_results.xlsx
2019-12-24 03:49:39,169 [INFO] ================= Finished running experiment no. 5 ================= 

2019-12-24 03:49:39,234 [INFO] Created directory: results_additional_exps/ann_data_efficiency_ids17_p60
2019-12-24 03:49:39,234 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_ids17_p60/run_log.log
2019-12-24 03:49:39,234 [INFO] ================= Running experiment no. 6  ================= 

2019-12-24 03:49:39,234 [INFO] Experiment parameters given below
2019-12-24 03:49:39,234 [INFO] 
{'experiment_num': 6, 'results_dir': 'results_additional_exps/ann_data_efficiency_ids17_p60', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': 0.4, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/full_datasets/ids2017', 'description': 'ann_data_efficiency_ids17_p60'}
2019-12-24 03:49:39,234 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_ids17_p60/tf_logs_run_2019_12_24-03_49_39
2019-12-24 03:49:39,234 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2017
2019-12-24 03:49:39,235 [INFO] Reading X, y files
2019-12-24 03:49:39,235 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_train.h5
2019-12-24 03:49:43,321 [INFO] Reading complete. time_to_read=4.09 seconds
2019-12-24 03:49:43,321 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_val.h5
2019-12-24 03:49:44,710 [INFO] Reading complete. time_to_read=1.39 seconds
2019-12-24 03:49:44,710 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_test.h5
2019-12-24 03:49:46,097 [INFO] Reading complete. time_to_read=1.39 seconds
2019-12-24 03:49:46,097 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_train.h5
2019-12-24 03:49:46,287 [INFO] Reading complete. time_to_read=0.19 seconds
2019-12-24 03:49:46,287 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_val.h5
2019-12-24 03:49:46,355 [INFO] Reading complete. time_to_read=0.07 seconds
2019-12-24 03:49:46,355 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_test.h5
2019-12-24 03:49:46,422 [INFO] Reading complete. time_to_read=0.07 seconds
2019-12-24 03:49:49,615 [INFO] Initializing model
2019-12-24 03:49:49,726 [INFO] _________________________________________________________________
2019-12-24 03:49:49,726 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-24 03:49:49,728 [INFO] =================================================================
2019-12-24 03:49:49,728 [INFO] dense_31 (Dense)             (None, 64)                5056      
2019-12-24 03:49:49,728 [INFO] _________________________________________________________________
2019-12-24 03:49:49,728 [INFO] batch_normalization_16 (Batc (None, 64)                256       
2019-12-24 03:49:49,728 [INFO] _________________________________________________________________
2019-12-24 03:49:49,728 [INFO] dropout_16 (Dropout)         (None, 64)                0         
2019-12-24 03:49:49,728 [INFO] _________________________________________________________________
2019-12-24 03:49:49,728 [INFO] dense_32 (Dense)             (None, 12)                780       
2019-12-24 03:49:49,728 [INFO] =================================================================
2019-12-24 03:49:49,728 [INFO] Total params: 6,092
2019-12-24 03:49:49,728 [INFO] Trainable params: 5,964
2019-12-24 03:49:49,728 [INFO] Non-trainable params: 128
2019-12-24 03:49:49,728 [INFO] _________________________________________________________________
2019-12-24 03:49:49,728 [INFO] Training model
2019-12-24 03:49:49,728 [INFO] Splitting train set into 2 sets (set1, set2), random_seed = 42
2019-12-24 03:50:05,522 [INFO] Split sizes (instances). total = 1696684, set1 = 678673, set2 = 1018011, set1 dataset hash = 06bd9acc41d326ddbc14726119541f93d38abc97
2019-12-24 03:54:00,769 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p60/ann_model_epoch_10.pickle
2019-12-24 03:57:38,459 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p60/ann_model_epoch_20.pickle
2019-12-24 04:01:16,644 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p60/ann_model_epoch_30.pickle
2019-12-24 04:04:54,855 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p60/ann_model_epoch_40.pickle
2019-12-24 04:08:32,863 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p60/ann_model_epoch_50.pickle
2019-12-24 04:12:10,963 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p60/ann_model_epoch_60.pickle
2019-12-24 04:15:49,092 [INFO] epoch = 70. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p60/ann_model_epoch_70.pickle
2019-12-24 04:19:27,342 [INFO] epoch = 80. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p60/ann_model_epoch_80.pickle
2019-12-24 04:23:05,204 [INFO] epoch = 90. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p60/ann_model_epoch_90.pickle
2019-12-24 04:26:30,907 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-24 04:27:00,969 [INFO] Last epoch loss evaluation: train_loss = 0.002648, val_loss = 0.002770
2019-12-24 04:27:01,007 [INFO] Training complete. time_to_train = 2231.28 sec, 37.19 min
2019-12-24 04:27:01,519 [INFO] Model saved to results_additional_exps/ann_data_efficiency_ids17_p60/best_model.pickle
2019-12-24 04:27:01,521 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_ids17_p60/training_error_history.csv
2019-12-24 04:27:01,692 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids17_p60/training_error_history.png
2019-12-24 04:27:01,860 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids17_p60/training_f1_history.png
2019-12-24 04:27:01,860 [INFO] Making predictions on training, validation, testing data
2019-12-24 04:27:50,614 [INFO] Evaluating predictions (results)
2019-12-24 04:28:00,755 [INFO] Dataset: Testing. Classification report below
2019-12-24 04:28:00,755 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454265
                   Bot       0.97      0.36      0.52       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       0.99      0.97      0.98      2058
              DoS Hulk       0.98      0.99      0.98     46025
      DoS Slowhttptest       0.88      0.99      0.93      1100
         DoS slowloris       0.98      0.94      0.96      1159
           FTP-Patator       1.00      0.99      1.00      1587
              PortScan       0.99      1.00      1.00     31761
           SSH-Patator       0.93      0.98      0.96      1179
Web Attack Brute Force       1.00      0.08      0.15       302
        Web Attack XSS       0.00      0.00      0.00       130

             micro avg       1.00      1.00      1.00    565562
             macro avg       0.89      0.77      0.79    565562
          weighted avg       0.99      1.00      0.99    565562

2019-12-24 04:28:00,755 [INFO] Overall accuracy (micro avg): 0.9950827672297644
2019-12-24 04:28:12,302 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9951         0.9951                       0.9951                0.0004                   0.0049  0.9951
1     Macro avg        0.9992         0.8942                       0.7744                0.0012                   0.2256  0.7894
2  Weighted avg        0.9959         0.9949                       0.9951                0.0097                   0.0049  0.9947
2019-12-24 04:28:22,614 [INFO] Dataset: Validation. Classification report below
2019-12-24 04:28:22,614 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454264
                   Bot       0.98      0.31      0.47       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       0.99      0.96      0.98      2059
              DoS Hulk       0.98      0.99      0.99     46025
      DoS Slowhttptest       0.89      0.98      0.93      1099
         DoS slowloris       0.98      0.93      0.96      1159
           FTP-Patator       1.00      0.99      0.99      1587
              PortScan       0.99      1.00      1.00     31761
           SSH-Patator       0.93      0.98      0.95      1180
Web Attack Brute Force       0.93      0.04      0.08       301
        Web Attack XSS       0.24      0.03      0.05       131

             micro avg       1.00      1.00      1.00    565562
             macro avg       0.91      0.77      0.78    565562
          weighted avg       0.99      1.00      0.99    565562

2019-12-24 04:28:22,614 [INFO] Overall accuracy (micro avg): 0.9951287392010072
2019-12-24 04:28:34,330 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9951         0.9951                       0.9951                0.0004                   0.0049  0.9951
1     Macro avg        0.9992         0.9086                       0.7679                0.0012                   0.2321  0.7832
2  Weighted avg        0.9960         0.9950                       0.9951                0.0097                   0.0049  0.9947
2019-12-24 04:29:08,456 [INFO] Dataset: Training. Classification report below
2019-12-24 04:29:08,456 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00   1362791
                   Bot       0.99      0.35      0.52      1174
                  DDoS       1.00      1.00      1.00     76815
         DoS GoldenEye       0.99      0.97      0.98      6176
              DoS Hulk       0.98      0.99      0.99    138074
      DoS Slowhttptest       0.90      0.98      0.94      3300
         DoS slowloris       0.98      0.95      0.96      3478
           FTP-Patator       1.00      0.99      0.99      4761
              PortScan       0.99      1.00      1.00     95282
           SSH-Patator       0.94      0.98      0.96      3538
Web Attack Brute Force       0.98      0.07      0.12       904
        Web Attack XSS       0.43      0.03      0.06       391

             micro avg       1.00      1.00      1.00   1696684
             macro avg       0.93      0.78      0.79   1696684
          weighted avg       1.00      1.00      0.99   1696684

2019-12-24 04:29:08,456 [INFO] Overall accuracy (micro avg): 0.9952454316773188
2019-12-24 04:29:47,185 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9952         0.9952                       0.9952                0.0004                   0.0048  0.9952
1     Macro avg        0.9992         0.9320                       0.7752                0.0012                   0.2248  0.7929
2  Weighted avg        0.9961         0.9951                       0.9952                0.0097                   0.0048  0.9948
2019-12-24 04:29:47,238 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_ids17_p60/ann_data_efficiency_ids17_p60_results.xlsx
2019-12-24 04:29:47,242 [INFO] ================= Finished running experiment no. 6 ================= 

2019-12-24 04:29:47,309 [INFO] Created directory: results_additional_exps/ann_data_efficiency_ids17_p70
2019-12-24 04:29:47,310 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_ids17_p70/run_log.log
2019-12-24 04:29:47,310 [INFO] ================= Running experiment no. 7  ================= 

2019-12-24 04:29:47,310 [INFO] Experiment parameters given below
2019-12-24 04:29:47,310 [INFO] 
{'experiment_num': 7, 'results_dir': 'results_additional_exps/ann_data_efficiency_ids17_p70', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': 0.3, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/full_datasets/ids2017', 'description': 'ann_data_efficiency_ids17_p70'}
2019-12-24 04:29:47,310 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_ids17_p70/tf_logs_run_2019_12_24-04_29_47
2019-12-24 04:29:47,310 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2017
2019-12-24 04:29:47,310 [INFO] Reading X, y files
2019-12-24 04:29:47,310 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_train.h5
2019-12-24 04:29:51,344 [INFO] Reading complete. time_to_read=4.03 seconds
2019-12-24 04:29:51,344 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_val.h5
2019-12-24 04:29:52,730 [INFO] Reading complete. time_to_read=1.39 seconds
2019-12-24 04:29:52,731 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_test.h5
2019-12-24 04:29:54,116 [INFO] Reading complete. time_to_read=1.39 seconds
2019-12-24 04:29:54,116 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_train.h5
2019-12-24 04:29:54,322 [INFO] Reading complete. time_to_read=0.21 seconds
2019-12-24 04:29:54,322 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_val.h5
2019-12-24 04:29:54,390 [INFO] Reading complete. time_to_read=0.07 seconds
2019-12-24 04:29:54,390 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_test.h5
2019-12-24 04:29:54,458 [INFO] Reading complete. time_to_read=0.07 seconds
2019-12-24 04:29:57,674 [INFO] Initializing model
2019-12-24 04:29:57,783 [INFO] _________________________________________________________________
2019-12-24 04:29:57,783 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-24 04:29:57,786 [INFO] =================================================================
2019-12-24 04:29:57,786 [INFO] dense_33 (Dense)             (None, 64)                5056      
2019-12-24 04:29:57,786 [INFO] _________________________________________________________________
2019-12-24 04:29:57,786 [INFO] batch_normalization_17 (Batc (None, 64)                256       
2019-12-24 04:29:57,786 [INFO] _________________________________________________________________
2019-12-24 04:29:57,786 [INFO] dropout_17 (Dropout)         (None, 64)                0         
2019-12-24 04:29:57,786 [INFO] _________________________________________________________________
2019-12-24 04:29:57,786 [INFO] dense_34 (Dense)             (None, 12)                780       
2019-12-24 04:29:57,786 [INFO] =================================================================
2019-12-24 04:29:57,786 [INFO] Total params: 6,092
2019-12-24 04:29:57,786 [INFO] Trainable params: 5,964
2019-12-24 04:29:57,786 [INFO] Non-trainable params: 128
2019-12-24 04:29:57,786 [INFO] _________________________________________________________________
2019-12-24 04:29:57,786 [INFO] Training model
2019-12-24 04:29:57,786 [INFO] Splitting train set into 2 sets (set1, set2), random_seed = 42
2019-12-24 04:30:13,698 [INFO] Split sizes (instances). total = 1696684, set1 = 509005, set2 = 1187679, set1 dataset hash = 5816bf5a542d5b8ebee12e14793df8cd28c1926f
2019-12-24 04:34:32,218 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p70/ann_model_epoch_10.pickle
2019-12-24 04:38:31,092 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p70/ann_model_epoch_20.pickle
2019-12-24 04:42:30,001 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p70/ann_model_epoch_30.pickle
2019-12-24 04:46:29,363 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p70/ann_model_epoch_40.pickle
2019-12-24 04:50:27,962 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p70/ann_model_epoch_50.pickle
2019-12-24 04:54:27,013 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p70/ann_model_epoch_60.pickle
2019-12-24 04:58:25,195 [INFO] epoch = 70. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p70/ann_model_epoch_70.pickle
2019-12-24 05:02:24,506 [INFO] epoch = 80. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p70/ann_model_epoch_80.pickle
2019-12-24 05:06:23,454 [INFO] epoch = 90. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p70/ann_model_epoch_90.pickle
2019-12-24 05:10:08,491 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-24 05:10:42,633 [INFO] Last epoch loss evaluation: train_loss = 0.002539, val_loss = 0.002620
2019-12-24 05:10:42,669 [INFO] Training complete. time_to_train = 2444.88 sec, 40.75 min
2019-12-24 05:10:43,103 [INFO] Model saved to results_additional_exps/ann_data_efficiency_ids17_p70/best_model.pickle
2019-12-24 05:10:43,105 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_ids17_p70/training_error_history.csv
2019-12-24 05:10:43,287 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids17_p70/training_error_history.png
2019-12-24 05:10:43,453 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids17_p70/training_f1_history.png
2019-12-24 05:10:43,453 [INFO] Making predictions on training, validation, testing data
2019-12-24 05:11:34,097 [INFO] Evaluating predictions (results)
2019-12-24 05:11:44,229 [INFO] Dataset: Testing. Classification report below
2019-12-24 05:11:44,229 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454265
                   Bot       0.97      0.37      0.54       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       1.00      0.98      0.99      2058
              DoS Hulk       0.96      1.00      0.98     46025
      DoS Slowhttptest       0.88      0.99      0.93      1100
         DoS slowloris       0.99      0.97      0.98      1159
           FTP-Patator       1.00      1.00      1.00      1587
              PortScan       0.99      1.00      1.00     31761
           SSH-Patator       0.94      0.98      0.96      1179
Web Attack Brute Force       0.00      0.00      0.00       302
        Web Attack XSS       0.00      0.00      0.00       130

             micro avg       0.99      0.99      0.99    565562
             macro avg       0.81      0.77      0.78    565562
          weighted avg       0.99      0.99      0.99    565562

2019-12-24 05:11:44,229 [INFO] Overall accuracy (micro avg): 0.9946831647105003
2019-12-24 05:11:55,769 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9947         0.9947                       0.9947                0.0005                   0.0053  0.9947
1     Macro avg        0.9991         0.8106                       0.7735                0.0010                   0.2265  0.7806
2  Weighted avg        0.9956         0.9941                       0.9947                0.0062                   0.0053  0.9942
2019-12-24 05:12:06,091 [INFO] Dataset: Validation. Classification report below
2019-12-24 05:12:06,091 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454264
                   Bot       0.99      0.35      0.51       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       0.99      0.97      0.98      2059
              DoS Hulk       0.96      1.00      0.98     46025
      DoS Slowhttptest       0.89      0.98      0.93      1099
         DoS slowloris       0.98      0.97      0.98      1159
           FTP-Patator       0.99      1.00      0.99      1587
              PortScan       0.99      1.00      1.00     31761
           SSH-Patator       0.95      0.98      0.96      1180
Web Attack Brute Force       0.00      0.00      0.00       301
        Web Attack XSS       0.25      0.02      0.03       131

             micro avg       0.99      0.99      0.99    565562
             macro avg       0.83      0.77      0.78    565562
          weighted avg       0.99      0.99      0.99    565562

2019-12-24 05:12:06,091 [INFO] Overall accuracy (micro avg): 0.9947061506961218
2019-12-24 05:12:17,796 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9947         0.9947                       0.9947                0.0005                   0.0053  0.9947
1     Macro avg        0.9991         0.8331                       0.7712                0.0010                   0.2288  0.7804
2  Weighted avg        0.9956         0.9941                       0.9947                0.0062                   0.0053  0.9943
2019-12-24 05:12:51,857 [INFO] Dataset: Training. Classification report below
2019-12-24 05:12:51,857 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00   1362791
                   Bot       0.99      0.37      0.54      1174
                  DDoS       1.00      1.00      1.00     76815
         DoS GoldenEye       0.99      0.98      0.99      6176
              DoS Hulk       0.97      1.00      0.98    138074
      DoS Slowhttptest       0.90      0.98      0.94      3300
         DoS slowloris       0.99      0.98      0.98      3478
           FTP-Patator       0.99      1.00      1.00      4761
              PortScan       0.99      1.00      1.00     95282
           SSH-Patator       0.95      0.98      0.97      3538
Web Attack Brute Force       0.00      0.00      0.00       904
        Web Attack XSS       0.63      0.03      0.06       391

             micro avg       0.99      0.99      0.99   1696684
             macro avg       0.87      0.78      0.79   1696684
          weighted avg       0.99      0.99      0.99   1696684

2019-12-24 05:12:51,857 [INFO] Overall accuracy (micro avg): 0.9948145912851185
2019-12-24 05:13:30,546 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9948         0.9948                       0.9948                0.0005                   0.0052  0.9948
1     Macro avg        0.9991         0.8667                       0.7758                0.0009                   0.2242  0.7865
2  Weighted avg        0.9957         0.9943                       0.9948                0.0061                   0.0052  0.9944
2019-12-24 05:13:30,597 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_ids17_p70/ann_data_efficiency_ids17_p70_results.xlsx
2019-12-24 05:13:30,600 [INFO] ================= Finished running experiment no. 7 ================= 

2019-12-24 05:13:30,669 [INFO] Created directory: results_additional_exps/ann_data_efficiency_ids17_p80
2019-12-24 05:13:30,670 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_ids17_p80/run_log.log
2019-12-24 05:13:30,670 [INFO] ================= Running experiment no. 8  ================= 

2019-12-24 05:13:30,670 [INFO] Experiment parameters given below
2019-12-24 05:13:30,670 [INFO] 
{'experiment_num': 8, 'results_dir': 'results_additional_exps/ann_data_efficiency_ids17_p80', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': 0.2, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/full_datasets/ids2017', 'description': 'ann_data_efficiency_ids17_p80'}
2019-12-24 05:13:30,670 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_ids17_p80/tf_logs_run_2019_12_24-05_13_30
2019-12-24 05:13:30,670 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2017
2019-12-24 05:13:30,672 [INFO] Reading X, y files
2019-12-24 05:13:30,672 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_train.h5
2019-12-24 05:13:34,767 [INFO] Reading complete. time_to_read=4.10 seconds
2019-12-24 05:13:34,767 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_val.h5
2019-12-24 05:13:36,150 [INFO] Reading complete. time_to_read=1.38 seconds
2019-12-24 05:13:36,151 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_test.h5
2019-12-24 05:13:37,543 [INFO] Reading complete. time_to_read=1.39 seconds
2019-12-24 05:13:37,543 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_train.h5
2019-12-24 05:13:37,738 [INFO] Reading complete. time_to_read=0.20 seconds
2019-12-24 05:13:37,738 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_val.h5
2019-12-24 05:13:37,806 [INFO] Reading complete. time_to_read=0.07 seconds
2019-12-24 05:13:37,806 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_test.h5
2019-12-24 05:13:37,874 [INFO] Reading complete. time_to_read=0.07 seconds
2019-12-24 05:13:41,086 [INFO] Initializing model
2019-12-24 05:13:41,195 [INFO] _________________________________________________________________
2019-12-24 05:13:41,195 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-24 05:13:41,197 [INFO] =================================================================
2019-12-24 05:13:41,197 [INFO] dense_35 (Dense)             (None, 64)                5056      
2019-12-24 05:13:41,197 [INFO] _________________________________________________________________
2019-12-24 05:13:41,198 [INFO] batch_normalization_18 (Batc (None, 64)                256       
2019-12-24 05:13:41,198 [INFO] _________________________________________________________________
2019-12-24 05:13:41,198 [INFO] dropout_18 (Dropout)         (None, 64)                0         
2019-12-24 05:13:41,198 [INFO] _________________________________________________________________
2019-12-24 05:13:41,198 [INFO] dense_36 (Dense)             (None, 12)                780       
2019-12-24 05:13:41,198 [INFO] =================================================================
2019-12-24 05:13:41,198 [INFO] Total params: 6,092
2019-12-24 05:13:41,198 [INFO] Trainable params: 5,964
2019-12-24 05:13:41,198 [INFO] Non-trainable params: 128
2019-12-24 05:13:41,198 [INFO] _________________________________________________________________
2019-12-24 05:13:41,198 [INFO] Training model
2019-12-24 05:13:41,198 [INFO] Splitting train set into 2 sets (set1, set2), random_seed = 42
2019-12-24 05:13:57,113 [INFO] Split sizes (instances). total = 1696684, set1 = 339336, set2 = 1357348, set1 dataset hash = 608d57cae1623e8c637717b29955993cba0e7107
2019-12-24 05:18:39,529 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p80/ann_model_epoch_10.pickle
2019-12-24 05:23:03,827 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p80/ann_model_epoch_20.pickle
2019-12-24 05:27:27,434 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p80/ann_model_epoch_30.pickle
2019-12-24 05:31:51,226 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p80/ann_model_epoch_40.pickle
2019-12-24 05:36:15,408 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p80/ann_model_epoch_50.pickle
2019-12-24 05:38:11,563 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-24 05:38:49,663 [INFO] Last epoch loss evaluation: train_loss = 0.002871, val_loss = 0.002939
2019-12-24 05:38:49,703 [INFO] Training complete. time_to_train = 1508.50 sec, 25.14 min
2019-12-24 05:38:50,146 [INFO] Model saved to results_additional_exps/ann_data_efficiency_ids17_p80/best_model.pickle
2019-12-24 05:38:50,148 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_ids17_p80/training_error_history.csv
2019-12-24 05:38:50,329 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids17_p80/training_error_history.png
2019-12-24 05:38:50,501 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids17_p80/training_f1_history.png
2019-12-24 05:38:50,501 [INFO] Making predictions on training, validation, testing data
2019-12-24 05:39:42,596 [INFO] Evaluating predictions (results)
2019-12-24 05:39:52,717 [INFO] Dataset: Testing. Classification report below
2019-12-24 05:39:52,717 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454265
                   Bot       0.97      0.37      0.54       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       1.00      0.96      0.98      2058
              DoS Hulk       0.97      1.00      0.98     46025
      DoS Slowhttptest       0.89      0.99      0.94      1100
         DoS slowloris       0.98      0.94      0.96      1159
           FTP-Patator       1.00      0.99      0.99      1587
              PortScan       0.99      0.99      0.99     31761
           SSH-Patator       0.93      0.98      0.96      1179
Web Attack Brute Force       1.00      0.08      0.15       302
        Web Attack XSS       0.00      0.00      0.00       130

             micro avg       0.99      0.99      0.99    565562
             macro avg       0.89      0.77      0.79    565562
          weighted avg       0.99      0.99      0.99    565562

2019-12-24 05:39:52,717 [INFO] Overall accuracy (micro avg): 0.9948582118317709
2019-12-24 05:40:04,240 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9949         0.9949                       0.9949                0.0005                   0.0051  0.9949
1     Macro avg        0.9991         0.8943                       0.7749                0.0011                   0.2251  0.7905
2  Weighted avg        0.9957         0.9947                       0.9949                0.0086                   0.0051  0.9945
2019-12-24 05:40:14,546 [INFO] Dataset: Validation. Classification report below
2019-12-24 05:40:14,546 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454264
                   Bot       0.97      0.34      0.50       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       0.99      0.95      0.97      2059
              DoS Hulk       0.97      1.00      0.98     46025
      DoS Slowhttptest       0.89      0.98      0.94      1099
         DoS slowloris       0.98      0.94      0.96      1159
           FTP-Patator       0.99      0.99      0.99      1587
              PortScan       0.99      0.99      0.99     31761
           SSH-Patator       0.94      0.98      0.96      1180
Web Attack Brute Force       1.00      0.04      0.08       301
        Web Attack XSS       1.00      0.03      0.06       131

             micro avg       0.99      0.99      0.99    565562
             macro avg       0.98      0.77      0.79    565562
          weighted avg       0.99      0.99      0.99    565562

2019-12-24 05:40:14,546 [INFO] Overall accuracy (micro avg): 0.9948352258461495
2019-12-24 05:40:26,235 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9948         0.9948                       0.9948                0.0005                   0.0052  0.9948
1     Macro avg        0.9991         0.9782                       0.7693                0.0012                   0.2307  0.7860
2  Weighted avg        0.9957         0.9949                       0.9948                0.0088                   0.0052  0.9944
2019-12-24 05:41:00,283 [INFO] Dataset: Training. Classification report below
2019-12-24 05:41:00,283 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00   1362791
                   Bot       0.98      0.36      0.53      1174
                  DDoS       1.00      1.00      1.00     76815
         DoS GoldenEye       0.99      0.96      0.97      6176
              DoS Hulk       0.97      1.00      0.99    138074
      DoS Slowhttptest       0.91      0.99      0.94      3300
         DoS slowloris       0.98      0.95      0.97      3478
           FTP-Patator       1.00      0.99      0.99      4761
              PortScan       0.99      0.99      0.99     95282
           SSH-Patator       0.95      0.98      0.97      3538
Web Attack Brute Force       1.00      0.07      0.12       904
        Web Attack XSS       1.00      0.03      0.06       391

             micro avg       1.00      1.00      1.00   1696684
             macro avg       0.98      0.78      0.79   1696684
          weighted avg       1.00      1.00      0.99   1696684

2019-12-24 05:41:00,285 [INFO] Overall accuracy (micro avg): 0.9950102670856801
2019-12-24 05:41:38,943 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9950         0.9950                       0.9950                0.0005                   0.0050  0.9950
1     Macro avg        0.9992         0.9812                       0.7754                0.0011                   0.2246  0.7939
2  Weighted avg        0.9958         0.9951                       0.9950                0.0085                   0.0050  0.9946
2019-12-24 05:41:38,994 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_ids17_p80/ann_data_efficiency_ids17_p80_results.xlsx
2019-12-24 05:41:38,998 [INFO] ================= Finished running experiment no. 8 ================= 

2019-12-24 05:41:39,063 [INFO] Created directory: results_additional_exps/ann_data_efficiency_ids17_p90
2019-12-24 10:40:41,570 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_ids17_p90/run_log.log
2019-12-24 10:40:41,570 [INFO] ================= Running experiment no. 9  ================= 

2019-12-24 10:40:41,570 [INFO] Experiment parameters given below
2019-12-24 10:40:41,570 [INFO] 
{'experiment_num': 9, 'results_dir': 'results_additional_exps/ann_data_efficiency_ids17_p90', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': 0.1, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/full_datasets/ids2017', 'description': 'ann_data_efficiency_ids17_p90'}
2019-12-24 10:40:41,570 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_ids17_p90/tf_logs_run_2019_12_24-10_40_41
2019-12-24 10:40:41,570 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2017
2019-12-24 10:40:41,571 [INFO] Reading X, y files
2019-12-24 10:40:41,571 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_train.h5
2019-12-24 10:40:45,796 [INFO] Reading complete. time_to_read=4.23 seconds
2019-12-24 10:40:45,796 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_val.h5
2019-12-24 10:40:47,178 [INFO] Reading complete. time_to_read=1.38 seconds
2019-12-24 10:40:47,178 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_test.h5
2019-12-24 10:40:48,560 [INFO] Reading complete. time_to_read=1.38 seconds
2019-12-24 10:40:48,560 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_train.h5
2019-12-24 10:40:48,788 [INFO] Reading complete. time_to_read=0.23 seconds
2019-12-24 10:40:48,788 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_val.h5
2019-12-24 10:40:48,856 [INFO] Reading complete. time_to_read=0.07 seconds
2019-12-24 10:40:48,857 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_test.h5
2019-12-24 10:40:48,925 [INFO] Reading complete. time_to_read=0.07 seconds
2019-12-24 10:40:52,108 [INFO] Initializing model
2019-12-24 10:40:52,122 [WARNING] From /home/sunanda/test/ml_env/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
2019-12-24 10:40:52,184 [WARNING] From /home/sunanda/test/ml_env/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2019-12-24 10:40:52,222 [INFO] _________________________________________________________________
2019-12-24 10:40:52,222 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-24 10:40:52,222 [INFO] =================================================================
2019-12-24 10:40:52,222 [INFO] dense_1 (Dense)              (None, 64)                5056      
2019-12-24 10:40:52,222 [INFO] _________________________________________________________________
2019-12-24 10:40:52,222 [INFO] batch_normalization_1 (Batch (None, 64)                256       
2019-12-24 10:40:52,222 [INFO] _________________________________________________________________
2019-12-24 10:40:52,222 [INFO] dropout_1 (Dropout)          (None, 64)                0         
2019-12-24 10:40:52,222 [INFO] _________________________________________________________________
2019-12-24 10:40:52,222 [INFO] dense_2 (Dense)              (None, 12)                780       
2019-12-24 10:40:52,222 [INFO] =================================================================
2019-12-24 10:40:52,223 [INFO] Total params: 6,092
2019-12-24 10:40:52,223 [INFO] Trainable params: 5,964
2019-12-24 10:40:52,223 [INFO] Non-trainable params: 128
2019-12-24 10:40:52,223 [INFO] _________________________________________________________________
2019-12-24 10:40:52,223 [INFO] Training model
2019-12-24 10:40:52,223 [INFO] Splitting train set into 2 sets (set1, set2), random_seed = 42
2019-12-24 10:41:07,278 [INFO] Split sizes (instances). total = 1696684, set1 = 169668, set2 = 1527016, set1 dataset hash = b4dc996d07489b6111147e4be7f283553bb61629
2019-12-24 10:41:07,808 [WARNING] From /home/sunanda/test/ml_env/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2019-12-24 10:44:33,994 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p90/ann_model_epoch_10.pickle
2019-12-24 10:47:44,798 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p90/ann_model_epoch_20.pickle
2019-12-24 10:50:55,114 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p90/ann_model_epoch_30.pickle
2019-12-24 10:54:05,414 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p90/ann_model_epoch_40.pickle
2019-12-24 10:57:16,087 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p90/ann_model_epoch_50.pickle
2019-12-24 11:00:26,393 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p90/ann_model_epoch_60.pickle
2019-12-24 11:03:36,926 [INFO] epoch = 70. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p90/ann_model_epoch_70.pickle
2019-12-24 11:06:47,198 [INFO] epoch = 80. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p90/ann_model_epoch_80.pickle
2019-12-24 11:09:58,240 [INFO] epoch = 90. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p90/ann_model_epoch_90.pickle
2019-12-24 11:12:54,574 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-24 11:13:16,561 [INFO] Last epoch loss evaluation: train_loss = 0.002579, val_loss = 0.002603
2019-12-24 11:13:16,598 [INFO] Training complete. time_to_train = 1944.37 sec, 32.41 min
2019-12-24 11:13:16,601 [INFO] Model saved to results_additional_exps/ann_data_efficiency_ids17_p90/best_model.pickle
2019-12-24 11:13:16,605 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_ids17_p90/training_error_history.csv
2019-12-24 11:13:16,797 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids17_p90/training_error_history.png
2019-12-24 11:13:16,968 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids17_p90/training_f1_history.png
2019-12-24 11:13:16,968 [INFO] Making predictions on training, validation, testing data
2019-12-24 11:13:38,725 [INFO] Evaluating predictions (results)
2019-12-24 11:13:49,076 [INFO] Dataset: Testing. Classification report below
2019-12-24 11:13:49,076 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454265
                   Bot       0.97      0.38      0.55       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       1.00      0.97      0.98      2058
              DoS Hulk       0.97      1.00      0.99     46025
      DoS Slowhttptest       0.88      0.99      0.93      1100
         DoS slowloris       0.98      0.93      0.95      1159
           FTP-Patator       1.00      0.99      1.00      1587
              PortScan       0.99      1.00      0.99     31761
           SSH-Patator       0.95      0.98      0.96      1179
Web Attack Brute Force       1.00      0.06      0.11       302
        Web Attack XSS       0.00      0.00      0.00       130

             micro avg       1.00      1.00      1.00    565562
             macro avg       0.90      0.77      0.79    565562
          weighted avg       1.00      1.00      0.99    565562

2019-12-24 11:13:49,076 [INFO] Overall accuracy (micro avg): 0.9952030016160917
2019-12-24 11:14:00,707 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9952         0.9952                       0.9952                0.0004                   0.0048  0.9952
1     Macro avg        0.9992         0.8952                       0.7742                0.0010                   0.2258  0.7887
2  Weighted avg        0.9961         0.9950                       0.9952                0.0075                   0.0048  0.9948
2019-12-24 11:14:11,087 [INFO] Dataset: Validation. Classification report below
2019-12-24 11:14:11,088 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454264
                   Bot       0.97      0.35      0.51       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       1.00      0.97      0.98      2059
              DoS Hulk       0.97      1.00      0.99     46025
      DoS Slowhttptest       0.88      0.98      0.93      1099
         DoS slowloris       0.98      0.93      0.95      1159
           FTP-Patator       0.99      0.99      0.99      1587
              PortScan       0.99      1.00      1.00     31761
           SSH-Patator       0.95      0.97      0.96      1180
Web Attack Brute Force       1.00      0.04      0.08       301
        Web Attack XSS       1.00      0.02      0.03       131

             micro avg       1.00      1.00      1.00    565562
             macro avg       0.98      0.77      0.78    565562
          weighted avg       1.00      1.00      0.99    565562

2019-12-24 11:14:11,088 [INFO] Overall accuracy (micro avg): 0.9952684232674756
2019-12-24 11:14:22,857 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9953         0.9953                       0.9953                0.0004                   0.0047  0.9953
1     Macro avg        0.9992         0.9782                       0.7691                0.0010                   0.2309  0.7842
2  Weighted avg        0.9961         0.9953                       0.9953                0.0073                   0.0047  0.9948
2019-12-24 11:14:56,861 [INFO] Dataset: Training. Classification report below
2019-12-24 11:14:56,861 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00   1362791
                   Bot       0.98      0.37      0.54      1174
                  DDoS       1.00      1.00      1.00     76815
         DoS GoldenEye       0.99      0.97      0.98      6176
              DoS Hulk       0.97      1.00      0.99    138074
      DoS Slowhttptest       0.90      0.98      0.94      3300
         DoS slowloris       0.98      0.94      0.96      3478
           FTP-Patator       1.00      0.99      0.99      4761
              PortScan       0.99      1.00      0.99     95282
           SSH-Patator       0.96      0.98      0.97      3538
Web Attack Brute Force       1.00      0.05      0.09       904
        Web Attack XSS       1.00      0.03      0.06       391

             micro avg       1.00      1.00      1.00   1696684
             macro avg       0.98      0.78      0.79   1696684
          weighted avg       1.00      1.00      0.99   1696684

2019-12-24 11:14:56,862 [INFO] Overall accuracy (micro avg): 0.9953544678914872
2019-12-24 11:15:35,461 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9954         0.9954                       0.9954                0.0004                   0.0046  0.9954
1     Macro avg        0.9992         0.9815                       0.7755                0.0010                   0.2245  0.7926
2  Weighted avg        0.9962         0.9954                       0.9954                0.0074                   0.0046  0.9949
2019-12-24 11:15:35,513 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_ids17_p90/ann_data_efficiency_ids17_p90_results.xlsx
2019-12-24 11:15:35,519 [INFO] ================= Finished running experiment no. 9 ================= 

2019-12-24 11:15:35,586 [INFO] Created directory: results_additional_exps/ann_data_efficiency_ids17_p100
2019-12-24 11:15:35,587 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_ids17_p100/run_log.log
2019-12-24 11:15:35,587 [INFO] ================= Running experiment no. 10  ================= 

2019-12-24 11:15:35,587 [INFO] Experiment parameters given below
2019-12-24 11:15:35,587 [INFO] 
{'experiment_num': 10, 'results_dir': 'results_additional_exps/ann_data_efficiency_ids17_p100', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': -1, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/full_datasets/ids2017', 'description': 'ann_data_efficiency_ids17_p100'}
2019-12-24 11:15:35,587 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_ids17_p100/tf_logs_run_2019_12_24-11_15_35
2019-12-24 11:15:35,587 [INFO] Loading datsets from: ../Datasets/full_datasets/ids2017
2019-12-24 11:15:35,587 [INFO] Reading X, y files
2019-12-24 11:15:35,588 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_train.h5
2019-12-24 11:15:39,622 [INFO] Reading complete. time_to_read=4.03 seconds
2019-12-24 11:15:39,622 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_val.h5
2019-12-24 11:15:40,996 [INFO] Reading complete. time_to_read=1.37 seconds
2019-12-24 11:15:40,996 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/X_test.h5
2019-12-24 11:15:42,373 [INFO] Reading complete. time_to_read=1.38 seconds
2019-12-24 11:15:42,374 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_train.h5
2019-12-24 11:15:42,587 [INFO] Reading complete. time_to_read=0.21 seconds
2019-12-24 11:15:42,587 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_val.h5
2019-12-24 11:15:42,655 [INFO] Reading complete. time_to_read=0.07 seconds
2019-12-24 11:15:42,655 [INFO] Reading HDF dataset ../Datasets/full_datasets/ids2017/y_test.h5
2019-12-24 11:15:42,722 [INFO] Reading complete. time_to_read=0.07 seconds
2019-12-24 11:15:45,895 [INFO] Initializing model
2019-12-24 11:15:46,000 [INFO] _________________________________________________________________
2019-12-24 11:15:46,000 [INFO] Layer (type)                 Output Shape              Param #   
2019-12-24 11:15:46,002 [INFO] =================================================================
2019-12-24 11:15:46,003 [INFO] dense_3 (Dense)              (None, 64)                5056      
2019-12-24 11:15:46,003 [INFO] _________________________________________________________________
2019-12-24 11:15:46,003 [INFO] batch_normalization_2 (Batch (None, 64)                256       
2019-12-24 11:15:46,003 [INFO] _________________________________________________________________
2019-12-24 11:15:46,003 [INFO] dropout_2 (Dropout)          (None, 64)                0         
2019-12-24 11:15:46,003 [INFO] _________________________________________________________________
2019-12-24 11:15:46,003 [INFO] dense_4 (Dense)              (None, 12)                780       
2019-12-24 11:15:46,003 [INFO] =================================================================
2019-12-24 11:15:46,004 [INFO] Total params: 6,092
2019-12-24 11:15:46,004 [INFO] Trainable params: 5,964
2019-12-24 11:15:46,004 [INFO] Non-trainable params: 128
2019-12-24 11:15:46,004 [INFO] _________________________________________________________________
2019-12-24 11:15:46,004 [INFO] Training model
2019-12-24 11:19:32,978 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p100/ann_model_epoch_10.pickle
2019-12-24 11:23:02,769 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p100/ann_model_epoch_20.pickle
2019-12-24 11:26:32,553 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p100/ann_model_epoch_30.pickle
2019-12-24 11:30:03,289 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p100/ann_model_epoch_40.pickle
2019-12-24 11:33:33,753 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p100/ann_model_epoch_50.pickle
2019-12-24 11:37:03,703 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p100/ann_model_epoch_60.pickle
2019-12-24 11:40:33,579 [INFO] epoch = 70. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p100/ann_model_epoch_70.pickle
2019-12-24 11:44:04,081 [INFO] epoch = 80. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids17_p100/ann_model_epoch_80.pickle
2019-12-24 11:46:57,409 [INFO] WeightRestorer::on_train_end(): restoring best weights
2019-12-24 11:47:22,262 [INFO] Last epoch loss evaluation: train_loss = 0.002398, val_loss = 0.002455
2019-12-24 11:47:22,262 [INFO] Training complete. time_to_train = 1896.26 sec, 31.60 min
2019-12-24 11:47:22,265 [INFO] Model saved to results_additional_exps/ann_data_efficiency_ids17_p100/best_model.pickle
2019-12-24 11:47:22,268 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_ids17_p100/training_error_history.csv
2019-12-24 11:47:22,449 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids17_p100/training_error_history.png
2019-12-24 11:47:22,614 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids17_p100/training_f1_history.png
2019-12-24 11:47:22,614 [INFO] Making predictions on training, validation, testing data
2019-12-24 11:47:46,015 [INFO] Evaluating predictions (results)
2019-12-24 11:47:56,140 [INFO] Dataset: Testing. Classification report below
2019-12-24 11:47:56,140 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454265
                   Bot       0.94      0.38      0.54       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       0.99      0.99      0.99      2058
              DoS Hulk       0.98      0.99      0.98     46025
      DoS Slowhttptest       0.88      0.99      0.93      1100
         DoS slowloris       0.98      0.97      0.97      1159
           FTP-Patator       1.00      1.00      1.00      1587
              PortScan       0.99      1.00      1.00     31761
           SSH-Patator       0.93      0.98      0.96      1179
Web Attack Brute Force       0.66      0.87      0.75       302
        Web Attack XSS       0.20      0.01      0.01       130

             micro avg       1.00      1.00      1.00    565562
             macro avg       0.88      0.85      0.84    565562
          weighted avg       1.00      1.00      1.00    565562

2019-12-24 11:47:56,140 [INFO] Overall accuracy (micro avg): 0.9955707773860337
2019-12-24 11:48:07,655 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9956         0.9956                       0.9956                0.0004                   0.0044  0.9956
1     Macro avg        0.9993         0.8795                       0.8469                0.0008                   0.1531  0.8441
2  Weighted avg        0.9965         0.9955                       0.9956                0.0055                   0.0044  0.9954
2019-12-24 11:48:17,964 [INFO] Dataset: Validation. Classification report below
2019-12-24 11:48:17,964 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00    454264
                   Bot       0.97      0.36      0.53       391
                  DDoS       1.00      1.00      1.00     25605
         DoS GoldenEye       0.99      0.98      0.99      2059
              DoS Hulk       0.98      0.99      0.98     46025
      DoS Slowhttptest       0.89      0.98      0.93      1099
         DoS slowloris       0.97      0.97      0.97      1159
           FTP-Patator       0.99      1.00      0.99      1587
              PortScan       0.99      1.00      1.00     31761
           SSH-Patator       0.93      0.98      0.95      1180
Web Attack Brute Force       0.66      0.86      0.75       301
        Web Attack XSS       0.50      0.03      0.06       131

             micro avg       1.00      1.00      1.00    565562
             macro avg       0.91      0.85      0.85    565562
          weighted avg       1.00      1.00      1.00    565562

2019-12-24 11:48:17,965 [INFO] Overall accuracy (micro avg): 0.9956927799251011
2019-12-24 11:48:29,660 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9957         0.9957                       0.9957                0.0004                   0.0043  0.9957
1     Macro avg        0.9993         0.9058                       0.8454                0.0008                   0.1546  0.8455
2  Weighted avg        0.9966         0.9957                       0.9957                0.0052                   0.0043  0.9955
2019-12-24 11:49:03,856 [INFO] Dataset: Training. Classification report below
2019-12-24 11:49:03,857 [INFO] 
                        precision    recall  f1-score   support

                BENIGN       1.00      1.00      1.00   1362791
                   Bot       0.96      0.37      0.53      1174
                  DDoS       1.00      1.00      1.00     76815
         DoS GoldenEye       0.99      0.99      0.99      6176
              DoS Hulk       0.98      0.99      0.98    138074
      DoS Slowhttptest       0.90      0.98      0.94      3300
         DoS slowloris       0.98      0.98      0.98      3478
           FTP-Patator       0.99      0.99      0.99      4761
              PortScan       0.99      1.00      1.00     95282
           SSH-Patator       0.95      0.98      0.96      3538
Web Attack Brute Force       0.68      0.90      0.78       904
        Web Attack XSS       0.44      0.04      0.07       391

             micro avg       1.00      1.00      1.00   1696684
             macro avg       0.91      0.85      0.85   1696684
          weighted avg       1.00      1.00      1.00   1696684

2019-12-24 11:49:03,857 [INFO] Overall accuracy (micro avg): 0.9958177244554672
2019-12-24 11:49:42,681 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9958         0.9958                       0.9958                0.0004                   0.0042  0.9958
1     Macro avg        0.9993         0.9052                       0.8518                0.0008                   0.1482  0.8522
2  Weighted avg        0.9967         0.9958                       0.9958                0.0052                   0.0042  0.9957
2019-12-24 11:49:42,733 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_ids17_p100/ann_data_efficiency_ids17_p100_results.xlsx
2019-12-24 11:49:42,737 [INFO] ================= Finished running experiment no. 10 ================= 

2019-12-24 11:49:42,806 [INFO] ================= Finished running 2 experiments ================= 

Using TensorFlow backend.
2020-01-07 21:06:40,767 [INFO] Read 7 experiments from file: experiment_specs/additional_exps/ann_data_efficiency.csv
2020-01-07 21:06:40,767 [INFO] ================= Started running experiments ================= 

2020-01-07 21:06:40,767 [INFO] Created directory: results_additional_exps/ann_data_efficiency_ids18_p10
2020-01-07 21:06:40,767 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_ids18_p10/run_log.log
2020-01-07 21:06:40,767 [INFO] ================= Running experiment no. 1  ================= 

2020-01-07 21:06:40,767 [INFO] Experiment parameters given below
2020-01-07 21:06:40,767 [INFO] 
{'experiment_num': 1, 'results_dir': 'results_additional_exps/ann_data_efficiency_ids18_p10', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': 0.9, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/ids2018', 'description': 'ann_data_efficiency_ids18_p10'}
2020-01-07 21:06:40,767 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_ids18_p10/tf_logs_run_2020_01_07-21_06_40
2020-01-07 21:06:40,767 [INFO] Loading datsets from: ../Datasets/small_datasets/ids2018
2020-01-07 21:06:40,770 [INFO] Reading X, y files
2020-01-07 21:06:40,770 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_train.h5
2020-01-07 21:06:45,953 [INFO] Reading complete. time_to_read=5.18 seconds
2020-01-07 21:06:45,953 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_val.h5
2020-01-07 21:06:47,477 [INFO] Reading complete. time_to_read=1.52 seconds
2020-01-07 21:06:47,477 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_test.h5
2020-01-07 21:06:48,995 [INFO] Reading complete. time_to_read=1.52 seconds
2020-01-07 21:06:48,995 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_train.h5
2020-01-07 21:06:49,301 [INFO] Reading complete. time_to_read=0.31 seconds
2020-01-07 21:06:49,301 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_val.h5
2020-01-07 21:06:49,395 [INFO] Reading complete. time_to_read=0.09 seconds
2020-01-07 21:06:49,396 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_test.h5
2020-01-07 21:06:49,489 [INFO] Reading complete. time_to_read=0.09 seconds
2020-01-07 21:06:53,114 [INFO] Initializing model
WARNING:tensorflow:From /home/sunanda/test/ml_env/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
2020-01-07 21:06:53,127 [WARNING] From /home/sunanda/test/ml_env/lib/python3.6/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /home/sunanda/test/ml_env/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2020-01-07 21:06:53,188 [WARNING] From /home/sunanda/test/ml_env/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2020-01-07 21:06:53,225 [INFO] _________________________________________________________________
2020-01-07 21:06:53,225 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-07 21:06:53,225 [INFO] =================================================================
2020-01-07 21:06:53,225 [INFO] dense_1 (Dense)              (None, 64)                4992      
2020-01-07 21:06:53,225 [INFO] _________________________________________________________________
2020-01-07 21:06:53,225 [INFO] batch_normalization_1 (Batch (None, 64)                256       
2020-01-07 21:06:53,226 [INFO] _________________________________________________________________
2020-01-07 21:06:53,226 [INFO] dropout_1 (Dropout)          (None, 64)                0         
2020-01-07 21:06:53,226 [INFO] _________________________________________________________________
2020-01-07 21:06:53,226 [INFO] dense_2 (Dense)              (None, 15)                975       
2020-01-07 21:06:53,226 [INFO] =================================================================
2020-01-07 21:06:53,226 [INFO] Total params: 6,223
2020-01-07 21:06:53,226 [INFO] Trainable params: 6,095
2020-01-07 21:06:53,226 [INFO] Non-trainable params: 128
2020-01-07 21:06:53,226 [INFO] _________________________________________________________________
2020-01-07 21:06:53,226 [INFO] Training model
2020-01-07 21:06:53,226 [INFO] Splitting train set into 2 sets (set1, set2), random_seed = 42
2020-01-07 21:07:13,269 [INFO] Split sizes (instances). total = 1936462, set1 = 1742815, set2 = 193647, set1 dataset hash = 615a102cf1b0aa558c2e8a74263cb743d417dd4e
WARNING:tensorflow:From /home/sunanda/test/ml_env/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2020-01-07 21:07:13,659 [WARNING] From /home/sunanda/test/ml_env/lib/python3.6/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
2020-01-07 21:07:13.927158: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-01-07 21:07:13.948789: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3299620000 Hz
2020-01-07 21:07:13.948983: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x58759e0 executing computations on platform Host. Devices:
2020-01-07 21:07:13.949008: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
Train on 193647 samples, validate on 645487 samples
Epoch 1/100
 - 3s - loss: 0.0539 - val_loss: 0.0144
 - val_f1: 0.9633
Epoch 2/100
 - 3s - loss: 0.0133 - val_loss: 0.0107
 - val_f1: 0.9743
Epoch 3/100
 - 3s - loss: 0.0111 - val_loss: 0.0097
 - val_f1: 0.9747
Epoch 4/100
 - 3s - loss: 0.0103 - val_loss: 0.0094
 - val_f1: 0.9762
Epoch 5/100
 - 3s - loss: 0.0098 - val_loss: 0.0091
 - val_f1: 0.9766
Epoch 6/100
 - 3s - loss: 0.0094 - val_loss: 0.0090
 - val_f1: 0.9768
Epoch 7/100
 - 3s - loss: 0.0093 - val_loss: 0.0089
 - val_f1: 0.9772
Epoch 8/100
 - 3s - loss: 0.0091 - val_loss: 0.0087
 - val_f1: 0.9770
Epoch 9/100
 - 3s - loss: 0.0090 - val_loss: 0.0088
 - val_f1: 0.9767
Epoch 10/100
 - 3s - loss: 0.0088 - val_loss: 0.0086
 - val_f1: 0.9768
Epoch 11/100
 - 3s - loss: 0.0088 - val_loss: 0.0086
/home/sunanda/test/ml_env/lib/python3.6/site-packages/sklearn/metrics/classification.py:1143: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no predicted samples.
  'precision', 'predicted', average, warn_for)
2020-01-07 21:08:45,127 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p10/ann_model_epoch_10.pickle
 - val_f1: 0.9774
Epoch 12/100
 - 3s - loss: 0.0087 - val_loss: 0.0086
 - val_f1: 0.9773
Epoch 13/100
 - 3s - loss: 0.0086 - val_loss: 0.0086
 - val_f1: 0.9772
Epoch 14/100
 - 3s - loss: 0.0086 - val_loss: 0.0085
 - val_f1: 0.9772
Epoch 15/100
 - 3s - loss: 0.0086 - val_loss: 0.0089
 - val_f1: 0.9767
Epoch 16/100
 - 3s - loss: 0.0085 - val_loss: 0.0085
 - val_f1: 0.9774
Epoch 17/100
 - 3s - loss: 0.0085 - val_loss: 0.0083
 - val_f1: 0.9775
Epoch 18/100
 - 3s - loss: 0.0085 - val_loss: 0.0087
 - val_f1: 0.9750
Epoch 19/100
 - 3s - loss: 0.0084 - val_loss: 0.0083
 - val_f1: 0.9780
Epoch 20/100
 - 3s - loss: 0.0085 - val_loss: 0.0085
 - val_f1: 0.9752
Epoch 21/100
 - 3s - loss: 0.0084 - val_loss: 0.0084
2020-01-07 21:10:12,367 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p10/ann_model_epoch_20.pickle
 - val_f1: 0.9776
Epoch 22/100
 - 3s - loss: 0.0084 - val_loss: 0.0083
 - val_f1: 0.9775
Epoch 23/100
 - 3s - loss: 0.0084 - val_loss: 0.0083
 - val_f1: 0.9776
Epoch 24/100
 - 3s - loss: 0.0084 - val_loss: 0.0084
 - val_f1: 0.9774
Epoch 25/100
 - 3s - loss: 0.0083 - val_loss: 0.0084
 - val_f1: 0.9752
Epoch 26/100
 - 3s - loss: 0.0084 - val_loss: 0.0083
 - val_f1: 0.9775
Epoch 27/100
 - 3s - loss: 0.0083 - val_loss: 0.0083
 - val_f1: 0.9776
Epoch 28/100
 - 3s - loss: 0.0083 - val_loss: 0.0083
 - val_f1: 0.9777
Epoch 29/100
 - 3s - loss: 0.0083 - val_loss: 0.0083
 - val_f1: 0.9779
Epoch 30/100
 - 3s - loss: 0.0083 - val_loss: 0.0085
 - val_f1: 0.9774
Epoch 31/100
 - 3s - loss: 0.0083 - val_loss: 0.0084
2020-01-07 21:11:39,566 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p10/ann_model_epoch_30.pickle
 - val_f1: 0.9774
Epoch 32/100
 - 3s - loss: 0.0083 - val_loss: 0.0083
 - val_f1: 0.9761
Epoch 33/100
 - 3s - loss: 0.0083 - val_loss: 0.0082
 - val_f1: 0.9780
Epoch 34/100
 - 3s - loss: 0.0083 - val_loss: 0.0082
 - val_f1: 0.9785
Epoch 35/100
 - 3s - loss: 0.0083 - val_loss: 0.0083
 - val_f1: 0.9776
Epoch 36/100
 - 3s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9779
Epoch 37/100
 - 3s - loss: 0.0082 - val_loss: 0.0083
 - val_f1: 0.9775
Epoch 38/100
 - 3s - loss: 0.0082 - val_loss: 0.0083
 - val_f1: 0.9781
Epoch 39/100
 - 3s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9763
Epoch 40/100
 - 3s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9780
Epoch 41/100
 - 3s - loss: 0.0082 - val_loss: 0.0081
2020-01-07 21:13:06,366 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p10/ann_model_epoch_40.pickle
 - val_f1: 0.9779
Epoch 42/100
 - 3s - loss: 0.0083 - val_loss: 0.0083
 - val_f1: 0.9780
Epoch 43/100
 - 3s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9778
Epoch 44/100
 - 3s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9778
Epoch 45/100
 - 3s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9761
Epoch 46/100
 - 3s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9761
Epoch 47/100
 - 3s - loss: 0.0082 - val_loss: 0.0083
 - val_f1: 0.9773
Epoch 48/100
 - 3s - loss: 0.0082 - val_loss: 0.0085
 - val_f1: 0.9772
Epoch 49/100
 - 3s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9777
Epoch 50/100
 - 3s - loss: 0.0082 - val_loss: 0.0083
 - val_f1: 0.9780
Epoch 51/100
 - 3s - loss: 0.0083 - val_loss: 0.0083
2020-01-07 21:14:33,457 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p10/ann_model_epoch_50.pickle
 - val_f1: 0.9761
Epoch 52/100
 - 3s - loss: 0.0082 - val_loss: 0.0083
 - val_f1: 0.9778
Epoch 53/100
 - 3s - loss: 0.0082 - val_loss: 0.0083
 - val_f1: 0.9779
Epoch 54/100
 - 3s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9780
Epoch 55/100
 - 3s - loss: 0.0081 - val_loss: 0.0083
 - val_f1: 0.9777
Epoch 56/100
 - 3s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9777
Epoch 57/100
 - 3s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9776
Epoch 58/100
 - 3s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9778
Epoch 59/100
 - 3s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9781
Epoch 60/100
 - 3s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9779
Epoch 61/100
 - 3s - loss: 0.0082 - val_loss: 0.0081
2020-01-07 21:16:00,353 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p10/ann_model_epoch_60.pickle
 - val_f1: 0.9779
Epoch 62/100
 - 3s - loss: 0.0081 - val_loss: 0.0082
 - val_f1: 0.9781
Epoch 63/100
 - 3s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9779
Epoch 64/100
 - 3s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9777
Epoch 65/100
 - 3s - loss: 0.0081 - val_loss: 0.0083
 - val_f1: 0.9777
Epoch 66/100
 - 3s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9782
Epoch 67/100
 - 3s - loss: 0.0081 - val_loss: 0.0082
 - val_f1: 0.9783
Epoch 68/100
 - 3s - loss: 0.0081 - val_loss: 0.0083
 - val_f1: 0.9773
Epoch 69/100
 - 3s - loss: 0.0081 - val_loss: 0.0082
 - val_f1: 0.9782
Epoch 70/100
 - 3s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9779
Epoch 71/100
 - 3s - loss: 0.0081 - val_loss: 0.0081
2020-01-07 21:17:27,183 [INFO] epoch = 70. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p10/ann_model_epoch_70.pickle
 - val_f1: 0.9779
Epoch 72/100
 - 3s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9777
Epoch 73/100
 - 3s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9779
Epoch 74/100
 - 3s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9776
Epoch 75/100
 - 3s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9777
Epoch 76/100
 - 3s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9783
Epoch 77/100
 - 3s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9776
Epoch 78/100
 - 3s - loss: 0.0081 - val_loss: 0.0082
 - val_f1: 0.9781
Epoch 79/100
 - 3s - loss: 0.0081 - val_loss: 0.0083
 - val_f1: 0.9779
Epoch 80/100
 - 3s - loss: 0.0081 - val_loss: 0.0084
 - val_f1: 0.9778
Epoch 81/100
 - 3s - loss: 0.0081 - val_loss: 0.0083
2020-01-07 21:18:54,113 [INFO] epoch = 80. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p10/ann_model_epoch_80.pickle
 - val_f1: 0.9779
Epoch 82/100
 - 3s - loss: 0.0081 - val_loss: 0.0082
 - val_f1: 0.9777
Epoch 83/100
 - 3s - loss: 0.0081 - val_loss: 0.0083
 - val_f1: 0.9778
Epoch 84/100
 - 3s - loss: 0.0081 - val_loss: 0.0083
 - val_f1: 0.9778
Epoch 85/100
 - 3s - loss: 0.0081 - val_loss: 0.0082
 - val_f1: 0.9779
Epoch 86/100
 - 3s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9778
Epoch 87/100
 - 3s - loss: 0.0081 - val_loss: 0.0083
 - val_f1: 0.9764
Epoch 88/100
 - 3s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9781
Epoch 89/100
 - 3s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9783
Epoch 90/100
 - 3s - loss: 0.0080 - val_loss: 0.0082
 - val_f1: 0.9780
Epoch 91/100
 - 3s - loss: 0.0081 - val_loss: 0.0084
2020-01-07 21:20:21,204 [INFO] epoch = 90. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p10/ann_model_epoch_90.pickle
 - val_f1: 0.9783
Epoch 92/100
 - 3s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9779
Epoch 93/100
 - 3s - loss: 0.0081 - val_loss: 0.0083
 - val_f1: 0.9784
Epoch 94/100
 - 3s - loss: 0.0080 - val_loss: 0.0082
 - val_f1: 0.9779
Epoch 95/100
 - 3s - loss: 0.0080 - val_loss: 0.0082
 - val_f1: 0.9778
Epoch 96/100
 - 3s - loss: 0.0080 - val_loss: 0.0082
2020-01-07 21:21:10,396 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-07 21:21:19,259 [INFO] Last epoch loss evaluation: train_loss = 0.007846, val_loss = 0.008049
2020-01-07 21:21:19,298 [INFO] Training complete. time_to_train = 866.07 sec, 14.43 min
2020-01-07 21:21:19,301 [INFO] Model saved to results_additional_exps/ann_data_efficiency_ids18_p10/best_model.pickle
2020-01-07 21:21:19,303 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_ids18_p10/training_error_history.csv
2020-01-07 21:21:19,476 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids18_p10/training_error_history.png
2020-01-07 21:21:19,641 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids18_p10/training_f1_history.png
2020-01-07 21:21:19,641 [INFO] Making predictions on training, validation, testing data
2020-01-07 21:21:44,295 [INFO] Evaluating predictions (results)
2020-01-07 21:21:56,389 [INFO] Dataset: Testing. Classification report below
2020-01-07 21:21:56,389 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       1.00      0.12      0.22        24
        Brute Force -XSS       1.00      0.33      0.50         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.00      0.00      0.00        67
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23010
   DoS attacks-GoldenEye       0.99      1.00      0.99      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.68      0.54      0.60      5596
   DoS attacks-Slowloris       0.96      0.96      0.96       440
          FTP-BruteForce       0.71      0.82      0.76      7718
           Infilteration       0.46      0.01      0.02      6404
           SQL Injection       1.00      0.50      0.67         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

               micro avg       0.98      0.98      0.98    645488
               macro avg       0.85      0.68      0.71    645488
            weighted avg       0.98      0.98      0.98    645488

2020-01-07 21:21:56,389 [INFO] Overall accuracy (micro avg): 0.9830996083583273
/home/sunanda/test/ids_experiments/utility.py:334: RuntimeWarning: invalid value encountered in true_divide
  F1 = (2 * PPV * TPR) / (PPV + TPR)  # F1 score
2020-01-07 21:22:09,974 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9831         0.9831                       0.9831                0.0012                   0.0169  0.9831
1     Macro avg        0.9977         0.8518                       0.6849                0.0044                   0.3151  0.7139
2  Weighted avg        0.9910         0.9778                       0.9831                0.0496                   0.0169  0.9782
2020-01-07 21:22:21,980 [INFO] Dataset: Validation. Classification report below
2020-01-07 21:22:21,980 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       1.00      0.20      0.33        25
        Brute Force -XSS       1.00      0.67      0.80         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.00      0.00      0.00        68
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23009
   DoS attacks-GoldenEye       0.99      1.00      0.99      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.69      0.54      0.60      5596
   DoS attacks-Slowloris       0.95      0.96      0.95       439
          FTP-BruteForce       0.71      0.83      0.76      7718
           Infilteration       0.43      0.01      0.02      6403
           SQL Injection       1.00      0.25      0.40         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

               micro avg       0.98      0.98      0.98    645487
               macro avg       0.85      0.70      0.72    645487
            weighted avg       0.98      0.98      0.98    645487

2020-01-07 21:22:21,981 [INFO] Overall accuracy (micro avg): 0.9831801415055609
2020-01-07 21:22:35,597 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9832         0.9832                       0.9832                0.0012                   0.0168  0.9832
1     Macro avg        0.9978         0.8502                       0.6956                0.0044                   0.3044  0.7234
2  Weighted avg        0.9910         0.9776                       0.9832                0.0495                   0.0168  0.9782
2020-01-07 21:23:14,700 [INFO] Dataset: Training. Classification report below
2020-01-07 21:23:14,700 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99   1606949
                     Bot       1.00      1.00      1.00     34396
        Brute Force -Web       1.00      0.12      0.22        73
        Brute Force -XSS       1.00      0.50      0.67        26
        DDOS attack-HOIC       1.00      1.00      1.00     82341
    DDOS attack-LOIC-UDP       0.11      0.00      0.01       203
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     69029
   DoS attacks-GoldenEye       0.99      1.00      0.99      4954
        DoS attacks-Hulk       1.00      1.00      1.00     55435
DoS attacks-SlowHTTPTest       0.68      0.54      0.60     16787
   DoS attacks-Slowloris       0.96      0.97      0.97      1318
          FTP-BruteForce       0.71      0.82      0.76     23153
           Infilteration       0.49      0.01      0.02     19210
           SQL Injection       1.00      0.25      0.40        12
          SSH-Bruteforce       1.00      1.00      1.00     22576

               micro avg       0.98      0.98      0.98   1936462
               macro avg       0.86      0.68      0.71   1936462
            weighted avg       0.98      0.98      0.98   1936462

2020-01-07 21:23:14,700 [INFO] Overall accuracy (micro avg): 0.9831393541417286
2020-01-07 21:23:59,103 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9831         0.9831                       0.9831                0.0012                   0.0169  0.9831
1     Macro avg        0.9978         0.8616                       0.6802                0.0044                   0.3198  0.7081
2  Weighted avg        0.9910         0.9782                       0.9831                0.0494                   0.0169  0.9782
2020-01-07 21:23:59,160 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_ids18_p10/ann_data_efficiency_ids18_p10_results.xlsx
2020-01-07 21:23:59,167 [INFO] ================= Finished running experiment no. 1 ================= 

2020-01-07 21:23:59,245 [INFO] Created directory: results_additional_exps/ann_data_efficiency_ids18_p20
2020-01-07 21:23:59,245 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_ids18_p20/run_log.log
2020-01-07 21:23:59,245 [INFO] ================= Running experiment no. 2  ================= 

2020-01-07 21:23:59,245 [INFO] Experiment parameters given below
2020-01-07 21:23:59,245 [INFO] 
{'experiment_num': 2, 'results_dir': 'results_additional_exps/ann_data_efficiency_ids18_p20', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': 0.8, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/ids2018', 'description': 'ann_data_efficiency_ids18_p20'}
2020-01-07 21:23:59,245 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_ids18_p20/tf_logs_run_2020_01_07-21_23_59
2020-01-07 21:23:59,245 [INFO] Loading datsets from: ../Datasets/small_datasets/ids2018
2020-01-07 21:23:59,246 [INFO] Reading X, y files
2020-01-07 21:23:59,246 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_train.h5
2020-01-07 21:24:03,581 [INFO] Reading complete. time_to_read=4.34 seconds
2020-01-07 21:24:03,582 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_val.h5
2020-01-07 21:24:05,072 [INFO] Reading complete. time_to_read=1.49 seconds
2020-01-07 21:24:05,072 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_test.h5
2020-01-07 21:24:06,562 [INFO] Reading complete. time_to_read=1.49 seconds
2020-01-07 21:24:06,562 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_train.h5
2020-01-07 21:24:06,808 [INFO] Reading complete. time_to_read=0.25 seconds
2020-01-07 21:24:06,808 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_val.h5
2020-01-07 21:24:06,886 [INFO] Reading complete. time_to_read=0.08 seconds
2020-01-07 21:24:06,886 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_test.h5
2020-01-07 21:24:06,963 [INFO] Reading complete. time_to_read=0.08 seconds
2020-01-07 21:24:10,606 [INFO] Initializing model
2020-01-07 21:24:10,709 [INFO] _________________________________________________________________
2020-01-07 21:24:10,709 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-07 21:24:10,709 [INFO] =================================================================
2020-01-07 21:24:10,709 [INFO] dense_3 (Dense)              (None, 64)                4992      
2020-01-07 21:24:10,709 [INFO] _________________________________________________________________
2020-01-07 21:24:10,709 [INFO] batch_normalization_2 (Batch (None, 64)                256       
2020-01-07 21:24:10,709 [INFO] _________________________________________________________________
2020-01-07 21:24:10,709 [INFO] dropout_2 (Dropout)          (None, 64)                0         
2020-01-07 21:24:10,709 [INFO] _________________________________________________________________
2020-01-07 21:24:10,709 [INFO] dense_4 (Dense)              (None, 15)                975       
2020-01-07 21:24:10,709 [INFO] =================================================================
2020-01-07 21:24:10,710 [INFO] Total params: 6,223
2020-01-07 21:24:10,710 [INFO] Trainable params: 6,095
2020-01-07 21:24:10,710 [INFO] Non-trainable params: 128
2020-01-07 21:24:10,710 [INFO] _________________________________________________________________
2020-01-07 21:24:10,710 [INFO] Training model
2020-01-07 21:24:10,710 [INFO] Splitting train set into 2 sets (set1, set2), random_seed = 42
2020-01-07 21:24:30,642 [INFO] Split sizes (instances). total = 1936462, set1 = 1549169, set2 = 387293, set1 dataset hash = 4fce4b889259797e2f515c84d59a2cc9807bfe20
 - val_f1: 0.9777
Epoch 00096: early stopping
Train on 387293 samples, validate on 645487 samples
Epoch 1/100
 - 5s - loss: 0.0351 - val_loss: 0.0111
 - val_f1: 0.9713
Epoch 2/100
 - 5s - loss: 0.0108 - val_loss: 0.0092
 - val_f1: 0.9760
Epoch 3/100
 - 5s - loss: 0.0097 - val_loss: 0.0091
 - val_f1: 0.9761
Epoch 4/100
 - 5s - loss: 0.0093 - val_loss: 0.0088
 - val_f1: 0.9770
Epoch 5/100
 - 5s - loss: 0.0090 - val_loss: 0.0089
 - val_f1: 0.9757
Epoch 6/100
 - 5s - loss: 0.0088 - val_loss: 0.0085
 - val_f1: 0.9774
Epoch 7/100
 - 5s - loss: 0.0087 - val_loss: 0.0085
 - val_f1: 0.9770
Epoch 8/100
 - 5s - loss: 0.0087 - val_loss: 0.0085
 - val_f1: 0.9774
Epoch 9/100
 - 5s - loss: 0.0086 - val_loss: 0.0083
 - val_f1: 0.9756
Epoch 10/100
 - 5s - loss: 0.0086 - val_loss: 0.0086
 - val_f1: 0.9750
Epoch 11/100
 - 5s - loss: 0.0085 - val_loss: 0.0084
/home/sunanda/test/ml_env/lib/python3.6/site-packages/sklearn/metrics/classification.py:1143: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no predicted samples.
  'precision', 'predicted', average, warn_for)
2020-01-07 21:26:22,109 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p20/ann_model_epoch_10.pickle
 - val_f1: 0.9775
Epoch 12/100
 - 5s - loss: 0.0085 - val_loss: 0.0086
 - val_f1: 0.9774
Epoch 13/100
 - 5s - loss: 0.0085 - val_loss: 0.0084
 - val_f1: 0.9772
Epoch 14/100
 - 5s - loss: 0.0085 - val_loss: 0.0085
 - val_f1: 0.9771
Epoch 15/100
 - 5s - loss: 0.0084 - val_loss: 0.0083
 - val_f1: 0.9782
Epoch 16/100
 - 5s - loss: 0.0084 - val_loss: 0.0083
 - val_f1: 0.9776
Epoch 17/100
 - 5s - loss: 0.0084 - val_loss: 0.0083
 - val_f1: 0.9776
Epoch 18/100
 - 5s - loss: 0.0084 - val_loss: 0.0085
 - val_f1: 0.9774
Epoch 19/100
 - 5s - loss: 0.0084 - val_loss: 0.0083
 - val_f1: 0.9779
Epoch 20/100
 - 5s - loss: 0.0083 - val_loss: 0.0083
 - val_f1: 0.9774
Epoch 21/100
 - 5s - loss: 0.0083 - val_loss: 0.0084
2020-01-07 21:28:08,085 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p20/ann_model_epoch_20.pickle
 - val_f1: 0.9775
Epoch 22/100
 - 5s - loss: 0.0083 - val_loss: 0.0082
 - val_f1: 0.9779
Epoch 23/100
 - 5s - loss: 0.0083 - val_loss: 0.0082
 - val_f1: 0.9782
Epoch 24/100
 - 5s - loss: 0.0083 - val_loss: 0.0082
 - val_f1: 0.9776
Epoch 25/100
 - 5s - loss: 0.0083 - val_loss: 0.0081
 - val_f1: 0.9778
Epoch 26/100
 - 5s - loss: 0.0083 - val_loss: 0.0082
 - val_f1: 0.9778
Epoch 27/100
 - 5s - loss: 0.0083 - val_loss: 0.0082
 - val_f1: 0.9778
Epoch 28/100
 - 5s - loss: 0.0083 - val_loss: 0.0083
 - val_f1: 0.9776
Epoch 29/100
 - 5s - loss: 0.0083 - val_loss: 0.0082
 - val_f1: 0.9777
Epoch 30/100
 - 5s - loss: 0.0083 - val_loss: 0.0082
 - val_f1: 0.9754
Epoch 31/100
 - 5s - loss: 0.0083 - val_loss: 0.0081
2020-01-07 21:29:53,844 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p20/ann_model_epoch_30.pickle
 - val_f1: 0.9778
Epoch 32/100
 - 5s - loss: 0.0083 - val_loss: 0.0093
 - val_f1: 0.9741
Epoch 33/100
 - 5s - loss: 0.0083 - val_loss: 0.0082
 - val_f1: 0.9778
Epoch 34/100
 - 5s - loss: 0.0083 - val_loss: 0.0083
 - val_f1: 0.9780
Epoch 35/100
 - 5s - loss: 0.0083 - val_loss: 0.0084
 - val_f1: 0.9782
Epoch 36/100
 - 5s - loss: 0.0083 - val_loss: 0.0082
 - val_f1: 0.9778
Epoch 37/100
 - 5s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9775
Epoch 38/100
 - 5s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9781
Epoch 39/100
 - 5s - loss: 0.0083 - val_loss: 0.0081
 - val_f1: 0.9778
Epoch 40/100
 - 5s - loss: 0.0082 - val_loss: 0.0083
 - val_f1: 0.9780
Epoch 41/100
 - 5s - loss: 0.0082 - val_loss: 0.0081
2020-01-07 21:31:39,613 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p20/ann_model_epoch_40.pickle
 - val_f1: 0.9781
Epoch 42/100
 - 5s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9777
Epoch 43/100
 - 5s - loss: 0.0083 - val_loss: 0.0083
 - val_f1: 0.9777
Epoch 44/100
 - 5s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9776
Epoch 45/100
 - 5s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9777
Epoch 46/100
 - 5s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9777
Epoch 47/100
 - 5s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9777
Epoch 48/100
 - 5s - loss: 0.0082 - val_loss: 0.0085
 - val_f1: 0.9767
Epoch 49/100
 - 5s - loss: 0.0082 - val_loss: 0.0083
 - val_f1: 0.9777
Epoch 50/100
 - 5s - loss: 0.0082 - val_loss: 0.0080
 - val_f1: 0.9780
Epoch 51/100
 - 5s - loss: 0.0082 - val_loss: 0.0081
2020-01-07 21:33:25,626 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p20/ann_model_epoch_50.pickle
 - val_f1: 0.9779
Epoch 52/100
 - 5s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9784
Epoch 53/100
 - 5s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9776
Epoch 54/100
 - 5s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9775
Epoch 55/100
 - 5s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9783
Epoch 56/100
 - 5s - loss: 0.0082 - val_loss: 0.0085
 - val_f1: 0.9778
Epoch 57/100
 - 5s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9775
Epoch 58/100
 - 5s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9778
Epoch 59/100
 - 5s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9781
Epoch 60/100
 - 5s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9778
Epoch 61/100
 - 5s - loss: 0.0082 - val_loss: 0.0081
2020-01-07 21:35:11,999 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p20/ann_model_epoch_60.pickle
 - val_f1: 0.9778
Epoch 62/100
 - 5s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9778
Epoch 63/100
 - 5s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9782
Epoch 64/100
 - 5s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9779
Epoch 65/100
 - 5s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9778
Epoch 66/100
 - 5s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9784
Epoch 67/100
 - 5s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9784
Epoch 68/100
 - 5s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9784
Epoch 69/100
 - 5s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 70/100
 - 5s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9783
Epoch 71/100
 - 5s - loss: 0.0081 - val_loss: 0.0081
2020-01-07 21:36:57,693 [INFO] epoch = 70. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p20/ann_model_epoch_70.pickle
 - val_f1: 0.9778
Epoch 72/100
 - 5s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9785
Epoch 73/100
 - 5s - loss: 0.0081 - val_loss: 0.0083
 - val_f1: 0.9779
Epoch 74/100
 - 5s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9780
Epoch 75/100
 - 5s - loss: 0.0081 - val_loss: 0.0082
 - val_f1: 0.9778
Epoch 76/100
 - 5s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9783
Epoch 77/100
 - 5s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9776
Epoch 78/100
 - 5s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9784
Epoch 79/100
 - 5s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9782
Epoch 80/100
 - 5s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9780
Epoch 81/100
 - 5s - loss: 0.0081 - val_loss: 0.0082
2020-01-07 21:38:43,405 [INFO] epoch = 80. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p20/ann_model_epoch_80.pickle
 - val_f1: 0.9782
Epoch 82/100
 - 5s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9780
Epoch 83/100
 - 5s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9782
Epoch 84/100
 - 5s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9784
Epoch 85/100
 - 5s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9778
Epoch 86/100
 - 5s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 87/100
 - 5s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9778
Epoch 88/100
 - 5s - loss: 0.0081 - val_loss: 0.0083
 - val_f1: 0.9780
Epoch 89/100
 - 5s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 90/100
 - 5s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9781
Epoch 91/100
 - 5s - loss: 0.0081 - val_loss: 0.0081
2020-01-07 21:40:29,575 [INFO] epoch = 90. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p20/ann_model_epoch_90.pickle
 - val_f1: 0.9779
Epoch 92/100
 - 5s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9778
Epoch 93/100
 - 5s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9787
Epoch 94/100
 - 5s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9778
Epoch 95/100
 - 5s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9777
Epoch 96/100
 - 5s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9784
Epoch 97/100
 - 5s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9782
Epoch 98/100
 - 5s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9783
Epoch 99/100
 - 5s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9782
Epoch 100/100
 - 5s - loss: 0.0081 - val_loss: 0.0080
2020-01-07 21:42:10,949 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-07 21:42:22,419 [INFO] Last epoch loss evaluation: train_loss = 0.007834, val_loss = 0.007933
2020-01-07 21:42:22,461 [INFO] Training complete. time_to_train = 1091.75 sec, 18.20 min
2020-01-07 21:42:22,464 [INFO] Model saved to results_additional_exps/ann_data_efficiency_ids18_p20/best_model.pickle
2020-01-07 21:42:22,466 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_ids18_p20/training_error_history.csv
2020-01-07 21:42:22,636 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids18_p20/training_error_history.png
2020-01-07 21:42:22,808 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids18_p20/training_f1_history.png
2020-01-07 21:42:22,808 [INFO] Making predictions on training, validation, testing data
2020-01-07 21:42:49,243 [INFO] Evaluating predictions (results)
2020-01-07 21:43:01,250 [INFO] Dataset: Testing. Classification report below
2020-01-07 21:43:01,250 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       0.99      1.00      1.00     11465
        Brute Force -Web       0.75      0.12      0.21        24
        Brute Force -XSS       1.00      0.33      0.50         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.77      0.15      0.25        67
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23010
   DoS attacks-GoldenEye       0.99      1.00      1.00      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.72      0.47      0.57      5596
   DoS attacks-Slowloris       0.95      0.95      0.95       440
          FTP-BruteForce       0.69      0.87      0.77      7718
           Infilteration       0.42      0.01      0.02      6404
           SQL Injection       1.00      0.25      0.40         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

               micro avg       0.98      0.98      0.98    645488
               macro avg       0.88      0.68      0.71    645488
            weighted avg       0.98      0.98      0.98    645488

2020-01-07 21:43:01,250 [INFO] Overall accuracy (micro avg): 0.9830438366011451
2020-01-07 21:43:14,893 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9830         0.9830                       0.9830                0.0012                   0.0170  0.9830
1     Macro avg        0.9977         0.8848                       0.6764                0.0044                   0.3236  0.7100
2  Weighted avg        0.9909         0.9777                       0.9830                0.0496                   0.0170  0.9780
/home/sunanda/test/ml_env/lib/python3.6/site-packages/sklearn/metrics/classification.py:1143: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples.
  'precision', 'predicted', average, warn_for)
2020-01-07 21:43:26,882 [INFO] Dataset: Validation. Classification report below
2020-01-07 21:43:26,883 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       1.00      0.20      0.33        25
        Brute Force -XSS       1.00      0.67      0.80         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.69      0.13      0.22        68
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23009
   DoS attacks-GoldenEye       0.99      1.00      1.00      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.73      0.46      0.57      5596
   DoS attacks-Slowloris       0.94      0.96      0.95       439
          FTP-BruteForce       0.69      0.88      0.77      7718
           Infilteration       0.38      0.01      0.02      6403
           SQL Injection       0.00      0.00      0.00         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

               micro avg       0.98      0.98      0.98    645487
               macro avg       0.83      0.69      0.71    645487
            weighted avg       0.98      0.98      0.98    645487

2020-01-07 21:43:26,883 [INFO] Overall accuracy (micro avg): 0.9830964837401838
/home/sunanda/test/ids_experiments/utility.py:328: RuntimeWarning: invalid value encountered in true_divide
  PPV = TP / (TP + FP)    # Precision or positive predictive value
/home/sunanda/test/ids_experiments/utility.py:332: RuntimeWarning: invalid value encountered in true_divide
  FDR = FP / (TP + FP)    # False discovery rate
2020-01-07 21:43:40,497 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9831         0.9831                       0.9831                0.0012                   0.0169  0.9831
1     Macro avg        0.9977         0.8269                       0.6863                0.0044                   0.3137  0.7093
2  Weighted avg        0.9909         0.9773                       0.9831                0.0495                   0.0169  0.9780
2020-01-07 21:44:19,719 [INFO] Dataset: Training. Classification report below
2020-01-07 21:44:19,719 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99   1606949
                     Bot       1.00      1.00      1.00     34396
        Brute Force -Web       0.82      0.12      0.21        73
        Brute Force -XSS       1.00      0.50      0.67        26
        DDOS attack-HOIC       1.00      1.00      1.00     82341
    DDOS attack-LOIC-UDP       0.67      0.12      0.20       203
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     69029
   DoS attacks-GoldenEye       0.99      1.00      1.00      4954
        DoS attacks-Hulk       1.00      1.00      1.00     55435
DoS attacks-SlowHTTPTest       0.73      0.46      0.56     16787
   DoS attacks-Slowloris       0.95      0.98      0.96      1318
          FTP-BruteForce       0.69      0.87      0.77     23153
           Infilteration       0.44      0.01      0.02     19210
           SQL Injection       1.00      0.25      0.40        12
          SSH-Bruteforce       1.00      1.00      1.00     22576

               micro avg       0.98      0.98      0.98   1936462
               macro avg       0.88      0.69      0.72   1936462
            weighted avg       0.98      0.98      0.98   1936462

2020-01-07 21:44:19,720 [INFO] Overall accuracy (micro avg): 0.9830675737504789
2020-01-07 21:45:04,233 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9831         0.9831                       0.9831                0.0012                   0.0169  0.9831
1     Macro avg        0.9977         0.8841                       0.6870                0.0044                   0.3130  0.7186
2  Weighted avg        0.9909         0.9779                       0.9831                0.0495                   0.0169  0.9780
2020-01-07 21:45:04,290 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_ids18_p20/ann_data_efficiency_ids18_p20_results.xlsx
2020-01-07 21:45:04,297 [INFO] ================= Finished running experiment no. 2 ================= 

2020-01-07 21:45:04,375 [INFO] Created directory: results_additional_exps/ann_data_efficiency_ids18_p30
2020-01-07 21:45:04,375 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_ids18_p30/run_log.log
2020-01-07 21:45:04,375 [INFO] ================= Running experiment no. 3  ================= 

2020-01-07 21:45:04,376 [INFO] Experiment parameters given below
2020-01-07 21:45:04,376 [INFO] 
{'experiment_num': 3, 'results_dir': 'results_additional_exps/ann_data_efficiency_ids18_p30', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': 0.7, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/ids2018', 'description': 'ann_data_efficiency_ids18_p30'}
2020-01-07 21:45:04,376 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_ids18_p30/tf_logs_run_2020_01_07-21_45_04
2020-01-07 21:45:04,376 [INFO] Loading datsets from: ../Datasets/small_datasets/ids2018
2020-01-07 21:45:04,376 [INFO] Reading X, y files
2020-01-07 21:45:04,376 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_train.h5
2020-01-07 21:45:08,694 [INFO] Reading complete. time_to_read=4.32 seconds
2020-01-07 21:45:08,694 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_val.h5
2020-01-07 21:45:10,177 [INFO] Reading complete. time_to_read=1.48 seconds
2020-01-07 21:45:10,177 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_test.h5
2020-01-07 21:45:11,663 [INFO] Reading complete. time_to_read=1.49 seconds
2020-01-07 21:45:11,663 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_train.h5
2020-01-07 21:45:11,897 [INFO] Reading complete. time_to_read=0.23 seconds
2020-01-07 21:45:11,897 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_val.h5
2020-01-07 21:45:11,973 [INFO] Reading complete. time_to_read=0.08 seconds
2020-01-07 21:45:11,973 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_test.h5
2020-01-07 21:45:12,050 [INFO] Reading complete. time_to_read=0.08 seconds
2020-01-07 21:45:15,704 [INFO] Initializing model
2020-01-07 21:45:15,904 [INFO] _________________________________________________________________
2020-01-07 21:45:15,904 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-07 21:45:15,904 [INFO] =================================================================
2020-01-07 21:45:15,904 [INFO] dense_5 (Dense)              (None, 64)                4992      
2020-01-07 21:45:15,904 [INFO] _________________________________________________________________
2020-01-07 21:45:15,904 [INFO] batch_normalization_3 (Batch (None, 64)                256       
2020-01-07 21:45:15,904 [INFO] _________________________________________________________________
2020-01-07 21:45:15,904 [INFO] dropout_3 (Dropout)          (None, 64)                0         
2020-01-07 21:45:15,904 [INFO] _________________________________________________________________
2020-01-07 21:45:15,905 [INFO] dense_6 (Dense)              (None, 15)                975       
2020-01-07 21:45:15,905 [INFO] =================================================================
2020-01-07 21:45:15,905 [INFO] Total params: 6,223
2020-01-07 21:45:15,905 [INFO] Trainable params: 6,095
2020-01-07 21:45:15,905 [INFO] Non-trainable params: 128
2020-01-07 21:45:15,905 [INFO] _________________________________________________________________
2020-01-07 21:45:15,905 [INFO] Training model
2020-01-07 21:45:15,905 [INFO] Splitting train set into 2 sets (set1, set2), random_seed = 42
2020-01-07 21:45:36,251 [INFO] Split sizes (instances). total = 1936462, set1 = 1355523, set2 = 580939, set1 dataset hash = 0c569f992f0c5392c99fc969d681557333bcd8a0
 - val_f1: 0.9782
Train on 580939 samples, validate on 645487 samples
Epoch 1/100
 - 7s - loss: 0.0267 - val_loss: 0.0100
 - val_f1: 0.9757
Epoch 2/100
 - 6s - loss: 0.0099 - val_loss: 0.0089
 - val_f1: 0.9765
Epoch 3/100
 - 7s - loss: 0.0091 - val_loss: 0.0086
 - val_f1: 0.9772
Epoch 4/100
 - 6s - loss: 0.0088 - val_loss: 0.0084
 - val_f1: 0.9759
Epoch 5/100
 - 6s - loss: 0.0087 - val_loss: 0.0086
 - val_f1: 0.9774
Epoch 6/100
 - 6s - loss: 0.0086 - val_loss: 0.0084
 - val_f1: 0.9762
Epoch 7/100
 - 6s - loss: 0.0085 - val_loss: 0.0083
 - val_f1: 0.9777
Epoch 8/100
 - 6s - loss: 0.0085 - val_loss: 0.0084
 - val_f1: 0.9778
Epoch 9/100
 - 6s - loss: 0.0084 - val_loss: 0.0084
 - val_f1: 0.9773
Epoch 10/100
 - 6s - loss: 0.0084 - val_loss: 0.0082
 - val_f1: 0.9781
Epoch 11/100
 - 7s - loss: 0.0083 - val_loss: 0.0082
/home/sunanda/test/ml_env/lib/python3.6/site-packages/sklearn/metrics/classification.py:1143: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no predicted samples.
  'precision', 'predicted', average, warn_for)
2020-01-07 21:47:49,748 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p30/ann_model_epoch_10.pickle
 - val_f1: 0.9782
Epoch 12/100
 - 6s - loss: 0.0084 - val_loss: 0.0082
 - val_f1: 0.9778
Epoch 13/100
 - 7s - loss: 0.0083 - val_loss: 0.0083
 - val_f1: 0.9770
Epoch 14/100
 - 6s - loss: 0.0083 - val_loss: 0.0081
 - val_f1: 0.9778
Epoch 15/100
 - 6s - loss: 0.0083 - val_loss: 0.0082
 - val_f1: 0.9777
Epoch 16/100
 - 6s - loss: 0.0083 - val_loss: 0.0081
 - val_f1: 0.9779
Epoch 17/100
 - 6s - loss: 0.0083 - val_loss: 0.0082
 - val_f1: 0.9758
Epoch 18/100
 - 7s - loss: 0.0082 - val_loss: 0.0083
 - val_f1: 0.9761
Epoch 19/100
 - 6s - loss: 0.0083 - val_loss: 0.0082
 - val_f1: 0.9776
Epoch 20/100
 - 6s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9772
Epoch 21/100
 - 7s - loss: 0.0082 - val_loss: 0.0081
2020-01-07 21:49:55,898 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p30/ann_model_epoch_20.pickle
 - val_f1: 0.9764
Epoch 22/100
 - 6s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9779
Epoch 23/100
 - 6s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9779
Epoch 24/100
 - 6s - loss: 0.0082 - val_loss: 0.0083
 - val_f1: 0.9778
Epoch 25/100
 - 6s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9752
Epoch 26/100
 - 6s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9760
Epoch 27/100
 - 7s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9779
Epoch 28/100
 - 6s - loss: 0.0082 - val_loss: 0.0080
 - val_f1: 0.9781
Epoch 29/100
 - 6s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9777
Epoch 30/100
 - 6s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9778
Epoch 31/100
 - 6s - loss: 0.0082 - val_loss: 0.0081
2020-01-07 21:52:01,485 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p30/ann_model_epoch_30.pickle
 - val_f1: 0.9782
Epoch 32/100
 - 7s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9777
Epoch 33/100
 - 6s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9777
Epoch 34/100
 - 6s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9777
Epoch 35/100
 - 7s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9776
Epoch 36/100
 - 6s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9780
Epoch 37/100
 - 7s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 38/100
 - 6s - loss: 0.0081 - val_loss: 0.0082
 - val_f1: 0.9775
Epoch 39/100
 - 6s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9778
Epoch 40/100
 - 6s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9776
Epoch 41/100
 - 6s - loss: 0.0082 - val_loss: 0.0082
2020-01-07 21:54:07,980 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p30/ann_model_epoch_40.pickle
 - val_f1: 0.9779
Epoch 42/100
 - 6s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9776
Epoch 43/100
 - 7s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9778
Epoch 44/100
 - 6s - loss: 0.0081 - val_loss: 0.0082
 - val_f1: 0.9777
Epoch 45/100
 - 6s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9780
Epoch 46/100
 - 6s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9763
Epoch 47/100
 - 7s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9762
Epoch 48/100
 - 6s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9778
Epoch 49/100
 - 6s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9762
Epoch 50/100
 - 6s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9766
Epoch 51/100
 - 6s - loss: 0.0081 - val_loss: 0.0081
2020-01-07 21:56:14,239 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p30/ann_model_epoch_50.pickle
 - val_f1: 0.9777
Epoch 52/100
 - 6s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9761
Epoch 53/100
 - 6s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9764
Epoch 54/100
 - 6s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9783
Epoch 55/100
 - 6s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9783
Epoch 56/100
 - 6s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 57/100
 - 6s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9784
Epoch 58/100
 - 6s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9784
Epoch 59/100
 - 6s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9777
Epoch 60/100
 - 7s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9783
Epoch 61/100
 - 6s - loss: 0.0081 - val_loss: 0.0081
2020-01-07 21:58:20,334 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p30/ann_model_epoch_60.pickle
 - val_f1: 0.9783
Epoch 62/100
 - 6s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9778
Epoch 63/100
 - 6s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9779
Epoch 64/100
 - 7s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9781
Epoch 65/100
 - 6s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9766
Epoch 66/100
 - 6s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9783
Epoch 67/100
 - 6s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9781
Epoch 68/100
 - 6s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9776
Epoch 69/100
 - 7s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9786
Epoch 70/100
 - 6s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9781
Epoch 71/100
 - 6s - loss: 0.0081 - val_loss: 0.0080
2020-01-07 22:00:26,608 [INFO] epoch = 70. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p30/ann_model_epoch_70.pickle
 - val_f1: 0.9785
Epoch 72/100
 - 6s - loss: 0.0080 - val_loss: 0.0082
 - val_f1: 0.9779
Epoch 73/100
 - 7s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9778
Epoch 74/100
 - 7s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9778
Epoch 75/100
 - 6s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 76/100
 - 6s - loss: 0.0080 - val_loss: 0.0082
 - val_f1: 0.9778
Epoch 77/100
 - 6s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9779
Epoch 78/100
 - 6s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9786
Epoch 79/100
 - 6s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9782
Epoch 80/100
 - 7s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 81/100
 - 6s - loss: 0.0080 - val_loss: 0.0079
2020-01-07 22:02:32,834 [INFO] epoch = 80. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p30/ann_model_epoch_80.pickle
 - val_f1: 0.9782
Epoch 82/100
 - 6s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9776
Epoch 83/100
 - 6s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9780
Epoch 84/100
 - 6s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9777
Epoch 85/100
 - 7s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9762
Epoch 86/100
 - 7s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9783
Epoch 87/100
 - 6s - loss: 0.0080 - val_loss: 0.0082
 - val_f1: 0.9778
Epoch 88/100
 - 6s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9777
Epoch 89/100
 - 6s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9778
Epoch 90/100
 - 6s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9782
Epoch 91/100
 - 6s - loss: 0.0080 - val_loss: 0.0079
2020-01-07 22:04:39,043 [INFO] epoch = 90. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p30/ann_model_epoch_90.pickle
 - val_f1: 0.9779
Epoch 92/100
 - 6s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9785
Epoch 93/100
 - 6s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9781
Epoch 94/100
 - 6s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9777
Epoch 95/100
 - 6s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9786
Epoch 96/100
 - 6s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9781
Epoch 97/100
 - 6s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9764
Epoch 98/100
 - 6s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9780
Epoch 99/100
 - 6s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9778
Epoch 100/100
 - 6s - loss: 0.0080 - val_loss: 0.0080
2020-01-07 22:06:38,901 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-07 22:06:53,321 [INFO] Last epoch loss evaluation: train_loss = 0.007840, val_loss = 0.007908
2020-01-07 22:06:53,363 [INFO] Training complete. time_to_train = 1297.46 sec, 21.62 min
2020-01-07 22:06:53,366 [INFO] Model saved to results_additional_exps/ann_data_efficiency_ids18_p30/best_model.pickle
2020-01-07 22:06:53,368 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_ids18_p30/training_error_history.csv
2020-01-07 22:06:53,550 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids18_p30/training_error_history.png
2020-01-07 22:06:53,725 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids18_p30/training_f1_history.png
2020-01-07 22:06:53,725 [INFO] Making predictions on training, validation, testing data
2020-01-07 22:07:22,224 [INFO] Evaluating predictions (results)
2020-01-07 22:07:34,189 [INFO] Dataset: Testing. Classification report below
2020-01-07 22:07:34,189 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       1.00      0.12      0.22        24
        Brute Force -XSS       1.00      0.33      0.50         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.00      0.00      0.00        67
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23010
   DoS attacks-GoldenEye       0.99      1.00      1.00      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.74      0.52      0.61      5596
   DoS attacks-Slowloris       0.95      0.97      0.96       440
          FTP-BruteForce       0.71      0.87      0.78      7718
           Infilteration       0.46      0.01      0.02      6404
           SQL Injection       1.00      0.50      0.67         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

               micro avg       0.98      0.98      0.98    645488
               macro avg       0.86      0.69      0.72    645488
            weighted avg       0.98      0.98      0.98    645488

2020-01-07 22:07:34,189 [INFO] Overall accuracy (micro avg): 0.9835659222169894
/home/sunanda/test/ids_experiments/utility.py:334: RuntimeWarning: invalid value encountered in true_divide
  F1 = (2 * PPV * TPR) / (PPV + TPR)  # F1 score
2020-01-07 22:07:47,803 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9836         0.9836                       0.9836                0.0012                   0.0164  0.9836
1     Macro avg        0.9978         0.8553                       0.6879                0.0044                   0.3121  0.7161
2  Weighted avg        0.9910         0.9783                       0.9836                0.0498                   0.0164  0.9785
/home/sunanda/test/ml_env/lib/python3.6/site-packages/sklearn/metrics/classification.py:1143: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples.
  'precision', 'predicted', average, warn_for)
2020-01-07 22:07:59,809 [INFO] Dataset: Validation. Classification report below
2020-01-07 22:07:59,810 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       1.00      0.20      0.33        25
        Brute Force -XSS       1.00      0.67      0.80         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.17      0.01      0.03        68
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23009
   DoS attacks-GoldenEye       0.99      1.00      1.00      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.75      0.52      0.61      5596
   DoS attacks-Slowloris       0.94      0.97      0.96       439
          FTP-BruteForce       0.71      0.87      0.79      7718
           Infilteration       0.39      0.01      0.01      6403
           SQL Injection       0.00      0.00      0.00         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

               micro avg       0.98      0.98      0.98    645487
               macro avg       0.80      0.68      0.70    645487
            weighted avg       0.98      0.98      0.98    645487

2020-01-07 22:07:59,810 [INFO] Overall accuracy (micro avg): 0.9835798397179184
/home/sunanda/test/ids_experiments/utility.py:328: RuntimeWarning: invalid value encountered in true_divide
  PPV = TP / (TP + FP)    # Precision or positive predictive value
/home/sunanda/test/ids_experiments/utility.py:332: RuntimeWarning: invalid value encountered in true_divide
  FDR = FP / (TP + FP)    # False discovery rate
2020-01-07 22:08:13,440 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9836         0.9836                       0.9836                0.0012                   0.0164  0.9836
1     Macro avg        0.9978         0.7956                       0.6828                0.0044                   0.3172  0.7007
2  Weighted avg        0.9910         0.9778                       0.9836                0.0498                   0.0164  0.9785
2020-01-07 22:08:52,627 [INFO] Dataset: Training. Classification report below
2020-01-07 22:08:52,627 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99   1606949
                     Bot       1.00      1.00      1.00     34396
        Brute Force -Web       1.00      0.12      0.22        73
        Brute Force -XSS       0.93      0.50      0.65        26
        DDOS attack-HOIC       1.00      1.00      1.00     82341
    DDOS attack-LOIC-UDP       0.29      0.02      0.04       203
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     69029
   DoS attacks-GoldenEye       0.99      1.00      1.00      4954
        DoS attacks-Hulk       1.00      1.00      1.00     55435
DoS attacks-SlowHTTPTest       0.74      0.52      0.61     16787
   DoS attacks-Slowloris       0.95      0.99      0.97      1318
          FTP-BruteForce       0.71      0.87      0.78     23153
           Infilteration       0.48      0.01      0.02     19210
           SQL Injection       1.00      0.25      0.40        12
          SSH-Bruteforce       1.00      1.00      1.00     22576

               micro avg       0.98      0.98      0.98   1936462
               macro avg       0.87      0.68      0.71   1936462
            weighted avg       0.98      0.98      0.98   1936462

2020-01-07 22:08:52,627 [INFO] Overall accuracy (micro avg): 0.9835855286599995
2020-01-07 22:09:37,128 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9836         0.9836                       0.9836                0.0012                   0.0164  0.9836
1     Macro avg        0.9978         0.8715                       0.6844                0.0044                   0.3156  0.7112
2  Weighted avg        0.9910         0.9786                       0.9836                0.0497                   0.0164  0.9785
2020-01-07 22:09:37,186 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_ids18_p30/ann_data_efficiency_ids18_p30_results.xlsx
2020-01-07 22:09:37,191 [INFO] ================= Finished running experiment no. 3 ================= 

2020-01-07 22:09:37,270 [INFO] Created directory: results_additional_exps/ann_data_efficiency_ids18_p40
2020-01-07 22:09:37,270 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_ids18_p40/run_log.log
2020-01-07 22:09:37,270 [INFO] ================= Running experiment no. 4  ================= 

2020-01-07 22:09:37,270 [INFO] Experiment parameters given below
2020-01-07 22:09:37,270 [INFO] 
{'experiment_num': 4, 'results_dir': 'results_additional_exps/ann_data_efficiency_ids18_p40', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': 0.6, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/ids2018', 'description': 'ann_data_efficiency_ids18_p40'}
2020-01-07 22:09:37,270 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_ids18_p40/tf_logs_run_2020_01_07-22_09_37
2020-01-07 22:09:37,270 [INFO] Loading datsets from: ../Datasets/small_datasets/ids2018
2020-01-07 22:09:37,270 [INFO] Reading X, y files
2020-01-07 22:09:37,270 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_train.h5
2020-01-07 22:09:41,595 [INFO] Reading complete. time_to_read=4.32 seconds
2020-01-07 22:09:41,595 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_val.h5
2020-01-07 22:09:43,077 [INFO] Reading complete. time_to_read=1.48 seconds
2020-01-07 22:09:43,077 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_test.h5
2020-01-07 22:09:44,561 [INFO] Reading complete. time_to_read=1.48 seconds
2020-01-07 22:09:44,561 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_train.h5
2020-01-07 22:09:44,779 [INFO] Reading complete. time_to_read=0.22 seconds
2020-01-07 22:09:44,779 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_val.h5
2020-01-07 22:09:44,856 [INFO] Reading complete. time_to_read=0.08 seconds
2020-01-07 22:09:44,856 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_test.h5
2020-01-07 22:09:44,933 [INFO] Reading complete. time_to_read=0.08 seconds
2020-01-07 22:09:48,565 [INFO] Initializing model
2020-01-07 22:09:48,669 [INFO] _________________________________________________________________
2020-01-07 22:09:48,669 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-07 22:09:48,669 [INFO] =================================================================
2020-01-07 22:09:48,669 [INFO] dense_7 (Dense)              (None, 64)                4992      
2020-01-07 22:09:48,669 [INFO] _________________________________________________________________
2020-01-07 22:09:48,669 [INFO] batch_normalization_4 (Batch (None, 64)                256       
2020-01-07 22:09:48,670 [INFO] _________________________________________________________________
2020-01-07 22:09:48,670 [INFO] dropout_4 (Dropout)          (None, 64)                0         
2020-01-07 22:09:48,670 [INFO] _________________________________________________________________
2020-01-07 22:09:48,670 [INFO] dense_8 (Dense)              (None, 15)                975       
2020-01-07 22:09:48,670 [INFO] =================================================================
2020-01-07 22:09:48,670 [INFO] Total params: 6,223
2020-01-07 22:09:48,670 [INFO] Trainable params: 6,095
2020-01-07 22:09:48,670 [INFO] Non-trainable params: 128
2020-01-07 22:09:48,670 [INFO] _________________________________________________________________
2020-01-07 22:09:48,670 [INFO] Training model
2020-01-07 22:09:48,670 [INFO] Splitting train set into 2 sets (set1, set2), random_seed = 42
2020-01-07 22:10:09,127 [INFO] Split sizes (instances). total = 1936462, set1 = 1161877, set2 = 774585, set1 dataset hash = e211c42470e527b7db137c5b520de34e615b428e
 - val_f1: 0.9780
Train on 774585 samples, validate on 645487 samples
Epoch 1/100
 - 9s - loss: 0.0221 - val_loss: 0.0092
 - val_f1: 0.9762
Epoch 2/100
 - 8s - loss: 0.0094 - val_loss: 0.0086
 - val_f1: 0.9770
Epoch 3/100
 - 8s - loss: 0.0089 - val_loss: 0.0084
 - val_f1: 0.9752
Epoch 4/100
 - 8s - loss: 0.0087 - val_loss: 0.0083
 - val_f1: 0.9772
Epoch 5/100
 - 8s - loss: 0.0086 - val_loss: 0.0082
 - val_f1: 0.9773
Epoch 6/100
 - 8s - loss: 0.0085 - val_loss: 0.0083
 - val_f1: 0.9761
Epoch 7/100
 - 8s - loss: 0.0084 - val_loss: 0.0082
 - val_f1: 0.9753
Epoch 8/100
 - 8s - loss: 0.0084 - val_loss: 0.0083
 - val_f1: 0.9776
Epoch 9/100
 - 8s - loss: 0.0083 - val_loss: 0.0084
 - val_f1: 0.9778
Epoch 10/100
 - 8s - loss: 0.0084 - val_loss: 0.0082
 - val_f1: 0.9776
Epoch 11/100
 - 8s - loss: 0.0083 - val_loss: 0.0083
/home/sunanda/test/ml_env/lib/python3.6/site-packages/sklearn/metrics/classification.py:1143: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no predicted samples.
  'precision', 'predicted', average, warn_for)
2020-01-07 22:12:48,414 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p40/ann_model_epoch_10.pickle
 - val_f1: 0.9777
Epoch 12/100
 - 8s - loss: 0.0083 - val_loss: 0.0081
 - val_f1: 0.9782
Epoch 13/100
 - 8s - loss: 0.0083 - val_loss: 0.0084
 - val_f1: 0.9775
Epoch 14/100
 - 8s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9782
Epoch 15/100
 - 8s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9777
Epoch 16/100
 - 8s - loss: 0.0082 - val_loss: 0.0083
 - val_f1: 0.9773
Epoch 17/100
 - 8s - loss: 0.0082 - val_loss: 0.0084
 - val_f1: 0.9774
Epoch 18/100
 - 8s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9779
Epoch 19/100
 - 8s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9776
Epoch 20/100
 - 8s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9782
Epoch 21/100
 - 8s - loss: 0.0082 - val_loss: 0.0082
2020-01-07 22:15:17,565 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p40/ann_model_epoch_20.pickle
 - val_f1: 0.9776
Epoch 22/100
 - 8s - loss: 0.0082 - val_loss: 0.0080
 - val_f1: 0.9784
Epoch 23/100
 - 8s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9779
Epoch 24/100
 - 8s - loss: 0.0082 - val_loss: 0.0080
 - val_f1: 0.9781
Epoch 25/100
 - 8s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9763
Epoch 26/100
 - 8s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9780
Epoch 27/100
 - 8s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9778
Epoch 28/100
 - 8s - loss: 0.0081 - val_loss: 0.0083
 - val_f1: 0.9756
Epoch 29/100
 - 8s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9781
Epoch 30/100
 - 8s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9784
Epoch 31/100
 - 8s - loss: 0.0081 - val_loss: 0.0080
2020-01-07 22:17:46,304 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p40/ann_model_epoch_30.pickle
 - val_f1: 0.9779
Epoch 32/100
 - 8s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9763
Epoch 33/100
 - 8s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 34/100
 - 8s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9780
Epoch 35/100
 - 8s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9778
Epoch 36/100
 - 8s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 37/100
 - 8s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9780
Epoch 38/100
 - 8s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 39/100
 - 8s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9778
Epoch 40/100
 - 8s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9780
Epoch 41/100
 - 8s - loss: 0.0081 - val_loss: 0.0080
2020-01-07 22:20:15,575 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p40/ann_model_epoch_40.pickle
 - val_f1: 0.9779
Epoch 42/100
 - 8s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9779
Epoch 43/100
 - 8s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9781
Epoch 44/100
 - 8s - loss: 0.0081 - val_loss: 0.0082
 - val_f1: 0.9781
Epoch 45/100
 - 8s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9780
Epoch 46/100
 - 8s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9778
Epoch 47/100
 - 8s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9782
Epoch 48/100
 - 8s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9764
Epoch 49/100
 - 8s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9781
Epoch 50/100
 - 8s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9762
Epoch 51/100
 - 8s - loss: 0.0080 - val_loss: 0.0082
2020-01-07 22:22:44,368 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p40/ann_model_epoch_50.pickle
 - val_f1: 0.9777
Epoch 52/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9767
Epoch 53/100
 - 8s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9780
Epoch 54/100
 - 8s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9780
Epoch 55/100
 - 8s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9780
Epoch 56/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9780
Epoch 57/100
 - 8s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9782
Epoch 58/100
 - 8s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9779
Epoch 59/100
 - 8s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9765
Epoch 60/100
 - 8s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9781
Epoch 61/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
2020-01-07 22:25:13,428 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p40/ann_model_epoch_60.pickle
 - val_f1: 0.9764
Epoch 62/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9781
Epoch 63/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9782
Epoch 64/100
 - 8s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 65/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9778
Epoch 66/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9782
Epoch 67/100
 - 8s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9768
Epoch 68/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9781
Epoch 69/100
 - 8s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9780
Epoch 70/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9782
Epoch 71/100
 - 8s - loss: 0.0080 - val_loss: 0.0080
2020-01-07 22:27:42,560 [INFO] epoch = 70. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p40/ann_model_epoch_70.pickle
 - val_f1: 0.9763
Epoch 72/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9780
Epoch 73/100
 - 8s - loss: 0.0080 - val_loss: 0.0082
 - val_f1: 0.9782
Epoch 74/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9785
Epoch 75/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9780
Epoch 76/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9786
Epoch 77/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9782
Epoch 78/100
 - 8s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9782
Epoch 79/100
 - 8s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9763
Epoch 80/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9782
Epoch 81/100
 - 8s - loss: 0.0081 - val_loss: 0.0080
2020-01-07 22:30:11,601 [INFO] epoch = 80. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p40/ann_model_epoch_80.pickle
 - val_f1: 0.9781
Epoch 82/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9782
Epoch 83/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9786
Epoch 84/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9786
Epoch 85/100
 - 8s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9773
Epoch 86/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9780
Epoch 87/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9783
Epoch 88/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9783
Epoch 89/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9766
Epoch 90/100
 - 8s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9781
Epoch 91/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
2020-01-07 22:32:40,432 [INFO] epoch = 90. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p40/ann_model_epoch_90.pickle
 - val_f1: 0.9780
Epoch 92/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9780
Epoch 93/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9784
Epoch 94/100
 - 8s - loss: 0.0080 - val_loss: 0.0078
 - val_f1: 0.9781
Epoch 95/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9786
Epoch 96/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9782
Epoch 97/100
 - 8s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9781
Epoch 98/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9786
Epoch 99/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9780
Epoch 100/100
 - 8s - loss: 0.0080 - val_loss: 0.0079
2020-01-07 22:35:01,024 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-07 22:35:18,498 [INFO] Last epoch loss evaluation: train_loss = 0.007811, val_loss = 0.007842
2020-01-07 22:35:18,544 [INFO] Training complete. time_to_train = 1529.87 sec, 25.50 min
2020-01-07 22:35:18,547 [INFO] Model saved to results_additional_exps/ann_data_efficiency_ids18_p40/best_model.pickle
2020-01-07 22:35:18,549 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_ids18_p40/training_error_history.csv
2020-01-07 22:35:18,726 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids18_p40/training_error_history.png
2020-01-07 22:35:18,899 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids18_p40/training_f1_history.png
2020-01-07 22:35:18,899 [INFO] Making predictions on training, validation, testing data
2020-01-07 22:35:49,380 [INFO] Evaluating predictions (results)
2020-01-07 22:36:01,342 [INFO] Dataset: Testing. Classification report below
2020-01-07 22:36:01,343 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       1.00      0.21      0.34        24
        Brute Force -XSS       1.00      0.33      0.50         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.61      0.16      0.26        67
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23010
   DoS attacks-GoldenEye       0.99      1.00      0.99      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.74      0.45      0.56      5596
   DoS attacks-Slowloris       0.96      0.97      0.97       440
          FTP-BruteForce       0.69      0.88      0.78      7718
           Infilteration       0.45      0.01      0.02      6404
           SQL Injection       1.00      0.25      0.40         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

               micro avg       0.98      0.98      0.98    645488
               macro avg       0.89      0.68      0.72    645488
            weighted avg       0.98      0.98      0.98    645488

2020-01-07 22:36:01,343 [INFO] Overall accuracy (micro avg): 0.9831553801155095
2020-01-07 22:36:14,956 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9832         0.9832                       0.9832                0.0012                   0.0168  0.9832
1     Macro avg        0.9978         0.8944                       0.6840                0.0044                   0.3160  0.7201
2  Weighted avg        0.9910         0.9780                       0.9832                0.0498                   0.0168  0.9780
/home/sunanda/test/ml_env/lib/python3.6/site-packages/sklearn/metrics/classification.py:1143: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples.
  'precision', 'predicted', average, warn_for)
2020-01-07 22:36:26,961 [INFO] Dataset: Validation. Classification report below
2020-01-07 22:36:26,961 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       1.00      0.28      0.44        25
        Brute Force -XSS       1.00      0.67      0.80         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.61      0.21      0.31        68
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23009
   DoS attacks-GoldenEye       1.00      0.99      0.99      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.75      0.45      0.56      5596
   DoS attacks-Slowloris       0.94      0.97      0.96       439
          FTP-BruteForce       0.69      0.89      0.78      7718
           Infilteration       0.47      0.01      0.02      6403
           SQL Injection       0.00      0.00      0.00         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

               micro avg       0.98      0.98      0.98    645487
               macro avg       0.83      0.70      0.72    645487
            weighted avg       0.98      0.98      0.98    645487

2020-01-07 22:36:26,963 [INFO] Overall accuracy (micro avg): 0.9832219703882495
/home/sunanda/test/ids_experiments/utility.py:328: RuntimeWarning: invalid value encountered in true_divide
  PPV = TP / (TP + FP)    # Precision or positive predictive value
/home/sunanda/test/ids_experiments/utility.py:332: RuntimeWarning: invalid value encountered in true_divide
  FDR = FP / (TP + FP)    # False discovery rate
2020-01-07 22:36:40,579 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9832         0.9832                       0.9832                0.0012                   0.0168  0.9832
1     Macro avg        0.9978         0.8292                       0.6975                0.0044                   0.3025  0.7227
2  Weighted avg        0.9910         0.9784                       0.9832                0.0497                   0.0168  0.9781
2020-01-07 22:37:19,805 [INFO] Dataset: Training. Classification report below
2020-01-07 22:37:19,805 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99   1606949
                     Bot       1.00      1.00      1.00     34396
        Brute Force -Web       1.00      0.26      0.41        73
        Brute Force -XSS       1.00      0.50      0.67        26
        DDOS attack-HOIC       1.00      1.00      1.00     82341
    DDOS attack-LOIC-UDP       0.64      0.17      0.27       203
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     69029
   DoS attacks-GoldenEye       0.99      1.00      1.00      4954
        DoS attacks-Hulk       1.00      1.00      1.00     55435
DoS attacks-SlowHTTPTest       0.74      0.45      0.56     16787
   DoS attacks-Slowloris       0.97      0.99      0.98      1318
          FTP-BruteForce       0.69      0.89      0.78     23153
           Infilteration       0.50      0.01      0.02     19210
           SQL Injection       1.00      0.25      0.40        12
          SSH-Bruteforce       1.00      1.00      1.00     22576

               micro avg       0.98      0.98      0.98   1936462
               macro avg       0.90      0.70      0.74   1936462
            weighted avg       0.98      0.98      0.98   1936462

2020-01-07 22:37:19,805 [INFO] Overall accuracy (micro avg): 0.9832199134297497
2020-01-07 22:38:04,332 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9832         0.9832                       0.9832                0.0012                   0.0168  0.9832
1     Macro avg        0.9978         0.9006                       0.7003                0.0044                   0.2997  0.7374
2  Weighted avg        0.9910         0.9787                       0.9832                0.0496                   0.0168  0.9781
2020-01-07 22:38:04,390 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_ids18_p40/ann_data_efficiency_ids18_p40_results.xlsx
2020-01-07 22:38:04,394 [INFO] ================= Finished running experiment no. 4 ================= 

2020-01-07 22:38:04,474 [INFO] Created directory: results_additional_exps/ann_data_efficiency_ids18_p50
2020-01-07 22:38:04,474 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_ids18_p50/run_log.log
2020-01-07 22:38:04,474 [INFO] ================= Running experiment no. 5  ================= 

2020-01-07 22:38:04,474 [INFO] Experiment parameters given below
2020-01-07 22:38:04,474 [INFO] 
{'experiment_num': 5, 'results_dir': 'results_additional_exps/ann_data_efficiency_ids18_p50', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': 0.5, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/ids2018', 'description': 'ann_data_efficiency_ids18_p50'}
2020-01-07 22:38:04,474 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_ids18_p50/tf_logs_run_2020_01_07-22_38_04
2020-01-07 22:38:04,474 [INFO] Loading datsets from: ../Datasets/small_datasets/ids2018
2020-01-07 22:38:04,475 [INFO] Reading X, y files
2020-01-07 22:38:04,475 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_train.h5
2020-01-07 22:38:08,810 [INFO] Reading complete. time_to_read=4.34 seconds
2020-01-07 22:38:08,810 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_val.h5
2020-01-07 22:38:10,298 [INFO] Reading complete. time_to_read=1.49 seconds
2020-01-07 22:38:10,298 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_test.h5
2020-01-07 22:38:11,788 [INFO] Reading complete. time_to_read=1.49 seconds
2020-01-07 22:38:11,788 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_train.h5
2020-01-07 22:38:12,019 [INFO] Reading complete. time_to_read=0.23 seconds
2020-01-07 22:38:12,019 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_val.h5
2020-01-07 22:38:12,095 [INFO] Reading complete. time_to_read=0.08 seconds
2020-01-07 22:38:12,095 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_test.h5
2020-01-07 22:38:12,171 [INFO] Reading complete. time_to_read=0.08 seconds
2020-01-07 22:38:15,829 [INFO] Initializing model
2020-01-07 22:38:15,933 [INFO] _________________________________________________________________
2020-01-07 22:38:15,933 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-07 22:38:15,933 [INFO] =================================================================
2020-01-07 22:38:15,934 [INFO] dense_9 (Dense)              (None, 64)                4992      
2020-01-07 22:38:15,934 [INFO] _________________________________________________________________
2020-01-07 22:38:15,934 [INFO] batch_normalization_5 (Batch (None, 64)                256       
2020-01-07 22:38:15,934 [INFO] _________________________________________________________________
2020-01-07 22:38:15,934 [INFO] dropout_5 (Dropout)          (None, 64)                0         
2020-01-07 22:38:15,934 [INFO] _________________________________________________________________
2020-01-07 22:38:15,934 [INFO] dense_10 (Dense)             (None, 15)                975       
2020-01-07 22:38:15,934 [INFO] =================================================================
2020-01-07 22:38:15,934 [INFO] Total params: 6,223
2020-01-07 22:38:15,934 [INFO] Trainable params: 6,095
2020-01-07 22:38:15,934 [INFO] Non-trainable params: 128
2020-01-07 22:38:15,934 [INFO] _________________________________________________________________
2020-01-07 22:38:15,934 [INFO] Training model
2020-01-07 22:38:15,934 [INFO] Splitting train set into 2 sets (set1, set2), random_seed = 42
2020-01-07 22:38:36,328 [INFO] Split sizes (instances). total = 1936462, set1 = 968231, set2 = 968231, set1 dataset hash = df2add71ad9b72cb5233a111509b2b74ff33670a
 - val_f1: 0.9779
Train on 968231 samples, validate on 645487 samples
Epoch 1/100
 - 11s - loss: 0.0202 - val_loss: 0.0092
 - val_f1: 0.9739
Epoch 2/100
 - 10s - loss: 0.0092 - val_loss: 0.0093
 - val_f1: 0.9758
Epoch 3/100
 - 10s - loss: 0.0088 - val_loss: 0.0084
 - val_f1: 0.9775
Epoch 4/100
 - 10s - loss: 0.0086 - val_loss: 0.0087
 - val_f1: 0.9774
Epoch 5/100
 - 10s - loss: 0.0085 - val_loss: 0.0082
 - val_f1: 0.9778
Epoch 6/100
 - 10s - loss: 0.0084 - val_loss: 0.0084
 - val_f1: 0.9774
Epoch 7/100
 - 10s - loss: 0.0084 - val_loss: 0.0082
 - val_f1: 0.9778
Epoch 8/100
 - 10s - loss: 0.0083 - val_loss: 0.0082
 - val_f1: 0.9763
Epoch 9/100
 - 10s - loss: 0.0083 - val_loss: 0.0084
 - val_f1: 0.9776
Epoch 10/100
 - 10s - loss: 0.0083 - val_loss: 0.0080
 - val_f1: 0.9791
Epoch 11/100
 - 10s - loss: 0.0083 - val_loss: 0.0081
/home/sunanda/test/ml_env/lib/python3.6/site-packages/sklearn/metrics/classification.py:1143: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no predicted samples.
  'precision', 'predicted', average, warn_for)
2020-01-07 22:41:41,351 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p50/ann_model_epoch_10.pickle
 - val_f1: 0.9778
Epoch 12/100
 - 10s - loss: 0.0082 - val_loss: 0.0080
 - val_f1: 0.9781
Epoch 13/100
 - 10s - loss: 0.0083 - val_loss: 0.0080
 - val_f1: 0.9786
Epoch 14/100
 - 10s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9779
Epoch 15/100
 - 10s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9779
Epoch 16/100
 - 10s - loss: 0.0083 - val_loss: 0.0083
 - val_f1: 0.9782
Epoch 17/100
 - 10s - loss: 0.0082 - val_loss: 0.0080
 - val_f1: 0.9781
Epoch 18/100
 - 10s - loss: 0.0082 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 19/100
 - 10s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9776
Epoch 20/100
 - 10s - loss: 0.0082 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 21/100
 - 10s - loss: 0.0082 - val_loss: 0.0080
2020-01-07 22:44:33,233 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p50/ann_model_epoch_20.pickle
 - val_f1: 0.9779
Epoch 22/100
 - 10s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 23/100
 - 10s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9757
Epoch 24/100
 - 10s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9778
Epoch 25/100
 - 10s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9781
Epoch 26/100
 - 10s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9778
Epoch 27/100
 - 10s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9780
Epoch 28/100
 - 10s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9776
Epoch 29/100
 - 10s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9761
Epoch 30/100
 - 10s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9780
Epoch 31/100
 - 10s - loss: 0.0081 - val_loss: 0.0080
2020-01-07 22:47:26,348 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p50/ann_model_epoch_30.pickle
 - val_f1: 0.9783
Epoch 32/100
 - 10s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9780
Epoch 33/100
 - 10s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 34/100
 - 10s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9783
Epoch 35/100
 - 10s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9767
Epoch 36/100
 - 10s - loss: 0.0081 - val_loss: 0.0082
 - val_f1: 0.9785
Epoch 37/100
 - 10s - loss: 0.0082 - val_loss: 0.0079
 - val_f1: 0.9780
Epoch 38/100
 - 10s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9784
Epoch 39/100
 - 10s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9763
Epoch 40/100
 - 10s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9785
Epoch 41/100
 - 10s - loss: 0.0081 - val_loss: 0.0081
2020-01-07 22:50:17,470 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p50/ann_model_epoch_40.pickle
 - val_f1: 0.9780
Epoch 42/100
 - 10s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9787
Epoch 43/100
 - 10s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9780
Epoch 44/100
 - 10s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9784
Epoch 45/100
 - 10s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9783
Epoch 46/100
 - 10s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9765
Epoch 47/100
 - 10s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9767
Epoch 48/100
 - 10s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9786
Epoch 49/100
 - 10s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9784
Epoch 50/100
 - 10s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9763
Epoch 51/100
 - 10s - loss: 0.0080 - val_loss: 0.0079
2020-01-07 22:53:08,339 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p50/ann_model_epoch_50.pickle
 - val_f1: 0.9783
Epoch 52/100
 - 10s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9777
Epoch 53/100
 - 10s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9781
Epoch 54/100
 - 10s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9783
Epoch 55/100
 - 10s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9777
Epoch 56/100
 - 10s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9784
Epoch 57/100
 - 10s - loss: 0.0080 - val_loss: 0.0083
 - val_f1: 0.9776
Epoch 58/100
 - 10s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9779
Epoch 59/100
 - 10s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9784
Epoch 60/100
 - 10s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9783
Epoch 61/100
 - 10s - loss: 0.0080 - val_loss: 0.0079
2020-01-07 22:56:00,688 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p50/ann_model_epoch_60.pickle
 - val_f1: 0.9787
Epoch 62/100
 - 10s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9781
Epoch 63/100
 - 10s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9785
Epoch 64/100
 - 10s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9781
Epoch 65/100
 - 10s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9780
Epoch 66/100
 - 10s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 67/100
 - 10s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9778
Epoch 68/100
 - 10s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9785
Epoch 69/100
 - 10s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9782
Epoch 70/100
 - 10s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9783
Epoch 71/100
 - 10s - loss: 0.0080 - val_loss: 0.0079
2020-01-07 22:58:53,209 [INFO] epoch = 70. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p50/ann_model_epoch_70.pickle
 - val_f1: 0.9779
Epoch 72/100
 - 10s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9781
Epoch 73/100
 - 10s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9786
Epoch 74/100
 - 10s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 75/100
 - 10s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9784
Epoch 76/100
 - 10s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9781
Epoch 77/100
 - 10s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9781
Epoch 78/100
 - 10s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9759
Epoch 79/100
 - 10s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9784
Epoch 80/100
 - 10s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9781
Epoch 81/100
 - 10s - loss: 0.0080 - val_loss: 0.0079
2020-01-07 23:01:44,739 [INFO] epoch = 80. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p50/ann_model_epoch_80.pickle
 - val_f1: 0.9781
Epoch 82/100
 - 10s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9782
Epoch 83/100
 - 10s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 84/100
 - 10s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9766
Epoch 85/100
 - 10s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9768
Epoch 86/100
 - 10s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9778
Epoch 87/100
 - 10s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9768
Epoch 88/100
 - 10s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9783
Epoch 89/100
 - 10s - loss: 0.0080 - val_loss: 0.0079
2020-01-07 23:04:10,009 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-07 23:04:30,857 [INFO] Last epoch loss evaluation: train_loss = 0.007826, val_loss = 0.007855
2020-01-07 23:04:30,901 [INFO] Training complete. time_to_train = 1574.97 sec, 26.25 min
2020-01-07 23:04:30,904 [INFO] Model saved to results_additional_exps/ann_data_efficiency_ids18_p50/best_model.pickle
2020-01-07 23:04:30,906 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_ids18_p50/training_error_history.csv
2020-01-07 23:04:31,076 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids18_p50/training_error_history.png
2020-01-07 23:04:31,240 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids18_p50/training_f1_history.png
2020-01-07 23:04:31,240 [INFO] Making predictions on training, validation, testing data
2020-01-07 23:05:03,181 [INFO] Evaluating predictions (results)
2020-01-07 23:05:15,171 [INFO] Dataset: Testing. Classification report below
2020-01-07 23:05:15,171 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       1.00      0.12      0.22        24
        Brute Force -XSS       1.00      0.33      0.50         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.79      0.45      0.57        67
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23010
   DoS attacks-GoldenEye       0.99      1.00      0.99      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.72      0.47      0.57      5596
   DoS attacks-Slowloris       0.92      0.96      0.94       440
          FTP-BruteForce       0.69      0.87      0.77      7718
           Infilteration       0.47      0.01      0.02      6404
           SQL Injection       1.00      0.50      0.67         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

               micro avg       0.98      0.98      0.98    645488
               macro avg       0.90      0.71      0.75    645488
            weighted avg       0.98      0.98      0.98    645488

2020-01-07 23:05:15,171 [INFO] Overall accuracy (micro avg): 0.9831336910988275
2020-01-07 23:05:28,807 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9831         0.9831                       0.9831                0.0012                   0.0169  0.9831
1     Macro avg        0.9978         0.9042                       0.7134                0.0044                   0.2866  0.7495
2  Weighted avg        0.9910         0.9782                       0.9831                0.0494                   0.0169  0.9781
2020-01-07 23:05:40,822 [INFO] Dataset: Validation. Classification report below
2020-01-07 23:05:40,822 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       1.00      0.20      0.33        25
        Brute Force -XSS       1.00      0.67      0.80         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.74      0.43      0.54        68
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23009
   DoS attacks-GoldenEye       0.99      1.00      0.99      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.73      0.46      0.57      5596
   DoS attacks-Slowloris       0.92      0.96      0.94       439
          FTP-BruteForce       0.69      0.88      0.77      7718
           Infilteration       0.46      0.01      0.02      6403
           SQL Injection       1.00      0.25      0.40         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

               micro avg       0.98      0.98      0.98    645487
               macro avg       0.90      0.72      0.76    645487
            weighted avg       0.98      0.98      0.98    645487

2020-01-07 23:05:40,822 [INFO] Overall accuracy (micro avg): 0.9831785922876836
2020-01-07 23:05:54,454 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9832         0.9832                       0.9832                0.0012                   0.0168  0.9832
1     Macro avg        0.9978         0.9010                       0.7230                0.0044                   0.2770  0.7572
2  Weighted avg        0.9910         0.9782                       0.9832                0.0493                   0.0168  0.9782
2020-01-07 23:06:33,689 [INFO] Dataset: Training. Classification report below
2020-01-07 23:06:33,689 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99   1606949
                     Bot       1.00      1.00      1.00     34396
        Brute Force -Web       1.00      0.12      0.22        73
        Brute Force -XSS       0.93      0.50      0.65        26
        DDOS attack-HOIC       1.00      1.00      1.00     82341
    DDOS attack-LOIC-UDP       0.78      0.46      0.58       203
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     69029
   DoS attacks-GoldenEye       0.99      1.00      1.00      4954
        DoS attacks-Hulk       1.00      1.00      1.00     55435
DoS attacks-SlowHTTPTest       0.73      0.46      0.56     16787
   DoS attacks-Slowloris       0.94      0.98      0.96      1318
          FTP-BruteForce       0.69      0.87      0.77     23153
           Infilteration       0.52      0.01      0.03     19210
           SQL Injection       1.00      0.33      0.50        12
          SSH-Bruteforce       1.00      1.00      1.00     22576

               micro avg       0.98      0.98      0.98   1936462
               macro avg       0.90      0.72      0.75   1936462
            weighted avg       0.98      0.98      0.98   1936462

2020-01-07 23:06:33,689 [INFO] Overall accuracy (micro avg): 0.9831951259565125
2020-01-07 23:07:18,238 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9832         0.9832                       0.9832                0.0012                   0.0168  0.9832
1     Macro avg        0.9978         0.9039                       0.7158                0.0044                   0.2842  0.7503
2  Weighted avg        0.9910         0.9788                       0.9832                0.0492                   0.0168  0.9782
2020-01-07 23:07:18,297 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_ids18_p50/ann_data_efficiency_ids18_p50_results.xlsx
2020-01-07 23:07:18,301 [INFO] ================= Finished running experiment no. 5 ================= 

2020-01-07 23:07:18,383 [INFO] Created directory: results_additional_exps/ann_data_efficiency_ids18_p60
2020-01-07 23:07:18,383 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_ids18_p60/run_log.log
2020-01-07 23:07:18,383 [INFO] ================= Running experiment no. 6  ================= 

2020-01-07 23:07:18,383 [INFO] Experiment parameters given below
2020-01-07 23:07:18,383 [INFO] 
{'experiment_num': 6, 'results_dir': 'results_additional_exps/ann_data_efficiency_ids18_p60', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': 0.4, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/ids2018', 'description': 'ann_data_efficiency_ids18_p60'}
2020-01-07 23:07:18,384 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_ids18_p60/tf_logs_run_2020_01_07-23_07_18
2020-01-07 23:07:18,384 [INFO] Loading datsets from: ../Datasets/small_datasets/ids2018
2020-01-07 23:07:18,384 [INFO] Reading X, y files
2020-01-07 23:07:18,384 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_train.h5
2020-01-07 23:07:22,694 [INFO] Reading complete. time_to_read=4.31 seconds
2020-01-07 23:07:22,694 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_val.h5
2020-01-07 23:07:24,175 [INFO] Reading complete. time_to_read=1.48 seconds
2020-01-07 23:07:24,175 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_test.h5
2020-01-07 23:07:25,661 [INFO] Reading complete. time_to_read=1.49 seconds
2020-01-07 23:07:25,661 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_train.h5
2020-01-07 23:07:25,909 [INFO] Reading complete. time_to_read=0.25 seconds
2020-01-07 23:07:25,909 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_val.h5
2020-01-07 23:07:25,986 [INFO] Reading complete. time_to_read=0.08 seconds
2020-01-07 23:07:25,986 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_test.h5
2020-01-07 23:07:26,063 [INFO] Reading complete. time_to_read=0.08 seconds
2020-01-07 23:07:29,749 [INFO] Initializing model
2020-01-07 23:07:29,853 [INFO] _________________________________________________________________
2020-01-07 23:07:29,853 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-07 23:07:29,853 [INFO] =================================================================
2020-01-07 23:07:29,853 [INFO] dense_11 (Dense)             (None, 64)                4992      
2020-01-07 23:07:29,853 [INFO] _________________________________________________________________
2020-01-07 23:07:29,853 [INFO] batch_normalization_6 (Batch (None, 64)                256       
2020-01-07 23:07:29,853 [INFO] _________________________________________________________________
2020-01-07 23:07:29,853 [INFO] dropout_6 (Dropout)          (None, 64)                0         
2020-01-07 23:07:29,853 [INFO] _________________________________________________________________
2020-01-07 23:07:29,853 [INFO] dense_12 (Dense)             (None, 15)                975       
2020-01-07 23:07:29,853 [INFO] =================================================================
2020-01-07 23:07:29,853 [INFO] Total params: 6,223
2020-01-07 23:07:29,854 [INFO] Trainable params: 6,095
2020-01-07 23:07:29,854 [INFO] Non-trainable params: 128
2020-01-07 23:07:29,854 [INFO] _________________________________________________________________
2020-01-07 23:07:29,854 [INFO] Training model
2020-01-07 23:07:29,854 [INFO] Splitting train set into 2 sets (set1, set2), random_seed = 42
2020-01-07 23:07:50,609 [INFO] Split sizes (instances). total = 1936462, set1 = 774584, set2 = 1161878, set1 dataset hash = 8f0716c0bd041679eb4e6193fdacf14ed7da3402
 - val_f1: 0.9783
Epoch 00089: early stopping
Train on 1161878 samples, validate on 645487 samples
Epoch 1/100
 - 13s - loss: 0.0189 - val_loss: 0.0088
 - val_f1: 0.9772
Epoch 2/100
 - 12s - loss: 0.0090 - val_loss: 0.0085
 - val_f1: 0.9758
Epoch 3/100
 - 12s - loss: 0.0087 - val_loss: 0.0084
 - val_f1: 0.9780
Epoch 4/100
 - 12s - loss: 0.0086 - val_loss: 0.0082
 - val_f1: 0.9779
Epoch 5/100
 - 12s - loss: 0.0085 - val_loss: 0.0082
 - val_f1: 0.9777
Epoch 6/100
 - 12s - loss: 0.0084 - val_loss: 0.0085
 - val_f1: 0.9771
Epoch 7/100
 - 12s - loss: 0.0084 - val_loss: 0.0081
 - val_f1: 0.9779
Epoch 8/100
 - 12s - loss: 0.0083 - val_loss: 0.0080
 - val_f1: 0.9778
Epoch 9/100
 - 12s - loss: 0.0083 - val_loss: 0.0082
 - val_f1: 0.9775
Epoch 10/100
 - 12s - loss: 0.0083 - val_loss: 0.0082
 - val_f1: 0.9777
Epoch 11/100
 - 12s - loss: 0.0083 - val_loss: 0.0081
/home/sunanda/test/ml_env/lib/python3.6/site-packages/sklearn/metrics/classification.py:1143: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no predicted samples.
  'precision', 'predicted', average, warn_for)
2020-01-07 23:11:23,428 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p60/ann_model_epoch_10.pickle
 - val_f1: 0.9778
Epoch 12/100
 - 12s - loss: 0.0083 - val_loss: 0.0082
 - val_f1: 0.9747
Epoch 13/100
 - 12s - loss: 0.0083 - val_loss: 0.0081
 - val_f1: 0.9777
Epoch 14/100
 - 12s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9776
Epoch 15/100
 - 12s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9778
Epoch 16/100
 - 12s - loss: 0.0082 - val_loss: 0.0080
 - val_f1: 0.9762
Epoch 17/100
 - 12s - loss: 0.0082 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 18/100
 - 12s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9760
Epoch 19/100
 - 12s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9777
Epoch 20/100
 - 12s - loss: 0.0082 - val_loss: 0.0080
 - val_f1: 0.9777
Epoch 21/100
 - 12s - loss: 0.0082 - val_loss: 0.0082
2020-01-07 23:14:38,956 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p60/ann_model_epoch_20.pickle
 - val_f1: 0.9778
Epoch 22/100
 - 12s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9778
Epoch 23/100
 - 12s - loss: 0.0082 - val_loss: 0.0080
 - val_f1: 0.9781
Epoch 24/100
 - 12s - loss: 0.0082 - val_loss: 0.0080
 - val_f1: 0.9777
Epoch 25/100
 - 12s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9763
Epoch 26/100
 - 12s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9780
Epoch 27/100
 - 12s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9776
Epoch 28/100
 - 12s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9781
Epoch 29/100
 - 12s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9777
Epoch 30/100
 - 12s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 31/100
 - 12s - loss: 0.0081 - val_loss: 0.0081
2020-01-07 23:17:56,695 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p60/ann_model_epoch_30.pickle
 - val_f1: 0.9761
Epoch 32/100
 - 12s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 33/100
 - 12s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9779
Epoch 34/100
 - 12s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9783
Epoch 35/100
 - 12s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9781
Epoch 36/100
 - 12s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9778
Epoch 37/100
 - 12s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9779
Epoch 38/100
 - 12s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9783
Epoch 39/100
 - 12s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9782
Epoch 40/100
 - 12s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9783
Epoch 41/100
 - 12s - loss: 0.0081 - val_loss: 0.0081
2020-01-07 23:21:12,798 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p60/ann_model_epoch_40.pickle
 - val_f1: 0.9779
Epoch 42/100
 - 12s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9777
Epoch 43/100
 - 12s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9779
Epoch 44/100
 - 12s - loss: 0.0081 - val_loss: 0.0082
 - val_f1: 0.9780
Epoch 45/100
 - 12s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9783
Epoch 46/100
 - 12s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9763
Epoch 47/100
 - 12s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9763
Epoch 48/100
 - 12s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9778
Epoch 49/100
 - 12s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9779
Epoch 50/100
 - 12s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9784
Epoch 51/100
 - 12s - loss: 0.0080 - val_loss: 0.0079
2020-01-07 23:24:29,688 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p60/ann_model_epoch_50.pickle
 - val_f1: 0.9783
Epoch 52/100
 - 12s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9780
Epoch 53/100
 - 12s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9779
Epoch 54/100
 - 12s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9780
Epoch 55/100
 - 12s - loss: 0.0081 - val_loss: 0.0079
2020-01-07 23:25:55,696 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-07 23:26:19,948 [INFO] Last epoch loss evaluation: train_loss = 0.007875, val_loss = 0.007881
2020-01-07 23:26:19,991 [INFO] Training complete. time_to_train = 1130.14 sec, 18.84 min
2020-01-07 23:26:19,994 [INFO] Model saved to results_additional_exps/ann_data_efficiency_ids18_p60/best_model.pickle
2020-01-07 23:26:19,996 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_ids18_p60/training_error_history.csv
2020-01-07 23:26:20,167 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids18_p60/training_error_history.png
2020-01-07 23:26:20,343 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids18_p60/training_f1_history.png
2020-01-07 23:26:20,343 [INFO] Making predictions on training, validation, testing data
2020-01-07 23:26:55,267 [INFO] Evaluating predictions (results)
2020-01-07 23:27:07,234 [INFO] Dataset: Testing. Classification report below
2020-01-07 23:27:07,234 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       1.00      0.12      0.22        24
        Brute Force -XSS       1.00      0.33      0.50         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.68      1.00      0.81        67
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23010
   DoS attacks-GoldenEye       0.99      1.00      0.99      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.75      0.45      0.56      5596
   DoS attacks-Slowloris       0.92      0.97      0.94       440
          FTP-BruteForce       0.69      0.89      0.78      7718
           Infilteration       0.42      0.01      0.02      6404
           SQL Injection       1.00      0.25      0.40         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

               micro avg       0.98      0.98      0.98    645488
               macro avg       0.90      0.73      0.75    645488
            weighted avg       0.98      0.98      0.98    645488

2020-01-07 23:27:07,235 [INFO] Overall accuracy (micro avg): 0.9832343901048509
2020-01-07 23:27:20,846 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9832         0.9832                       0.9832                0.0012                   0.0168  0.9832
1     Macro avg        0.9978         0.8955                       0.7340                0.0044                   0.2660  0.7476
2  Weighted avg        0.9909         0.9779                       0.9832                0.0497                   0.0168  0.9781
/home/sunanda/test/ml_env/lib/python3.6/site-packages/sklearn/metrics/classification.py:1143: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples.
  'precision', 'predicted', average, warn_for)
2020-01-07 23:27:32,870 [INFO] Dataset: Validation. Classification report below
2020-01-07 23:27:32,871 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       1.00      0.20      0.33        25
        Brute Force -XSS       1.00      0.67      0.80         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.72      1.00      0.84        68
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23009
   DoS attacks-GoldenEye       0.99      1.00      0.99      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.76      0.45      0.57      5596
   DoS attacks-Slowloris       0.92      0.97      0.95       439
          FTP-BruteForce       0.69      0.90      0.78      7718
           Infilteration       0.39      0.01      0.01      6403
           SQL Injection       0.00      0.00      0.00         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

               micro avg       0.98      0.98      0.98    645487
               macro avg       0.83      0.75      0.75    645487
            weighted avg       0.98      0.98      0.98    645487

2020-01-07 23:27:32,871 [INFO] Overall accuracy (micro avg): 0.9833242187681549
/home/sunanda/test/ids_experiments/utility.py:328: RuntimeWarning: invalid value encountered in true_divide
  PPV = TP / (TP + FP)    # Precision or positive predictive value
/home/sunanda/test/ids_experiments/utility.py:332: RuntimeWarning: invalid value encountered in true_divide
  FDR = FP / (TP + FP)    # False discovery rate
2020-01-07 23:27:46,498 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9833         0.9833                       0.9833                0.0012                   0.0167  0.9833
1     Macro avg        0.9978         0.8307                       0.7452                0.0044                   0.2548  0.7504
2  Weighted avg        0.9909         0.9777                       0.9833                0.0497                   0.0167  0.9781
2020-01-07 23:28:25,854 [INFO] Dataset: Training. Classification report below
2020-01-07 23:28:25,854 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99   1606949
                     Bot       1.00      1.00      1.00     34396
        Brute Force -Web       1.00      0.12      0.22        73
        Brute Force -XSS       1.00      0.50      0.67        26
        DDOS attack-HOIC       1.00      1.00      1.00     82341
    DDOS attack-LOIC-UDP       0.71      0.99      0.82       203
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     69029
   DoS attacks-GoldenEye       0.99      1.00      1.00      4954
        DoS attacks-Hulk       1.00      1.00      1.00     55435
DoS attacks-SlowHTTPTest       0.75      0.45      0.56     16787
   DoS attacks-Slowloris       0.94      0.99      0.96      1318
          FTP-BruteForce       0.69      0.89      0.78     23153
           Infilteration       0.46      0.01      0.02     19210
           SQL Injection       1.00      0.25      0.40        12
          SSH-Bruteforce       1.00      1.00      1.00     22576

               micro avg       0.98      0.98      0.98   1936462
               macro avg       0.90      0.75      0.76   1936462
            weighted avg       0.98      0.98      0.98   1936462

2020-01-07 23:28:25,854 [INFO] Overall accuracy (micro avg): 0.9833082188031576
2020-01-07 23:29:10,536 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9833         0.9833                       0.9833                0.0012                   0.0167  0.9833
1     Macro avg        0.9978         0.9009                       0.7460                0.0044                   0.2540  0.7606
2  Weighted avg        0.9910         0.9784                       0.9833                0.0495                   0.0167  0.9782
2020-01-07 23:29:10,594 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_ids18_p60/ann_data_efficiency_ids18_p60_results.xlsx
2020-01-07 23:29:10,599 [INFO] ================= Finished running experiment no. 6 ================= 

2020-01-07 23:29:10,679 [INFO] Created directory: results_additional_exps/ann_data_efficiency_ids18_p70
2020-01-07 23:29:10,679 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_ids18_p70/run_log.log
2020-01-07 23:29:10,679 [INFO] ================= Running experiment no. 7  ================= 

2020-01-07 23:29:10,679 [INFO] Experiment parameters given below
2020-01-07 23:29:10,680 [INFO] 
{'experiment_num': 7, 'results_dir': 'results_additional_exps/ann_data_efficiency_ids18_p70', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': 0.3, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/ids2018', 'description': 'ann_data_efficiency_ids18_p70'}
2020-01-07 23:29:10,680 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_ids18_p70/tf_logs_run_2020_01_07-23_29_10
2020-01-07 23:29:10,680 [INFO] Loading datsets from: ../Datasets/small_datasets/ids2018
2020-01-07 23:29:10,680 [INFO] Reading X, y files
2020-01-07 23:29:10,680 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_train.h5
2020-01-07 23:29:14,995 [INFO] Reading complete. time_to_read=4.32 seconds
2020-01-07 23:29:14,996 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_val.h5
2020-01-07 23:29:16,481 [INFO] Reading complete. time_to_read=1.49 seconds
2020-01-07 23:29:16,481 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_test.h5
2020-01-07 23:29:17,966 [INFO] Reading complete. time_to_read=1.48 seconds
2020-01-07 23:29:17,966 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_train.h5
2020-01-07 23:29:18,184 [INFO] Reading complete. time_to_read=0.22 seconds
2020-01-07 23:29:18,184 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_val.h5
2020-01-07 23:29:18,261 [INFO] Reading complete. time_to_read=0.08 seconds
2020-01-07 23:29:18,262 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_test.h5
2020-01-07 23:29:18,340 [INFO] Reading complete. time_to_read=0.08 seconds
2020-01-07 23:29:21,972 [INFO] Initializing model
2020-01-07 23:29:22,076 [INFO] _________________________________________________________________
2020-01-07 23:29:22,077 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-07 23:29:22,077 [INFO] =================================================================
2020-01-07 23:29:22,077 [INFO] dense_13 (Dense)             (None, 64)                4992      
2020-01-07 23:29:22,077 [INFO] _________________________________________________________________
2020-01-07 23:29:22,077 [INFO] batch_normalization_7 (Batch (None, 64)                256       
2020-01-07 23:29:22,077 [INFO] _________________________________________________________________
2020-01-07 23:29:22,077 [INFO] dropout_7 (Dropout)          (None, 64)                0         
2020-01-07 23:29:22,077 [INFO] _________________________________________________________________
2020-01-07 23:29:22,077 [INFO] dense_14 (Dense)             (None, 15)                975       
2020-01-07 23:29:22,077 [INFO] =================================================================
2020-01-07 23:29:22,077 [INFO] Total params: 6,223
2020-01-07 23:29:22,077 [INFO] Trainable params: 6,095
2020-01-07 23:29:22,077 [INFO] Non-trainable params: 128
2020-01-07 23:29:22,077 [INFO] _________________________________________________________________
2020-01-07 23:29:22,077 [INFO] Training model
2020-01-07 23:29:22,077 [INFO] Splitting train set into 2 sets (set1, set2), random_seed = 42
2020-01-07 23:29:43,164 [INFO] Split sizes (instances). total = 1936462, set1 = 580938, set2 = 1355524, set1 dataset hash = 1a7899e7c68f9a6273ec466b569a3d15e19918b2
 - val_f1: 0.9787
Epoch 00055: early stopping
Train on 1355524 samples, validate on 645487 samples
Epoch 1/100
 - 15s - loss: 0.0170 - val_loss: 0.0097
 - val_f1: 0.9751
Epoch 2/100
 - 14s - loss: 0.0090 - val_loss: 0.0087
 - val_f1: 0.9771
Epoch 3/100
 - 14s - loss: 0.0086 - val_loss: 0.0084
 - val_f1: 0.9772
Epoch 4/100
 - 14s - loss: 0.0085 - val_loss: 0.0081
 - val_f1: 0.9777
Epoch 5/100
 - 14s - loss: 0.0084 - val_loss: 0.0083
 - val_f1: 0.9779
Epoch 6/100
 - 14s - loss: 0.0083 - val_loss: 0.0081
 - val_f1: 0.9777
Epoch 7/100
 - 14s - loss: 0.0083 - val_loss: 0.0081
 - val_f1: 0.9776
Epoch 8/100
 - 14s - loss: 0.0083 - val_loss: 0.0081
 - val_f1: 0.9781
Epoch 9/100
 - 15s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9776
Epoch 10/100
 - 14s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9779
Epoch 11/100
 - 14s - loss: 0.0082 - val_loss: 0.0082
/home/sunanda/test/ml_env/lib/python3.6/site-packages/sklearn/metrics/classification.py:1143: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no predicted samples.
  'precision', 'predicted', average, warn_for)
2020-01-07 23:33:45,388 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p70/ann_model_epoch_10.pickle
 - val_f1: 0.9776
Epoch 12/100
 - 14s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9778
Epoch 13/100
 - 14s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9776
Epoch 14/100
 - 14s - loss: 0.0082 - val_loss: 0.0082
 - val_f1: 0.9775
Epoch 15/100
 - 14s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9779
Epoch 16/100
 - 14s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9783
Epoch 17/100
 - 14s - loss: 0.0082 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 18/100
 - 14s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9781
Epoch 19/100
 - 14s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9783
Epoch 20/100
 - 14s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9779
Epoch 21/100
 - 14s - loss: 0.0081 - val_loss: 0.0081
2020-01-07 23:37:29,500 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p70/ann_model_epoch_20.pickle
 - val_f1: 0.9779
Epoch 22/100
 - 14s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9785
Epoch 23/100
 - 14s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 24/100
 - 14s - loss: 0.0081 - val_loss: 0.0082
 - val_f1: 0.9777
Epoch 25/100
 - 14s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9778
Epoch 26/100
 - 14s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9783
Epoch 27/100
 - 14s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9780
Epoch 28/100
 - 14s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9783
Epoch 29/100
 - 14s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9782
Epoch 30/100
 - 14s - loss: 0.0081 - val_loss: 0.0083
 - val_f1: 0.9778
Epoch 31/100
 - 14s - loss: 0.0081 - val_loss: 0.0080
2020-01-07 23:41:14,983 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p70/ann_model_epoch_30.pickle
 - val_f1: 0.9779
Epoch 32/100
 - 14s - loss: 0.0081 - val_loss: 0.0082
 - val_f1: 0.9778
Epoch 33/100
 - 14s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9778
Epoch 34/100
 - 14s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9784
Epoch 35/100
 - 14s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9784
Epoch 36/100
 - 14s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9782
Epoch 37/100
 - 14s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9778
Epoch 38/100
 - 14s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9784
Epoch 39/100
 - 14s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9781
Epoch 40/100
 - 14s - loss: 0.0080 - val_loss: 0.0082
 - val_f1: 0.9781
Epoch 41/100
 - 14s - loss: 0.0081 - val_loss: 0.0080
2020-01-07 23:44:59,438 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p70/ann_model_epoch_40.pickle
 - val_f1: 0.9782
Epoch 42/100
 - 14s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 43/100
 - 14s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9782
Epoch 44/100
 - 14s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9780
Epoch 45/100
 - 14s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9780
Epoch 46/100
 - 14s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9785
Epoch 47/100
 - 14s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9784
Epoch 48/100
 - 14s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9784
Epoch 49/100
 - 14s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9787
Epoch 50/100
 - 14s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9784
Epoch 51/100
 - 14s - loss: 0.0080 - val_loss: 0.0081
2020-01-07 23:48:45,196 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p70/ann_model_epoch_50.pickle
 - val_f1: 0.9778
Epoch 52/100
 - 14s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9783
Epoch 53/100
 - 14s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9780
Epoch 54/100
 - 14s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9784
Epoch 55/100
 - 14s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9783
Epoch 56/100
 - 14s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9784
Epoch 57/100
 - 14s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9782
Epoch 58/100
 - 14s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9780
Epoch 59/100
 - 14s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9785
Epoch 60/100
 - 14s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9787
Epoch 61/100
 - 14s - loss: 0.0080 - val_loss: 0.0080
2020-01-07 23:52:29,309 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p70/ann_model_epoch_60.pickle
 - val_f1: 0.9780
Epoch 62/100
 - 14s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9786
Epoch 63/100
 - 14s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9780
Epoch 64/100
 - 14s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9785
Epoch 65/100
 - 14s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9781
Epoch 66/100
 - 14s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9783
Epoch 67/100
 - 14s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9779
Epoch 68/100
 - 14s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9785
Epoch 69/100
 - 14s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9783
Epoch 70/100
 - 14s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9781
Epoch 71/100
 - 14s - loss: 0.0080 - val_loss: 0.0080
2020-01-07 23:56:12,237 [INFO] epoch = 70. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p70/ann_model_epoch_70.pickle
 - val_f1: 0.9780
Epoch 72/100
 - 14s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9786
Epoch 73/100
 - 14s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9783
Epoch 74/100
 - 14s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9783
Epoch 75/100
 - 14s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9783
Epoch 76/100
 - 14s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9784
Epoch 77/100
 - 14s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9782
Epoch 78/100
 - 14s - loss: 0.0080 - val_loss: 0.0080
2020-01-07 23:58:56,694 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-07 23:59:24,717 [INFO] Last epoch loss evaluation: train_loss = 0.007883, val_loss = 0.007906
2020-01-07 23:59:24,761 [INFO] Training complete. time_to_train = 1802.68 sec, 30.04 min
2020-01-07 23:59:24,764 [INFO] Model saved to results_additional_exps/ann_data_efficiency_ids18_p70/best_model.pickle
2020-01-07 23:59:24,766 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_ids18_p70/training_error_history.csv
2020-01-07 23:59:24,945 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids18_p70/training_error_history.png
2020-01-07 23:59:25,125 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids18_p70/training_f1_history.png
2020-01-07 23:59:25,125 [INFO] Making predictions on training, validation, testing data
2020-01-08 00:00:03,062 [INFO] Evaluating predictions (results)
2020-01-08 00:00:15,018 [INFO] Dataset: Testing. Classification report below
2020-01-08 00:00:15,018 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       0.89      0.33      0.48        24
        Brute Force -XSS       1.00      0.33      0.50         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.68      0.99      0.80        67
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23010
   DoS attacks-GoldenEye       1.00      1.00      1.00      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.72      0.46      0.56      5596
   DoS attacks-Slowloris       0.99      0.76      0.86       440
          FTP-BruteForce       0.69      0.87      0.77      7718
           Infilteration       0.44      0.01      0.02      6404
           SQL Injection       1.00      0.50      0.67         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

               micro avg       0.98      0.98      0.98    645488
               macro avg       0.89      0.75      0.78    645488
            weighted avg       0.98      0.98      0.98    645488

2020-01-08 00:00:15,018 [INFO] Overall accuracy (micro avg): 0.9830066554296905
2020-01-08 00:00:28,606 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9830         0.9830                       0.9830                0.0012                   0.0170  0.9830
1     Macro avg        0.9977         0.8927                       0.7492                0.0045                   0.2508  0.7766
2  Weighted avg        0.9909         0.9779                       0.9830                0.0500                   0.0170  0.9780
/home/sunanda/test/ml_env/lib/python3.6/site-packages/sklearn/metrics/classification.py:1143: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples.
  'precision', 'predicted', average, warn_for)
2020-01-08 00:00:40,641 [INFO] Dataset: Validation. Classification report below
2020-01-08 00:00:40,641 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       0.92      0.48      0.63        25
        Brute Force -XSS       1.00      0.67      0.80         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.72      1.00      0.84        68
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23009
   DoS attacks-GoldenEye       0.99      0.99      0.99      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.73      0.45      0.56      5596
   DoS attacks-Slowloris       0.99      0.82      0.90       439
          FTP-BruteForce       0.69      0.88      0.77      7718
           Infilteration       0.41      0.01      0.02      6403
           SQL Injection       0.00      0.00      0.00         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

               micro avg       0.98      0.98      0.98    645487
               macro avg       0.83      0.75      0.77    645487
            weighted avg       0.98      0.98      0.98    645487

2020-01-08 00:00:40,641 [INFO] Overall accuracy (micro avg): 0.9830562040753725
/home/sunanda/test/ids_experiments/utility.py:328: RuntimeWarning: invalid value encountered in true_divide
  PPV = TP / (TP + FP)    # Precision or positive predictive value
/home/sunanda/test/ids_experiments/utility.py:332: RuntimeWarning: invalid value encountered in true_divide
  FDR = FP / (TP + FP)    # False discovery rate
2020-01-08 00:00:54,293 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9831         0.9831                       0.9831                0.0012                   0.0169  0.9831
1     Macro avg        0.9977         0.8285                       0.7530                0.0044                   0.2470  0.7664
2  Weighted avg        0.9909         0.9776                       0.9831                0.0498                   0.0169  0.9780
2020-01-08 00:01:33,543 [INFO] Dataset: Training. Classification report below
2020-01-08 00:01:33,543 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99   1606949
                     Bot       1.00      1.00      1.00     34396
        Brute Force -Web       0.90      0.37      0.52        73
        Brute Force -XSS       1.00      0.50      0.67        26
        DDOS attack-HOIC       1.00      1.00      1.00     82341
    DDOS attack-LOIC-UDP       0.71      0.99      0.83       203
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     69029
   DoS attacks-GoldenEye       0.99      1.00      0.99      4954
        DoS attacks-Hulk       1.00      1.00      1.00     55435
DoS attacks-SlowHTTPTest       0.72      0.46      0.56     16787
   DoS attacks-Slowloris       1.00      0.80      0.89      1318
          FTP-BruteForce       0.69      0.87      0.77     23153
           Infilteration       0.50      0.01      0.03     19210
           SQL Injection       1.00      0.25      0.40        12
          SSH-Bruteforce       1.00      1.00      1.00     22576

               micro avg       0.98      0.98      0.98   1936462
               macro avg       0.90      0.75      0.78   1936462
            weighted avg       0.98      0.98      0.98   1936462

2020-01-08 00:01:33,543 [INFO] Overall accuracy (micro avg): 0.983053630796783
2020-01-08 00:02:18,091 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9831         0.9831                       0.9831                0.0012                   0.0169  0.9831
1     Macro avg        0.9977         0.8989                       0.7492                0.0044                   0.2508  0.7758
2  Weighted avg        0.9909         0.9784                       0.9831                0.0498                   0.0169  0.9780
2020-01-08 00:02:18,150 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_ids18_p70/ann_data_efficiency_ids18_p70_results.xlsx
2020-01-08 00:02:18,155 [INFO] ================= Finished running experiment no. 7 ================= 

2020-01-08 00:02:18,236 [INFO] ================= Finished running 7 experiments ================= 

 - val_f1: 0.9782
Epoch 00078: early stopping
Using TensorFlow backend.
2020-01-07 21:08:22,509 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_ids18_p80/run_log.log
2020-01-07 21:08:22,509 [INFO] ================= Running experiment no. 8  ================= 

2020-01-07 21:08:22,509 [INFO] Experiment parameters given below
2020-01-07 21:08:22,509 [INFO] 
{'experiment_num': 8, 'results_dir': 'results_additional_exps/ann_data_efficiency_ids18_p80', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': 0.2, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/ids2018', 'description': 'ann_data_efficiency_ids18_p80'}
2020-01-07 21:08:22,509 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_ids18_p80/tf_logs_run_2020_01_07-21_08_22
2020-01-07 21:08:22,509 [INFO] Loading datsets from: ../Datasets/small_datasets/ids2018
2020-01-07 21:08:22,510 [INFO] Reading X, y files
2020-01-07 21:08:22,510 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_train.h5
2020-01-07 21:08:26,988 [INFO] Reading complete. time_to_read=4.48 seconds
2020-01-07 21:08:26,988 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_val.h5
2020-01-07 21:08:28,522 [INFO] Reading complete. time_to_read=1.53 seconds
2020-01-07 21:08:28,522 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_test.h5
2020-01-07 21:08:30,050 [INFO] Reading complete. time_to_read=1.53 seconds
2020-01-07 21:08:30,050 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_train.h5
2020-01-07 21:08:30,337 [INFO] Reading complete. time_to_read=0.29 seconds
2020-01-07 21:08:30,337 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_val.h5
2020-01-07 21:08:30,421 [INFO] Reading complete. time_to_read=0.08 seconds
2020-01-07 21:08:30,421 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_test.h5
2020-01-07 21:08:30,505 [INFO] Reading complete. time_to_read=0.08 seconds
2020-01-07 21:08:34,490 [INFO] Initializing model
2020-01-07 21:08:34,491 [WARNING] From /home/hasitha/anaconda3/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:74: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

2020-01-07 21:08:34,500 [WARNING] From /home/hasitha/anaconda3/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:517: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

2020-01-07 21:08:34,502 [WARNING] From /home/hasitha/anaconda3/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:4138: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

2020-01-07 21:08:34,560 [WARNING] From /home/hasitha/anaconda3/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:133: The name tf.placeholder_with_default is deprecated. Please use tf.compat.v1.placeholder_with_default instead.

2020-01-07 21:08:34,575 [WARNING] From /home/hasitha/anaconda3/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
2020-01-07 21:08:34,593 [WARNING] From /home/hasitha/anaconda3/lib/python3.7/site-packages/keras/optimizers.py:790: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

2020-01-07 21:08:34,607 [WARNING] From /home/hasitha/anaconda3/lib/python3.7/site-packages/keras/backend/tensorflow_backend.py:3376: The name tf.log is deprecated. Please use tf.math.log instead.

2020-01-07 21:08:34,610 [WARNING] From /home/hasitha/anaconda3/lib/python3.7/site-packages/tensorflow/python/ops/nn_impl.py:180: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
2020-01-07 21:08:34,620 [INFO] _________________________________________________________________
2020-01-07 21:08:34,620 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-07 21:08:34,620 [INFO] =================================================================
2020-01-07 21:08:34,620 [INFO] dense_1 (Dense)              (None, 64)                4992      
2020-01-07 21:08:34,620 [INFO] _________________________________________________________________
2020-01-07 21:08:34,620 [INFO] batch_normalization_1 (Batch (None, 64)                256       
2020-01-07 21:08:34,620 [INFO] _________________________________________________________________
2020-01-07 21:08:34,620 [INFO] dropout_1 (Dropout)          (None, 64)                0         
2020-01-07 21:08:34,621 [INFO] _________________________________________________________________
2020-01-07 21:08:34,621 [INFO] dense_2 (Dense)              (None, 15)                975       
2020-01-07 21:08:34,621 [INFO] =================================================================
2020-01-07 21:08:34,621 [INFO] Total params: 6,223
2020-01-07 21:08:34,621 [INFO] Trainable params: 6,095
2020-01-07 21:08:34,621 [INFO] Non-trainable params: 128
2020-01-07 21:08:34,621 [INFO] _________________________________________________________________
2020-01-07 21:08:34,621 [INFO] Training model
2020-01-07 21:08:34,621 [INFO] Splitting train set into 2 sets (set1, set2), random_seed = 42
2020-01-07 21:08:57,337 [INFO] Split sizes (instances). total = 1936462, set1 = 387292, set2 = 1549170, set1 dataset hash = 65c7775eb40b23319a5318035034298446afff70
2020-01-07 21:08:58.078781: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-01-07 21:08:58.100948: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2893425000 Hz
2020-01-07 21:08:58.101177: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5613082ac8e0 executing computations on platform Host. Devices:
2020-01-07 21:08:58.101201: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <undefined>
2020-01-07 21:08:58.204506: W tensorflow/compiler/jit/mark_for_compilation_pass.cc:1412] (One-time warning): Not using XLA:CPU for cluster because envvar TF_XLA_FLAGS=--tf_xla_cpu_global_jit was not set.  If you want XLA:CPU, either set that envvar, or use experimental_jit_scope to enable XLA:CPU.  To confirm that XLA is active, pass --vmodule=xla_compilation_cache=1 (as a proper command-line flag, not via TF_XLA_FLAGS) or set the envvar XLA_FLAGS=--xla_hlo_profile.
2020-01-07 21:08:58,208 [WARNING] From /home/hasitha/anaconda3/lib/python3.7/site-packages/keras/callbacks.py:850: The name tf.summary.merge_all is deprecated. Please use tf.compat.v1.summary.merge_all instead.

2020-01-07 21:08:58,208 [WARNING] From /home/hasitha/anaconda3/lib/python3.7/site-packages/keras/callbacks.py:853: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

Train on 1549170 samples, validate on 645487 samples
Epoch 1/100
 - 17s - loss: 0.0165 - val_loss: 0.0088
 - val_f1: 0.9770
Epoch 2/100
 - 18s - loss: 0.0089 - val_loss: 0.0085
 - val_f1: 0.9776
Epoch 3/100
 - 18s - loss: 0.0086 - val_loss: 0.0084
 - val_f1: 0.9769
Epoch 4/100
 - 18s - loss: 0.0085 - val_loss: 0.0082
 - val_f1: 0.9775
Epoch 5/100
 - 18s - loss: 0.0084 - val_loss: 0.0082
 - val_f1: 0.9776
Epoch 6/100
 - 18s - loss: 0.0083 - val_loss: 0.0084
 - val_f1: 0.9757
Epoch 7/100
 - 18s - loss: 0.0083 - val_loss: 0.0081
 - val_f1: 0.9763
Epoch 8/100
 - 18s - loss: 0.0083 - val_loss: 0.0080
 - val_f1: 0.9780
Epoch 9/100
 - 18s - loss: 0.0083 - val_loss: 0.0080
 - val_f1: 0.9781
Epoch 10/100
 - 18s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9779
Epoch 11/100
 - 18s - loss: 0.0082 - val_loss: 0.0081
/home/hasitha/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:1143: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no predicted samples.
  'precision', 'predicted', average, warn_for)
2020-01-07 21:13:37,649 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p80/ann_model_epoch_10.pickle
 - val_f1: 0.9782
Epoch 12/100
 - 18s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9779
Epoch 13/100
 - 19s - loss: 0.0082 - val_loss: 0.0080
 - val_f1: 0.9765
Epoch 14/100
 - 18s - loss: 0.0082 - val_loss: 0.0080
 - val_f1: 0.9783
Epoch 15/100
 - 18s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9781
Epoch 16/100
 - 19s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9781
Epoch 17/100
 - 19s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9781
Epoch 18/100
 - 18s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9786
Epoch 19/100
 - 19s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 20/100
 - 19s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9780
Epoch 21/100
 - 19s - loss: 0.0081 - val_loss: 0.0080
2020-01-07 21:18:04,177 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p80/ann_model_epoch_20.pickle
 - val_f1: 0.9765
Epoch 22/100
 - 19s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9782
Epoch 23/100
 - 19s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9783
Epoch 24/100
 - 19s - loss: 0.0081 - val_loss: 0.0082
 - val_f1: 0.9780
Epoch 25/100
 - 18s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9782
Epoch 26/100
 - 19s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9782
Epoch 27/100
 - 19s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9780
Epoch 28/100
 - 19s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9781
Epoch 29/100
 - 19s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9766
Epoch 30/100
 - 19s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9780
Epoch 31/100
 - 18s - loss: 0.0081 - val_loss: 0.0079
2020-01-07 21:22:31,342 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p80/ann_model_epoch_30.pickle
 - val_f1: 0.9787
Epoch 32/100
 - 19s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9786
Epoch 33/100
 - 19s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9779
Epoch 34/100
 - 19s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 35/100
 - 19s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9784
Epoch 36/100
 - 19s - loss: 0.0080 - val_loss: 0.0079
2020-01-07 21:24:52,989 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-07 21:25:26,383 [INFO] Last epoch loss evaluation: train_loss = 0.007872, val_loss = 0.007877
2020-01-07 21:25:26,419 [INFO] Training complete. time_to_train = 1011.80 sec, 16.86 min
2020-01-07 21:25:26,422 [INFO] Model saved to results_additional_exps/ann_data_efficiency_ids18_p80/best_model.pickle
2020-01-07 21:25:26,424 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_ids18_p80/training_error_history.csv
2020-01-07 21:25:26,565 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids18_p80/training_error_history.png
2020-01-07 21:25:26,692 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids18_p80/training_f1_history.png
2020-01-07 21:25:26,693 [INFO] Making predictions on training, validation, testing data
2020-01-07 21:26:04,182 [INFO] Evaluating predictions (results)
/home/hasitha/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:1143: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples.
  'precision', 'predicted', average, warn_for)
2020-01-07 21:26:16,370 [INFO] Dataset: Testing. Classification report below
2020-01-07 21:26:16,370 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       1.00      0.12      0.22        24
        Brute Force -XSS       1.00      0.33      0.50         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.74      0.96      0.83        67
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23010
   DoS attacks-GoldenEye       0.98      1.00      0.99      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.72      0.46      0.56      5596
   DoS attacks-Slowloris       0.86      0.97      0.91       440
          FTP-BruteForce       0.69      0.87      0.77      7718
           Infilteration       0.46      0.01      0.03      6404
           SQL Injection       0.00      0.00      0.00         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

               micro avg       0.98      0.98      0.98    645488
               macro avg       0.83      0.71      0.72    645488
            weighted avg       0.98      0.98      0.98    645488

2020-01-07 21:26:16,370 [INFO] Overall accuracy (micro avg): 0.9830051062142131
/home/hasitha/sunanda/ids_experiments/utility.py:328: RuntimeWarning: invalid value encountered in true_divide
  PPV = TP / (TP + FP)    # Precision or positive predictive value
/home/hasitha/sunanda/ids_experiments/utility.py:332: RuntimeWarning: invalid value encountered in true_divide
  FDR = FP / (TP + FP)    # False discovery rate
2020-01-07 21:26:30,226 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9830         0.9830                       0.9830                0.0012                   0.0170  0.9830
1     Macro avg        0.9977         0.8286                       0.7146                0.0044                   0.2854  0.7200
2  Weighted avg        0.9909         0.9780                       0.9830                0.0490                   0.0170  0.9780
2020-01-07 21:26:42,335 [INFO] Dataset: Validation. Classification report below
2020-01-07 21:26:42,335 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       1.00      0.20      0.33        25
        Brute Force -XSS       1.00      0.67      0.80         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.74      0.96      0.83        68
  DDoS attacks-LOIC-HTTP       0.99      1.00      0.99     23009
   DoS attacks-GoldenEye       0.99      1.00      0.99      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.73      0.45      0.56      5596
   DoS attacks-Slowloris       0.87      0.97      0.92       439
          FTP-BruteForce       0.69      0.88      0.77      7718
           Infilteration       0.45      0.01      0.03      6403
           SQL Injection       0.00      0.00      0.00         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

               micro avg       0.98      0.98      0.98    645487
               macro avg       0.83      0.74      0.75    645487
            weighted avg       0.98      0.98      0.98    645487

2020-01-07 21:26:42,335 [INFO] Overall accuracy (micro avg): 0.9830469087681084
2020-01-07 21:26:56,103 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9830         0.9830                       0.9830                0.0012                   0.0170  0.9830
1     Macro avg        0.9977         0.8295                       0.7419                0.0044                   0.2581  0.7482
2  Weighted avg        0.9909         0.9780                       0.9830                0.0489                   0.0170  0.9780
2020-01-07 21:27:35,659 [INFO] Dataset: Training. Classification report below
2020-01-07 21:27:35,660 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99   1606949
                     Bot       1.00      1.00      1.00     34396
        Brute Force -Web       0.90      0.12      0.22        73
        Brute Force -XSS       1.00      0.46      0.63        26
        DDOS attack-HOIC       1.00      1.00      1.00     82341
    DDOS attack-LOIC-UDP       0.75      0.96      0.84       203
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     69029
   DoS attacks-GoldenEye       0.99      1.00      0.99      4954
        DoS attacks-Hulk       1.00      1.00      1.00     55435
DoS attacks-SlowHTTPTest       0.72      0.46      0.56     16787
   DoS attacks-Slowloris       0.89      0.99      0.94      1318
          FTP-BruteForce       0.69      0.87      0.77     23153
           Infilteration       0.50      0.02      0.03     19210
           SQL Injection       0.00      0.00      0.00        12
          SSH-Bruteforce       1.00      1.00      1.00     22576

               micro avg       0.98      0.98      0.98   1936462
               macro avg       0.83      0.72      0.73   1936462
            weighted avg       0.98      0.98      0.98   1936462

2020-01-07 21:27:35,660 [INFO] Overall accuracy (micro avg): 0.9830737706187883
2020-01-07 21:28:20,598 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9831         0.9831                       0.9831                0.0012                   0.0169  0.9831
1     Macro avg        0.9977         0.8279                       0.7246                0.0044                   0.2754  0.7309
2  Weighted avg        0.9909         0.9785                       0.9831                0.0489                   0.0169  0.9781
2020-01-07 21:28:20,624 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_ids18_p80/ann_data_efficiency_ids18_p80_results.xlsx
2020-01-07 21:28:20,632 [INFO] ================= Finished running experiment no. 8 ================= 

2020-01-07 21:28:20,709 [INFO] Created directory: results_additional_exps/ann_data_efficiency_ids18_p90
2020-01-07 21:28:20,710 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_ids18_p90/run_log.log
2020-01-07 21:28:20,710 [INFO] ================= Running experiment no. 9  ================= 

2020-01-07 21:28:20,710 [INFO] Experiment parameters given below
2020-01-07 21:28:20,710 [INFO] 
{'experiment_num': 9, 'results_dir': 'results_additional_exps/ann_data_efficiency_ids18_p90', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': 0.1, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/ids2018', 'description': 'ann_data_efficiency_ids18_p90'}
2020-01-07 21:28:20,710 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_ids18_p90/tf_logs_run_2020_01_07-21_28_20
2020-01-07 21:28:20,710 [INFO] Loading datsets from: ../Datasets/small_datasets/ids2018
2020-01-07 21:28:20,710 [INFO] Reading X, y files
2020-01-07 21:28:20,710 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_train.h5
2020-01-07 21:28:25,156 [INFO] Reading complete. time_to_read=4.45 seconds
2020-01-07 21:28:25,156 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_val.h5
2020-01-07 21:28:26,683 [INFO] Reading complete. time_to_read=1.53 seconds
2020-01-07 21:28:26,683 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_test.h5
2020-01-07 21:28:28,209 [INFO] Reading complete. time_to_read=1.53 seconds
2020-01-07 21:28:28,209 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_train.h5
2020-01-07 21:28:28,473 [INFO] Reading complete. time_to_read=0.26 seconds
2020-01-07 21:28:28,473 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_val.h5
2020-01-07 21:28:28,557 [INFO] Reading complete. time_to_read=0.08 seconds
2020-01-07 21:28:28,557 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_test.h5
2020-01-07 21:28:28,641 [INFO] Reading complete. time_to_read=0.08 seconds
2020-01-07 21:28:32,504 [INFO] Initializing model
2020-01-07 21:28:32,620 [INFO] _________________________________________________________________
2020-01-07 21:28:32,621 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-07 21:28:32,621 [INFO] =================================================================
2020-01-07 21:28:32,621 [INFO] dense_3 (Dense)              (None, 64)                4992      
2020-01-07 21:28:32,621 [INFO] _________________________________________________________________
2020-01-07 21:28:32,621 [INFO] batch_normalization_2 (Batch (None, 64)                256       
2020-01-07 21:28:32,621 [INFO] _________________________________________________________________
2020-01-07 21:28:32,621 [INFO] dropout_2 (Dropout)          (None, 64)                0         
2020-01-07 21:28:32,621 [INFO] _________________________________________________________________
2020-01-07 21:28:32,621 [INFO] dense_4 (Dense)              (None, 15)                975       
2020-01-07 21:28:32,621 [INFO] =================================================================
2020-01-07 21:28:32,621 [INFO] Total params: 6,223
2020-01-07 21:28:32,621 [INFO] Trainable params: 6,095
2020-01-07 21:28:32,621 [INFO] Non-trainable params: 128
2020-01-07 21:28:32,621 [INFO] _________________________________________________________________
2020-01-07 21:28:32,621 [INFO] Training model
2020-01-07 21:28:32,622 [INFO] Splitting train set into 2 sets (set1, set2), random_seed = 42
2020-01-07 21:28:55,033 [INFO] Split sizes (instances). total = 1936462, set1 = 193646, set2 = 1742816, set1 dataset hash = d4d6cbaa92d4f8f60abd009428187e6709267974
 - val_f1: 0.9781
Epoch 00036: early stopping
Train on 1742816 samples, validate on 645487 samples
Epoch 1/100
 - 20s - loss: 0.0152 - val_loss: 0.0086
 - val_f1: 0.9771
Epoch 2/100
 - 20s - loss: 0.0088 - val_loss: 0.0084
 - val_f1: 0.9772
Epoch 3/100
 - 21s - loss: 0.0085 - val_loss: 0.0085
 - val_f1: 0.9776
Epoch 4/100
 - 21s - loss: 0.0084 - val_loss: 0.0083
 - val_f1: 0.9777
Epoch 5/100
 - 21s - loss: 0.0084 - val_loss: 0.0082
 - val_f1: 0.9782
Epoch 6/100
 - 21s - loss: 0.0083 - val_loss: 0.0081
 - val_f1: 0.9778
Epoch 7/100
 - 21s - loss: 0.0083 - val_loss: 0.0082
 - val_f1: 0.9777
Epoch 8/100
 - 21s - loss: 0.0083 - val_loss: 0.0082
 - val_f1: 0.9778
Epoch 9/100
 - 21s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9777
Epoch 10/100
 - 21s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9778
Epoch 11/100
 - 21s - loss: 0.0082 - val_loss: 0.0083
/home/hasitha/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:1143: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no predicted samples.
  'precision', 'predicted', average, warn_for)
2020-01-07 21:34:08,622 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p90/ann_model_epoch_10.pickle
 - val_f1: 0.9775
Epoch 12/100
 - 21s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9779
Epoch 13/100
 - 21s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9783
Epoch 14/100
 - 21s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9754
Epoch 15/100
 - 21s - loss: 0.0081 - val_loss: 0.0082
 - val_f1: 0.9782
Epoch 16/100
 - 21s - loss: 0.0081 - val_loss: 0.0087
 - val_f1: 0.9768
Epoch 17/100
 - 21s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9784
Epoch 18/100
 - 21s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9783
Epoch 19/100
 - 21s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9776
Epoch 20/100
 - 21s - loss: 0.0081 - val_loss: 0.0082
 - val_f1: 0.9778
Epoch 21/100
 - 21s - loss: 0.0081 - val_loss: 0.0080
2020-01-07 21:39:02,611 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p90/ann_model_epoch_20.pickle
 - val_f1: 0.9781
Epoch 22/100
 - 21s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9784
Epoch 23/100
 - 21s - loss: 0.0081 - val_loss: 0.0085
 - val_f1: 0.9770
Epoch 24/100
 - 21s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9782
Epoch 25/100
 - 21s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9783
Epoch 26/100
 - 21s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9778
Epoch 27/100
 - 21s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9786
Epoch 28/100
 - 21s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9783
Epoch 29/100
 - 21s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 30/100
 - 21s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9784
Epoch 31/100
 - 21s - loss: 0.0080 - val_loss: 0.0080
2020-01-07 21:43:56,637 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p90/ann_model_epoch_30.pickle
 - val_f1: 0.9778
Epoch 32/100
 - 21s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9778
Epoch 33/100
 - 21s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9781
Epoch 34/100
 - 21s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9785
Epoch 35/100
 - 21s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9776
Epoch 36/100
 - 21s - loss: 0.0080 - val_loss: 0.0085
 - val_f1: 0.9777
Epoch 37/100
 - 21s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9777
Epoch 38/100
 - 21s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9786
Epoch 39/100
 - 21s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9782
Epoch 40/100
 - 21s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9781
Epoch 41/100
 - 21s - loss: 0.0080 - val_loss: 0.0080
2020-01-07 21:48:50,173 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p90/ann_model_epoch_40.pickle
 - val_f1: 0.9782
Epoch 42/100
 - 21s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9763
Epoch 43/100
 - 21s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9783
Epoch 44/100
 - 21s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9781
Epoch 45/100
 - 21s - loss: 0.0080 - val_loss: 0.0080
2020-01-07 21:50:56,234 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-07 21:51:34,890 [INFO] Last epoch loss evaluation: train_loss = 0.007900, val_loss = 0.007911
2020-01-07 21:51:34,930 [INFO] Training complete. time_to_train = 1382.31 sec, 23.04 min
2020-01-07 21:51:34,933 [INFO] Model saved to results_additional_exps/ann_data_efficiency_ids18_p90/best_model.pickle
2020-01-07 21:51:34,934 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_ids18_p90/training_error_history.csv
2020-01-07 21:51:35,067 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids18_p90/training_error_history.png
2020-01-07 21:51:35,190 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids18_p90/training_f1_history.png
2020-01-07 21:51:35,190 [INFO] Making predictions on training, validation, testing data
2020-01-07 21:52:15,407 [INFO] Evaluating predictions (results)
/home/hasitha/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:1143: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples.
  'precision', 'predicted', average, warn_for)
2020-01-07 21:52:27,544 [INFO] Dataset: Testing. Classification report below
2020-01-07 21:52:27,544 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       1.00      0.12      0.22        24
        Brute Force -XSS       1.00      0.33      0.50         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.69      0.99      0.81        67
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23010
   DoS attacks-GoldenEye       0.99      1.00      0.99      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.73      0.50      0.59      5596
   DoS attacks-Slowloris       0.88      0.97      0.92       440
          FTP-BruteForce       0.71      0.87      0.78      7718
           Infilteration       0.43      0.01      0.02      6404
           SQL Injection       0.00      0.00      0.00         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

               micro avg       0.98      0.98      0.98    645488
               macro avg       0.83      0.72      0.72    645488
            weighted avg       0.98      0.98      0.98    645488

2020-01-07 21:52:27,544 [INFO] Overall accuracy (micro avg): 0.9832777681382148
/home/hasitha/sunanda/ids_experiments/utility.py:328: RuntimeWarning: invalid value encountered in true_divide
  PPV = TP / (TP + FP)    # Precision or positive predictive value
/home/hasitha/sunanda/ids_experiments/utility.py:332: RuntimeWarning: invalid value encountered in true_divide
  FDR = FP / (TP + FP)    # False discovery rate
2020-01-07 21:52:41,340 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9833         0.9833                       0.9833                0.0012                   0.0167  0.9833
1     Macro avg        0.9978         0.8276                       0.7181                0.0045                   0.2819  0.7218
2  Weighted avg        0.9908         0.9780                       0.9833                0.0502                   0.0167  0.9783
2020-01-07 21:52:53,490 [INFO] Dataset: Validation. Classification report below
2020-01-07 21:52:53,490 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       1.00      0.16      0.28        25
        Brute Force -XSS       1.00      0.67      0.80         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.70      0.99      0.82        68
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23009
   DoS attacks-GoldenEye       0.99      0.99      0.99      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.74      0.49      0.59      5596
   DoS attacks-Slowloris       0.89      0.97      0.93       439
          FTP-BruteForce       0.70      0.87      0.78      7718
           Infilteration       0.42      0.01      0.02      6403
           SQL Injection       0.00      0.00      0.00         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

               micro avg       0.98      0.98      0.98    645487
               macro avg       0.83      0.74      0.75    645487
            weighted avg       0.98      0.98      0.98    645487

2020-01-07 21:52:53,490 [INFO] Overall accuracy (micro avg): 0.983307177371504
2020-01-07 21:53:07,300 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9833         0.9833                       0.9833                0.0012                   0.0167  0.9833
1     Macro avg        0.9978         0.8283                       0.7427                0.0045                   0.2573  0.7460
2  Weighted avg        0.9909         0.9779                       0.9833                0.0501                   0.0167  0.9783
2020-01-07 21:53:46,842 [INFO] Dataset: Training. Classification report below
2020-01-07 21:53:46,842 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99   1606949
                     Bot       1.00      1.00      1.00     34396
        Brute Force -Web       1.00      0.12      0.22        73
        Brute Force -XSS       1.00      0.50      0.67        26
        DDOS attack-HOIC       1.00      1.00      1.00     82341
    DDOS attack-LOIC-UDP       0.70      0.99      0.82       203
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     69029
   DoS attacks-GoldenEye       0.99      1.00      0.99      4954
        DoS attacks-Hulk       1.00      1.00      1.00     55435
DoS attacks-SlowHTTPTest       0.73      0.49      0.59     16787
   DoS attacks-Slowloris       0.91      0.99      0.95      1318
          FTP-BruteForce       0.70      0.87      0.78     23153
           Infilteration       0.46      0.01      0.02     19210
           SQL Injection       0.00      0.00      0.00        12
          SSH-Bruteforce       1.00      1.00      1.00     22576

               micro avg       0.98      0.98      0.98   1936462
               macro avg       0.83      0.73      0.73   1936462
            weighted avg       0.98      0.98      0.98   1936462

2020-01-07 21:53:46,842 [INFO] Overall accuracy (micro avg): 0.9832911774153069
2020-01-07 21:54:31,762 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9833         0.9833                       0.9833                0.0012                   0.0167  0.9833
1     Macro avg        0.9978         0.8323                       0.7301                0.0044                   0.2699  0.7346
2  Weighted avg        0.9909         0.9783                       0.9833                0.0500                   0.0167  0.9783
2020-01-07 21:54:31,802 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_ids18_p90/ann_data_efficiency_ids18_p90_results.xlsx
2020-01-07 21:54:31,807 [INFO] ================= Finished running experiment no. 9 ================= 

2020-01-07 21:54:31,887 [INFO] Created directory: results_additional_exps/ann_data_efficiency_ids18_p100
2020-01-07 21:54:31,887 [INFO] Initialized logging. log_filename = results_additional_exps/ann_data_efficiency_ids18_p100/run_log.log
2020-01-07 21:54:31,887 [INFO] ================= Running experiment no. 10  ================= 

2020-01-07 21:54:31,887 [INFO] Experiment parameters given below
2020-01-07 21:54:31,887 [INFO] 
{'experiment_num': 10, 'results_dir': 'results_additional_exps/ann_data_efficiency_ids18_p100', 'model_type': 'classifier', 'model': 'ann', 'normal_label': 'BENIGN', 'training_data_feed': 'preload', 'split_random_seed': 42, 'dataset_split_ratio': -1, 'ann_layer_units': [64], 'ann_layer_activations': ['relu'], 'ann_layer_dropout_rates': [0.2], 'epochs': 100, 'early_stop_patience': 20, 'batch_size': 256, 'training_set': 'train_set_only', 'dataset_dir': '../Datasets/small_datasets/ids2018', 'description': 'ann_data_efficiency_ids18_p100'}
2020-01-07 21:54:31,887 [INFO] Created tensorboard log directory: results_additional_exps/ann_data_efficiency_ids18_p100/tf_logs_run_2020_01_07-21_54_31
2020-01-07 21:54:31,887 [INFO] Loading datsets from: ../Datasets/small_datasets/ids2018
2020-01-07 21:54:31,887 [INFO] Reading X, y files
2020-01-07 21:54:31,888 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_train.h5
2020-01-07 21:54:36,334 [INFO] Reading complete. time_to_read=4.45 seconds
2020-01-07 21:54:36,334 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_val.h5
2020-01-07 21:54:37,858 [INFO] Reading complete. time_to_read=1.52 seconds
2020-01-07 21:54:37,858 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/X_test.h5
2020-01-07 21:54:39,387 [INFO] Reading complete. time_to_read=1.53 seconds
2020-01-07 21:54:39,387 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_train.h5
2020-01-07 21:54:39,644 [INFO] Reading complete. time_to_read=0.26 seconds
2020-01-07 21:54:39,644 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_val.h5
2020-01-07 21:54:39,728 [INFO] Reading complete. time_to_read=0.08 seconds
2020-01-07 21:54:39,728 [INFO] Reading HDF dataset ../Datasets/small_datasets/ids2018/y_test.h5
2020-01-07 21:54:39,813 [INFO] Reading complete. time_to_read=0.09 seconds
2020-01-07 21:54:43,700 [INFO] Initializing model
2020-01-07 21:54:43,816 [INFO] _________________________________________________________________
2020-01-07 21:54:43,817 [INFO] Layer (type)                 Output Shape              Param #   
2020-01-07 21:54:43,817 [INFO] =================================================================
2020-01-07 21:54:43,817 [INFO] dense_5 (Dense)              (None, 64)                4992      
2020-01-07 21:54:43,817 [INFO] _________________________________________________________________
2020-01-07 21:54:43,817 [INFO] batch_normalization_3 (Batch (None, 64)                256       
2020-01-07 21:54:43,817 [INFO] _________________________________________________________________
2020-01-07 21:54:43,817 [INFO] dropout_3 (Dropout)          (None, 64)                0         
2020-01-07 21:54:43,817 [INFO] _________________________________________________________________
2020-01-07 21:54:43,817 [INFO] dense_6 (Dense)              (None, 15)                975       
2020-01-07 21:54:43,817 [INFO] =================================================================
2020-01-07 21:54:43,817 [INFO] Total params: 6,223
2020-01-07 21:54:43,817 [INFO] Trainable params: 6,095
2020-01-07 21:54:43,817 [INFO] Non-trainable params: 128
2020-01-07 21:54:43,817 [INFO] _________________________________________________________________
2020-01-07 21:54:43,817 [INFO] Training model
 - val_f1: 0.9780
Epoch 00045: early stopping
Train on 1936462 samples, validate on 645487 samples
Epoch 1/100
 - 22s - loss: 0.0148 - val_loss: 0.0088
 - val_f1: 0.9771
Epoch 2/100
 - 22s - loss: 0.0087 - val_loss: 0.0085
 - val_f1: 0.9758
Epoch 3/100
 - 22s - loss: 0.0085 - val_loss: 0.0509
 - val_f1: 0.8124
Epoch 4/100
 - 22s - loss: 0.0084 - val_loss: 0.0142
 - val_f1: 0.9480
Epoch 5/100
 - 22s - loss: 0.0083 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 6/100
 - 22s - loss: 0.0083 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 7/100
 - 23s - loss: 0.0083 - val_loss: 0.0080
 - val_f1: 0.9780
Epoch 8/100
 - 23s - loss: 0.0083 - val_loss: 0.0080
 - val_f1: 0.9778
Epoch 9/100
 - 23s - loss: 0.0082 - val_loss: 0.0081
 - val_f1: 0.9785
Epoch 10/100
 - 23s - loss: 0.0082 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 11/100
 - 23s - loss: 0.0082 - val_loss: 0.0082
/home/hasitha/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:1143: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no predicted samples.
  'precision', 'predicted', average, warn_for)
2020-01-07 22:00:24,596 [INFO] epoch = 10. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p100/ann_model_epoch_10.pickle
 - val_f1: 0.9781
Epoch 12/100
 - 23s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9779
Epoch 13/100
 - 23s - loss: 0.0081 - val_loss: 0.0082
 - val_f1: 0.9777
Epoch 14/100
 - 23s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9781
Epoch 15/100
 - 23s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9778
Epoch 16/100
 - 23s - loss: 0.0081 - val_loss: 0.0080
 - val_f1: 0.9777
Epoch 17/100
 - 23s - loss: 0.0081 - val_loss: 0.0100
 - val_f1: 0.9744
Epoch 18/100
 - 23s - loss: 0.0081 - val_loss: 0.0081
 - val_f1: 0.9777
Epoch 19/100
 - 23s - loss: 0.0081 - val_loss: 0.0082
 - val_f1: 0.9777
Epoch 20/100
 - 23s - loss: 0.0081 - val_loss: 0.0082
 - val_f1: 0.9774
Epoch 21/100
 - 23s - loss: 0.0081 - val_loss: 0.0084
2020-01-07 22:05:47,487 [INFO] epoch = 20. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p100/ann_model_epoch_20.pickle
 - val_f1: 0.9773
Epoch 22/100
 - 23s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9784
Epoch 23/100
 - 23s - loss: 0.0081 - val_loss: 0.0123
 - val_f1: 0.9656
Epoch 24/100
 - 23s - loss: 0.0081 - val_loss: 0.0110
 - val_f1: 0.9709
Epoch 25/100
 - 23s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9781
Epoch 26/100
 - 23s - loss: 0.0081 - val_loss: 0.0079
 - val_f1: 0.9783
Epoch 27/100
 - 23s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9783
Epoch 28/100
 - 23s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9784
Epoch 29/100
 - 23s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9780
Epoch 30/100
 - 23s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9781
Epoch 31/100
 - 23s - loss: 0.0080 - val_loss: 0.0081
2020-01-07 22:11:10,227 [INFO] epoch = 30. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p100/ann_model_epoch_30.pickle
 - val_f1: 0.9779
Epoch 32/100
 - 23s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9780
Epoch 33/100
 - 23s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9778
Epoch 34/100
 - 23s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9781
Epoch 35/100
 - 23s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9781
Epoch 36/100
 - 23s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9781
Epoch 37/100
 - 23s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9779
Epoch 38/100
 - 23s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9785
Epoch 39/100
 - 23s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9782
Epoch 40/100
 - 23s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9780
Epoch 41/100
 - 23s - loss: 0.0080 - val_loss: 0.0080
2020-01-07 22:16:34,695 [INFO] epoch = 40. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p100/ann_model_epoch_40.pickle
 - val_f1: 0.9781
Epoch 42/100
 - 23s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9780
Epoch 43/100
 - 23s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9781
Epoch 44/100
 - 23s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9788
Epoch 45/100
 - 23s - loss: 0.0080 - val_loss: 0.0078
 - val_f1: 0.9788
Epoch 46/100
 - 23s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9776
Epoch 47/100
 - 23s - loss: 0.0080 - val_loss: 0.0081
 - val_f1: 0.9777
Epoch 48/100
 - 23s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9781
Epoch 49/100
 - 23s - loss: 0.0080 - val_loss: 0.0080
 - val_f1: 0.9787
Epoch 50/100
 - 23s - loss: 0.0080 - val_loss: 0.0262
 - val_f1: 0.8960
Epoch 51/100
 - 23s - loss: 0.0080 - val_loss: 0.0079
2020-01-07 22:21:59,929 [INFO] epoch = 50. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p100/ann_model_epoch_50.pickle
 - val_f1: 0.9782
Epoch 52/100
 - 23s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9779
Epoch 53/100
 - 23s - loss: 0.0080 - val_loss: 0.0078
 - val_f1: 0.9787
Epoch 54/100
 - 23s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9780
Epoch 55/100
 - 23s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9787
Epoch 56/100
 - 23s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9788
Epoch 57/100
 - 23s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9782
Epoch 58/100
 - 24s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9781
Epoch 59/100
 - 23s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9784
Epoch 60/100
 - 23s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9780
Epoch 61/100
 - 23s - loss: 0.0080 - val_loss: 0.0079
2020-01-07 22:27:25,534 [INFO] epoch = 60. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p100/ann_model_epoch_60.pickle
 - val_f1: 0.9785
Epoch 62/100
 - 23s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9787
Epoch 63/100
 - 24s - loss: 0.0080 - val_loss: 0.0149
 - val_f1: 0.9480
Epoch 64/100
 - 23s - loss: 0.0079 - val_loss: 0.0080
 - val_f1: 0.9796
Epoch 65/100
 - 23s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9780
Epoch 66/100
 - 23s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9784
Epoch 67/100
 - 23s - loss: 0.0079 - val_loss: 0.0078
 - val_f1: 0.9783
Epoch 68/100
 - 23s - loss: 0.0080 - val_loss: 0.0079
 - val_f1: 0.9783
Epoch 69/100
 - 23s - loss: 0.0079 - val_loss: 0.0078
 - val_f1: 0.9791
Epoch 70/100
 - 23s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9789
Epoch 71/100
 - 23s - loss: 0.0079 - val_loss: 0.0078
2020-01-07 22:32:51,534 [INFO] epoch = 70. Intermediate model saved to results_additional_exps/ann_data_efficiency_ids18_p100/ann_model_epoch_70.pickle
 - val_f1: 0.9781
Epoch 72/100
 - 23s - loss: 0.0079 - val_loss: 0.0079
 - val_f1: 0.9781
Epoch 73/100
 - 23s - loss: 0.0079 - val_loss: 0.0079
2020-01-07 22:34:05,623 [INFO] WeightRestorer::on_train_end(): restoring best weights
2020-01-07 22:34:52,092 [INFO] Last epoch loss evaluation: train_loss = 0.007798, val_loss = 0.007823
2020-01-07 22:34:52,092 [INFO] Training complete. time_to_train = 2408.27 sec, 40.14 min
2020-01-07 22:34:52,097 [INFO] Model saved to results_additional_exps/ann_data_efficiency_ids18_p100/best_model.pickle
2020-01-07 22:34:52,100 [INFO] Training history saved to: results_additional_exps/ann_data_efficiency_ids18_p100/training_error_history.csv
2020-01-07 22:34:52,237 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids18_p100/training_error_history.png
2020-01-07 22:34:52,366 [INFO] Plot saved to: results_additional_exps/ann_data_efficiency_ids18_p100/training_f1_history.png
2020-01-07 22:34:52,366 [INFO] Making predictions on training, validation, testing data
2020-01-07 22:35:35,058 [INFO] Evaluating predictions (results)
/home/hasitha/anaconda3/lib/python3.7/site-packages/sklearn/metrics/classification.py:1143: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples.
  'precision', 'predicted', average, warn_for)
2020-01-07 22:35:47,223 [INFO] Dataset: Testing. Classification report below
2020-01-07 22:35:47,223 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       1.00      0.12      0.22        24
        Brute Force -XSS       1.00      0.33      0.50         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.77      0.34      0.47        67
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23010
   DoS attacks-GoldenEye       0.99      1.00      0.99      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.71      0.54      0.62      5596
   DoS attacks-Slowloris       0.96      0.97      0.97       440
          FTP-BruteForce       0.72      0.84      0.78      7718
           Infilteration       0.45      0.01      0.02      6404
           SQL Injection       0.00      0.00      0.00         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

               micro avg       0.98      0.98      0.98    645488
               macro avg       0.84      0.68      0.70    645488
            weighted avg       0.98      0.98      0.98    645488

2020-01-07 22:35:47,224 [INFO] Overall accuracy (micro avg): 0.9834915598740798
/home/hasitha/sunanda/ids_experiments/utility.py:328: RuntimeWarning: invalid value encountered in true_divide
  PPV = TP / (TP + FP)    # Precision or positive predictive value
/home/hasitha/sunanda/ids_experiments/utility.py:332: RuntimeWarning: invalid value encountered in true_divide
  FDR = FP / (TP + FP)    # False discovery rate
2020-01-07 22:36:01,049 [INFO] Average metrics for Testing dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9835         0.9835                       0.9835                0.0012                   0.0165  0.9835
1     Macro avg        0.9978         0.8391                       0.6770                0.0044                   0.3230  0.7038
2  Weighted avg        0.9910         0.9783                       0.9835                0.0495                   0.0165  0.9786
2020-01-07 22:36:13,188 [INFO] Dataset: Validation. Classification report below
2020-01-07 22:36:13,188 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99    535650
                     Bot       1.00      1.00      1.00     11465
        Brute Force -Web       1.00      0.20      0.33        25
        Brute Force -XSS       1.00      0.67      0.80         9
        DDOS attack-HOIC       1.00      1.00      1.00     27447
    DDOS attack-LOIC-UDP       0.70      0.34      0.46        68
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     23009
   DoS attacks-GoldenEye       0.99      0.99      0.99      1651
        DoS attacks-Hulk       1.00      1.00      1.00     18478
DoS attacks-SlowHTTPTest       0.72      0.54      0.62      5596
   DoS attacks-Slowloris       0.94      0.98      0.96       439
          FTP-BruteForce       0.72      0.85      0.78      7718
           Infilteration       0.44      0.01      0.03      6403
           SQL Injection       0.00      0.00      0.00         4
          SSH-Bruteforce       1.00      1.00      1.00      7525

               micro avg       0.98      0.98      0.98    645487
               macro avg       0.83      0.70      0.73    645487
            weighted avg       0.98      0.98      0.98    645487

2020-01-07 22:36:13,188 [INFO] Overall accuracy (micro avg): 0.9835132233491921
2020-01-07 22:36:27,015 [INFO] Average metrics for Validation dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9835         0.9835                       0.9835                0.0012                   0.0165  0.9835
1     Macro avg        0.9978         0.8330                       0.7046                0.0044                   0.2954  0.7299
2  Weighted avg        0.9910         0.9783                       0.9835                0.0494                   0.0165  0.9786
2020-01-07 22:37:06,584 [INFO] Dataset: Training. Classification report below
2020-01-07 22:37:06,584 [INFO] 
                          precision    recall  f1-score   support

                  Benign       0.99      1.00      0.99   1606949
                     Bot       1.00      1.00      1.00     34396
        Brute Force -Web       1.00      0.12      0.22        73
        Brute Force -XSS       1.00      0.50      0.67        26
        DDOS attack-HOIC       1.00      1.00      1.00     82341
    DDOS attack-LOIC-UDP       0.74      0.35      0.48       203
  DDoS attacks-LOIC-HTTP       0.99      0.99      0.99     69029
   DoS attacks-GoldenEye       0.99      1.00      0.99      4954
        DoS attacks-Hulk       1.00      1.00      1.00     55435
DoS attacks-SlowHTTPTest       0.72      0.54      0.61     16787
   DoS attacks-Slowloris       0.96      0.99      0.98      1318
          FTP-BruteForce       0.72      0.85      0.78     23153
           Infilteration       0.50      0.01      0.03     19210
           SQL Injection       0.00      0.00      0.00        12
          SSH-Bruteforce       1.00      1.00      1.00     22576

               micro avg       0.98      0.98      0.98   1936462
               macro avg       0.84      0.69      0.72   1936462
            weighted avg       0.98      0.98      0.98   1936462

2020-01-07 22:37:06,584 [INFO] Overall accuracy (micro avg): 0.983540601364757
2020-01-07 22:37:51,528 [INFO] Average metrics for Training dataset below
   average type  avg accuracy  avg precision  avg detection rate (recall)  avg false alarm rate  avg false negative rate  avg f1
0     Micro avg        0.9835         0.9835                       0.9835                0.0012                   0.0165  0.9835
1     Macro avg        0.9978         0.8411                       0.6904                0.0044                   0.3096  0.7162
2  Weighted avg        0.9910         0.9789                       0.9835                0.0492                   0.0165  0.9787
2020-01-07 22:37:51,554 [INFO] Results saved to: results_additional_exps/ann_data_efficiency_ids18_p100/ann_data_efficiency_ids18_p100_results.xlsx
2020-01-07 22:37:51,562 [INFO] ================= Finished running experiment no. 10 ================= 

2020-01-07 22:37:51,639 [INFO] ================= Finished running 3 experiments ================= 
